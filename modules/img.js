const _0x131e23=_0xf60c;(function(_0x51e2ca,_0x210218){const _0x46d3c4=_0xf60c,_0x263662=_0x51e2ca();while(!![]){try{const _0x33c521=parseInt(_0x46d3c4(0xec))/(0xbcd+-0x2ad*0xe+-0x5a*-0x49)*(-parseInt(_0x46d3c4(0x134))/(-0x93+-0x1b2a+0x1bbf))+-parseInt(_0x46d3c4(0xee))/(0x25*-0x7f+-0x12*-0x149+-0x4c4)+parseInt(_0x46d3c4(0x122))/(-0xf55+-0x4*0x458+0x20b9*0x1)*(parseInt(_0x46d3c4(0x111))/(0x783+0x2056*-0x1+-0xd4*-0x1e))+parseInt(_0x46d3c4(0x106))/(0xf9d*0x1+0x1224+0x311*-0xb)*(-parseInt(_0x46d3c4(0xed))/(-0x46c*0x4+-0xe03+0x1fba))+parseInt(_0x46d3c4(0x142))/(-0x68a*0x2+-0x25*-0x57+-0x1*-0x89)*(-parseInt(_0x46d3c4(0x124))/(-0x1*-0x869+0x1048*-0x1+0x2*0x3f4))+-parseInt(_0x46d3c4(0x146))/(0xa96*0x1+0x25fe+-0x308a)*(parseInt(_0x46d3c4(0x13f))/(-0x197+-0x1abb*0x1+0x1c5d))+parseInt(_0x46d3c4(0x12a))/(0xfa3+-0x1e2c+0xe95)*(parseInt(_0x46d3c4(0xfc))/(-0xcc9*-0x1+0x11f*0x1+-0xddb));if(_0x33c521===_0x210218)break;else _0x263662['push'](_0x263662['shift']());}catch(_0x39f5a7){_0x263662['push'](_0x263662['shift']());}}}(_0x3388,-0x58952+-0x3183f+-0x76*-0x19a3));import{info,warn,error}from'../utils/logger.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import _0x4bfd63 from'axios';export const name='img';function _0x3388(){const _0x200c9c=['startsWith','C2&first=1','get','text','\x20a\x20search\x20','string','35xEIfsm','ch\x20failed:','\x20handler\x20e','Found\x20(no\x20','https://ww','add','\x0a•\x20img\x203\x20:','/images/se',':\x20\x22$1\x22',':\x20sent\x20','ror:\x20','No\x20images\x20','trim','data',':\x20Could\x20no','ge\x20error','rror:\x20','37920RiSVqt','1.0.8','955467ocqidy','has','Which\x20imag','&form=HDRS','murl',':\x20findStor','3900zQQHtd','key','\x20cleaned\x20u','push','http','ples:\x0a•\x20im','turl',':\x20botInsta','exec','message','38SXzLaF','Searching\x20','Source:\x20','max','mg\x201\x20trees','slice','w.bing.com','url','toLowerCas','from','ch\x20failed\x20','1628803bjxfMK','\x20cleanup\x20e','replace','16biDzRg','isCommand','join',':\x20send\x20ima','10NDzuIX','right\x20now.','for\x20messag','length','Result:\x20','\x20images\x20to','images\x20for','found\x20for\x20','14041ClBNEU','917413GOllYS','1237485xJqPIa','sendMessag','img','stination\x20','rror','arch?q=','thumb','):\x20','BasicHover',':\x20initiali','sourcePage','\x20sunsets','\x22\x20(sending','clear','63011zLkQJq','your\x20searc','bot','.com)','direct\x20URL',')...','Image\x20sear','edMatch\x20er','t\x20determin','jid','18aNspFi','.0;\x20+https','h\x20term.','parse','0\x20(compati'];_0x3388=function(){return _0x200c9c;};return _0x3388();}export const version=_0x131e23(0x123);export const priority=0x913*-0x3+0xba5+0xf9e;let botInstance=null,respondedMsgIds=new Set();async function findStoredMatchFromFindings(_0x2eb2e1=[]){const _0x421e23=_0x131e23;try{const _0x13f64d=await listSudo(),_0x206fde=new Set(_0x13f64d['map'](String));for(const _0x102cf0 of _0x2eb2e1){if(!_0x102cf0||typeof _0x102cf0[_0x421e23(0x105)]!==_0x421e23(0x110))continue;const _0x4acb6b=normalizeToJid(_0x102cf0['jid']);if(_0x4acb6b&&_0x206fde[_0x421e23(0x125)](_0x4acb6b))return _0x4acb6b;if(_0x206fde[_0x421e23(0x125)](_0x102cf0[_0x421e23(0x105)]))return _0x102cf0['jid'];}return null;}catch(_0x41772e){return warn(name+(_0x421e23(0x129)+_0x421e23(0x103)+_0x421e23(0x11b))+(_0x41772e?.[_0x421e23(0x133)]||_0x41772e)),null;}}function htmlUnescape(_0x41832d){const _0x3eefe7=_0x131e23;if(!_0x41832d||typeof _0x41832d!==_0x3eefe7(0x110))return _0x41832d;return _0x41832d[_0x3eefe7(0x141)](/&quot;/g,'\x22')[_0x3eefe7(0x141)](/&#39;/g,'\x27')[_0x3eefe7(0x141)](/&amp;/g,'&')[_0x3eefe7(0x141)](/&lt;/g,'<')[_0x3eefe7(0x141)](/&gt;/g,'>')[_0x3eefe7(0x141)](/&nbsp;/g,'\x20');}function tryParseJsonSafe(_0x125fde){const _0x970167=_0x131e23;if(!_0x125fde||typeof _0x125fde!==_0x970167(0x110))return null;try{return JSON[_0x970167(0x109)](_0x125fde);}catch(_0xe37a1f){try{const _0x372278=htmlUnescape(_0x125fde);return JSON[_0x970167(0x109)](_0x372278);}catch(_0x12aa28){try{const _0x4d6830=htmlUnescape(_0x125fde)['replace'](/(['"])?([a-zA-Z0-9_]+)\1\s*:/g,'\x22$2\x22:')[_0x970167(0x141)](/:\s*'([^']*)'/g,_0x970167(0x119));return JSON['parse'](_0x4d6830);}catch(_0x24ddc6){return null;}}}}async function searchBingNoCheerio(_0x526a82,_0x3370c0=-0x22d7+-0x987+0x2c66){const _0x3bcd40=_0x131e23;try{const _0x3bba74=encodeURIComponent(_0x526a82),_0x33d4b8=_0x3bcd40(0x115)+_0x3bcd40(0x13a)+_0x3bcd40(0x118)+_0x3bcd40(0xf3)+_0x3bba74+(_0x3bcd40(0x127)+_0x3bcd40(0x10c)+'&tsc=Image'+_0x3bcd40(0xf6)),_0x5989ce=await _0x4bfd63[_0x3bcd40(0x10d)](_0x33d4b8,{'headers':{'User-Agent':'Mozilla/5.'+_0x3bcd40(0x10a)+'ble;\x20Bot/1'+_0x3bcd40(0x107)+'://example'+_0x3bcd40(0xff)},'responseType':_0x3bcd40(0x10e),'maxRedirects':0x5}),_0x57b098=String(_0x5989ce[_0x3bcd40(0x11e)]||''),_0xd3baf5=/ m=(?:"([^"]+)"|'([^']+)')/g,_0x59202c=[];let _0x436323;while((_0x436323=_0xd3baf5[_0x3bcd40(0x132)](_0x57b098))&&_0x59202c['length']<_0x3370c0){const _0x289780=_0x436323[0xf49+0x1014+-0x1f5c]||_0x436323[0x3e*-0x5+0x11a6+-0x106e];if(!_0x289780)continue;const _0x127c90=htmlUnescape(_0x289780),_0x43f6d4=tryParseJsonSafe(_0x127c90);if(!_0x43f6d4)continue;const _0x104975=_0x43f6d4[_0x3bcd40(0x128)]||_0x43f6d4['m']||_0x43f6d4[_0x3bcd40(0x130)]||_0x43f6d4['p']||null;if(!_0x104975)continue;_0x59202c[_0x3bcd40(0x12d)]({'url':_0x104975,'thumb':_0x43f6d4[_0x3bcd40(0x130)]||null,'sourcePage':_0x43f6d4['p']||null,'title':_0x43f6d4['t']||null});}if(_0x59202c['length']===-0x341*-0xb+-0x182b+-0xba0){const _0x457941=/<img[^>]+(?:data-src|src|data-thumb)=["']([^"']+)["'][^>]*>/g;while((_0x436323=_0x457941[_0x3bcd40(0x132)](_0x57b098))&&_0x59202c[_0x3bcd40(0xe7)]<_0x3370c0){const _0x459b08=_0x436323[0x168b*0x1+-0xb*-0x41+-0x1*0x1955];_0x459b08&&String(_0x459b08)[_0x3bcd40(0x10b)](_0x3bcd40(0x12e))&&_0x59202c[_0x3bcd40(0x12d)]({'url':_0x459b08,'thumb':_0x459b08,'sourcePage':null,'title':null});}}return _0x59202c[_0x3bcd40(0x139)](0x110f+0x8d2+-0x19e1,_0x3370c0);}catch(_0x3643b0){throw _0x3643b0;}}async function performImageSearch(_0x23397e,_0x32bd68=0x1*0x2b6+-0x2342+0x4*0x825){const _0x3834e2=_0x131e23;try{const _0x5a82ef=await searchBingNoCheerio(_0x23397e,_0x32bd68);return _0x5a82ef;}catch(_0x3c6698){throw new Error('Image\x20sear'+_0x3834e2(0x112)+'\x20'+(_0x3c6698?.['message']||_0x3c6698));}}export async function initialize(_0xcb0187){const _0x3c7ea6=_0x131e23;botInstance=_0xcb0187,info(name+(_0x3c7ea6(0xf7)+'zed.'));}export async function onMessage(_0x483a68){const _0x4889dd=_0x131e23;try{if(!_0x483a68?.[_0x4889dd(0x12b)]||!_0x483a68[_0x4889dd(0x143)])return;const _0x599345=_0x483a68[_0x4889dd(0x12b)]['id'];if(_0x599345&&respondedMsgIds['has'](_0x599345))return;if(_0x599345)respondedMsgIds[_0x4889dd(0x116)](_0x599345);const _0x5390a6=(_0x483a68['text']||'')[_0x4889dd(0x11d)]();if(!_0x5390a6[_0x4889dd(0x13c)+'e']()['startsWith'](_0x4889dd(0xf0)))return;const _0x77f385=_0x5390a6['split'](/\s+/),_0x3d5054=_0x77f385[-0x711+-0xede+-0x463*-0x5][_0x4889dd(0x13c)+'e']();if(_0x3d5054!==_0x4889dd(0xf0))return;if(!botInstance)botInstance=_0x483a68[_0x4889dd(0xfe)]||_0x483a68['client'];if(!botInstance){warn(name+(_0x4889dd(0x131)+'nce\x20missin'+'g'));return;}const _0x1973a0=getBotJid();let _0x51bf0c;if(_0x483a68['key']['fromMe'])_0x51bf0c=_0x1973a0;else{const _0xf1e194=await isSudo(botInstance,_0x483a68)['catch'](()=>![]);if(!_0xf1e194)return;const {findings:_0x461cd6}=userJidFromCtx(_0x483a68),_0x4b12cc=await findStoredMatchFromFindings(_0x461cd6);if(!_0x4b12cc)return;_0x51bf0c=_0x4b12cc;}if(!_0x51bf0c){warn(name+(_0x4889dd(0x11f)+_0x4889dd(0x104)+'e\x20final\x20de'+_0x4889dd(0xf1)+_0x4889dd(0xe6)+'e.'));return;}let _0xca3039=0x1d41+-0x1c4d+-0xee,_0x579fc1=_0x77f385['slice'](-0x21ad+-0x131*-0xf+-0xd5*-0x13)[_0x4889dd(0x144)]('\x20');if(_0x77f385[_0x4889dd(0xe7)]>=0x236b*-0x1+0x1*-0x178+-0x5*-0x761){const _0x435a39=parseInt(_0x77f385[-0x297+0x1*0x20e9+-0x1e51],0x500*0x7+-0x15*-0x67+-0x2b69);if(!Number['isNaN'](_0x435a39)){_0xca3039=Math[_0x4889dd(0x137)](0x14*0x71+-0x11b*0x17+0x109a*0x1,_0x435a39);if(_0xca3039>-0x3fb*0x1+0x1003*0x1+-0x601*0x2)_0xca3039=-0x2af*0xd+-0x1bd8+-0x99*-0x69;_0x579fc1=_0x77f385[_0x4889dd(0x139)](-0x1d30+-0xf*0x5+0x1d7d)[_0x4889dd(0x144)]('\x20');}else _0xca3039=0x1fef+-0xd28*0x1+-0x12c1,_0x579fc1=_0x77f385[_0x4889dd(0x139)](0x1097*-0x2+-0x2022+0x2d7*0x17)[_0x4889dd(0x144)]('\x20');}_0x579fc1=(_0x579fc1||'')[_0x4889dd(0x11d)]();if(!_0x579fc1){await botInstance[_0x4889dd(0xef)+'e'](_0x51bf0c,{'text':_0x4889dd(0x126)+'e?\x20Provide'+_0x4889dd(0x10f)+'term.\x20Exam'+_0x4889dd(0x12f)+'g\x20cats\x0a•\x20i'+_0x4889dd(0x138)+_0x4889dd(0x117)+_0x4889dd(0xf9)});return;}try{await botInstance[_0x4889dd(0xef)+'e'](_0x51bf0c,{'text':'Searching\x20'+'images\x20for'+'\x20\x22'+_0x579fc1+(_0x4889dd(0xfa)+'\x20')+_0xca3039+')...'},{'quoted':_0x483a68['ms']});}catch(_0x2cd8d4){try{await botInstance[_0x4889dd(0xef)+'e'](_0x51bf0c,{'text':_0x4889dd(0x135)+_0x4889dd(0xea)+'\x20\x22'+_0x579fc1+(_0x4889dd(0xfa)+'\x20')+_0xca3039+_0x4889dd(0x101)});}catch(_0x3a2708){}}let _0x3d9346;try{_0x3d9346=await performImageSearch(_0x579fc1,Math[_0x4889dd(0x137)](-0x2569+-0x888*-0x2+0x145a,_0xca3039));}catch(_0x426b3b){error(_0x426b3b,name+(':\x20image\x20se'+'arch\x20faile'+'d')),await botInstance[_0x4889dd(0xef)+'e'](_0x51bf0c,{'text':_0x4889dd(0x102)+_0x4889dd(0x13e)+_0x4889dd(0xe5)});return;}if(!Array['isArray'](_0x3d9346)||_0x3d9346[_0x4889dd(0xe7)]===0x1*0x69e+-0x232*0x3+-0x8){await botInstance[_0x4889dd(0xef)+'e'](_0x51bf0c,{'text':_0x4889dd(0x11c)+_0x4889dd(0xeb)+_0x4889dd(0xfd)+_0x4889dd(0x108)});return;}const _0x10bbf5=_0x3d9346[_0x4889dd(0x139)](-0x1f*0x3+0x17*-0x5+0xd0,_0xca3039);for(const _0xa292d5 of _0x10bbf5){try{_0xa292d5[_0x4889dd(0x13b)]&&String(_0xa292d5[_0x4889dd(0x13b)])[_0x4889dd(0x10b)]('http')?await botInstance[_0x4889dd(0xef)+'e'](_0x51bf0c,{'image':{'url':_0xa292d5['url']},'caption':_0x4889dd(0xe8)+_0x579fc1},{'quoted':_0x483a68['ms']}):await botInstance[_0x4889dd(0xef)+'e'](_0x51bf0c,{'text':_0x4889dd(0x114)+_0x4889dd(0x100)+_0x4889dd(0xf5)+(_0xa292d5[_0x4889dd(0xf8)]||_0xa292d5[_0x4889dd(0xf4)]||'unknown')});}catch(_0xf8d154){error(_0xf8d154,name+(_0x4889dd(0x145)+_0x4889dd(0x120)));if(_0xa292d5['sourcePage'])try{await botInstance['sendMessag'+'e'](_0x51bf0c,{'text':_0x4889dd(0x136)+_0xa292d5[_0x4889dd(0xf8)]});}catch(_0xda8786){}}}info(name+_0x4889dd(0x11a)+_0x10bbf5[_0x4889dd(0xe7)]+(_0x4889dd(0xe9)+'\x20')+_0x51bf0c);if(respondedMsgIds['size']>0x752+0x1817+-0xbe1){const _0x240f6a=Array[_0x4889dd(0x13d)](respondedMsgIds);respondedMsgIds=new Set(_0x240f6a['slice'](-(0x299+-0x342*-0x1+0x5dd)));}}catch(_0xdd71ca){error(_0xdd71ca,name+(_0x4889dd(0x113)+_0x4889dd(0xf2)));}}function _0xf60c(_0x39bd19,_0x331183){const _0x49e7a=_0x3388();return _0xf60c=function(_0x4509f8,_0xe764e9){_0x4509f8=_0x4509f8-(-0x2195*-0x1+0x26e2+-0x4792);let _0x3de636=_0x49e7a[_0x4509f8];return _0x3de636;},_0xf60c(_0x39bd19,_0x331183);}export async function cleanup(){const _0x28ef51=_0x131e23;try{botInstance=null,respondedMsgIds[_0x28ef51(0xfb)](),info(name+(_0x28ef51(0x12c)+'p'));}catch(_0xe74915){warn(name+(_0x28ef51(0x140)+_0x28ef51(0x121))+(_0xe74915?.['message']||_0xe74915));}}