const _0x29995d=_0x5961;(function(_0x37d2be,_0x1a107c){const _0x2ff9d1=_0x5961,_0x56e6ee=_0x37d2be();while(!![]){try{const _0x4dbdab=parseInt(_0x2ff9d1(0x11d))/(0x1f23+-0xe5*-0x25+-0x9*0x723)*(parseInt(_0x2ff9d1(0x328))/(0xadb*0x1+0xaf5*0x1+0x1*-0x15ce))+-parseInt(_0x2ff9d1(0x16b))/(0x21aa+0x6*0x1f1+0x1*-0x2d4d)+parseInt(_0x2ff9d1(0x250))/(0x23c1+0x2185+0x24f*-0x1e)+-parseInt(_0x2ff9d1(0x269))/(-0x211d*0x1+-0x78a*0x1+0x28ac)*(parseInt(_0x2ff9d1(0x174))/(0x4*-0x6af+-0x1*0x2356+-0x4*-0xf86))+-parseInt(_0x2ff9d1(0x201))/(0x1629+0xf0d*-0x2+-0x28*-0x33)*(parseInt(_0x2ff9d1(0x345))/(0xe*0xd7+0xbe3+-0x179d))+-parseInt(_0x2ff9d1(0x105))/(0x210+-0xbea+0x9e3)+parseInt(_0x2ff9d1(0x205))/(-0x159c+0x3d8+0x11ce)*(parseInt(_0x2ff9d1(0x102))/(0x1b0*0xa+-0x1d*0xa+-0xfb3));if(_0x4dbdab===_0x1a107c)break;else _0x56e6ee['push'](_0x56e6ee['shift']());}catch(_0x156e0a){_0x56e6ee['push'](_0x56e6ee['shift']());}}}(_0x2e85,-0x5f2*-0xbb+-0x226a4+0x64b04));import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import{getDefault,getConnection}from'../utils/connection.js';import{isadmin}from'../utils/isadmin.js';import*as _0x258e00 from'../utils/groups.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name='sched';export const version=_0x29995d(0x262);export const priority=-0xf69+-0x8*-0x13a+0x5ee;export const commands=[_0x29995d(0x33e),'schedule'];export const configKeys=[_0x29995d(0x15e)+_0x29995d(0x18d)+_0x29995d(0x155),_0x29995d(0x30e)+_0x29995d(0x20b)+'NE',_0x29995d(0xa0)+_0x29995d(0x1b0),_0x29995d(0x31a)+_0x29995d(0x13d)+_0x29995d(0x290)];let botRef=null,sendApi=null,schedulerIntervalHandle=null,executorRunning=![],CHECK_INTERVAL_MS=(0xa20+-0xf*0x1fc+-0x10*-0x13e)*(-0x1*-0x1051+-0x2439+-0x7f*-0x30),DEFAULT_TIMEZONE=_0x29995d(0x126)+_0x29995d(0x128),SEND_RETRIES=-0x14dc+0x264+0x127b,INITIAL_BACKOFF_MS=0xc*0xc1+0x26fa+-0x2e12;function ensureArray(_0x2d7b92){const _0x5ccaa0=_0x29995d;if(!_0x2d7b92)return[];if(Array[_0x5ccaa0(0xa7)](_0x2d7b92))return _0x2d7b92;return[_0x2d7b92];}function uniqArray(_0x53dd9f){const _0x59de6c=_0x29995d,_0x48d369=new Set(),_0x3fa962=[];for(const _0x5f5468 of _0x53dd9f||[]){const _0x5995a0=String(_0x5f5468||'')[_0x59de6c(0x32b)]();if(!_0x5995a0)continue;!_0x48d369[_0x59de6c(0x2f7)](_0x5995a0)&&(_0x48d369[_0x59de6c(0xd3)](_0x5995a0),_0x3fa962[_0x59de6c(0x17e)](_0x5995a0));}return _0x3fa962;}async function tableExists(_0x4ac68d){const _0x4ee42b=_0x29995d;try{const _0x3632a7=await db[_0x4ee42b(0x2f4)](_0x4ee42b(0x1a1)+_0x4ee42b(0x302)+_0x4ee42b(0xcf)+'\x20WHERE\x20typ'+_0x4ee42b(0x142)+'AND\x20name=?',[_0x4ac68d]);return!!_0x3632a7;}catch(_0x38e44c){return warn(_0x4ee42b(0x2b8)+'bleExists\x20'+_0x4ee42b(0x14a)+(_0x38e44c?.[_0x4ee42b(0x32f)]||_0x38e44c)),![];}}async function getTableColumns(_0x1784fb){const _0x2190c3=_0x29995d;try{const _0x437b06=await db[_0x2190c3(0x2ad)](_0x2190c3(0x1ad)+_0x2190c3(0x1b4)+_0x1784fb+')');return(_0x437b06||[])[_0x2190c3(0x15a)](_0x143e44=>_0x143e44['name']);}catch(_0x41e685){return warn('[sched]\x20ge'+_0x2190c3(0x110)+_0x2190c3(0x158)+_0x2190c3(0x29e)+_0x1784fb+':\x20'+(_0x41e685?.[_0x2190c3(0x32f)]||_0x41e685)),[];}}function resolveChatJidFromRow(_0x2bfb09){const _0x2431b8=_0x29995d,_0x3d57a5=[_0x2431b8(0xba),_0x2431b8(0x1ce),'chat_id',_0x2431b8(0x122),_0x2431b8(0x146),_0x2431b8(0xda),_0x2431b8(0xac)];for(const _0x5e6330 of _0x3d57a5)if(_0x5e6330 in _0x2bfb09&&_0x2bfb09[_0x5e6330])return String(_0x2bfb09[_0x5e6330]);for(const _0x36d358 of Object['keys'](_0x2bfb09)){const _0x4e7bf8=_0x2bfb09[_0x36d358];if(typeof _0x4e7bf8===_0x2431b8(0x1d1)&&_0x4e7bf8[_0x2431b8(0xa9)]('@'))return _0x4e7bf8;}return null;}function resolveMessageFromRow(_0x317a28){const _0xb6b4a=_0x29995d,_0x53df70=[_0xb6b4a(0x32f),'msg',_0xb6b4a(0x1a2),_0xb6b4a(0x2ba),_0xb6b4a(0xc5)];for(const _0x2fc65b of _0x53df70)if(_0x2fc65b in _0x317a28&&_0x317a28[_0x2fc65b]!=null)return String(_0x317a28[_0x2fc65b]);for(const _0x426762 of Object['keys'](_0x317a28)){if(typeof _0x317a28[_0x426762]==='string'&&_0x317a28[_0x426762][_0xb6b4a(0xaf)]>0x6dd+0x8*0x406+-0x270d&&!_0x317a28[_0x426762][_0xb6b4a(0xa9)]('@'))return _0x317a28[_0x426762];}return'';}function resolveWhenFromRow(_0x39cefb){const _0x300f59=_0x29995d,_0x54a705=[_0x300f59(0x1bf),_0x300f59(0x1c4),_0x300f59(0x116),'send',_0x300f59(0x1cd),'ts','time_at'];for(const _0x1f4e4a of _0x54a705){if(_0x1f4e4a in _0x39cefb&&_0x39cefb[_0x1f4e4a]){const _0x4e1311=Number(_0x39cefb[_0x1f4e4a]);if(!Number[_0x300f59(0x10b)](_0x4e1311)&&_0x4e1311>-0x9c0b*0x37c7+0x55d3f415+0x158*0x5c94d)return{'send_at':_0x4e1311};}}const _0x3b4c5a=['time','hhmm',_0x300f59(0x147)+_0x300f59(0x2f6),_0x300f59(0x176)+_0x300f59(0x166)];for(const _0x454236 of _0x3b4c5a){if(_0x454236 in _0x39cefb&&_0x39cefb[_0x454236]){const _0x2b1c2d=String(_0x39cefb[_0x454236])[_0x300f59(0x32b)]();if(/^\d{1,2}:\d{2}$/['test'](_0x2b1c2d))return{'time':_0x2b1c2d};}}return{'time':null,'send_at':null};}async function readAndNormalizeExistingSchedules(){const _0x2fbdf6=_0x29995d;try{const _0x152f02=await db['all'](_0x2fbdf6(0x31e)+_0x2fbdf6(0x10e)+_0x2fbdf6(0x2cc)),_0x5914e5=[];for(const _0x55f13e of _0x152f02||[]){const _0x1c07e9=resolveChatJidFromRow(_0x55f13e)||'',_0x2cd9f0=resolveMessageFromRow(_0x55f13e)||'',_0x30206e=resolveWhenFromRow(_0x55f13e)||{};let _0x2479ef=_0x55f13e['frequency']||_0x55f13e[_0x2fbdf6(0x1f7)]||_0x55f13e['repeat']||_0x55f13e[_0x2fbdf6(0x1cc)]||_0x2fbdf6(0x19b);if(typeof _0x2479ef===_0x2fbdf6(0x1b7))_0x2479ef=_0x2fbdf6(0x227)+_0x2fbdf6(0x2c2)+_0x2479ef;const _0x2e22d3=_0x55f13e[_0x2fbdf6(0x123)]||_0x55f13e['tz']||null,_0x30b629=_0x55f13e[_0x2fbdf6(0xb4)+'d']||_0x55f13e[_0x2fbdf6(0x235)]||_0x55f13e[_0x2fbdf6(0x241)]||_0x55f13e['creator']||'';let _0xe9798b=Number(_0x55f13e[_0x2fbdf6(0x21a)]||_0x55f13e['ts']||_0x55f13e['timestamp']||0x1*0x50e+-0x5*-0x26a+0x224*-0x8);if(!_0xe9798b)_0xe9798b=Math[_0x2fbdf6(0x324)](Date[_0x2fbdf6(0x19d)]()/(0x3fa+0x16*-0x101+0xb02*0x2));_0x5914e5['push']({'chat_jid':_0x1c07e9,'message':_0x2cd9f0,'time':_0x30206e[_0x2fbdf6(0x166)]||null,'send_at':_0x30206e[_0x2fbdf6(0x1bf)]||null,'frequency':_0x2479ef||_0x2fbdf6(0x19b),'timezone':_0x2e22d3,'last_sent':Number(_0x55f13e['last_sent']||_0x55f13e[_0x2fbdf6(0x289)]||-0x1*-0x2da+0x11d1+-0x14ab)||0x1698+-0x1*0xff1+0x1*-0x6a7,'creator_jid':_0x30b629||'','created_at':_0xe9798b});}return _0x5914e5;}catch(_0x31df90){return warn(_0x2fbdf6(0x28f)+_0x2fbdf6(0xb9)+'lizeExisti'+_0x2fbdf6(0x181)+_0x2fbdf6(0x13e)+(_0x31df90?.[_0x2fbdf6(0x32f)]||_0x31df90)),[];}}async function ensureSchema(){const _0x334379=_0x29995d,_0xede446={'id':'INTEGER\x20PR'+_0x334379(0x287)+_0x334379(0x26d)+'ENT','chat_jid':'TEXT\x20NOT\x20N'+_0x334379(0x25c),'message':_0x334379(0x159)+_0x334379(0x25c),'time':_0x334379(0x1d8),'send_at':'INTEGER','frequency':_0x334379(0x334)+_0x334379(0x1a7),'timezone':_0x334379(0x1d8),'last_sent':'INTEGER','creator_jid':_0x334379(0x159)+'ULL','enabled':_0x334379(0x171)+'FAULT\x201','created_at':_0x334379(0x171)+_0x334379(0x234)+_0x334379(0x2ec)+_0x334379(0xa1)};try{const _0x576443=await tableExists(_0x334379(0x133));if(!_0x576443){const _0x38c09e=Object[_0x334379(0xed)](_0xede446)['map'](([_0x5b1351,_0x39ebac])=>_0x5b1351+'\x20'+_0x39ebac)[_0x334379(0x161)](_0x334379(0x264));await db[_0x334379(0x134)](_0x334379(0x204)+_0x334379(0x308)+_0x334379(0x2e6)+_0x38c09e+_0x334379(0x294));try{await db[_0x334379(0x134)]('CREATE\x20IND'+_0x334379(0x1d3)+'EXISTS\x20idx'+'_schedules'+'_chat\x20ON\x20s'+_0x334379(0x106)+'hat_jid);');}catch(_0x35f16c){}info(_0x334379(0x2b0)+'eated\x20cano'+'nical\x20sche'+'dules\x20tabl'+'e'),await db[_0x334379(0x134)](_0x334379(0x256)+_0x334379(0x261)+_0x334379(0x25d)+'XISTS\x20sche'+_0x334379(0x29d)+_0x334379(0x273)+'\x20\x20\x20\x20\x20\x20\x20cha'+_0x334379(0x319)+'\x20PRIMARY\x20K'+_0x334379(0x304)+'\x20\x20\x20\x20enable'+'d\x20INTEGER\x20'+'DEFAULT\x201,'+_0x334379(0x125)+'\x20timezone\x20'+_0x334379(0x14f)+_0x334379(0x2cd)+'\x20\x20');return;}const _0x55a8d6=await getTableColumns(_0x334379(0x133)),_0x2ab043=_0x55a8d6[_0x334379(0xa9)]('chat_jid'),_0x14708a=_0x55a8d6[_0x334379(0xa9)](_0x334379(0x32f))||_0x55a8d6[_0x334379(0xa9)]('msg')||_0x55a8d6[_0x334379(0xa9)](_0x334379(0x2ba))||_0x55a8d6[_0x334379(0xa9)](_0x334379(0x1a2)),_0x551cec=_0x55a8d6[_0x334379(0xa9)](_0x334379(0xb4)+'d')||_0x55a8d6[_0x334379(0xa9)](_0x334379(0x235))||_0x55a8d6[_0x334379(0xa9)](_0x334379(0x241));if(_0x2ab043&&_0x14708a&&_0x551cec){try{await db[_0x334379(0x134)](_0x334379(0x27c)+_0x334379(0x1d3)+_0x334379(0x209)+_0x334379(0x1e9)+_0x334379(0xf1)+_0x334379(0x106)+'hat_jid);');}catch(_0x51cb38){}await db[_0x334379(0x134)](_0x334379(0x256)+_0x334379(0x261)+_0x334379(0x25d)+_0x334379(0x2d3)+'duler_sett'+_0x334379(0x273)+_0x334379(0x31f)+'t_jid\x20TEXT'+'\x20PRIMARY\x20K'+_0x334379(0x304)+'\x20\x20\x20\x20enable'+_0x334379(0x2ff)+_0x334379(0x2df)+_0x334379(0x125)+_0x334379(0x121)+_0x334379(0x14f)+_0x334379(0x2cd)+'\x20\x20'),info('[sched]\x20sc'+_0x334379(0x141)+_0x334379(0x16c)+_0x334379(0x22e)+_0x334379(0x2a8));return;}info('[sched]\x20Le'+_0x334379(0x2de)+_0x334379(0x23e)+'ted\x20â€”\x20migr'+'ating\x20safe'+'ly');const _0x51acb5=await readAndNormalizeExistingSchedules();await db[_0x334379(0x134)](_0x334379(0x2b7)+_0x334379(0xd4)+_0x334379(0x139));try{await db[_0x334379(0x134)](_0x334379(0x204)+'LE\x20IF\x20NOT\x20'+'EXISTS\x20sch'+'edules_new'+'\x20(\x0a\x20\x20\x20\x20\x20\x20\x20'+_0x334379(0x189)+_0x334379(0xdf)+_0x334379(0xea)+_0x334379(0x21f)+_0x334379(0x31f)+'t_jid\x20TEXT'+_0x334379(0x2be)+_0x334379(0x2b2)+'essage\x20TEX'+_0x334379(0x221)+',\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x334379(0x2ca)+_0x334379(0x15d)+_0x334379(0x247)+_0x334379(0x164)+_0x334379(0x24c)+_0x334379(0x15b)+_0x334379(0x2b3)+_0x334379(0x12c)+_0x334379(0x27a)+_0x334379(0xb8)+_0x334379(0x245)+'t_sent\x20INT'+_0x334379(0x164)+_0x334379(0x2cb)+_0x334379(0x17f)+_0x334379(0x2be)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20e'+_0x334379(0x2fc)+_0x334379(0x11c)+'LT\x201,\x0a\x20\x20\x20\x20'+_0x334379(0x2d4)+'d_at\x20INTEG'+_0x334379(0x1af)+_0x334379(0x2b5)+_0x334379(0x254)+'\x27))\x0a\x20\x20\x20\x20\x20\x20'+');');}catch(_0x3e04b5){await db[_0x334379(0x134)]('CREATE\x20TAB'+_0x334379(0x297)+'EXISTS\x20sch'+_0x334379(0x1f4)+_0x334379(0x246)+_0x334379(0x189)+_0x334379(0xdf)+_0x334379(0xea)+_0x334379(0x21f)+_0x334379(0x31f)+'t_jid\x20TEXT'+_0x334379(0x2be)+_0x334379(0x2b2)+_0x334379(0x251)+_0x334379(0x221)+_0x334379(0x2c3)+_0x334379(0x2ca)+_0x334379(0x15d)+_0x334379(0x247)+'EGER,\x0a\x20\x20\x20\x20'+'\x20\x20\x20\x20freque'+_0x334379(0x306)+'\x20\x20\x20\x20\x20\x20\x20\x20ti'+_0x334379(0x1e5)+_0x334379(0x2e7)+'\x20last_sent'+_0x334379(0x187)+_0x334379(0x199)+_0x334379(0x1e6)+_0x334379(0x159)+_0x334379(0x1bd)+_0x334379(0x1e0)+_0x334379(0x187)+_0x334379(0x199)+'eated_at\x20I'+_0x334379(0x330)+_0x334379(0x1cb)),warn('[sched]\x20cr'+_0x334379(0x197)+_0x334379(0x172)+_0x334379(0x33f)+'faults\x20as\x20'+'fallback');}const _0x48814b=await db[_0x334379(0x242)]('INSERT\x20INT'+_0x334379(0xa8)+'s_new\x20(cha'+_0x334379(0x337)+_0x334379(0x15f)+',\x20send_at,'+_0x334379(0x27f)+_0x334379(0xbc)+_0x334379(0x10a)+_0x334379(0x339)+_0x334379(0x16d)+_0x334379(0x112)+'ed_at)\x20VAL'+_0x334379(0x165)+_0x334379(0x151)+'?,\x20?,\x20?,\x20?'+_0x334379(0x149));try{for(const _0x5af4f8 of _0x51acb5){try{await _0x48814b['run'](_0x5af4f8['chat_jid']||'',_0x5af4f8[_0x334379(0x32f)]||'',_0x5af4f8[_0x334379(0x166)]||null,_0x5af4f8['send_at']||null,_0x5af4f8[_0x334379(0xdb)]||_0x334379(0x19b),_0x5af4f8[_0x334379(0x123)]||null,_0x5af4f8['last_sent']||0x27a*-0xf+-0xeb7+0x33dd,_0x5af4f8[_0x334379(0xb4)+'d']||'',0x21f4+0x4b6+-0x26a9,_0x5af4f8['created_at']||Math[_0x334379(0x324)](Date[_0x334379(0x19d)]()/(0x2*-0xcbb+0x26ca+0x6*-0x192)));}catch(_0x23f346){warn(_0x334379(0xf2)+_0x334379(0x2c1)+'t\x20normaliz'+'ed\x20schedul'+_0x334379(0x167)+_0x5af4f8[_0x334379(0xba)]+':\x20'+(_0x23f346?.[_0x334379(0x32f)]||_0x23f346));}}}finally{try{await _0x48814b[_0x334379(0x243)]();}catch(_0x211ed0){}}try{const _0x75a37e=_0x334379(0x26c)+_0x334379(0x124)+Math['floor'](Date[_0x334379(0x19d)]()/(0x1fcf*-0x1+-0x1116+-0x1*-0x34cd));await db[_0x334379(0x134)](_0x334379(0x1f1)+_0x334379(0x2d2)+_0x334379(0x1ae)+'O\x20'+_0x75a37e+';'),await db['exec'](_0x334379(0x1f1)+_0x334379(0x2d2)+_0x334379(0x202)+'ME\x20TO\x20sche'+_0x334379(0x162));try{await db[_0x334379(0x134)]('CREATE\x20IND'+_0x334379(0x1d3)+_0x334379(0x209)+'_schedules'+_0x334379(0xf1)+'chedules(c'+_0x334379(0x326));}catch(_0x15c993){}info(_0x334379(0x108)+_0x334379(0x13c)+_0x334379(0x257)+_0x334379(0x303)+_0x334379(0x1e1)+'p');}catch(_0x5ed7f3){warn(_0x334379(0x333)+'ap\x20tables\x20'+'failed:\x20'+(_0x5ed7f3?.[_0x334379(0x32f)]||_0x5ed7f3));throw _0x5ed7f3;}finally{await db[_0x334379(0x134)](_0x334379(0x2b7)+_0x334379(0xd4)+_0x334379(0x2ef));}await db['exec'](_0x334379(0x323)+_0x334379(0x26a)+_0x334379(0x28d)+_0x334379(0x13b)+'ler_settin'+_0x334379(0xd6)+_0x334379(0x1c3)+'d\x20TEXT\x20PRI'+_0x334379(0xe5)+_0x334379(0x2d7)+_0x334379(0x18e)+'GER\x20DEFAUL'+_0x334379(0x325)+_0x334379(0x228)+_0x334379(0x153)+_0x334379(0x2cd));}catch(_0x1d3cd3){error(_0x1d3cd3,_0x334379(0xd7)+_0x334379(0x2bc)+_0x334379(0xa5));throw _0x1d3cd3;}}function refreshConfig(){const _0x5463fb=_0x29995d;try{const _0x35a10c=getConfig()||{};CHECK_INTERVAL_MS=Number(_0x35a10c[_0x5463fb(0x15e)+_0x5463fb(0x18d)+_0x5463fb(0x155)]??CHECK_INTERVAL_MS),DEFAULT_TIMEZONE=_0x35a10c[_0x5463fb(0x30e)+'ULT_TIMEZO'+'NE']||DEFAULT_TIMEZONE,SEND_RETRIES=Number(_0x35a10c[_0x5463fb(0xa0)+_0x5463fb(0x1b0)]??SEND_RETRIES),INITIAL_BACKOFF_MS=Number(_0x35a10c['SCHED_INIT'+_0x5463fb(0x13d)+_0x5463fb(0x290)]??INITIAL_BACKOFF_MS),info(_0x5463fb(0x2ae)+_0x5463fb(0x314)+_0x5463fb(0x145)+_0x5463fb(0x207)+CHECK_INTERVAL_MS+(_0x5463fb(0x1e3)+'TZ=')+DEFAULT_TIMEZONE);}catch(_0xd6acfc){warn(_0x5463fb(0x28f)+_0x5463fb(0x2a4)+'g\x20error:\x20'+(_0xd6acfc?.[_0x5463fb(0x32f)]||_0xd6acfc));}}try{typeof hotReloadConfig===_0x29995d(0xfa)&&hotReloadConfig((_0x26f2a0=[])=>{const _0x4551c0=_0x29995d;try{refreshConfig();}catch(_0x2bb50e){warn(_0x4551c0(0xdd)+_0x4551c0(0x320)+'ndler\x20erro'+_0x4551c0(0x240)+(_0x2bb50e?.[_0x4551c0(0x32f)]||_0x2bb50e));}});}catch(_0x3fc118){warn(_0x29995d(0xdd)+_0x29995d(0x16a)+_0x29995d(0xb5)+'ration\x20fai'+'led:\x20'+(_0x3fc118?.[_0x29995d(0x32f)]||_0x3fc118));}refreshConfig();function tryBuildSendApiFromBot(_0x47f5c6){const _0x289cbf=_0x29995d;if(!_0x47f5c6)return null;if(typeof _0x47f5c6[_0x289cbf(0x2ac)+'e']===_0x289cbf(0xfa))return async(_0x42e495,_0x14cbf5)=>_0x47f5c6['sendMessag'+'e'](_0x42e495,_0x14cbf5);else{if(_0x47f5c6[_0x289cbf(0x1c2)]&&typeof _0x47f5c6[_0x289cbf(0x1c2)][_0x289cbf(0x2ac)+'e']==='function')return async(_0x3d2cd5,_0x2d366a)=>_0x47f5c6[_0x289cbf(0x1c2)]['sendMessag'+'e'](_0x3d2cd5,_0x2d366a);}return null;}function setupSendApi(_0x54911c){const _0x2dc72a=_0x29995d;botRef=_0x54911c,sendApi=tryBuildSendApiFromBot(botRef),info(_0x2dc72a(0x168)+_0x2dc72a(0x23f)+_0x2dc72a(0x1f6)+_0x2dc72a(0x191)+(sendApi?'available':'not-availa'+_0x2dc72a(0x305)));}async function sendWithRetry(_0x3cfafe,_0x2fa18b){const _0x579777=_0x29995d,_0x42bb6d=Number(SEND_RETRIES||0x121*-0x1b+0xe5f+0x101f);let _0x5d3728=-0x4f5+-0x237a+0x286f,_0x3b227f=Number(INITIAL_BACKOFF_MS||-0x2381+-0x2566+-0x1*-0x4adb);while(_0x5d3728<_0x42bb6d){try{const _0x5d9fa5=_0x3cfafe||null;if(!_0x5d9fa5)throw new Error(_0x579777(0xbd)+_0x579777(0x190)+_0x579777(0x21d)+_0x579777(0x107)+_0x579777(0x14e)+')');if(typeof sendApi===_0x579777(0xfa))return await sendApi(_0x5d9fa5,_0x2fa18b),!![];if(botRef&&typeof botRef[_0x579777(0x2ac)+'e']===_0x579777(0xfa))return await botRef[_0x579777(0x2ac)+'e'](_0x5d9fa5,_0x2fa18b),!![];if(botRef&&botRef[_0x579777(0x1c2)]&&typeof botRef[_0x579777(0x1c2)][_0x579777(0x2ac)+'e']===_0x579777(0xfa))return await botRef['sock']['sendMessag'+'e'](_0x5d9fa5,_0x2fa18b),!![];throw new Error(_0x579777(0x12f)+_0x579777(0x22d));}catch(_0x207859){_0x5d3728++;const _0x5bec38=String(_0x207859?.['message']||'')[_0x579777(0xe4)+'e']()[_0x579777(0xa9)]('rate')||_0x207859?.['status']===-0x22f0+0x8e7+0x1bb6;warn(_0x579777(0x168)+_0x579777(0x100)+'\x20'+_0x5d3728+_0x579777(0x1f8)+(_0x207859?.[_0x579777(0x32f)]||_0x207859));if(_0x5d3728>=_0x42bb6d||!_0x5bec38)return![];await new Promise(_0x3aada9=>setTimeout(_0x3aada9,_0x3b227f)),_0x3b227f*=0x205f+0x552+0x25af*-0x1;try{setupSendApi(botRef);}catch(_0xfd2980){}}}return![];}function parseTimeToken(_0x8e665e,_0x590e23=DEFAULT_TIMEZONE){const _0x42bf09=_0x29995d;if(!_0x8e665e||typeof _0x8e665e!=='string')return null;const _0x5857ff=_0x8e665e[_0x42bf09(0x32b)](),_0x57e7d9=_0x5857ff['match'](/^in\s+(\d+)\s*(minute|min|minutes|m|hour|hours|hr|h|day|days|d)$/i);if(_0x57e7d9){const _0x19e8be=Number(_0x57e7d9[-0x103*-0x16+0xe3f+-0x2480]),_0x255f99=_0x57e7d9[-0x3c8+0x12fd*0x1+-0xf33][_0x42bf09(0xe4)+'e']();let _0x397ea1=DateTime[_0x42bf09(0x19d)]()[_0x42bf09(0x2ee)](_0x590e23);if(_0x255f99[_0x42bf09(0x2a9)](_0x42bf09(0x127))||_0x255f99==='m')_0x397ea1=_0x397ea1['plus']({'minutes':_0x19e8be});else{if(_0x255f99['startsWith']('h')||_0x255f99[_0x42bf09(0x2a9)]('hr'))_0x397ea1=_0x397ea1[_0x42bf09(0x1ef)]({'hours':_0x19e8be});else{if(_0x255f99[_0x42bf09(0x2a9)]('d'))_0x397ea1=_0x397ea1['plus']({'days':_0x19e8be});}}if(_0x397ea1[_0x42bf09(0x183)])return{'type':_0x42bf09(0x1df),'dt':_0x397ea1};}if(/^\d{4}-\d{2}-\d{2}[ T]\d{1,2}:\d{2}$/[_0x42bf09(0x177)](_0x5857ff)){const _0x2b65e4=_0x5857ff['replace']('\x20','T'),_0x105663=DateTime[_0x42bf09(0x1ea)](_0x2b65e4,{'zone':_0x590e23});if(_0x105663[_0x42bf09(0x183)])return{'type':_0x42bf09(0x1df),'dt':_0x105663};}if(/^\d{1,2}:\d{2}$/[_0x42bf09(0x177)](_0x5857ff)){const [_0x316d55,_0x31210b]=_0x5857ff[_0x42bf09(0x300)](':')[_0x42bf09(0x15a)](Number);if(Number['isInteger'](_0x316d55)&&Number[_0x42bf09(0xe8)](_0x31210b)&&_0x316d55>=-0x1372+-0x6f3+0x1a65*0x1&&_0x316d55<=-0x1d28+0x12ac+0xa93&&_0x31210b>=0x9d*-0x23+0x90+-0x1*-0x14e7&&_0x31210b<=-0x1f*-0x75+-0x3*0xa57+0x1115*0x1)return{'type':'hhmm','hhmm':String(_0x316d55)[_0x42bf09(0x331)](-0x1f7b*-0x1+0x49*-0x59+-0x618,'0')+':'+String(_0x31210b)[_0x42bf09(0x331)](0x1b5c+0x995+-0x24ef,'0')};}return null;}function shouldSendSlot(_0xaff5d5,_0x5a53ed){const _0x1006a3=_0x29995d,_0x5a7517=_0xaff5d5[_0x1006a3(0xdb)]||_0x1006a3(0x19b),_0x120160=_0xaff5d5['last_sent']||-0x1af*0x5+0x1bc1+-0x1356,_0x1a83a0=_0x120160?DateTime[_0x1006a3(0x28b)](_0x120160*(0x2*0xdb1+-0x1*0x18d+0x1*-0x15ed))[_0x1006a3(0x2ee)](_0x5a53ed[_0x1006a3(0x327)]):null;if(!_0x1a83a0)return!![];if(_0x5a7517===_0x1006a3(0x19b))return!_0x1a83a0[_0x1006a3(0x208)](_0x5a53ed,_0x1006a3(0x343));if(_0x5a7517===_0x1006a3(0x2fe))return _0x5a53ed[_0x1006a3(0xaa)](_0x1a83a0,_0x1006a3(0x17c))['days']>=0x1*0x142c+-0x637+-0x2*0x6f7;if(_0x5a7517['startsWith'](_0x1006a3(0x227)+_0x1006a3(0x2c2))){const _0x5dcbc2=parseInt(_0x5a7517[_0x1006a3(0x300)](':')[0x1ecc+0x1*0x446+0x2311*-0x1],-0x21*-0x73+0xf8a*-0x1+0xc1*0x1);if(isNaN(_0x5dcbc2)||_0x5dcbc2<-0x13*-0x18f+-0x3*0x752+-0xb*0xb2)return![];return _0x5a53ed[_0x1006a3(0xaa)](_0x1a83a0,'days')[_0x1006a3(0x17c)]>=_0x5dcbc2;}if(_0x5a7517[_0x1006a3(0x2a9)](_0x1006a3(0x21b)+_0x1006a3(0x160))){const _0x1605ae=_0x5a7517[_0x1006a3(0x300)](':')[0x6b5*-0x2+0x1631+0x8c6*-0x1][_0x1006a3(0x300)](',')[_0x1006a3(0x15a)](_0x48be32=>parseInt(_0x48be32,-0x253a+-0x3*0x9a9+0x423f))['filter'](Boolean);return _0x1605ae[_0x1006a3(0xa9)](_0x5a53ed['weekday'])&&!_0x1a83a0['hasSame'](_0x5a53ed,_0x1006a3(0x343));}if(_0x5a7517[_0x1006a3(0x2a9)](_0x1006a3(0x2a1)+'th:')){const _0x4ab27c=parseInt(_0x5a7517[_0x1006a3(0x300)](':')[0xae9+-0x22c9+-0x17e1*-0x1],0x13d*-0xb+0x100d*0x1+-0x264);return _0x5a53ed['day']===_0x4ab27c&&!_0x1a83a0[_0x1006a3(0x208)](_0x5a53ed,'day');}return![];}async function addScheduleRow(_0x29273f){const _0x41e069=_0x29995d;try{const _0x18a7f1=await db[_0x41e069(0x2ab)]('INSERT\x20INT'+_0x41e069(0xa8)+_0x41e069(0x291)+_0x41e069(0x244)+',\x20time,\x20se'+_0x41e069(0x2e5)+_0x41e069(0x2d0)+_0x41e069(0x2ea)+'eator_jid)'+_0x41e069(0x336)+'LUES\x20(?,\x20?'+_0x41e069(0x2a2)+_0x41e069(0x265),[_0x29273f['chat_jid'],_0x29273f[_0x41e069(0x32f)],_0x29273f[_0x41e069(0x166)],_0x29273f[_0x41e069(0x1bf)],_0x29273f[_0x41e069(0xdb)]||_0x41e069(0x19b),_0x29273f[_0x41e069(0x123)]||null,_0x29273f[_0x41e069(0xb4)+'d']]),_0x54a66f=_0x18a7f1?.[_0x41e069(0x1f9)]||null;return info(_0x41e069(0x29a)+_0x41e069(0x1ff)+'le\x20id='+_0x54a66f+_0x41e069(0x1c6)+_0x29273f['chat_jid']+_0x41e069(0x259)+(_0x29273f[_0x41e069(0x166)]||_0x29273f['send_at'])),_0x54a66f;}catch(_0x6c1ea8){return warn(_0x41e069(0x29a)+_0x41e069(0x182)+_0x41e069(0x114)+(_0x6c1ea8?.[_0x41e069(0x32f)]||_0x6c1ea8)),null;}}async function listSchedulesForChat(_0x2c9e99){const _0x1462e2=_0x29995d;try{const _0x1aaf8b=await db[_0x1462e2(0x2ad)](_0x1462e2(0x31e)+_0x1462e2(0x10e)+_0x1462e2(0x348)+_0x1462e2(0x2f3)+_0x1462e2(0x216)+_0x1462e2(0x310),[_0x2c9e99]);return _0x1aaf8b||[];}catch(_0xb83650){return warn('[sched]\x20li'+'stSchedule'+_0x1462e2(0xfc)+_0x1462e2(0x1a3)+(_0xb83650?.[_0x1462e2(0x32f)]||_0xb83650)),[];}}async function removeScheduleByDBId(_0xf62c75){const _0x57d1bc=_0x29995d;try{const _0x22e064=await db[_0x57d1bc(0x2ab)]('DELETE\x20FRO'+_0x57d1bc(0xf3)+'s\x20WHERE\x20id'+_0x57d1bc(0x263),[_0xf62c75]);return _0x22e064?.[_0x57d1bc(0x2f1)]?!![]:![];}catch(_0x238288){return warn('[sched]\x20re'+_0x57d1bc(0xeb)+_0x57d1bc(0x1e7)+_0x57d1bc(0x1a3)+(_0x238288?.[_0x57d1bc(0x32f)]||_0x238288)),![];}}async function removeAllSchedulesForChat(_0x183844){const _0x472c3d=_0x29995d;try{const _0x5f2dd4=await db[_0x472c3d(0x2ab)](_0x472c3d(0x10c)+'M\x20schedule'+'s\x20WHERE\x20ch'+_0x472c3d(0x349),[_0x183844]);return _0x5f2dd4?.['changes']||0x1683+-0x1*-0x97d+-0x2*0x1000;}catch(_0x4a8426){return warn(_0x472c3d(0x28f)+'moveAllSch'+_0x472c3d(0x25a)+_0x472c3d(0x2b6)+'\x20'+(_0x4a8426?.[_0x472c3d(0x32f)]||_0x4a8426)),0x6eb+0x59d*0x2+-0x1225*0x1;}}async function updateScheduleFields(_0x4d65ac,_0x6fd98e={}){const _0x273e7f=_0x29995d;try{const _0x3b9482=[],_0x5ede95=[];for(const _0x3ffb6f of Object[_0x273e7f(0x14b)](_0x6fd98e)){_0x3b9482[_0x273e7f(0x17e)](_0x3ffb6f+'\x20=\x20?'),_0x5ede95['push'](_0x6fd98e[_0x3ffb6f]);}if(!_0x3b9482['length'])return![];_0x5ede95[_0x273e7f(0x17e)](_0x4d65ac);const _0x39dd8b=_0x273e7f(0x11b)+_0x273e7f(0x1ba)+'\x20'+_0x3b9482[_0x273e7f(0x161)](',\x20')+('\x20WHERE\x20id\x20'+_0x273e7f(0x23a)),_0x58e10a=await db[_0x273e7f(0x2ab)](_0x39dd8b,_0x5ede95);return _0x58e10a?.[_0x273e7f(0x2f1)]?!![]:![];}catch(_0x47cdc5){return warn('[sched]\x20up'+_0x273e7f(0xbf)+_0x273e7f(0x1ac)+_0x273e7f(0x1a3)+(_0x47cdc5?.[_0x273e7f(0x32f)]||_0x47cdc5)),![];}}async function getChatTimezone(_0x53ff63){const _0x2368d4=_0x29995d;try{const _0x5c4c4a=await db[_0x2368d4(0x2f4)](_0x2368d4(0x1e4)+_0x2368d4(0x236)+_0x2368d4(0x19a)+_0x2368d4(0xc0)+_0x2368d4(0x196)+_0x2368d4(0xa6),[_0x53ff63]);return _0x5c4c4a?.[_0x2368d4(0x123)]||null;}catch(_0x4ba8ac){return warn(_0x2368d4(0x271)+'tChatTimez'+_0x2368d4(0x154)+'\x20'+(_0x4ba8ac?.['message']||_0x4ba8ac)),null;}}async function setChatTimezone(_0x137d7f,_0x96575c){const _0xecd4af=_0x29995d;try{return await db[_0xecd4af(0x2ab)](_0xecd4af(0x346)+_0xecd4af(0xa8)+_0xecd4af(0x28a)+'\x20(chat_jid'+',\x20timezone'+_0xecd4af(0x26b)+_0xecd4af(0x203)+'ONFLICT(ch'+'at_jid)\x20DO'+'\x20UPDATE\x20SE'+_0xecd4af(0x286)+_0xecd4af(0xca)+_0xecd4af(0x123),[_0x137d7f,_0x96575c]),!![];}catch(_0x323006){return warn(_0xecd4af(0x168)+_0xecd4af(0x24a)+_0xecd4af(0x154)+'\x20'+(_0x323006?.[_0xecd4af(0x32f)]||_0x323006)),![];}}async function executorTick(){const _0x2736c0=_0x29995d;if(executorRunning)return;executorRunning=!![];try{const _0xd146c9=await db[_0x2736c0(0x2ad)](_0x2736c0(0x31e)+_0x2736c0(0x10e)+_0x2736c0(0x348)+_0x2736c0(0xab)+_0x2736c0(0x1b2)+'\x20id\x20ASC');if(!_0xd146c9||_0xd146c9[_0x2736c0(0xaf)]===-0x1bd*0x6+0x13bb+0x1*-0x94d)return;for(const _0x10746e of _0xd146c9){try{const _0x47afea=_0x10746e['timezone']||await getChatTimezone(_0x10746e['chat_jid'])||DEFAULT_TIMEZONE,_0x357ddb=DateTime[_0x2736c0(0x19d)]()[_0x2736c0(0x2ee)](_0x47afea);if(_0x10746e[_0x2736c0(0x1bf)]&&Number(_0x10746e['send_at'])>-0x1c*0x14b+0x3*-0x5e7+0x35e9*0x1){const _0x238ab2=Number(_0x10746e[_0x2736c0(0x1bf)]),_0x511ec1=Math[_0x2736c0(0x324)](Date['now']()/(-0x35*0x13+0x218b+-0x14*0x149));if(_0x238ab2<=_0x511ec1){const _0x3d1b0b=await sendWithRetry(_0x10746e[_0x2736c0(0xba)],{'text':_0x10746e['message']});if(_0x3d1b0b)try{const _0x15b510=await removeScheduleByDBId(_0x10746e['id']);_0x15b510?info('[sched]\x20de'+_0x2736c0(0x307)+_0x2736c0(0x231)+_0x2736c0(0xd8)+'='+_0x10746e['id']+_0x2736c0(0x222)+_0x10746e[_0x2736c0(0xba)]):(await updateScheduleFields(_0x10746e['id'],{'enabled':0x0,'last_sent':_0x511ec1}),warn('[sched]\x20de'+'livered\x20on'+_0x2736c0(0x309)+_0x10746e['id']+_0x2736c0(0x222)+_0x10746e[_0x2736c0(0xba)]+(_0x2736c0(0x17b)+_0x2736c0(0x13f)+_0x2736c0(0xc1)+_0x2736c0(0x1fb)+'instead')));}catch(_0x371b86){warn(_0x2736c0(0x20e)+_0x2736c0(0x277)+_0x2736c0(0x14c)+_0x2736c0(0x198)+'\x20'+(_0x371b86?.[_0x2736c0(0x32f)]||_0x371b86));try{await updateScheduleFields(_0x10746e['id'],{'enabled':0x0,'last_sent':_0x511ec1});}catch(_0x158e49){}}else warn(_0x2736c0(0x2c8)+_0x2736c0(0xcc)+_0x2736c0(0x2a0)+_0x2736c0(0x340)+_0x10746e['id']+_0x2736c0(0x222)+_0x10746e[_0x2736c0(0xba)]);}continue;}if(!_0x10746e[_0x2736c0(0x166)])continue;const _0x3a643a=_0x357ddb[_0x2736c0(0x140)]('HH:mm');if(_0x3a643a!==_0x10746e[_0x2736c0(0x166)])continue;const _0x2d94a5={'id':_0x10746e['id'],'frequency':_0x10746e['frequency']||'daily','last_sent':_0x10746e['last_sent']||0x226d+-0x29d*0xb+-0x5ae};if(!shouldSendSlot(_0x2d94a5,_0x357ddb))continue;const _0x30aa2f=await sendWithRetry(_0x10746e[_0x2736c0(0xba)],{'text':_0x10746e['message']});_0x30aa2f?(await updateScheduleFields(_0x10746e['id'],{'last_sent':Math[_0x2736c0(0x324)](Date['now']()/(-0x20d+0xcab+-0x35b*0x2))}),info(_0x2736c0(0x28c)+'livered\x20re'+_0x2736c0(0x12e)+'='+_0x10746e['id']+_0x2736c0(0x222)+_0x10746e[_0x2736c0(0xba)]+_0x2736c0(0x24f)+_0x10746e[_0x2736c0(0x166)]+'\x20('+_0x47afea+')')):warn(_0x2736c0(0x2c8)+_0x2736c0(0xcc)+'liver\x20recu'+_0x2736c0(0x18f)+_0x10746e['id']+_0x2736c0(0x222)+_0x10746e[_0x2736c0(0xba)]+_0x2736c0(0x24f)+_0x10746e['time']);}catch(_0x25acd6){warn('[sched]\x20ex'+_0x2736c0(0xfe)+'m\x20error:\x20'+(_0x25acd6?.[_0x2736c0(0x32f)]||_0x25acd6));}}}catch(_0x53e0d6){error(_0x2736c0(0x33d)+'ecutorTick'+'\x20error:\x20'+(_0x53e0d6?.['message']||_0x53e0d6));}finally{executorRunning=![];}}function startSchedulerAligned(){stopScheduler();const _0x21bfa5=0xe407+0xc204*0x1+-0x1c1*0x6b-Date['now']()%(0x123ac+-0x1b9e8+0x1*0x1809c);setTimeout(()=>{const _0x1194b7=_0x5961;executorTick()[_0x1194b7(0x30b)](_0x438b5c=>warn(_0x1194b7(0x2d9)+_0x1194b7(0x288)+_0x1194b7(0x33a)+':\x20'+(_0x438b5c?.['message']||_0x438b5c))),schedulerIntervalHandle=setInterval(()=>{const _0x240935=_0x1194b7;executorTick()[_0x240935(0x30b)](_0x44fe5f=>warn(_0x240935(0x33d)+_0x240935(0x2af)+_0x240935(0xdc)+(_0x44fe5f?.[_0x240935(0x32f)]||_0x44fe5f)));},CHECK_INTERVAL_MS),info(_0x1194b7(0x184)+_0x1194b7(0x321)+_0x1194b7(0x1db)+_0x1194b7(0x11a)+_0x1194b7(0xb3));},_0x21bfa5);}function stopScheduler(){const _0x2c8c82=_0x29995d;schedulerIntervalHandle&&(clearInterval(schedulerIntervalHandle),schedulerIntervalHandle=null,info(_0x2c8c82(0x184)+_0x2c8c82(0x321)+_0x2c8c82(0x185)));}function extractTextFromMessage(_0x11e48a){const _0x19a838=_0x29995d;if(!_0x11e48a||!_0x11e48a[_0x19a838(0x32f)])return'';const _0x23ae50=_0x11e48a[_0x19a838(0x32f)];if(_0x23ae50[_0x19a838(0x225)+'on'])return _0x23ae50[_0x19a838(0x225)+'on'];if(_0x23ae50[_0x19a838(0x2b9)+_0x19a838(0x2c0)]?.['text'])return _0x23ae50[_0x19a838(0x2b9)+_0x19a838(0x2c0)][_0x19a838(0x1a2)];if(_0x23ae50[_0x19a838(0x135)+'ge']?.['caption'])return _0x23ae50['imageMessa'+'ge']['caption'];if(_0x23ae50[_0x19a838(0x2dd)+'ge']?.[_0x19a838(0x211)])return _0x23ae50[_0x19a838(0x2dd)+'ge']['caption'];if(_0x23ae50[_0x19a838(0x34a)+_0x19a838(0x150)+'ge']?.['selectedBu'+'ttonId'])return _0x23ae50[_0x19a838(0x34a)+_0x19a838(0x150)+'ge']['selectedBu'+_0x19a838(0x344)];if(_0x23ae50[_0x19a838(0x282)+'seMessage']?.[_0x19a838(0xf0)+_0x19a838(0x2e4)]?.['selectedRo'+'wId'])return _0x23ae50[_0x19a838(0x282)+_0x19a838(0x316)]['singleSele'+_0x19a838(0x2e4)][_0x19a838(0x299)+_0x19a838(0x2ce)];return'';}function splitFirstLinePreserveRest(_0x5498c6){const _0x2ad6f4=_0x29995d,_0x27df66=_0x5498c6[_0x2ad6f4(0x300)](/\r?\n/),_0x305225=_0x27df66[_0x2ad6f4(0xaf)]>0xbdf+0x259c+-0x317b?_0x27df66['shift']():'',_0x218232=_0x27df66[_0x2ad6f4(0x161)]('\x0a'),_0x3bad9d=_0x305225[_0x2ad6f4(0x32b)]()[_0x2ad6f4(0x300)](/\s+/)[_0x2ad6f4(0x329)](Boolean);return{'firstLine':_0x305225,'restText':_0x218232,'firstTokens':_0x3bad9d};}function findGpAndCleanBodyFromRestAndFirst(_0x43730e,_0x1b4fa5){const _0x584f3d=_0x29995d,_0x374df5=(_0x1b4fa5&&_0x1b4fa5['length']?_0x1b4fa5:'')+'\x0a'+(_0x43730e||''),_0x399c4d=_0x374df5['match'](/\bgp[:\s]+(\S+)/i),_0x542219=_0x399c4d?_0x399c4d[0x1*0x23b1+0x313*0x2+-0x29d6][_0x584f3d(0x32b)]():null;let _0x5487a2=(_0x1b4fa5||'')[_0x584f3d(0x300)](/\r?\n/);if(!_0x5487a2||_0x5487a2['length']===-0x2*-0xb29+-0x6cb*0x1+0x3*-0x52d||_0x5487a2[_0x584f3d(0xc2)](_0x2de58d=>!_0x2de58d[_0x584f3d(0x32b)]()))return{'gpValue':_0x542219,'cleanedBody':''};const _0x2b5b13=_0x5487a2[_0x584f3d(0x15a)](_0x2f45df=>_0x2f45df[_0x584f3d(0x30a)](/^\s*gp[:\s]+\S+\s*$/i,'')[_0x584f3d(0x30a)](/\s*\bgp[:\s]+\S+\s*$/i,'')[_0x584f3d(0x117)]())[_0x584f3d(0x329)](_0x3381f0=>_0x3381f0[_0x584f3d(0xaf)]>0x1187*-0x2+-0xc*-0x167+0x123a),_0x29a742=_0x2b5b13[_0x584f3d(0x161)]('\x0a')[_0x584f3d(0x32b)]();return{'gpValue':_0x542219,'cleanedBody':_0x29a742};}function extractInlineAfterToken(_0x1ea3a5,_0x2b8546){const _0x2ea322=_0x29995d;if(!_0x1ea3a5||!_0x2b8546)return'';try{const _0x26bc67=new RegExp('\x5cb'+_0x2b8546['replace'](/[.*+?^${}()|[\\]\\\\]/g,_0x2ea322(0x1d2))+'\x5cb'),_0xaa7b7e=_0x1ea3a5['match'](_0x26bc67);if(!_0xaa7b7e)return'';const _0x3ae51d=_0x1ea3a5[_0x2ea322(0x1dd)](_0xaa7b7e[0x2e7+0x7*0x429+-0x2006]),_0x3f962f=_0x3ae51d+_0xaa7b7e[-0x18e1+0x1c2a+-0x349][_0x2ea322(0xaf)];let _0x6a8cba=_0x1ea3a5['slice'](_0x3f962f)[_0x2ea322(0x30a)](/^\s+/,'');return _0x6a8cba=_0x6a8cba[_0x2ea322(0x30a)](/\s*\bgp[:\s]+\S+\s*$/i,'')[_0x2ea322(0x32b)](),_0x6a8cba;}catch(_0x1dd30e){return'';}}const USAGE=_0x29995d(0x253)+'lp\x20Command'+_0x29995d(0x1b5)+_0x29995d(0x249)+_0x29995d(0x2e9)+_0x29995d(0x23d)+'H:mm\x20|\x20in\x20'+_0x29995d(0x2f9)+_0x29995d(0x1c0)+_0x29995d(0x27d)+_0x29995d(0x1de)+_0x29995d(0xe9)+_0x29995d(0x31c)+_0x29995d(0x2e2)+_0x29995d(0x17a)+_0x29995d(0x295)+_0x29995d(0x11e)+'ewlines\x20pr'+_0x29995d(0x1ab)+_0x29995d(0x136)+'nce*\x20`<HH:'+'mm>`\x20`[Nda'+_0x29995d(0xb6)+'sage...>`\x0a'+_0x29995d(0x270)+'schedule.\x20'+_0x29995d(0x18b)+_0x29995d(0x180)+_0x29995d(0x2c5)+_0x29995d(0x296)+_0x29995d(0x32d)+_0x29995d(0x12d)+_0x29995d(0x1fa)+_0x29995d(0x233)+_0x29995d(0xd1)+_0x29995d(0x2d5)+_0x29995d(0x188)+_0x29995d(0x239)+'hed\x20delete'+_0x29995d(0x272)+_0x29995d(0x213)+'number,...'+'\x20|\x20all>`\x0aâ€£'+_0x29995d(0x1bb)+_0x29995d(0x173)+_0x29995d(0xbe)+_0x29995d(0x229)+_0x29995d(0x237)+_0x29995d(0x15c)+_0x29995d(0xe1)+'`<HH:mm\x20|\x20'+_0x29995d(0x14d)+_0x29995d(0x217)+'-DDTHH:mm>'+_0x29995d(0x1d9)+_0x29995d(0x2da)+_0x29995d(0x103)+'uled\x20messa'+_0x29995d(0xc9)+'hed\x20freque'+_0x29995d(0x28e)+_0x29995d(0x20d)+'`\x0aâ€£\x20Set\x20re'+_0x29995d(0xe0)+_0x29995d(0x115)+_0x29995d(0xc6)+_0x29995d(0x186)+_0x29995d(0x2bf)+_0x29995d(0x2a3)+_0x29995d(0x226)+_0x29995d(0x272)+_0x29995d(0x220)+'rarily\x20dis'+_0x29995d(0x19c)+_0x29995d(0x1ec)+_0x29995d(0x274)+_0x29995d(0x29c)+_0x29995d(0x2f8)+'er>`\x0aâ€£\x20Re-'+'enable\x20a\x20p'+_0x29995d(0x11f)+_0x29995d(0x156)+'essage.\x0a',processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(0x1aec+0x24dc*0x1+-0x3fb4)*(0x1d4d+-0x11d7*0x2+0xa49);function markCmdProcessed(_0x10aee4){const _0x538272=_0x29995d;if(!_0x10aee4)return;if(processedCmdKeys[_0x538272(0x2f7)](_0x10aee4))try{clearTimeout(processedCmdKeys[_0x538272(0x2f4)](_0x10aee4));}catch(_0x1ed047){}const _0xc5e10c=setTimeout(()=>processedCmdKeys[_0x538272(0x27e)](_0x10aee4),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x538272(0x312)](_0x10aee4,_0xc5e10c);}function isCmdProcessed(_0x1b09b5){return _0x1b09b5&&processedCmdKeys['has'](_0x1b09b5);}async function resolveDefaultChatJidsForUser(_0x230352){const _0x4b15d5=_0x29995d;try{const _0x1ef85d=await getDefault(_0x230352)[_0x4b15d5(0x30b)](()=>null);if(!_0x1ef85d||Array[_0x4b15d5(0xa7)](_0x1ef85d)&&_0x1ef85d[_0x4b15d5(0xaf)]===-0x26a*0x10+0x1*-0x519+0x2bb9)return[];const _0x17fcde=Array['isArray'](_0x1ef85d)?_0x1ef85d:[_0x1ef85d],_0x3534bb=[];for(const _0x3638f0 of _0x17fcde){try{const _0x1bae46=await getConnection(_0x3638f0)['catch'](()=>null);if(Array[_0x4b15d5(0xa7)](_0x1bae46))_0x3534bb[_0x4b15d5(0x17e)](..._0x1bae46);else{if(_0x1bae46)_0x3534bb[_0x4b15d5(0x17e)](String(_0x1bae46));}}catch(_0x392f90){warn(_0x4b15d5(0x28f)+_0x4b15d5(0xf6)+_0x4b15d5(0x317)+_0x3638f0+_0x4b15d5(0x1f8)+(_0x392f90?.['message']||_0x392f90));}}return uniqArray(_0x3534bb);}catch(_0x460bbe){return warn(_0x4b15d5(0x28f)+_0x4b15d5(0x338)+'ltChatJids'+_0x4b15d5(0x21c)+'ror:\x20'+(_0x460bbe?.[_0x4b15d5(0x32f)]||_0x460bbe)),[];}}async function getCombinedSchedulesForChats(_0x5f1cd1){const _0x4a3ab4=_0x29995d,_0x44b1f2=[];for(const _0x4fba2f of _0x5f1cd1){const _0x2b4efc=await listSchedulesForChat(_0x4fba2f);for(const _0x76a160 of _0x2b4efc){_0x44b1f2[_0x4a3ab4(0x17e)](Object[_0x4a3ab4(0x20a)]({},_0x76a160,{'chat_jid':_0x4fba2f}));}}return _0x44b1f2;}async function resolveNumberToDbId(_0x589f49,_0x3093b2){const _0x3a4146=_0x29995d;if(!_0x589f49||!Number[_0x3a4146(0xe8)](_0x589f49)||_0x589f49<0x38e+0x5*0x79f+-0x29a8)return null;const _0x5e9bd9=await getCombinedSchedulesForChats(_0x3093b2);if(!_0x5e9bd9||_0x5e9bd9[_0x3a4146(0xaf)]<_0x589f49)return null;return _0x5e9bd9[_0x589f49-(-0xcf0+0x1ad9*0x1+-0xde8)]['id'];}async function findStoredMatchFromFindings(_0x197ed4=[]){const _0x3dba92=_0x29995d;try{const _0x18c135=await listSudo();if(!Array[_0x3dba92(0xa7)](_0x18c135)||_0x18c135[_0x3dba92(0xaf)]===-0x161c+-0xbcf*0x3+0x3989)return null;const _0x2ffc26=new Set(_0x18c135[_0x3dba92(0x15a)](String));for(const _0x581e1b of _0x197ed4||[]){if(!_0x581e1b||typeof _0x581e1b[_0x3dba92(0x122)]!==_0x3dba92(0x1d1))continue;const _0x485a97=normalizeToJid(_0x581e1b[_0x3dba92(0x122)]);if(_0x485a97&&_0x2ffc26[_0x3dba92(0x2f7)](_0x485a97))return _0x485a97;if(_0x2ffc26[_0x3dba92(0x2f7)](_0x581e1b[_0x3dba92(0x122)]))return _0x581e1b['jid'];const _0x4c082e=String(_0x581e1b[_0x3dba92(0x122)])['split']('@')[-0x5c0+0x9f6+0xb*-0x62][_0x3dba92(0x300)](':')[0x6b4+0x1281+-0x867*0x3];if(_0x4c082e)for(const _0x3f6916 of _0x18c135){const _0x20aded=String(_0x3f6916)[_0x3dba92(0x300)]('@')[0x39f+0x3*-0x42e+0x8eb];if(_0x20aded&&_0x20aded===_0x4c082e)return _0x3f6916;}}return null;}catch(_0x41889e){return warn(_0x3dba92(0x1f5)+_0x3dba92(0x178)+_0x3dba92(0x31d)+'dings\x20erro'+_0x3dba92(0x240)+(_0x41889e?.[_0x3dba92(0x32f)]||_0x41889e)),null;}}export async function onMessage(_0x57e618){const _0x290e18=_0x29995d;try{if(!_0x57e618||!_0x57e618[_0x290e18(0x276)]||!_0x57e618[_0x290e18(0x32f)])return;const _0x5af2f3=String(_0x57e618[_0x290e18(0x276)][_0x290e18(0x1c9)]||'')+'::'+String(_0x57e618[_0x290e18(0x276)]['id']||_0x57e618[_0x290e18(0x276)]['participan'+'t']||'');if(isCmdProcessed(_0x5af2f3))return;markCmdProcessed(_0x5af2f3);if(!_0x57e618[_0x290e18(0x10f)])return;const _0x103477=typeof _0x57e618[_0x290e18(0x1a2)]===_0x290e18(0x1d1)&&_0x57e618[_0x290e18(0x1a2)]['trim']()[_0x290e18(0xaf)]?_0x57e618[_0x290e18(0x1a2)]:extractTextFromMessage(_0x57e618)||'';if(!_0x103477)return;const _0x2edda9=_0x57e618[_0x290e18(0x276)][_0x290e18(0x1c9)],_0x54e23b=typeof _0x2edda9===_0x290e18(0x1d1)&&_0x2edda9[_0x290e18(0x101)](_0x290e18(0x175));if(_0x54e23b){let _0x4e7eb0=![];try{_0x4e7eb0=await isadmin(botRef,_0x57e618);}catch(_0x4938ed){warn('[sched]\x20is'+_0x290e18(0x21e)+_0x290e18(0x138)),_0x4e7eb0=![];}if(!_0x4e7eb0)return;const _0x2f5d9e=String(_0x103477)[_0x290e18(0x32b)](),{firstLine:_0x1ceed7,restText:_0x539904,firstTokens:_0x50427d}=splitFirstLinePreserveRest(_0x2f5d9e),_0x222d95=(_0x50427d[-0x269d+-0x1*-0x8fc+-0x5*-0x5ed]||'')[_0x290e18(0xe4)+'e']();if(!commands['includes'](_0x222d95))return;const _0x14b987=(_0x50427d[0x8bf+-0x2309*0x1+0x1a4b*0x1]||'')[_0x290e18(0xe4)+'e'](),_0xaa94b7=_0x57e618['key'][_0x290e18(0x1a0)+'t']||_0x57e618[_0x290e18(0x276)][_0x290e18(0x33c)]||_0x57e618[_0x290e18(0x276)][_0x290e18(0x1c9)]||'',_0x1f2a2f=(_0xaa94b7||'')[_0x290e18(0x300)]('@')[-0xb*0x1b+-0x1ca6+0x1dcf],_0x58a124=await resolveDefaultChatJidsForUser(_0x1f2a2f),_0x1ee5be=_0x2edda9;if(!_0x58a124||_0x58a124[_0x290e18(0xaf)]===0x1f6*-0x8+-0x1972*0x1+0x5a*0x75){await sendWithRetry(_0x1ee5be,{'text':_0x290e18(0x293)+_0x290e18(0x170)+_0x290e18(0x26e)+_0x290e18(0x2ed)+_0x290e18(0x1ed)+_0x290e18(0x132)+_0x290e18(0x20c)+_0x290e18(0x31b)});return;}await handleSchedCommandGroup(_0x57e618,{'firstLine':_0x1ceed7,'restText':_0x539904,'firstTokens':_0x50427d,'sub':_0x14b987,'defaultChatJids':_0x58a124,'confirmationTarget':_0x1ee5be,'senderJid':_0xaa94b7});return;}const _0x58979b=Boolean(_0x57e618['key'][_0x290e18(0x285)]);let _0x153705=null;if(_0x58979b){const _0x595669=getBotJid();if(!_0x595669){warn('[sched]\x20PM'+_0x290e18(0x143)+'not\x20availa'+'ble\x20for\x20re'+_0x290e18(0x1a8)+_0x290e18(0x118));return;}_0x153705=_0x595669;}else{let _0x204b6a=![];try{_0x204b6a=await isSudo(botRef,_0x57e618);}catch(_0x322e0b){_0x204b6a=![];}if(!_0x204b6a)return;const _0x3aab78=userJidFromCtx(_0x57e618)||{'findings':[]},_0x252757=await findStoredMatchFromFindings(_0x3aab78[_0x290e18(0x30d)]||[]);if(!_0x252757)return;_0x153705=_0x252757;}const _0x4883ca=String(_0x103477),{firstLine:_0x46d800,restText:_0x54a665,firstTokens:_0x225656}=splitFirstLinePreserveRest(_0x4883ca),_0x3c339=(_0x225656[-0x1287+0x1*-0x24a1+-0x28*-0x161]||'')['toLowerCas'+'e']();if(!commands[_0x290e18(0xa9)](_0x3c339))return;const _0xd3c9cc=(_0x225656[-0xce9+0xcc*0x11+0x12*-0x9]||'')[_0x290e18(0xe4)+'e']();if(!_0xd3c9cc||_0xd3c9cc==='help'){await sendWithRetry(_0x153705,{'text':USAGE});return;}const _0x498bfb=['once',_0x290e18(0xd3),_0x290e18(0x1c5),_0x290e18(0x27e),_0x290e18(0x1ca),_0x290e18(0xdb),_0x290e18(0x129),'enable'],{gpValue:_0x2a6d2a,cleanedBody:_0x14900c}=findGpAndCleanBodyFromRestAndFirst(_0x46d800,_0x54a665);if(_0x498bfb[_0x290e18(0xa9)](_0xd3c9cc)&&!_0x2a6d2a){await sendWithRetry(_0x153705,{'text':'PM\x20usage:\x20'+_0x290e18(0x1a6)+_0x290e18(0xf9)+_0x290e18(0x137)+'ine\x20when\x20m'+_0x290e18(0x1dc)+_0x290e18(0x12b)+'xample:\x0asc'+_0x290e18(0x292)+_0x290e18(0x301)+_0x290e18(0x2f5)+_0x290e18(0xd9)+_0x290e18(0x1b3)});return;}let _0x33b723=[];if(_0x2a6d2a){const _0x333240=_0x2a6d2a['trim']();if(_0x333240['toLowerCas'+'e']()===_0x290e18(0x2ad))_0x33b723=await _0x258e00['getUniqueJ'+_0x290e18(0x157)]();else{const _0x254c18=await _0x258e00['resolveNam'+'e'](_0x333240);if(_0x254c18)_0x33b723=[_0x254c18];else{if(_0x333240[_0x290e18(0xa9)]('@'))_0x33b723=[_0x258e00[_0x290e18(0x131)+'oUserJid'](_0x333240)];}}if(_0x498bfb[_0x290e18(0xa9)](_0xd3c9cc)&&(!_0x33b723||_0x33b723[_0x290e18(0xaf)]===0x72*0x4+0x11d8*0x1+-0x4e8*0x4)){await sendWithRetry(_0x153705,{'text':_0x290e18(0x293)+_0x290e18(0x1d7)+_0x290e18(0x1b9)+_0x2a6d2a+(_0x290e18(0xae)+_0x290e18(0x24d)+_0x290e18(0x230)+_0x290e18(0x315))});return;}}await handleSchedCommandPM(_0x57e618,{'sub':_0xd3c9cc,'firstLine':_0x46d800,'restText':_0x54a665,'firstTokens':_0x225656,'targetChatJids':_0x33b723,'confirmationTarget':_0x153705,'senderJid':_0x57e618[_0x290e18(0x276)]['participan'+'t']||_0x57e618['key'][_0x290e18(0x33c)]||'','cleanedBody':_0x14900c});return;}catch(_0x5f089a){error(_0x290e18(0x20e)+_0x290e18(0xa3)+_0x290e18(0xe2)+(_0x5f089a?.[_0x290e18(0x32f)]||_0x5f089a));}}async function handleSchedCommandGroup(_0x28f294,{firstLine:_0x24133b,restText:_0x5e62c4,firstTokens:_0x26e51f,sub:_0x297387,defaultChatJids:_0x321d30,confirmationTarget:_0x59b600,senderJid:_0x1fb299}){const _0x4c1db6=_0x29995d;try{if(!_0x297387||_0x297387===_0x4c1db6(0xb1)){await sendWithRetry(_0x59b600,{'text':USAGE});return;}if(_0x297387===_0x4c1db6(0x29b)){const _0x3705c3=_0x26e51f[-0x1*0x1abf+-0x19ab+0xf4*0x37],_0x72fcf1=_0x26e51f[-0x475+-0x6c0+0x4*0x2ce]&&/^\d+$/[_0x4c1db6(0x177)](_0x26e51f[-0x2b+-0x1*-0x71b+-0x6ed])?Number(_0x26e51f[-0xf88+0x2*-0xeb9+0x2cfd]):null;let _0x58075e='';if(_0x3705c3){const _0x3bf80d=new RegExp('\x5cb'+_0x3705c3[_0x4c1db6(0x30a)](/[.*+?^${}()|[\\]\\\\]/g,_0x4c1db6(0x1d2))+'\x5cb'),_0x2bd3c8=_0x24133b[_0x4c1db6(0x1eb)](_0x3bf80d);if(_0x2bd3c8){const _0x42cc79=_0x24133b[_0x4c1db6(0x1dd)](_0x2bd3c8[-0x38d+0x1*-0x1685+0x1a12]),_0x23af94=_0x42cc79+_0x2bd3c8[-0x2*-0xe0c+-0x11b*0x1+0x1*-0x1afd][_0x4c1db6(0xaf)];_0x58075e=_0x24133b[_0x4c1db6(0x1c1)](_0x23af94)[_0x4c1db6(0x30a)](/^\s*/,'');if(_0x58075e&&/^\d+/[_0x4c1db6(0x177)](_0x58075e))_0x58075e=_0x58075e[_0x4c1db6(0x30a)](/^\d+\s*/,'');}}const _0xa2ef6f=_0x58075e&&_0x5e62c4?_0x58075e+'\x0a'+_0x5e62c4:_0x58075e||_0x5e62c4||'';if(!_0x3705c3||!_0xa2ef6f||_0xa2ef6f[_0x4c1db6(0x32b)]()[_0x4c1db6(0xaf)]===0x2499+0x1371+0x9*-0x63a){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x32c)+_0x4c1db6(0xb2)+_0x4c1db6(0x2e3)+_0x4c1db6(0x120)+'ge...>'});return;}const _0x28c7d8=[];for(const _0x220775 of _0x321d30){const _0x5b48e8=await getChatTimezone(_0x220775)||DEFAULT_TIMEZONE,_0x32e9ef=parseTimeToken(_0x3705c3,_0x5b48e8);if(!_0x32e9ef){_0x28c7d8[_0x4c1db6(0x17e)]({'chat':_0x220775,'ok':![],'reason':'parse_fail'+'ed'});continue;}if(_0x32e9ef[_0x4c1db6(0x2f0)]==='datetime'){const _0x4644d4=_0x32e9ef['dt'],_0xae4db2=Math[_0x4c1db6(0x324)](_0x4644d4['toMillis']()/(0x79c*0x3+0x3d*-0x26+0x2*-0x4ef)),_0xd8c801=await addScheduleRow({'chat_jid':_0x220775,'message':_0xa2ef6f,'time':null,'send_at':_0xae4db2,'frequency':_0x4c1db6(0x29b),'timezone':_0x4644d4[_0x4c1db6(0x1fe)]||_0x5b48e8,'creator_jid':_0x1fb299});if(_0xd8c801)_0x28c7d8[_0x4c1db6(0x17e)]({'chat':_0x220775,'ok':!![],'id':_0xd8c801,'when':_0x4644d4['toLocaleSt'+_0x4c1db6(0x2c6)](DateTime[_0x4c1db6(0x238)+'ED'])});else _0x28c7d8['push']({'chat':_0x220775,'ok':![],'reason':_0x4c1db6(0xd5)});continue;}if(_0x32e9ef[_0x4c1db6(0x2f0)]===_0x4c1db6(0x2e1)){const [_0x953829,_0x59dc5d]=_0x32e9ef[_0x4c1db6(0x2e1)]['split'](':')[_0x4c1db6(0x15a)](Number);let _0x37b43f=DateTime[_0x4c1db6(0x19d)]()['setZone'](_0x5b48e8),_0x2232cb=_0x37b43f[_0x4c1db6(0x1e2)](_0x4c1db6(0x343))[_0x4c1db6(0x312)]({'hour':_0x953829,'minute':_0x59dc5d,'second':0x0,'millisecond':0x0});if(_0x72fcf1&&Number['isInteger'](_0x72fcf1)&&_0x72fcf1>=-0x213+0x175*0x5+-0x535*0x1)_0x2232cb=_0x2232cb[_0x4c1db6(0x1ef)]({'days':Number(_0x72fcf1)});else{if(_0x2232cb<=_0x37b43f)_0x2232cb=_0x2232cb[_0x4c1db6(0x1ef)]({'days':0x1});}const _0xf9fb45=Math[_0x4c1db6(0x324)](_0x2232cb[_0x4c1db6(0x1a4)]()/(0x59*-0x24+-0x221e+0x328a)),_0x5614cf=await addScheduleRow({'chat_jid':_0x220775,'message':_0xa2ef6f,'time':null,'send_at':_0xf9fb45,'frequency':'once','timezone':_0x5b48e8,'creator_jid':_0x1fb299});if(_0x5614cf)_0x28c7d8[_0x4c1db6(0x17e)]({'chat':_0x220775,'ok':!![],'id':_0x5614cf,'when':_0x2232cb[_0x4c1db6(0x193)+_0x4c1db6(0x2c6)](DateTime[_0x4c1db6(0x238)+'ED'])});else _0x28c7d8[_0x4c1db6(0x17e)]({'chat':_0x220775,'ok':![],'reason':'db_failed'});continue;}_0x28c7d8[_0x4c1db6(0x17e)]({'chat':_0x220775,'ok':![],'reason':'unsupporte'+_0x4c1db6(0x23b)});}const _0x2298a2=_0x28c7d8[_0x4c1db6(0x329)](_0x234f68=>_0x234f68['ok']),_0x59a0b4=_0x28c7d8[_0x4c1db6(0x329)](_0xf00e4a=>!_0xf00e4a['ok']);let _0x4a4bee='';if(_0x2298a2['length']){_0x4a4bee+=_0x4c1db6(0x27b)+'one-off\x20fo'+'r\x20'+_0x2298a2[_0x4c1db6(0xaf)]+('\x20default\x20c'+'onnection('+_0x4c1db6(0xf8));for(const _0x18883b of _0x2298a2)_0x4a4bee+='â€¢\x20'+_0x18883b[_0x4c1db6(0x146)]+_0x4c1db6(0x347)+_0x18883b['id']+_0x4c1db6(0x24f)+_0x18883b['when']+'\x0a';}if(_0x59a0b4[_0x4c1db6(0xaf)]){_0x4a4bee+='Failed\x20for'+'\x20'+_0x59a0b4[_0x4c1db6(0xaf)]+('\x20default\x20c'+_0x4c1db6(0x19f)+_0x4c1db6(0xf8));for(const _0x1be238 of _0x59a0b4)_0x4a4bee+='â€¢\x20'+_0x1be238[_0x4c1db6(0x146)]+_0x4c1db6(0xc4)+_0x1be238[_0x4c1db6(0xd2)]+'\x0a';}await sendWithRetry(_0x59b600,{'text':_0x4a4bee[_0x4c1db6(0x32b)]()||'No\x20schedul'+'es\x20created'+'.'});return;}if(_0x297387===_0x4c1db6(0xd3)){if(!_0x26e51f[0x1046+-0x55*-0x31+-0x1*0x2089]){await sendWithRetry(_0x59b600,{'text':'Usage:\x20sch'+'ed\x20add\x20<HH'+_0x4c1db6(0x215)+_0x4c1db6(0x224)+_0x4c1db6(0x278)+_0x4c1db6(0xe6)+_0x4c1db6(0x30c)+_0x4c1db6(0x24b)});return;}const _0x2f3eae=_0x26e51f[-0x71c+0x1e0c+0x5*-0x496],_0x444882=_0x26e51f[0x1*0x1ad7+0x1*-0x7fc+-0x12d8]&&/^\d+$/[_0x4c1db6(0x177)](_0x26e51f[0x1dcf*-0x1+-0x1*-0x21fd+-0x42b])?Number(_0x26e51f[0x727*0x1+-0x1872+0x114e]):null;let _0x23dbfc='';const _0x3aab27=new RegExp('\x5cb'+_0x2f3eae[_0x4c1db6(0x30a)](/[.*+?^${}()|[\\]\\\\]/g,_0x4c1db6(0x1d2))+'\x5cb'),_0x366430=_0x24133b[_0x4c1db6(0x1eb)](_0x3aab27);if(_0x366430){const _0x17e68a=_0x24133b[_0x4c1db6(0x1dd)](_0x366430[-0xd64+-0x2f+0xd93]),_0x2f54bb=_0x17e68a+_0x366430[0x13e1*-0x1+0x437*-0x7+0x3162][_0x4c1db6(0xaf)];_0x23dbfc=_0x24133b[_0x4c1db6(0x1c1)](_0x2f54bb)[_0x4c1db6(0x30a)](/^\s*/,'');if(_0x23dbfc&&/^\d+/[_0x4c1db6(0x177)](_0x23dbfc))_0x23dbfc=_0x23dbfc[_0x4c1db6(0x30a)](/^\d+\s*/,'');}const _0x2a2c62=_0x23dbfc&&_0x5e62c4?_0x23dbfc+'\x0a'+_0x5e62c4:_0x23dbfc||_0x5e62c4||'';if(!_0x2a2c62||_0x2a2c62[_0x4c1db6(0x32b)]()[_0x4c1db6(0xaf)]===0x2*-0xc31+-0xb43+-0x19*-0x16d){await sendWithRetry(_0x59b600,{'text':'Please\x20pro'+_0x4c1db6(0x1da)+_0x4c1db6(0x2db)+_0x4c1db6(0x267)+_0x4c1db6(0x163)+_0x4c1db6(0x2e8)+_0x4c1db6(0x2fa)+_0x4c1db6(0x252)});return;}const _0x15b6ac=[];for(const _0x290d70 of _0x321d30){const _0x17f390=await getChatTimezone(_0x290d70)||DEFAULT_TIMEZONE,_0x4eb34d=parseTimeToken(_0x2f3eae,_0x17f390);if(!_0x4eb34d){_0x15b6ac[_0x4c1db6(0x17e)]({'chat':_0x290d70,'ok':![],'reason':_0x4c1db6(0x255)+'ed'});continue;}const _0x4f4620=_0x1fb299;if(_0x4eb34d[_0x4c1db6(0x2f0)]===_0x4c1db6(0x1df)){const _0x1c9cf7=_0x4eb34d['dt'],_0x4177b9=Math[_0x4c1db6(0x324)](_0x1c9cf7[_0x4c1db6(0x1a4)]()/(-0x23b3+0x19*0x91+0xcb9*0x2)),_0x4f9bda=await addScheduleRow({'chat_jid':_0x290d70,'message':_0x2a2c62,'time':null,'send_at':_0x4177b9,'frequency':_0x4c1db6(0x29b),'timezone':_0x1c9cf7[_0x4c1db6(0x1fe)]||_0x17f390,'creator_jid':_0x4f4620});if(_0x4f9bda)_0x15b6ac['push']({'chat':_0x290d70,'ok':!![],'id':_0x4f9bda,'when':_0x1c9cf7[_0x4c1db6(0x193)+_0x4c1db6(0x2c6)](DateTime['DATETIME_M'+'ED'])});else _0x15b6ac['push']({'chat':_0x290d70,'ok':![],'reason':_0x4c1db6(0xd5)});continue;}if(_0x4eb34d['type']===_0x4c1db6(0x2e1)){const _0x46b44e=_0x4eb34d['hhmm'];if(_0x444882&&Number[_0x4c1db6(0xe8)](_0x444882)&&_0x444882>=0xe4c+0x2592+-0x33dd*0x1){let _0x1d8a9c=DateTime['now']()[_0x4c1db6(0x2ee)](_0x17f390);const [_0x457ad8,_0x5862c2]=_0x46b44e[_0x4c1db6(0x300)](':')[_0x4c1db6(0x15a)](Number);let _0x4a5865=_0x1d8a9c[_0x4c1db6(0x1e2)]('day')[_0x4c1db6(0x312)]({'hour':_0x457ad8,'minute':_0x5862c2,'second':0x0,'millisecond':0x0});_0x4a5865=_0x4a5865[_0x4c1db6(0x1ef)]({'days':Number(_0x444882)});const _0x9e6478=Math['floor'](_0x4a5865['toMillis']()/(-0x74*-0x33+0xb36+0xf35*-0x2)),_0x521e80=await addScheduleRow({'chat_jid':_0x290d70,'message':_0x2a2c62,'time':null,'send_at':_0x9e6478,'frequency':'once','timezone':_0x17f390,'creator_jid':_0x4f4620});if(_0x521e80)_0x15b6ac['push']({'chat':_0x290d70,'ok':!![],'id':_0x521e80,'when':_0x4a5865['toLocaleSt'+_0x4c1db6(0x2c6)](DateTime[_0x4c1db6(0x238)+'ED'])});else _0x15b6ac['push']({'chat':_0x290d70,'ok':![],'reason':_0x4c1db6(0xd5)});continue;}const _0x18414f=await addScheduleRow({'chat_jid':_0x290d70,'message':_0x2a2c62,'time':_0x46b44e,'send_at':null,'frequency':_0x4c1db6(0x19b),'timezone':_0x17f390,'creator_jid':_0x4f4620});if(_0x18414f)_0x15b6ac['push']({'chat':_0x290d70,'ok':!![],'id':_0x18414f,'when':_0x46b44e+'\x20('+_0x17f390+')'});else _0x15b6ac['push']({'chat':_0x290d70,'ok':![],'reason':_0x4c1db6(0xd5)});continue;}_0x15b6ac['push']({'chat':_0x290d70,'ok':![],'reason':_0x4c1db6(0x258)+_0x4c1db6(0x23b)});}const _0xade6ac=_0x15b6ac['filter'](_0x1aef6d=>_0x1aef6d['ok']),_0x279f38=_0x15b6ac['filter'](_0x7ebed4=>!_0x7ebed4['ok']);let _0x53c578='';if(_0xade6ac[_0x4c1db6(0xaf)]){_0x53c578+=_0x4c1db6(0x27b)+'for\x20'+_0xade6ac[_0x4c1db6(0xaf)]+('\x20default\x20c'+_0x4c1db6(0x19f)+_0x4c1db6(0xf8));for(const _0x2f0c6c of _0xade6ac)_0x53c578+='â€¢\x20'+_0x2f0c6c[_0x4c1db6(0x146)]+_0x4c1db6(0x347)+_0x2f0c6c['id']+_0x4c1db6(0x2d6)+_0x2f0c6c['when']+'\x0a';}if(_0x279f38[_0x4c1db6(0xaf)]){_0x53c578+='Failed\x20for'+'\x20'+_0x279f38[_0x4c1db6(0xaf)]+(_0x4c1db6(0x2dc)+'onnection('+'s):\x0a');for(const _0x2fe069 of _0x279f38)_0x53c578+='â€¢\x20'+_0x2fe069[_0x4c1db6(0x146)]+_0x4c1db6(0xc4)+_0x2fe069['reason']+'\x0a';}await sendWithRetry(_0x59b600,{'text':_0x53c578['trim']()||'No\x20schedul'+_0x4c1db6(0x192)+'.'});return;}if(_0x297387===_0x4c1db6(0x1c5)){const _0x2ff31d=await getCombinedSchedulesForChats(_0x321d30);if(!_0x2ff31d['length']){await sendWithRetry(_0x59b600,{'text':'No\x20schedul'+'ed\x20message'+_0x4c1db6(0x195)+_0x4c1db6(0x22c)+':\x20'+_0x321d30[_0x4c1db6(0x161)](',\x20')});return;}const _0x238ae2=_0x2ff31d[_0x4c1db6(0x15a)]((_0x4db836,_0x4ae9bd)=>{const _0x77796b=_0x4c1db6,_0x1a1c88=_0x4db836[_0x77796b(0x1bf)]?DateTime['fromMillis'](Number(_0x4db836[_0x77796b(0x1bf)])*(0x1d72+0x1*-0x98b+0x555*-0x3))[_0x77796b(0x2ee)](_0x4db836['timezone']||DEFAULT_TIMEZONE)['toISO']({'suppressSeconds':!![]}):_0x4db836[_0x77796b(0x166)]?_0x4db836[_0x77796b(0x166)]+'\x20('+(_0x4db836[_0x77796b(0x123)]||'group/defa'+_0x77796b(0x219))+')':_0x77796b(0x1fd),_0x158378=(_0x4db836[_0x77796b(0x32f)]||'')[_0x77796b(0x300)]('\x0a')[_0x77796b(0x15a)](_0x12aab9=>_0x12aab9[_0x77796b(0x117)]())[_0x77796b(0x161)]('\x0a');return _0x4ae9bd+(-0x1*-0x206f+0x99b+0xd3*-0x33)+')\x20id:'+_0x4db836['id']+'\x20chat:'+_0x4db836[_0x77796b(0xba)]+_0x77796b(0x2d6)+_0x1a1c88+_0x77796b(0x26f)+(_0x4db836['frequency']||_0x77796b(0x19b))+_0x77796b(0x22f)+(_0x4db836[_0x77796b(0x16e)]?_0x77796b(0xcd):'no')+_0x77796b(0x206)+_0x158378;}),_0x412896=_0x4c1db6(0x27b)+_0x4c1db6(0x2bb)+_0x4c1db6(0x332)+_0x321d30[_0x4c1db6(0x161)](',\x20')+_0x4c1db6(0xa2)+_0x238ae2[_0x4c1db6(0x161)]('\x0a\x0a');await sendWithRetry(_0x59b600,{'text':_0x412896});return;}if(_0x297387==='delete'){const _0x3b9337=_0x26e51f['slice'](-0x425+0x751*-0x4+-0x3b*-0x91);let _0x1c36f7=_0x3b9337['join']('\x20');if(!_0x1c36f7&&_0x5e62c4)_0x1c36f7=_0x5e62c4[_0x4c1db6(0x32b)]();if(!_0x1c36f7){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x32c)+_0x4c1db6(0x148)+_0x4c1db6(0xee)+_0x4c1db6(0x341)+'r,...|all>'});return;}if(/^\s*all\s*$/i[_0x4c1db6(0x177)](_0x1c36f7)){let _0xd8e6a6=-0xde4+0xcc0+0x92*0x2;for(const _0x275134 of _0x321d30){const _0x5a2ca6=await removeAllSchedulesForChat(_0x275134);_0xd8e6a6+=_0x5a2ca6;}await sendWithRetry(_0x59b600,{'text':'Deleted\x20'+_0xd8e6a6+(_0x4c1db6(0x111)+_0x4c1db6(0x1b1)+_0x4c1db6(0x24e))+_0x321d30[_0x4c1db6(0x161)](',\x20')});return;}const _0xa2ea40=_0x1c36f7[_0x4c1db6(0x300)](/[\s,]+/)['map'](_0x2284a6=>_0x2284a6[_0x4c1db6(0x32b)]())[_0x4c1db6(0x329)](Boolean),_0x5a7a82=_0xa2ea40['map'](_0x4ad4c1=>Number(_0x4ad4c1))[_0x4c1db6(0x329)](_0x57da77=>!Number[_0x4c1db6(0x10b)](_0x57da77)&&Number[_0x4c1db6(0xe8)](_0x57da77)&&_0x57da77>-0x305*-0x2+0x21ac+-0x11*0x256);if(!_0x5a7a82[_0x4c1db6(0xaf)]){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0xce)+_0x4c1db6(0x2a5)+_0x4c1db6(0x22b)+_0x4c1db6(0x29f)+'delete\x201\x202'+_0x4c1db6(0xfd)+_0x4c1db6(0x1aa)+_0x4c1db6(0x284)+_0x4c1db6(0x25f)+_0x4c1db6(0xe7)});return;}const _0x116459=[...new Set(_0x5a7a82)],_0x4ec9d2=await getCombinedSchedulesForChats(_0x321d30),_0xac9d4e=[],_0x340310=[];for(const _0x2592eb of _0x116459){if(_0x2592eb<-0x26f6+0x1*-0x1853+0x3f4a||_0x2592eb>_0x4ec9d2[_0x4c1db6(0xaf)]){_0x340310[_0x4c1db6(0x17e)]({'n':_0x2592eb,'reason':_0x4c1db6(0xef)});continue;}const _0x24be0e=_0x4ec9d2[_0x2592eb-(-0x2282+-0x394*0x4+0x30d3)]['id'],_0x59cb2b=await removeScheduleByDBId(_0x24be0e);if(_0x59cb2b)_0xac9d4e[_0x4c1db6(0x17e)]({'n':_0x2592eb,'id':_0x24be0e});else _0x340310['push']({'n':_0x2592eb,'reason':_0x4c1db6(0x1e8)+_0x4c1db6(0x260)});}let _0x45f55f='';if(_0xac9d4e[_0x4c1db6(0xaf)])_0x45f55f+='Deleted\x20'+_0xac9d4e[_0x4c1db6(0xaf)]+(_0x4c1db6(0x111)+'s):\x20')+_0xac9d4e[_0x4c1db6(0x15a)](_0x245f6e=>_0x245f6e['n']+_0x4c1db6(0x18c)+_0x245f6e['id']+')')[_0x4c1db6(0x161)](',\x20')+'.\x0a';if(_0x340310[_0x4c1db6(0xaf)])_0x45f55f+=_0x4c1db6(0x1a9)+'delete:\x20'+_0x340310['map'](_0x20d685=>_0x20d685['n']+'('+_0x20d685[_0x4c1db6(0xd2)]+')')[_0x4c1db6(0x161)](',\x20')+'.';await sendWithRetry(_0x59b600,{'text':_0x45f55f[_0x4c1db6(0x32b)]()||_0x4c1db6(0xe3)+_0x4c1db6(0x1fc)});return;}if(_0x297387==='edit'){const _0x5ce151=Number(_0x26e51f[-0xca*0x15+-0x14b8+0x1f*0x134]),_0x1427a1=_0x26e51f[-0xb88+0xc8e*0x1+-0x103]||(_0x5e62c4?_0x5e62c4[_0x4c1db6(0x300)](/\r?\n/)[0x6c5*0x5+0x3*0x7f5+0x737*-0x8]['trim']():null);if(!_0x5ce151||!_0x1427a1){await sendWithRetry(_0x59b600,{'text':'Usage:\x20sch'+_0x4c1db6(0x13a)+_0x4c1db6(0x223)+_0x4c1db6(0x311)+_0x4c1db6(0x1ee)+_0x4c1db6(0x1b8)+'m>'});return;}const _0x3837c3=await getCombinedSchedulesForChats(_0x321d30);if(!_0x3837c3||_0x3837c3[_0x4c1db6(0xaf)]<_0x5ce151){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1c8)+_0x4c1db6(0xb7)+_0x5ce151+(_0x4c1db6(0x210)+_0x4c1db6(0x335)+_0x4c1db6(0xfb))});return;}const _0x3deb28=_0x3837c3[_0x5ce151-(0x1c99*0x1+-0xea*-0x11+-0x15*0x21a)]['id'];if(!_0x3deb28){await sendWithRetry(_0x59b600,{'text':'No\x20schedul'+_0x4c1db6(0xb7)+_0x5ce151+('\x20found\x20acr'+_0x4c1db6(0x335)+_0x4c1db6(0xfb))});return;}const _0x1ff68c=parseTimeToken(_0x1427a1,DEFAULT_TIMEZONE);if(!_0x1ff68c){await sendWithRetry(_0x59b600,{'text':'Failed\x20to\x20'+_0x4c1db6(0x1c7)+_0x4c1db6(0x1d5)});return;}if(_0x1ff68c[_0x4c1db6(0x2f0)]===_0x4c1db6(0x1df)){const _0x522a4d=_0x1ff68c['dt'],_0x8124e8=Math[_0x4c1db6(0x324)](_0x522a4d['toMillis']()/(-0x215+-0x1417+-0xd0a*-0x2)),_0x52d64d=await updateScheduleFields(_0x3deb28,{'send_at':_0x8124e8,'time':null,'frequency':_0x4c1db6(0x29b),'timezone':_0x522a4d[_0x4c1db6(0x1fe)]||DEFAULT_TIMEZONE});if(_0x52d64d)await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x33b)+_0x5ce151+(_0x4c1db6(0x22a)+'o\x20one-off\x20'+_0x4c1db6(0x1be))+_0x522a4d[_0x4c1db6(0x193)+'ring'](DateTime[_0x4c1db6(0x238)+'ED'])+'\x20('+_0x522a4d['zoneName']+')'});else await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1a9)+_0x4c1db6(0x2d8)+_0x4c1db6(0x1f0)});return;}else{if(_0x1ff68c[_0x4c1db6(0x2f0)]===_0x4c1db6(0x2e1)){const _0x2a3599=_0x1ff68c[_0x4c1db6(0x2e1)],_0x201bbd=_0x3837c3[_0x5ce151-(-0x3*-0x5f3+-0xd*-0x56+0x1636*-0x1)],_0x25f045=_0x201bbd['timezone']||await getChatTimezone(_0x201bbd[_0x4c1db6(0xba)])||DEFAULT_TIMEZONE,_0x3a05b0=await updateScheduleFields(_0x3deb28,{'time':_0x2a3599,'send_at':null,'frequency':_0x4c1db6(0x19b),'timezone':_0x25f045});if(_0x3a05b0)await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x33b)+_0x5ce151+('\x20updated\x20t'+'o\x20recurrin'+_0x4c1db6(0x104))+_0x2a3599+'\x20('+_0x25f045+')'});else await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1a9)+_0x4c1db6(0x2d8)+_0x4c1db6(0x1f0)});return;}else{await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0xb0)+_0x4c1db6(0xf4)+_0x4c1db6(0x2b4)+_0x4c1db6(0xec)});return;}}}if(_0x297387===_0x4c1db6(0xdb)){const _0x4f0f40=Number(_0x26e51f[-0x15f0+-0x2af+0x18a1]),_0x41c392=Number(_0x26e51f[0x117f*0x1+0xe*0xee+0x20*-0xf4]);if(!_0x4f0f40||!_0x41c392||_0x41c392<-0x5ca+0xbce+0x603*-0x1){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x32c)+_0x4c1db6(0xde)+_0x4c1db6(0x16f)+_0x4c1db6(0x1cf)+'1\x20daily,\x20n'+'=2\x20every\x202'+_0x4c1db6(0x2cf)+'.)'});return;}const _0x29fcc7=await getCombinedSchedulesForChats(_0x321d30);if(!_0x29fcc7||_0x29fcc7[_0x4c1db6(0xaf)]<_0x4f0f40){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1c8)+_0x4c1db6(0xb7)+_0x4f0f40+(_0x4c1db6(0x210)+_0x4c1db6(0x335)+_0x4c1db6(0xfb))});return;}const _0xa1c5b1=_0x29fcc7[_0x4f0f40-(0x1b27+-0xdbb+-0xf*0xe5)]['id'];if(!_0xa1c5b1){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1c8)+_0x4c1db6(0xb7)+_0x4f0f40+(_0x4c1db6(0x210)+'oss\x20your\x20d'+'efaults.')});return;}let _0x2fd33e=_0x4c1db6(0x19b);if(_0x41c392===-0x1435+-0x1*0x15df+0x2a15)_0x2fd33e=_0x4c1db6(0x19b);else _0x2fd33e=_0x4c1db6(0x227)+_0x4c1db6(0x2c2)+_0x41c392;const _0x513e80=await updateScheduleFields(_0xa1c5b1,{'frequency':_0x2fd33e});if(_0x513e80)await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x33b)+_0x4f0f40+(_0x4c1db6(0x27f)+_0x4c1db6(0xa4))+_0x2fd33e});else await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1a9)+'update\x20fre'+_0x4c1db6(0x318)});return;}if(_0x297387===_0x4c1db6(0x129)||_0x297387==='enable'){const _0x28da15=Number(_0x26e51f[0x733+0x252b+-0x2c5c]);if(!_0x28da15){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x32c)+_0x4c1db6(0x113)+_0x297387+_0x4c1db6(0x20f)});return;}const _0x3d6192=await getCombinedSchedulesForChats(_0x321d30);if(!_0x3d6192||_0x3d6192[_0x4c1db6(0xaf)]<_0x28da15){await sendWithRetry(_0x59b600,{'text':'No\x20schedul'+'e\x20#'+_0x28da15+(_0x4c1db6(0x210)+_0x4c1db6(0x335)+_0x4c1db6(0xfb))});return;}const _0x24bbf1=_0x3d6192[_0x28da15-(0x913*-0x2+-0x16d6+0x28fd*0x1)]['id'];if(!_0x24bbf1){await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1c8)+_0x4c1db6(0xb7)+_0x28da15+(_0x4c1db6(0x210)+_0x4c1db6(0x335)+'efaults.')});return;}const _0x3f631d=await updateScheduleFields(_0x24bbf1,{'enabled':_0x297387==='enable'?0xb*-0x2e1+0xd4f*0x1+0x125d:0x2*-0x9d3+0xb*-0x1eb+0x28bf});if(_0x3f631d)await sendWithRetry(_0x59b600,{'text':'Schedule\x20#'+_0x28da15+'\x20'+_0x297387+'d.'});else await sendWithRetry(_0x59b600,{'text':_0x4c1db6(0x1a9)+_0x4c1db6(0x2eb)+_0x4c1db6(0x25e)+'.'});return;}await sendWithRetry(_0x59b600,{'text':USAGE});}catch(_0x211da1){warn(_0x4c1db6(0x17d)+_0x4c1db6(0x218)+_0x4c1db6(0x212)+'p\x20error:\x20'+(_0x211da1?.[_0x4c1db6(0x32f)]||_0x211da1));}}function _0x2e85(){const _0x9f2c33=['leFields\x20e','PRAGMA\x20tab','s\x20RENAME\x20T','ER\x20DEFAULT','_RETRIES','s)\x20across\x20','1\x20ORDER\x20BY','alias','le_info(','s*\x0a\x0a>\x20*sch','group/defa','number','MM-DDTHH:m',':\x20\x22','edules\x20SET','\x20Delete\x20on','s):\x20','ULL,\x0a\x20\x20\x20\x20\x20','at\x20','send_at','ys/minutes','slice','sock','\x20\x20\x20chat_ji','sendAt','list','\x20chat=','parse\x20new\x20','No\x20schedul','remoteJid','edit','\x20\x20\x20);','recurrence','timestamp','chatid','>\x20<n>\x20\x20(n=','Deleted\x20','string','\x5c$&','EX\x20IF\x20NOT\x20','itialized\x20','time.','as|jid|all','resolve\x20gp','TEXT','`\x0aâ€£\x20Change','vide\x20messa','arted\x20(ali','anaging\x20sc','indexOf','ge...>`\x0aâ€£\x20','datetime','\x20\x20\x20enabled','d\x20to\x20backu','startOf','ms\x20default','SELECT\x20tim','mezone\x20TEX','eator_jid\x20','leByDBId\x20e','db\x20delete\x20','_schedules','fromISO','match','eduled\x20mes','n(s).\x20Set\x20','ours|YYYY-','plus','edule.','ALTER\x20TABL','chatJid','ommandPM\x20e','edules_new','[sched]\x20fi','\x20done;\x20sen','freq','\x20failed:\x20','lastID','\x20time.\x0a\x0a>\x20','\x20disabled\x20','\x20made.','unknown','zoneName','ded\x20schedu','.)\x20gp:<ali','1722HpBeGx','s_new\x20RENA','?,\x20?)\x20ON\x20C','CREATE\x20TAB','2409430kRPedZ','\x0amsg:\x0a','rval=','hasSame','EXISTS\x20idx','assign','ULT_TIMEZO','th\x20/setdef','ber>`\x20`<n>','[sched]\x20on','\x20<number>','\x20found\x20acr','caption','ommandGrou','\x20|\x20number,','iled\x20to\x20re',':mm|YYYY-M','\x20?\x20ORDER\x20B','\x20|\x20YYYY-MM','ndleSchedC','ult\x20TZ','created_at','days_of_we','ForUser\x20er','able\x20(expl','admin\x20chec','CREMENT,\x0a\x20','>`\x0aâ€£\x20Tempo','T\x20NOT\x20NULL','\x20to\x20','umber>\x20<HH','M-DDTHH:mm','conversati','ed\x20disable','every_n_da','\x20\x20\x20timezon','led\x20entrie','\x20updated\x20t','vided.\x20Usa','r\x20defaults','\x20available','s\x20canonica','\x20enabled:','all\x20or\x20a\x20g','d\x20removed\x20','uires\x20bot\x20','*sched\x20lis','FAULT\x20(str','created_by','ezone\x20FROM','s.\x0a\x0a>\x20*sch','DATETIME_M','es.\x0a\x0a>\x20*sc','=\x20?','d_time','s).\x20gp:<al','YY-MM-DDTH','ules\x20detec','tupSendApi','r:\x20','author','prepare','finalize','d,\x20message','\x20\x20\x20\x20\x20\x20\x20las','\x20(\x0a\x20\x20\x20\x20\x20\x20\x20','end_at\x20INT','.update','ed\x20add*\x20`<','tChatTimez','sage...>','\x20\x20\x20\x20freque','alias,\x20gp:','defaults:\x20','\x20at\x20','899468JkSjWu','essage\x20TEX','s).','ðŸ“…\x20*SchedHe','(\x27%s\x27,\x27now','parse_fail','\x0a\x20\x20\x20\x20\x20\x20\x20\x20C','ne;\x20old\x20ta','unsupporte','\x20time=','edulesForC','id|all>','ULL','E\x20IF\x20NOT\x20E','bled\x20state','hed\x20delete','failed','REATE\x20TABL','2.3.4','\x20=\x20?',',\x0a\x20\x20','\x20?,\x20?)','nnection.u','ame\x20line\x20a','pdate\x20obse','355840rjmWiP','ATE\x20TABLE\x20',')\x20VALUES\x20(','schedules_','AUTOINCREM','ur\x20default','\x20freq:','â€£\x20One-off\x20','[sched]\x20ge','*\x20`<number','ings\x20(\x0a\x20\x20\x20','sage.\x0a\x0a>\x20*','ection\x20upd','key','e-off\x20post','|in\x20N\x20hour','sched.init','\x20\x20\x20\x20timezo','Scheduled\x20','CREATE\x20IND','>`\x20`<messa','delete','\x20frequency','anager\x20use','ted\x20target','listRespon','o\x20recurrin',',2,3\x20OR\x20sc','fromMe','T\x20timezone','IMARY\x20KEY\x20','itial\x20exec','sent_at','r_settings','fromMillis','[sched]\x20de','IF\x20NOT\x20EXI','ncy*\x20`<num','[sched]\x20re','F_MS','s\x20(chat_ji','hed\x20add\x2009','Could\x20not\x20','\x0a);','t\x20lines\x20â€”\x20','les\x20for\x20to','LE\x20IF\x20NOT\x20','iled:\x20','selectedRo','[sched]\x20ad','once','sched\x20enab','duler_sett','for\x20','ge:\x20sched\x20','liver\x20one-','day_of_mon',',\x20?,\x20?,\x20?,','c.\x0a\x0a>\x20*sch','freshConfi','ndexes\x20pro','sage...>\x20g','|jid|all>','l/adequate','startsWith','=2\x20every\x202','run','sendMessag','all','[sched]\x20co','ecutorTick','[sched]\x20cr','\x20messages\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20m','EFAULT\x20\x27da','mat\x20for\x20ed','\x20(strftime','hat\x20error:','PRAGMA\x20for','[sched]\x20ta','extendedTe','body','for\x20defaul','sureSchema','delete:\x20','\x20NOT\x20NULL,','2\x20days,\x20et','xtMessage','nnot\x20inser','ys:',',\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Please\x20pro','ed,\x20schedu','ring','[sched]\x20cl','[sched]\x20fa','eaned\x20up','time\x20TEXT,','\x20\x20\x20\x20creato','les','\x20\x20\x20);\x0a\x20\x20\x20\x20','wId','\x20days,\x20etc','quency,\x20ti','p:<alias|j','E\x20schedule','XISTS\x20sche','\x20\x20\x20\x20create','all\x20schedu','\x20when:','\x20\x20\x20\x20\x20\x20\x20\x20en','update\x20sch','[sched]\x20in','\x20the\x20time\x20','ge\x20text\x20(s','\x20default\x20c','videoMessa','gacy\x20sched','DEFAULT\x201,','ler\x20error:','hhmm','ime\x20inline','H:mm>\x20[Nda','ctReply','nd_at,\x20fre','es\x20(\x0a\x20\x20','T,\x0a\x20\x20\x20\x20\x20\x20\x20','or\x20on\x20foll','HH:mm\x20|\x20YY','mezone,\x20cr','update\x20ena','ftime(\x27%s\x27','\x20connectio','setZone','=\x20ON;','type','changes','o\x20one-off\x20','chat_jid\x20=','get','there\x0amore','ime','has','le*\x20`<numb','N\x20hours/da','owing\x20line','one-off\x20fo','nabled\x20INT','targets.','weekly','d\x20INTEGER\x20','split',':00\x20Hello\x20','e\x20FROM\x20sql','ble\x20rename','EY,\x0a\x20\x20\x20\x20\x20\x20','ble','ncy\x20TEXT,\x0a','livered\x20an','LE\x20schedul','e-off\x20id=','replace','catch','utes>\x20<mes','findings','SCHED_DEFA','ed\x20listene','Y\x20id\x20ASC',':mm|in\x20N\x20h','set','ates)','nfig\x20refre','roup\x20JID.','seMessage','nnection\x20','quency.','t_jid\x20TEXT','SCHED_INIT','ault.','n\x20follow\x20t','tchFromFin','SELECT\x20*\x20F','\x20\x20\x20\x20\x20\x20\x20cha','tReload\x20ha','heduler\x20st','delete\x201\x202','\x0a\x20\x20\x20\x20\x20\x20CRE','floor','T\x201,\x0a\x20\x20\x20\x20\x20','hat_jid);','zone','6870dyMDzM','filter','rved\x20-\x20re-','trim','Usage:\x20sch','day\x20+\x20Nday','eanup\x20erro','message','NTEGER\x0a\x20\x20\x20','padStart','ts\x20(','[sched]\x20sw','TEXT\x20DEFAU','oss\x20your\x20d','\x0a\x20\x20\x20\x20\x20\x20\x20VA','t_jid,\x20mes','solveDefau','t,\x20creator','utor\x20error','Schedule\x20#','from','[sched]\x20ex','sched','without\x20de','off\x20id=','mber,numbe','ction.upda','day','ttonId','31216MDqCto','INSERT\x20INT','\x20->\x20id:','les\x20WHERE\x20','at_jid\x20=\x20?','buttonsRes','SCHED_SEND',',\x27now\x27))','):\x0a\x0a','Message\x20er','\x20set\x20to\x20','\x20fatal','_jid\x20=\x20?','isArray','O\x20schedule','includes','diff','enabled\x20=\x20','target_jid','m>\x20gp:<ali','\x22.\x20Use\x20gp:','length','Unsupporte','help','ed\x20once\x20<H','nutes)','creator_ji','fig\x20regist','ys]`\x20`<mes','e\x20#','ne\x20TEXT,\x0a\x20','adAndNorma','chat_jid','d|all>)',',\x20timezone','no\x20send\x20ta','ple\x20schedu','dateSchedu','_settings\x20','e\x20from\x20DB;','every','\x20all\x20gp:<a','\x20->\x20','value','\x20daily,\x20`n','1\x20daily,\x20n','oss\x20reques','ge.\x0a\x0a>\x20*sc','=excluded.','ge...>\x20\x20\x20(','iled\x20to\x20de','yes','No\x20valid\x20i','ite_master','lias|jid|a','t*\x0aâ€£\x20View\x20','reason','add','eign_keys\x20','db_failed','gs\x20(\x0a\x20\x20\x20\x20\x20','[sched]\x20en','one-off\x20id','\x20lines\x0agp:','room','frequency','\x20error:\x20','[sched]\x20ho','ed\x20frequen','R\x20PRIMARY\x20','peat\x20inter','<number>`\x20','ror:\x20','No\x20changes','toLowerCas','MARY\x20KEY,\x0a','s/days/min','\x20all','isInteger','Message\x20ca','KEY\x20AUTOIN','moveSchedu','it.','entries','<number|nu','not\x20found','singleSele','_chat\x20ON\x20s','[sched]\x20ca','M\x20schedule','d\x20time\x20for','connection','solving\x20co','ed\x20add\x20<HH','s):\x0a',':<alias|ji','function','efaults.','sForChat\x20e','\x203\x20OR\x20sche','ecutor\x20ite','\x20target(s)','nd\x20attempt','endsWith','88LfuAuy','of\x20a\x20sched','g\x20at\x20','9200880WuCdZK','chedules(c','icit\x20targe','[sched]\x20mi','pdate\x20hand',',\x20last_sen','isNaN','DELETE\x20FRO','ialize\x20req','ROM\x20schedu','isCommand','tTableColu','\x20schedule(','led,\x20creat','ed\x20','ow\x20error:\x20','val:\x20`n=1`','sendat','trimEnd','mMe)','te\x20listene','gned\x20to\x20mi','UPDATE\x20sch','EGER\x20DEFAU','313bRRnVI','original\x20n','reviously\x20','ys]\x20<messa','\x20timezone\x20','jid','timezone','backup_','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','Africa/Nai','min','robi','disable','gister\x20man','hedules.\x20E','ily\x27,\x0a\x20\x20\x20\x20','s\x20at\x20given','curring\x20id','no\x20sendApi','requested\x20','normalizeT','default\x20wi','schedules','exec','imageMessa','>\x20*sched\x20o','d|all>\x20inl','k\x20failed','=\x20OFF;','ed\x20edit\x20<n','STS\x20schedu','gration\x20do','IAL_BACKOF','s\x20failed:\x20','d\x20to\x20remov','toFormat','hedules\x20ta','e=\x27table\x27\x20',':\x20bot\x20JID\x20','instance','shed:\x20inte','chat','schedule_t','ed\x20delete\x20',',\x20?)','error:\x20','keys','-send\x20clea','in\x20N\x20hours','t\x20required','TEXT\x0a\x20\x20\x20\x20\x20','ponseMessa','\x20?,\x20?,\x20?,\x20','Failed\x20for','e\x20TEXT\x0a\x20\x20\x20','one\x20error:','_MS','disabled\x20m','ids','mns\x20error\x20','TEXT\x20NOT\x20N','map','ncy\x20TEXT\x20D','ed\x20edit*\x20`','\x0a\x20\x20\x20\x20\x20\x20\x20\x20s','SCHED_CHEC','sage,\x20time','ek:','join','dules;','fter\x20time\x20','EGER,\x0a\x20\x20\x20\x20','UES\x20(?,\x20?,','time','e\x20for\x20','[sched]\x20se','when','tReloadCon','573324EDxNRY','ble\x20appear','_jid,\x20enab','enabled','cy\x20<number','resolve\x20yo','INTEGER\x20DE','dules_new\x20','e\x20or\x20multi','42yXIjKE','@g.us','scheduled_','test','ndStoredMa','gp:<alias|','\x20or\x20on\x20nex','\x20but\x20faile','days','[sched]\x20ha','push','r_jid\x20TEXT','\x20is\x20provid','ngSchedule','dScheduleR','isValid','[sched]\x20sc','opped','=2`\x20every\x20','\x20INTEGER,\x0a','led\x20messag','\x20id\x20INTEGE','update\x20fre','If\x20`Ndays`','(id:','K_INTERVAL','abled\x20INTE','rring\x20id=','rget\x20avail','dApi\x20','es\x20created','toLocaleSt','enable','s\x20found\x20fo','WHERE\x20chat','eated\x20sche','nup\x20error:','\x20\x20\x20\x20\x20\x20\x20\x20cr','\x20scheduler','daily','able\x20a\x20sch','now','\x20<number>\x20','onnection(','participan','SELECT\x20nam','text','rror:\x20','toMillis','jid|all>','include\x20gp','LT\x20\x27daily\x27','plies\x20(fro','Failed\x20to\x20','d\x20delete\x201','eserved.\x0a\x0a'];_0x2e85=function(){return _0x9f2c33;};return _0x2e85();}function _0x5961(_0x26ec2e,_0x4abb70){const _0x1a986d=_0x2e85();return _0x5961=function(_0x5581cb,_0x1ce12e){_0x5581cb=_0x5581cb-(-0x1f84+0x9*0x301+0x51b);let _0x3baa55=_0x1a986d[_0x5581cb];return _0x3baa55;},_0x5961(_0x26ec2e,_0x4abb70);}async function handleSchedCommandPM(_0x5bccbc,{sub:_0x1e5aab,firstLine:_0x5dfb4d,restText:_0x5b76dd,firstTokens:_0x4f92e1,targetChatJids:_0x4b1a1e,confirmationTarget:_0x939aba,senderJid:_0x135460,cleanedBody:_0x51b7e5}){const _0x229f8a=_0x29995d;try{if(!_0x1e5aab||_0x1e5aab===_0x229f8a(0xb1)){await sendWithRetry(_0x939aba,{'text':USAGE});return;}if(_0x1e5aab==='once'){const _0x56ddc1=_0x4f92e1[0x3*0x9e3+-0x1f19+0x1*0x172],_0x4e18c5=_0x4f92e1[-0x210e+0x119b*-0x2+-0x1*-0x4447]&&/^\d+$/[_0x229f8a(0x177)](_0x4f92e1[0x2*-0x1369+0x224*0x10+0x495])?Number(_0x4f92e1[0x15f8+0x5*0x11+-0x164a]):null;let _0x1411f2=(_0x51b7e5||'')[_0x229f8a(0x32b)]();!_0x1411f2&&_0x56ddc1&&(_0x1411f2=extractInlineAfterToken(_0x5dfb4d,_0x56ddc1));if(!_0x56ddc1||!_0x1411f2||_0x1411f2[_0x229f8a(0x32b)]()[_0x229f8a(0xaf)]===0x151*0x5+0x64*0x35+-0x1b49*0x1){await sendWithRetry(_0x939aba,{'text':'Usage:\x20sch'+_0x229f8a(0xb2)+_0x229f8a(0x2e3)+_0x229f8a(0x120)+_0x229f8a(0xcb)+_0x229f8a(0x1a6)+_0x229f8a(0xf9)+_0x229f8a(0xbb)});return;}const _0x360a98=[];for(const _0x311b92 of _0x4b1a1e){const _0x113baa=await getChatTimezone(_0x311b92)||DEFAULT_TIMEZONE,_0x4a09c6=parseTimeToken(_0x56ddc1,_0x113baa);if(!_0x4a09c6){_0x360a98['push']({'chat':_0x311b92,'ok':![],'reason':'parse_fail'+'ed'});continue;}if(_0x4a09c6[_0x229f8a(0x2f0)]===_0x229f8a(0x1df)){const _0x31f771=_0x4a09c6['dt'],_0xc04870=Math[_0x229f8a(0x324)](_0x31f771[_0x229f8a(0x1a4)]()/(-0xe79*0x2+-0x2*-0x1b8+0x1d6a)),_0x5ead9b=await addScheduleRow({'chat_jid':_0x311b92,'message':_0x1411f2,'time':null,'send_at':_0xc04870,'frequency':_0x229f8a(0x29b),'timezone':_0x31f771[_0x229f8a(0x1fe)]||_0x113baa,'creator_jid':_0x135460});if(_0x5ead9b)_0x360a98['push']({'chat':_0x311b92,'ok':!![],'id':_0x5ead9b,'when':_0x31f771['toLocaleSt'+'ring'](DateTime[_0x229f8a(0x238)+'ED'])});else _0x360a98[_0x229f8a(0x17e)]({'chat':_0x311b92,'ok':![],'reason':'db_failed'});continue;}if(_0x4a09c6['type']==='hhmm'){const [_0x227f0d,_0xbef2a4]=_0x4a09c6['hhmm'][_0x229f8a(0x300)](':')['map'](Number);let _0x56d767=DateTime[_0x229f8a(0x19d)]()['setZone'](_0x113baa),_0x211d35=_0x56d767[_0x229f8a(0x1e2)](_0x229f8a(0x343))['set']({'hour':_0x227f0d,'minute':_0xbef2a4,'second':0x0,'millisecond':0x0});if(_0x4e18c5&&Number[_0x229f8a(0xe8)](_0x4e18c5)&&_0x4e18c5>=0x13c9+0x4eb*0x5+0x2c5f*-0x1)_0x211d35=_0x211d35[_0x229f8a(0x1ef)]({'days':Number(_0x4e18c5)});else{if(_0x211d35<=_0x56d767)_0x211d35=_0x211d35[_0x229f8a(0x1ef)]({'days':0x1});}const _0xabd287=Math[_0x229f8a(0x324)](_0x211d35[_0x229f8a(0x1a4)]()/(0x90e+0x12a2+-0x17c8)),_0x30e395=await addScheduleRow({'chat_jid':_0x311b92,'message':_0x1411f2,'time':null,'send_at':_0xabd287,'frequency':_0x229f8a(0x29b),'timezone':_0x113baa,'creator_jid':_0x135460});if(_0x30e395)_0x360a98[_0x229f8a(0x17e)]({'chat':_0x311b92,'ok':!![],'id':_0x30e395,'when':_0x211d35[_0x229f8a(0x193)+_0x229f8a(0x2c6)](DateTime['DATETIME_M'+'ED'])});else _0x360a98[_0x229f8a(0x17e)]({'chat':_0x311b92,'ok':![],'reason':_0x229f8a(0xd5)});continue;}_0x360a98[_0x229f8a(0x17e)]({'chat':_0x311b92,'ok':![],'reason':_0x229f8a(0x258)+'d_time'});}const _0x346165=_0x360a98[_0x229f8a(0x329)](_0x2e219e=>_0x2e219e['ok']),_0x17fc5e=_0x360a98[_0x229f8a(0x329)](_0x56be3b=>!_0x56be3b['ok']);let _0x103b00='';if(_0x346165[_0x229f8a(0xaf)]){_0x103b00+=_0x229f8a(0x27b)+_0x229f8a(0x2fb)+'r\x20'+_0x346165[_0x229f8a(0xaf)]+(_0x229f8a(0xff)+':\x0a');for(const _0x361d3f of _0x346165)_0x103b00+='â€¢\x20'+_0x361d3f[_0x229f8a(0x146)]+_0x229f8a(0x347)+_0x361d3f['id']+_0x229f8a(0x24f)+_0x361d3f[_0x229f8a(0x169)]+'\x0a';}if(_0x17fc5e['length']){_0x103b00+='Failed\x20for'+'\x20'+_0x17fc5e[_0x229f8a(0xaf)]+('\x20target(s)'+':\x0a');for(const _0x5035e3 of _0x17fc5e)_0x103b00+='â€¢\x20'+_0x5035e3['chat']+_0x229f8a(0xc4)+_0x5035e3[_0x229f8a(0xd2)]+'\x0a';}await sendWithRetry(_0x939aba,{'text':_0x103b00[_0x229f8a(0x32b)]()||'No\x20schedul'+_0x229f8a(0x192)+'.'});return;}if(_0x1e5aab===_0x229f8a(0xd3)){if(!_0x4f92e1[0x509+0x1*0x1195+-0x5a7*0x4]){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x32c)+_0x229f8a(0xf7)+_0x229f8a(0x215)+'M-DDTHH:mm'+_0x229f8a(0x278)+_0x229f8a(0xe6)+_0x229f8a(0x30c)+_0x229f8a(0x2a6)+_0x229f8a(0x2d1)+_0x229f8a(0x25b)});return;}const _0x6ff0ad=_0x4f92e1[0x26ee+-0x7fd*-0x2+0x1b73*-0x2],_0x22f815=_0x4f92e1[-0x3b*-0xa7+-0x7*-0x68+0x6*-0x6e3]&&/^\d+$/['test'](_0x4f92e1[0x1b6b+0x1*-0x1232+-0x936])?Number(_0x4f92e1[0x1*0xcbd+-0x115b+-0xf*-0x4f]):null;let _0x14b585=(_0x51b7e5||'')['trim']();!_0x14b585&&(_0x14b585=extractInlineAfterToken(_0x5dfb4d,_0x6ff0ad));if(!_0x14b585||_0x14b585[_0x229f8a(0x32b)]()['length']===0x1d3e+0x1b81+0x49*-0xc7){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x2c4)+_0x229f8a(0x1da)+_0x229f8a(0x2db)+'ame\x20line\x20a'+_0x229f8a(0x163)+_0x229f8a(0x2e8)+_0x229f8a(0x2fa)+_0x229f8a(0x23c)+'ias|jid|al'+'l>'});return;}const _0x539201=[];for(const _0x31e86a of _0x4b1a1e){const _0x518ca0=await getChatTimezone(_0x31e86a)||DEFAULT_TIMEZONE,_0x45ff21=parseTimeToken(_0x6ff0ad,_0x518ca0);if(!_0x45ff21){_0x539201[_0x229f8a(0x17e)]({'chat':_0x31e86a,'ok':![],'reason':_0x229f8a(0x255)+'ed'});continue;}const _0x205bbe=_0x135460;if(_0x45ff21[_0x229f8a(0x2f0)]===_0x229f8a(0x1df)){const _0xbe110c=_0x45ff21['dt'],_0x2c38cb=Math[_0x229f8a(0x324)](_0xbe110c['toMillis']()/(-0x385+0x7*-0x409+0x23ac)),_0x3f51d8=await addScheduleRow({'chat_jid':_0x31e86a,'message':_0x14b585,'time':null,'send_at':_0x2c38cb,'frequency':'once','timezone':_0xbe110c[_0x229f8a(0x1fe)]||_0x518ca0,'creator_jid':_0x205bbe});if(_0x3f51d8)_0x539201[_0x229f8a(0x17e)]({'chat':_0x31e86a,'ok':!![],'id':_0x3f51d8,'when':_0xbe110c[_0x229f8a(0x193)+_0x229f8a(0x2c6)](DateTime[_0x229f8a(0x238)+'ED'])});else _0x539201[_0x229f8a(0x17e)]({'chat':_0x31e86a,'ok':![],'reason':_0x229f8a(0xd5)});continue;}if(_0x45ff21['type']==='hhmm'){const _0x2bff36=_0x45ff21[_0x229f8a(0x2e1)];if(_0x22f815&&Number[_0x229f8a(0xe8)](_0x22f815)&&_0x22f815>=0x209f+-0x39*-0x25+-0x28db){let _0x285aea=DateTime[_0x229f8a(0x19d)]()[_0x229f8a(0x2ee)](_0x518ca0);const [_0x3ed0e2,_0x5f5a69]=_0x2bff36[_0x229f8a(0x300)](':')[_0x229f8a(0x15a)](Number);let _0x212e83=_0x285aea['startOf'](_0x229f8a(0x343))[_0x229f8a(0x312)]({'hour':_0x3ed0e2,'minute':_0x5f5a69,'second':0x0,'millisecond':0x0});_0x212e83=_0x212e83[_0x229f8a(0x1ef)]({'days':Number(_0x22f815)});const _0xa8c508=Math[_0x229f8a(0x324)](_0x212e83['toMillis']()/(0x1ae*0x5+0x4de+-0x4*0x257)),_0x511e37=await addScheduleRow({'chat_jid':_0x31e86a,'message':_0x14b585,'time':null,'send_at':_0xa8c508,'frequency':_0x229f8a(0x29b),'timezone':_0x518ca0,'creator_jid':_0x205bbe});if(_0x511e37)_0x539201['push']({'chat':_0x31e86a,'ok':!![],'id':_0x511e37,'when':_0x212e83[_0x229f8a(0x193)+_0x229f8a(0x2c6)](DateTime['DATETIME_M'+'ED'])});else _0x539201[_0x229f8a(0x17e)]({'chat':_0x31e86a,'ok':![],'reason':_0x229f8a(0xd5)});continue;}const _0x312b5d=await addScheduleRow({'chat_jid':_0x31e86a,'message':_0x14b585,'time':_0x2bff36,'send_at':null,'frequency':_0x229f8a(0x19b),'timezone':_0x518ca0,'creator_jid':_0x205bbe});if(_0x312b5d)_0x539201['push']({'chat':_0x31e86a,'ok':!![],'id':_0x312b5d,'when':_0x2bff36+'\x20('+_0x518ca0+')'});else _0x539201[_0x229f8a(0x17e)]({'chat':_0x31e86a,'ok':![],'reason':_0x229f8a(0xd5)});continue;}_0x539201[_0x229f8a(0x17e)]({'chat':_0x31e86a,'ok':![],'reason':_0x229f8a(0x258)+_0x229f8a(0x23b)});}const _0x10d413=_0x539201['filter'](_0x2aa3f1=>_0x2aa3f1['ok']),_0x472e50=_0x539201[_0x229f8a(0x329)](_0x3b3a5e=>!_0x3b3a5e['ok']);let _0xe485d0='';if(_0x10d413[_0x229f8a(0xaf)]){_0xe485d0+=_0x229f8a(0x27b)+_0x229f8a(0x29e)+_0x10d413['length']+(_0x229f8a(0xff)+':\x0a');for(const _0x3615e1 of _0x10d413)_0xe485d0+='â€¢\x20'+_0x3615e1[_0x229f8a(0x146)]+_0x229f8a(0x347)+_0x3615e1['id']+_0x229f8a(0x2d6)+_0x3615e1[_0x229f8a(0x169)]+'\x0a';}if(_0x472e50[_0x229f8a(0xaf)]){_0xe485d0+=_0x229f8a(0x152)+'\x20'+_0x472e50[_0x229f8a(0xaf)]+(_0x229f8a(0xff)+':\x0a');for(const _0xe4c2b8 of _0x472e50)_0xe485d0+='â€¢\x20'+_0xe4c2b8['chat']+_0x229f8a(0xc4)+_0xe4c2b8['reason']+'\x0a';}await sendWithRetry(_0x939aba,{'text':_0xe485d0[_0x229f8a(0x32b)]()||_0x229f8a(0x1c8)+_0x229f8a(0x192)+'.'});return;}if(_0x1e5aab===_0x229f8a(0x1c5)){const _0x2045fe=[];for(const _0x2bf471 of _0x4b1a1e){const _0x3b5fff=await listSchedulesForChat(_0x2bf471);for(const _0xc0e12d of _0x3b5fff)_0x2045fe[_0x229f8a(0x17e)]({'chatJid':_0x2bf471,..._0xc0e12d});}if(!_0x2045fe[_0x229f8a(0xaf)]){await sendWithRetry(_0x939aba,{'text':'[sched]\x20No'+'\x20scheduled'+_0x229f8a(0x2b1)+'found\x20for\x20'+'requested\x20'+_0x229f8a(0x2fd)});return;}let _0x5693ef='';for(const _0x4f8d31 of _0x2045fe){const _0x5f28aa=_0x4f8d31['send_at']?DateTime[_0x229f8a(0x28b)](Number(_0x4f8d31[_0x229f8a(0x1bf)])*(-0x1a9f+0x8f*-0x2+0x1fa5))[_0x229f8a(0x2ee)](_0x4f8d31[_0x229f8a(0x123)]||DEFAULT_TIMEZONE)['toISO']({'suppressSeconds':!![]}):_0x4f8d31[_0x229f8a(0x166)]?_0x4f8d31['time']+'\x20('+(_0x4f8d31['timezone']||_0x229f8a(0x1b6)+_0x229f8a(0x219))+')':_0x229f8a(0x1fd),_0x551d8a=(_0x4f8d31[_0x229f8a(0x32f)]||'')[_0x229f8a(0x300)]('\x0a')[_0x229f8a(0x15a)](_0x194de7=>_0x194de7[_0x229f8a(0x117)]())[_0x229f8a(0x161)]('\x0a'),_0x56fd1e=_0x4f8d31[_0x229f8a(0x1f2)]+':'+_0x4f8d31['id']+_0x229f8a(0x2d6)+_0x5f28aa+_0x229f8a(0x26f)+(_0x4f8d31[_0x229f8a(0xdb)]||_0x229f8a(0x19b))+_0x229f8a(0x22f)+(_0x4f8d31[_0x229f8a(0x16e)]?_0x229f8a(0xcd):'no')+_0x229f8a(0x206)+_0x551d8a+'\x0a\x0a';(_0x5693ef+_0x56fd1e)[_0x229f8a(0xaf)]>-0x826*0x1+0xd4d+0xb5&&(await sendWithRetry(_0x939aba,{'text':_0x5693ef[_0x229f8a(0x32b)]()}),_0x5693ef=''),_0x5693ef+=_0x56fd1e;}if(_0x5693ef[_0x229f8a(0x32b)]())await sendWithRetry(_0x939aba,{'text':_0x5693ef[_0x229f8a(0x32b)]()});return;}if(_0x1e5aab==='delete'){const _0x4d5743=_0x4f92e1[_0x229f8a(0x1c1)](-0x2*0x542+0x5bb+-0x199*-0x3);let _0x31e394=_0x4d5743['join']('\x20');if(!_0x31e394&&_0x5b76dd)_0x31e394=_0x5b76dd['trim']();if(!_0x31e394){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x32c)+'ed\x20delete\x20'+_0x229f8a(0xee)+_0x229f8a(0x341)+'r,...|all>'+'\x20gp:<alias'+_0x229f8a(0x2a7)});return;}if(/^\s*all\s*$/i[_0x229f8a(0x177)](_0x31e394)){let _0x865e7f=-0x6*-0x1bb+0xc88*-0x2+0xeae;for(const _0x401960 of _0x4b1a1e){const _0x2b1284=await removeAllSchedulesForChat(_0x401960);_0x865e7f+=_0x2b1284;}await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1d0)+_0x865e7f+('\x20schedule('+_0x229f8a(0x1b1)+_0x229f8a(0x130)+_0x229f8a(0x2fd))});return;}const _0x5c757e=_0x31e394['split'](/[\s,]+/)[_0x229f8a(0x15a)](_0x52e07d=>_0x52e07d[_0x229f8a(0x32b)]())[_0x229f8a(0x329)](Boolean),_0x3c62d8=_0x5c757e['map'](_0x43cb39=>Number(_0x43cb39))[_0x229f8a(0x329)](_0xa5847d=>!Number[_0x229f8a(0x10b)](_0xa5847d)&&Number['isInteger'](_0xa5847d)&&_0xa5847d>0x254f*-0x1+-0x254b*0x1+0x4a9a);if(!_0x3c62d8['length']){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0xce)+_0x229f8a(0x2a5)+_0x229f8a(0x22b)+'ge:\x20sched\x20'+_0x229f8a(0x322)+_0x229f8a(0xfd)+_0x229f8a(0x1aa)+',2,3\x20OR\x20sc'+_0x229f8a(0x25f)+_0x229f8a(0xc3)+_0x229f8a(0xd0)+'ll>'});return;}const _0x382a2e=[...new Set(_0x3c62d8)],_0x5032df=await getCombinedSchedulesForChats(_0x4b1a1e),_0x195c0d=[],_0x54ec95=[];for(const _0x53816c of _0x382a2e){if(_0x53816c<-0x117a+-0x3*0x922+0x2ce1||_0x53816c>_0x5032df[_0x229f8a(0xaf)]){_0x54ec95[_0x229f8a(0x17e)]({'n':_0x53816c,'reason':_0x229f8a(0xef)});continue;}const _0x5b4d84=_0x5032df[_0x53816c-(0x16*-0x1bb+0x236*0xb+0xdc1)]['id'],_0x5c9858=await removeScheduleByDBId(_0x5b4d84);if(_0x5c9858)_0x195c0d['push']({'n':_0x53816c,'id':_0x5b4d84});else _0x54ec95[_0x229f8a(0x17e)]({'n':_0x53816c,'reason':_0x229f8a(0x1e8)+_0x229f8a(0x260)});}let _0x92cf7d='';if(_0x195c0d['length'])_0x92cf7d+='Deleted\x20'+_0x195c0d[_0x229f8a(0xaf)]+('\x20schedule('+_0x229f8a(0x1bc))+_0x195c0d[_0x229f8a(0x15a)](_0x71af0e=>_0x71af0e['n']+'(id:'+_0x71af0e['id']+')')[_0x229f8a(0x161)](',\x20')+'.\x0a';if(_0x54ec95[_0x229f8a(0xaf)])_0x92cf7d+=_0x229f8a(0x1a9)+_0x229f8a(0x2bd)+_0x54ec95['map'](_0x2d0bb3=>_0x2d0bb3['n']+'('+_0x2d0bb3[_0x229f8a(0xd2)]+')')[_0x229f8a(0x161)](',\x20')+'.';await sendWithRetry(_0x939aba,{'text':_0x92cf7d['trim']()||_0x229f8a(0xe3)+'\x20made.'});return;}if(_0x1e5aab===_0x229f8a(0x1ca)){const _0x232119=Number(_0x4f92e1[0x15b*0xd+-0x1750+0x5b3]),_0x5d8fd4=_0x4f92e1[0x65b*0x6+0x8*-0x260+-0x131f]||(_0x5b76dd?_0x5b76dd[_0x229f8a(0x300)](/\r?\n/)[-0x2048+-0x81*-0xf+0x1*0x18b9][_0x229f8a(0x32b)]():null);if(!_0x232119||!_0x5d8fd4){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x32c)+_0x229f8a(0x13a)+_0x229f8a(0x223)+_0x229f8a(0x311)+_0x229f8a(0x1ee)+_0x229f8a(0x1b8)+_0x229f8a(0xad)+_0x229f8a(0x1d6)+'>'});return;}const _0x1d4e03=await getCombinedSchedulesForChats(_0x4b1a1e);if(!_0x1d4e03||_0x1d4e03['length']<_0x232119){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1c8)+_0x229f8a(0xb7)+_0x232119+(_0x229f8a(0x210)+_0x229f8a(0xc8)+_0x229f8a(0x281)+'s.')});return;}const _0x16ec43=_0x1d4e03[_0x232119-(-0x82*0xb+0x1c70+-0x16d9*0x1)]['id'];if(!_0x16ec43){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1c8)+_0x229f8a(0xb7)+_0x232119+(_0x229f8a(0x210)+_0x229f8a(0xc8)+_0x229f8a(0x281)+'s.')});return;}const _0x47fe8a=parseTimeToken(_0x5d8fd4,DEFAULT_TIMEZONE);if(!_0x47fe8a){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1a9)+_0x229f8a(0x1c7)+_0x229f8a(0x1d5)});return;}if(_0x47fe8a[_0x229f8a(0x2f0)]===_0x229f8a(0x1df)){const _0x2e307a=_0x47fe8a['dt'],_0x359238=Math[_0x229f8a(0x324)](_0x2e307a[_0x229f8a(0x1a4)]()/(-0xe5d+0x41*-0x8b+0x10*0x359)),_0x4d84cf=await updateScheduleFields(_0x16ec43,{'send_at':_0x359238,'time':null,'frequency':_0x229f8a(0x29b),'timezone':_0x2e307a[_0x229f8a(0x1fe)]||DEFAULT_TIMEZONE});if(_0x4d84cf)await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x33b)+_0x232119+('\x20updated\x20t'+_0x229f8a(0x2f2)+'at\x20')+_0x2e307a[_0x229f8a(0x193)+_0x229f8a(0x2c6)](DateTime['DATETIME_M'+'ED'])+'\x20('+_0x2e307a['zoneName']+')'});else await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1a9)+_0x229f8a(0x2d8)+_0x229f8a(0x1f0)});return;}else{if(_0x47fe8a[_0x229f8a(0x2f0)]===_0x229f8a(0x2e1)){const _0x137cee=_0x47fe8a[_0x229f8a(0x2e1)],_0xfa0748=_0x1d4e03[_0x232119-(0x102b*0x1+-0x1*-0xc1+-0x10eb)],_0x34caae=_0xfa0748[_0x229f8a(0x123)]||await getChatTimezone(_0xfa0748[_0x229f8a(0xba)])||DEFAULT_TIMEZONE,_0x5cb639=await updateScheduleFields(_0x16ec43,{'time':_0x137cee,'send_at':null,'frequency':'daily','timezone':_0x34caae});if(_0x5cb639)await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x33b)+_0x232119+(_0x229f8a(0x22a)+_0x229f8a(0x283)+_0x229f8a(0x104))+_0x137cee+'\x20('+_0x34caae+')'});else await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1a9)+_0x229f8a(0x2d8)+_0x229f8a(0x1f0)});return;}else{await sendWithRetry(_0x939aba,{'text':_0x229f8a(0xb0)+_0x229f8a(0xf4)+_0x229f8a(0x2b4)+_0x229f8a(0xec)});return;}}}if(_0x1e5aab===_0x229f8a(0xdb)){const _0x5186c1=Number(_0x4f92e1[0x11*0x1f9+0x1*0x624+-0x27ab]),_0xb9cd43=Number(_0x4f92e1[0x3d*-0x2f+-0x1*-0xefd+0x1*-0x3c7]);if(!_0x5186c1||!_0xb9cd43||_0xb9cd43<0x4*0x81e+0x1*0x217b+-0x41f2){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x32c)+'ed\x20frequen'+_0x229f8a(0x16f)+_0x229f8a(0x1cf)+_0x229f8a(0xc7)+_0x229f8a(0x2aa)+_0x229f8a(0x2cf)+_0x229f8a(0x200)+_0x229f8a(0x1d6)+'>'});return;}const _0x1cd008=await getCombinedSchedulesForChats(_0x4b1a1e);if(!_0x1cd008||_0x1cd008[_0x229f8a(0xaf)]<_0x5186c1){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1c8)+_0x229f8a(0xb7)+_0x5186c1+(_0x229f8a(0x210)+'oss\x20reques'+_0x229f8a(0x281)+'s.')});return;}const _0x442ec4=_0x1cd008[_0x5186c1-(-0x325+0x1*0x276+-0x4*-0x2c)]['id'];if(!_0x442ec4){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1c8)+_0x229f8a(0xb7)+_0x5186c1+(_0x229f8a(0x210)+_0x229f8a(0xc8)+_0x229f8a(0x281)+'s.')});return;}let _0x5da048=_0x229f8a(0x19b);if(_0xb9cd43===0x241*0xf+-0x2*-0x7bb+0x3*-0x106c)_0x5da048=_0x229f8a(0x19b);else _0x5da048='every_n_da'+_0x229f8a(0x2c2)+_0xb9cd43;const _0xb65a95=await updateScheduleFields(_0x442ec4,{'frequency':_0x5da048});if(_0xb65a95)await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x33b)+_0x5186c1+(_0x229f8a(0x27f)+_0x229f8a(0xa4))+_0x5da048});else await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1a9)+_0x229f8a(0x18a)+_0x229f8a(0x318)});return;}if(_0x1e5aab===_0x229f8a(0x129)||_0x1e5aab==='enable'){const _0x2e8143=Number(_0x4f92e1[-0x1*-0x1f6f+0xac*0x22+-0x1217*0x3]);if(!_0x2e8143){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x32c)+_0x229f8a(0x113)+_0x1e5aab+(_0x229f8a(0x19e)+_0x229f8a(0x179)+_0x229f8a(0x1a5))});return;}const _0x406db6=await getCombinedSchedulesForChats(_0x4b1a1e);if(!_0x406db6||_0x406db6[_0x229f8a(0xaf)]<_0x2e8143){await sendWithRetry(_0x939aba,{'text':'No\x20schedul'+_0x229f8a(0xb7)+_0x2e8143+(_0x229f8a(0x210)+_0x229f8a(0xc8)+_0x229f8a(0x281)+'s.')});return;}const _0x3ad75f=_0x406db6[_0x2e8143-(0x1*0xa7+-0x16dd*0x1+-0x205*-0xb)]['id'];if(!_0x3ad75f){await sendWithRetry(_0x939aba,{'text':_0x229f8a(0x1c8)+_0x229f8a(0xb7)+_0x2e8143+(_0x229f8a(0x210)+'oss\x20reques'+_0x229f8a(0x281)+'s.')});return;}const _0xcfb243=await updateScheduleFields(_0x3ad75f,{'enabled':_0x1e5aab===_0x229f8a(0x194)?0xa*-0x248+-0xc4*0x29+-0x1*-0x3635:-0x1*-0x214b+-0x19da+-0x771});if(_0xcfb243)await sendWithRetry(_0x939aba,{'text':'Schedule\x20#'+_0x2e8143+'\x20'+_0x1e5aab+'d.'});else await sendWithRetry(_0x939aba,{'text':'Failed\x20to\x20'+'update\x20ena'+_0x229f8a(0x25e)+'.'});return;}await sendWithRetry(_0x939aba,{'text':USAGE});}catch(_0x17cf4c){warn(_0x229f8a(0x17d)+_0x229f8a(0x218)+_0x229f8a(0x1f3)+'rror:\x20'+(_0x17cf4c?.[_0x229f8a(0x32f)]||_0x17cf4c));}}export async function initialize(_0x1ea58c){const _0x559385=_0x29995d;if(!_0x1ea58c)throw new Error(_0x559385(0x279)+_0x559385(0x10d)+_0x559385(0x232)+_0x559385(0x144));setupSendApi(_0x1ea58c),refreshConfig();try{await ensureSchema();}catch(_0x117284){error('[sched]\x20DB'+'\x20ensure\x20fa'+_0x559385(0x298)+(_0x117284?.[_0x559385(0x32f)]||_0x117284));throw _0x117284;}try{startManagedListener({'botRef':_0x1ea58c,'eventName':_0x559385(0xf5)+'.update','handler':_0x456123=>{const _0x3fe21f=_0x559385;try{info(_0x3fe21f(0x2ae)+_0x3fe21f(0x266)+_0x3fe21f(0x268)+_0x3fe21f(0x32a)+'setup\x20send'+'Api\x20(manag'+_0x3fe21f(0x30f)+'r)'),setupSendApi(_0x1ea58c);}catch(_0x58db2b){warn(_0x3fe21f(0x2ae)+_0x3fe21f(0x266)+_0x3fe21f(0x109)+_0x3fe21f(0x2e0)+'\x20'+(_0x58db2b?.['message']||_0x58db2b));}},'moduleName':name});}catch(_0x572300){warn(_0x559385(0x2c8)+_0x559385(0x214)+_0x559385(0x12a)+'aged\x20conne'+_0x559385(0x342)+_0x559385(0x119)+_0x559385(0x240)+(_0x572300?.[_0x559385(0x32f)]||_0x572300));}startSchedulerAligned(),info('[sched]\x20in'+_0x559385(0x1d4)+'(listenerM'+_0x559385(0x280)+'d\x20for\x20conn'+_0x559385(0x275)+_0x559385(0x313));}export async function cleanup(){const _0x1f8e14=_0x29995d;try{stopScheduler();try{stopManagedListener(name,'connection'+_0x1f8e14(0x248));}catch(_0xd819){}}catch(_0x15326a){warn(_0x1f8e14(0x2c7)+_0x1f8e14(0x32e)+'r:\x20'+(_0x15326a?.['message']||_0x15326a));}finally{botRef=null,sendApi=null,info(_0x1f8e14(0x2c7)+_0x1f8e14(0x2c9));}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};