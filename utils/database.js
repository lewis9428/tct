const _0x68304d=_0x3cea;(function(_0x1c9eb8,_0xe3c704){const _0x43b031=_0x3cea,_0x2b7bb0=_0x1c9eb8();while(!![]){try{const _0x447123=parseInt(_0x43b031(0x1be))/(0x9*-0x36e+0x1a6+0x1d39)*(-parseInt(_0x43b031(0x197))/(0x521+0x2*-0x2aa+0x35))+parseInt(_0x43b031(0x1a7))/(0x45c+0x15a4+0x19fd*-0x1)*(-parseInt(_0x43b031(0x16f))/(-0xf2a+0x1b73*-0x1+0x2aa1))+-parseInt(_0x43b031(0x135))/(-0x2282+0x1*0x1e19+0x46e)*(parseInt(_0x43b031(0x154))/(0x1a48+0x2dd+0x163*-0x15))+-parseInt(_0x43b031(0x1c3))/(0x1d0e+0x3*0xc8e+-0x42b1*0x1)+parseInt(_0x43b031(0x177))/(0x155*0x13+-0x2097+0x4e*0x18)+-parseInt(_0x43b031(0x1ac))/(0x1d71+-0x1dc1*0x1+0x1*0x59)*(-parseInt(_0x43b031(0x188))/(0x5*0x5b3+0x216f+0x11*-0x3a4))+parseInt(_0x43b031(0x126))/(-0x18d6+0xf35+0x26b*0x4)*(parseInt(_0x43b031(0x18e))/(0xb47*0x1+0x1195+0x39a*-0x8));if(_0x447123===_0xe3c704)break;else _0x2b7bb0['push'](_0x2b7bb0['shift']());}catch(_0x4e119b){_0x2b7bb0['push'](_0x2b7bb0['shift']());}}}(_0x551d,0x6807+0x6c9*0x2+0x3df2f));import _0x2108b6 from'sqlite3';import{open}from'sqlite';import _0x4e3232 from'fs-extra';import _0x28bbc3 from'path';import{getConfig}from'./config.js';import{info,error,warn}from'./logger.js';let db,setStmt,deleteStmt,logStmt,dbReady=![],writeQueue=[],queueBytes=-0x687+-0x22ff+0x2986,maxTotalBytes=0x2*0x742+0x1697+-0x251b,isFlushing=![],flushTimer,cache;function estimateQueueItemSize(_0x166bc6){const _0x1f18f6=_0x3cea,_0x33f387=-0x1510+-0x288+0xc*0x1fe;switch(_0x166bc6[_0x1f18f6(0x195)]){case _0x1f18f6(0x1c7):return Buffer[_0x1f18f6(0x137)](_0x166bc6[_0x1f18f6(0x187)],_0x1f18f6(0x163))+Buffer['byteLength'](_0x166bc6[_0x1f18f6(0x1c9)],_0x1f18f6(0x163))+_0x33f387;case _0x1f18f6(0x17b):return Buffer[_0x1f18f6(0x137)](_0x166bc6[_0x1f18f6(0x187)],'utf8')+_0x33f387;case _0x1f18f6(0x182):return Object[_0x1f18f6(0x1a6)](_0x166bc6[_0x1f18f6(0x134)])['reduce']((_0x10bd53,_0xb595a0)=>_0x10bd53+Buffer[_0x1f18f6(0x137)](String(_0xb595a0),_0x1f18f6(0x163)),0x1046+0x3c5*-0x7+0x3*0x35f)+_0x33f387;default:return-0xaf1+0x899+0x2d8;}}function _0x551d(){const _0x14ec69=['134KNAveO','ry.','llback:\x20','map','stat','s\x20(ts\x20INTE','_value_sto','e\x20memory\x20p','SELECT\x20val','dirname','pathExists','=\x20WAL;','get','\x22\x20is\x20not\x20s','Database\x20i','values','141GuZwMx','Y\x20KEY,\x20mod','uccessfull','versized\x20i','ressure:\x20D','18SunxDt','DB_BATCH_S','re\x20(key\x20TE','Error\x20duri','ng\x20final\x20d','_addToTail','=\x2010000;','O\x20logs\x20(ts','bytes','key,\x20value','iated.\x20Flu','Database\x20b','shift','Database\x20s','atabase\x20cl','le\x20failure','level','SIGTERM','4211TdaIhT','rnal_mode\x20','s\x20started.','ror:\x20','copy','786191ORcGsH','ailed:','maxBytes','GER\x20PRIMAR','set','key\x20\x22','value','serialized','once','COMMIT;','SIGINT','ocess\x20comp','chronous\x20=','hutdown\x20pr','slice','anly.','CRITICAL:\x20','DB_FLUSH_I','ng\x20for\x20ret','close','process\x20DB','ransaction','e_store\x20WH','\x20item,\x20wil','\x20operation','Write\x20queu','CREATE\x20TAB','11ynBgsM','ocess\x20init','stringify','o\x20stay\x20wit','DELETE\x20FRO','hin\x20memory','olling\x20bac','ore\x20WHERE\x20','h\x20complete','EXISTS\x20key','\x22\x20from\x20DB:','now','key\x20=\x20?','LE\x20IF\x20NOT\x20','data','415fbEgoQ','PROJECT_RO','byteLength',',\x20module,\x20','ache\x20for\x20o','PRAGMA\x20bus','y_timeout\x20','run','essfully.','SACTION;','next','finalize','ackup\x20fail','extname','INSERT\x20INT','_moveToTai','N/A','ose:','level\x20TEXT','dy\x20for\x20get','ROLLBACK;','message','_removeNod','s.\x20Item:\x20','join','?,\x20?)','exit','PRAGMA\x20for','ES\x20(?,\x20?,\x20','estimateSi',')\x20VALUES\x20(','7914zEOGBT','reduce','PRAGMA\x20syn','length','e;\x20skippin','eign_keys\x20',',\x20message\x20','Failed\x20to\x20','erializabl','ensureDirS','retries','zed\x20at\x20','est\x20item\x20t','onnection\x20','y\x20initiali','utf8','=\x20ON;','tail','XT\x20PRIMARY','\x20limits.\x20T','resolve','DB\x20flush\x20t','.bak','\x20failed,\x20r','PRAGMA\x20jou','k.\x20Prepari','Database','18264jOtrro','sage)\x20VALU','unshift','Value\x20for\x20','exec','timestamp','prepare','Skipping\x20c','2143728EBDusY','\x20KEY,\x20valu','AX_BYTES','s\x20ready.','delete','size','DB_PATH','M\x20key_valu','head','shing\x20queu','ue\x20FROM\x20ke','log','NTERVAL','push','TEXT);','get\x20key\x20\x22','key','1410590dLubml','DB\x20item\x20di','ed\x20by\x20tran','tem\x20\x22','prev','ERE\x20key\x20=\x20','5427516nziUHl','closed\x20cle','level,\x20mes','mtimeMs','Rollback\x20f','leted\x20succ','e\x20TEXT);','type','finally'];_0x551d=function(){return _0x14ec69;};return _0x551d();}class MemoryCache{constructor(_0x49bb51){const _0x423c95=_0x3cea;this['maxBytes']=_0x49bb51,this[_0x423c95(0x1b4)]=0x1a15+0x40*-0x3+-0x5*0x511,this[_0x423c95(0x19a)]=new Map(),this[_0x423c95(0x17f)]={'prev':null,'next':null},this[_0x423c95(0x165)]={'prev':null,'next':null},this['head'][_0x423c95(0x13f)]=this[_0x423c95(0x165)],this[_0x423c95(0x165)][_0x423c95(0x18c)]=this['head'];}static[_0x68304d(0x152)+'ze'](_0x4106e0,_0x469820){const _0x5bcf6d=_0x68304d,_0x50b076=Buffer[_0x5bcf6d(0x137)](String(_0x4106e0),_0x5bcf6d(0x163)),_0x45f5be=Buffer['byteLength'](_0x469820??'','utf8');return _0x50b076+_0x45f5be+(-0x69+-0x13e8+0x1491);}[_0x68304d(0x14b)+'e'](_0x5e23c4){const _0x9a52e3=_0x68304d;_0x5e23c4[_0x9a52e3(0x18c)]['next']=_0x5e23c4['next'],_0x5e23c4[_0x9a52e3(0x13f)][_0x9a52e3(0x18c)]=_0x5e23c4['prev'];}[_0x68304d(0x1b1)](_0x21b3be){const _0x22e5eb=_0x68304d;_0x21b3be[_0x22e5eb(0x18c)]=this['tail'][_0x22e5eb(0x18c)],_0x21b3be[_0x22e5eb(0x13f)]=this[_0x22e5eb(0x165)],this['tail'][_0x22e5eb(0x18c)][_0x22e5eb(0x13f)]=_0x21b3be,this[_0x22e5eb(0x165)]['prev']=_0x21b3be;}[_0x68304d(0x144)+'l'](_0x1d8a08){const _0x32de95=_0x68304d;this[_0x32de95(0x14b)+'e'](_0x1d8a08),this[_0x32de95(0x1b1)](_0x1d8a08);}['has'](_0x5c6902){const _0x3da3ff=_0x68304d;return this[_0x3da3ff(0x19a)]['has'](_0x5c6902);}[_0x68304d(0x1a3)](_0x5165cf){const _0x280fe5=_0x68304d,_0x5dc4f9=this[_0x280fe5(0x19a)][_0x280fe5(0x1a3)](_0x5165cf);if(!_0x5dc4f9)return undefined;return this['_moveToTai'+'l'](_0x5dc4f9),_0x5dc4f9[_0x280fe5(0x1c9)];}['set'](_0x486895,_0x88462b,_0x10a3ef){const _0x2cbeb1=_0x68304d,_0x2b3432=this[_0x2cbeb1(0x19a)][_0x2cbeb1(0x1a3)](_0x486895),_0x2eb1db=MemoryCache[_0x2cbeb1(0x152)+'ze'](_0x486895,_0x10a3ef);if(_0x2eb1db>this[_0x2cbeb1(0x1c5)]){warn(_0x2cbeb1(0x176)+_0x2cbeb1(0x139)+_0x2cbeb1(0x1aa)+_0x2cbeb1(0x18b)+_0x486895+'\x22\x20('+_0x2eb1db+('\x20bytes\x20>\x20m'+'ax\x20')+this['maxBytes']+')');if(_0x2b3432)this[_0x2cbeb1(0x17b)](_0x486895);return;}if(_0x2b3432)this[_0x2cbeb1(0x1b4)]-=_0x2b3432[_0x2cbeb1(0x17c)],_0x2b3432[_0x2cbeb1(0x1c9)]=_0x88462b,_0x2b3432[_0x2cbeb1(0x1ca)]=_0x10a3ef,_0x2b3432[_0x2cbeb1(0x17c)]=_0x2eb1db,this[_0x2cbeb1(0x1b4)]+=_0x2eb1db,this['_moveToTai'+'l'](_0x2b3432);else{const _0x58dac3={'key':_0x486895,'value':_0x88462b,'serialized':_0x10a3ef,'size':_0x2eb1db,'prev':null,'next':null};this['map'][_0x2cbeb1(0x1c7)](_0x486895,_0x58dac3),this[_0x2cbeb1(0x1b1)](_0x58dac3),this[_0x2cbeb1(0x1b4)]+=_0x2eb1db;}while(this[_0x2cbeb1(0x1b4)]>this[_0x2cbeb1(0x1c5)]){const _0x3a65c0=this[_0x2cbeb1(0x17f)]['next'];if(_0x3a65c0===this[_0x2cbeb1(0x165)])break;this[_0x2cbeb1(0x17b)](_0x3a65c0[_0x2cbeb1(0x187)]);}}[_0x68304d(0x17b)](_0x22f936){const _0x3986ca=_0x68304d,_0x99235a=this[_0x3986ca(0x19a)]['get'](_0x22f936);if(!_0x99235a)return;this['_removeNod'+'e'](_0x99235a),this['map'][_0x3986ca(0x17b)](_0x22f936),this[_0x3986ca(0x1b4)]-=_0x99235a[_0x3986ca(0x17c)];}}function enforceMemoryLimit(){const _0x4fdbd2=_0x68304d;while(cache[_0x4fdbd2(0x1b4)]+queueBytes>maxTotalBytes&&writeQueue[_0x4fdbd2(0x157)]>-0x33*0x56+-0x25c8+-0x927*-0x6){const _0x3774e4=writeQueue[_0x4fdbd2(0x1b8)]();_0x3774e4['size']&&(queueBytes-=_0x3774e4[_0x4fdbd2(0x17c)]),warn(_0x4fdbd2(0x124)+_0x4fdbd2(0x19e)+_0x4fdbd2(0x1ab)+'ropped\x20old'+_0x4fdbd2(0x160)+_0x4fdbd2(0x129)+_0x4fdbd2(0x12b)+_0x4fdbd2(0x167)+'ype:\x20'+_0x3774e4[_0x4fdbd2(0x195)]+',\x20Key:\x20'+(_0x3774e4[_0x4fdbd2(0x187)]||_0x4fdbd2(0x145)));}}export async function initializeDatabase(){const _0x311b60=_0x68304d;info(_0x311b60(0x1a5)+'nitializat'+'ion\x20proces'+_0x311b60(0x1c0)+'..');try{flushTimer&&(clearInterval(flushTimer),flushTimer=null);const _0x323e6e=getConfig();maxTotalBytes=_0x323e6e['DB_CACHE_M'+_0x311b60(0x179)],cache=new MemoryCache(maxTotalBytes);const _0x276581=_0x323e6e[_0x311b60(0x136)+'OT'],_0x5c8ca6=_0x28bbc3[_0x311b60(0x168)](_0x276581,_0x323e6e[_0x311b60(0x17d)]);_0x4e3232[_0x311b60(0x15d)+'ync'](_0x5c8ca6);const _0x11524a=_0x323e6e['DB_NAME'],_0x155bc1=_0x28bbc3[_0x311b60(0x14d)](_0x5c8ca6,_0x11524a);await backupDB(_0x155bc1),db=await open({'filename':_0x155bc1,'driver':_0x2108b6[_0x311b60(0x16e)]}),await db['exec'](_0x311b60(0x16c)+_0x311b60(0x1bf)+_0x311b60(0x1a2)),await db[_0x311b60(0x173)](_0x311b60(0x156)+_0x311b60(0x1cf)+'\x20NORMAL;'),await db[_0x311b60(0x173)](_0x311b60(0x13a)+_0x311b60(0x13b)+_0x311b60(0x1b2)),await db[_0x311b60(0x173)](_0x311b60(0x150)+_0x311b60(0x159)+_0x311b60(0x164)),await applyMigrations(),await prepareStatements(),dbReady=!![],writeQueue=[],queueBytes=0x13ee+-0x260f+0x165*0xd;const _0x19b4e3=_0x323e6e[_0x311b60(0x11c)+_0x311b60(0x183)];flushTimer=setInterval(()=>flushQueue(),_0x19b4e3),info('Database\x20s'+_0x311b60(0x1a9)+_0x311b60(0x162)+_0x311b60(0x15f)+_0x155bc1+('.\x20System\x20i'+_0x311b60(0x17a)));}catch(_0x1f3b20){error('DB\x20init\x20er'+_0x311b60(0x1c1)+(_0x1f3b20?.[_0x311b60(0x14a)]||_0x1f3b20),_0x1f3b20);throw _0x1f3b20;}}async function prepareStatements(){const _0x4fa337=_0x68304d;setStmt=await db[_0x4fa337(0x175)]('INSERT\x20OR\x20'+'REPLACE\x20IN'+'TO\x20key_val'+'ue_store\x20('+_0x4fa337(0x1b5)+_0x4fa337(0x153)+_0x4fa337(0x14e)),deleteStmt=await db[_0x4fa337(0x175)](_0x4fa337(0x12a)+_0x4fa337(0x17e)+_0x4fa337(0x121)+_0x4fa337(0x18d)+'?'),logStmt=await db[_0x4fa337(0x175)](_0x4fa337(0x143)+_0x4fa337(0x1b3)+_0x4fa337(0x138)+_0x4fa337(0x190)+_0x4fa337(0x170)+_0x4fa337(0x151)+_0x4fa337(0x14e));}async function applyMigrations(){const _0x4444f8=_0x68304d;await db[_0x4444f8(0x173)](_0x4444f8(0x125)+_0x4444f8(0x133)+_0x4444f8(0x12f)+_0x4444f8(0x19d)+_0x4444f8(0x1ae)+_0x4444f8(0x166)+_0x4444f8(0x178)+_0x4444f8(0x194)),await db[_0x4444f8(0x173)](_0x4444f8(0x125)+'LE\x20IF\x20NOT\x20'+'EXISTS\x20log'+_0x4444f8(0x19c)+_0x4444f8(0x1c6)+_0x4444f8(0x1a8)+'ule\x20TEXT,\x20'+_0x4444f8(0x147)+_0x4444f8(0x15a)+_0x4444f8(0x185));}async function flushQueue(){const _0x184b5d=_0x68304d;if(!dbReady||isFlushing||writeQueue[_0x184b5d(0x157)]===-0x16ae+-0x2556+0x3c04)return;const _0x17d662=writeQueue[0xaec+0x9ce+0xe*-0x17b];if(_0x17d662[_0x184b5d(0x15e)]>-0x1b54+-0xa5d+0x25b1&&Date[_0x184b5d(0x131)]()-_0x17d662['timestamp']<0x4b7*0x4+-0x1603+0xedf)return;isFlushing=!![];const _0x2d69e8=writeQueue['splice'](0x21f0+0x1166+-0x2*0x19ab,getConfig()[_0x184b5d(0x1ad)+'IZE']),_0x44c830=_0x2d69e8[_0x184b5d(0x155)]((_0x5c2c7f,_0xf0eb77)=>_0x5c2c7f+(_0xf0eb77[_0x184b5d(0x17c)]||0x1a61*-0x1+-0xe9f+-0x2*-0x1480),-0x10c7+-0x7*-0x18e+0x5e5);try{await db[_0x184b5d(0x173)]('BEGIN\x20TRAN'+_0x184b5d(0x13e));for(const _0x12810e of _0x2d69e8){try{switch(_0x12810e[_0x184b5d(0x195)]){case'set':await setStmt[_0x184b5d(0x13c)](_0x12810e[_0x184b5d(0x187)],_0x12810e['value']);break;case'delete':await deleteStmt[_0x184b5d(0x13c)](_0x12810e[_0x184b5d(0x187)]);break;case'log':await logStmt[_0x184b5d(0x13c)](_0x12810e[_0x184b5d(0x134)]['ts'],_0x12810e[_0x184b5d(0x134)]['module'],_0x12810e[_0x184b5d(0x134)][_0x184b5d(0x1bc)],_0x12810e[_0x184b5d(0x134)]['message']);break;}}catch(_0x2062ec){error(_0x184b5d(0x15b)+_0x184b5d(0x11f)+_0x184b5d(0x122)+'l\x20be\x20handl'+_0x184b5d(0x18a)+'saction\x20ro'+_0x184b5d(0x199)+JSON[_0x184b5d(0x128)](_0x12810e),_0x2062ec);throw _0x2062ec;}}await db[_0x184b5d(0x173)](_0x184b5d(0x1cc)),queueBytes-=_0x44c830;}catch(_0x1d3dc7){error(_0x184b5d(0x169)+_0x184b5d(0x120)+_0x184b5d(0x16b)+_0x184b5d(0x12c)+_0x184b5d(0x16d)+_0x184b5d(0x11d)+_0x184b5d(0x198),_0x1d3dc7);try{await db['exec'](_0x184b5d(0x149));}catch(_0x4cbbbf){error(_0x184b5d(0x192)+_0x184b5d(0x1c4),_0x4cbbbf);}const _0x1ec367=Date[_0x184b5d(0x131)](),_0x5d6b2d=[];for(const _0x3318c7 of _0x2d69e8){_0x3318c7['retries']=(_0x3318c7[_0x184b5d(0x15e)]||0x1684+-0x13*0x1c1+0xacf*0x1)+(0xd35+-0xfe0+-0xab*-0x4),_0x3318c7[_0x184b5d(0x174)]=_0x1ec367,_0x3318c7['retries']<0x12f*-0xa+0xc81+-0xa9?_0x5d6b2d[_0x184b5d(0x184)](_0x3318c7):error(_0x184b5d(0x1d3)+_0x184b5d(0x189)+'scarded\x20af'+'ter\x20multip'+_0x184b5d(0x1bb)+_0x184b5d(0x14c)+JSON[_0x184b5d(0x128)](_0x3318c7));}_0x5d6b2d['length']>-0x1*-0x19c0+-0x1f8e+-0x2*-0x2e7&&writeQueue[_0x184b5d(0x171)](..._0x5d6b2d);}finally{isFlushing=![];}}export async function get(_0x1e591e){const _0x53d76e=_0x68304d;if(cache['has'](_0x1e591e))return cache[_0x53d76e(0x1a3)](_0x1e591e);if(!dbReady)return warn('DB\x20not\x20rea'+_0x53d76e(0x148)+_0x53d76e(0x123)+'.'),undefined;try{const _0x244bf6=await db[_0x53d76e(0x1a3)](_0x53d76e(0x19f)+_0x53d76e(0x181)+'y_value_st'+_0x53d76e(0x12d)+_0x53d76e(0x132),_0x1e591e);if(_0x244bf6?.[_0x53d76e(0x1c9)]){const _0x129dac=JSON['parse'](_0x244bf6[_0x53d76e(0x1c9)]);return cache[_0x53d76e(0x1c7)](_0x1e591e,_0x129dac,_0x244bf6['value']),_0x129dac;}}catch(_0x3091cb){error(_0x53d76e(0x15b)+_0x53d76e(0x186)+_0x1e591e+(_0x53d76e(0x130)+'\x20')+_0x3091cb[_0x53d76e(0x14a)],_0x3091cb);}return undefined;}function _0x3cea(_0x2d66f2,_0x38942c){const _0x27b908=_0x551d();return _0x3cea=function(_0x4f9496,_0x1eeced){_0x4f9496=_0x4f9496-(0xd*0x91+-0x8*-0x242+-0x1*0x1851);let _0x21b2b4=_0x27b908[_0x4f9496];return _0x21b2b4;},_0x3cea(_0x2d66f2,_0x38942c);}export function set(_0x272d9d,_0x345d7c){const _0x406e39=_0x68304d;if(_0x345d7c===undefined){del(_0x272d9d);return;}let _0x1e60f5;try{_0x1e60f5=JSON[_0x406e39(0x128)](_0x345d7c);}catch(_0x51fb92){error(_0x406e39(0x172)+_0x406e39(0x1c8)+_0x272d9d+(_0x406e39(0x1a4)+_0x406e39(0x15c)+_0x406e39(0x158)+'g\x20persist.'),_0x51fb92);return;}cache['set'](_0x272d9d,_0x345d7c,_0x1e60f5);const _0xc21c6b={'type':_0x406e39(0x1c7),'key':_0x272d9d,'value':_0x1e60f5,'retries':0x0,'timestamp':Date[_0x406e39(0x131)]()};_0xc21c6b[_0x406e39(0x17c)]=estimateQueueItemSize(_0xc21c6b),queueBytes+=_0xc21c6b['size'],writeQueue[_0x406e39(0x184)](_0xc21c6b),enforceMemoryLimit(),writeQueue[_0x406e39(0x157)]>=getConfig()[_0x406e39(0x1ad)+'IZE']&&flushQueue();}export function del(_0x454796){const _0x1b247a=_0x68304d;cache[_0x1b247a(0x17b)](_0x454796);const _0x235fef={'type':_0x1b247a(0x17b),'key':_0x454796,'retries':0x0,'timestamp':Date[_0x1b247a(0x131)]()};_0x235fef['size']=estimateQueueItemSize(_0x235fef),queueBytes+=_0x235fef[_0x1b247a(0x17c)],writeQueue['push'](_0x235fef),enforceMemoryLimit(),writeQueue[_0x1b247a(0x157)]>=getConfig()[_0x1b247a(0x1ad)+'IZE']&&flushQueue();}export function logToDB(module,_0x573463,_0x4e9113){const _0x3ff62c=_0x68304d,_0x41d170={'ts':Date[_0x3ff62c(0x131)](),'module':module,'level':_0x573463,'message':String(_0x4e9113)[_0x3ff62c(0x1d1)](-0xf50+-0x10*0x14d+-0x908*-0x4,0x1ecc+-0x2dc*-0x6+-0x2824)},_0x9aa7e0={'type':_0x3ff62c(0x182),'data':_0x41d170,'retries':0x0,'timestamp':Date[_0x3ff62c(0x131)]()};_0x9aa7e0[_0x3ff62c(0x17c)]=estimateQueueItemSize(_0x9aa7e0),queueBytes+=_0x9aa7e0['size'],writeQueue[_0x3ff62c(0x184)](_0x9aa7e0),enforceMemoryLimit();}export async function shutdownDatabase(){const _0x5abedd=_0x68304d;info(_0x5abedd(0x1b9)+_0x5abedd(0x1d0)+_0x5abedd(0x127)+_0x5abedd(0x1b6)+_0x5abedd(0x180)+'e...'),dbReady=![];flushTimer&&(clearInterval(flushTimer),flushTimer=null);await flushQueue(),await flushQueue(),info('Final\x20flus'+_0x5abedd(0x12e)+'d.');if(db)try{if(setStmt)await setStmt[_0x5abedd(0x140)]();if(deleteStmt)await deleteStmt[_0x5abedd(0x140)]();if(logStmt)await logStmt['finalize']();await db[_0x5abedd(0x11e)](),info('Database\x20c'+_0x5abedd(0x161)+_0x5abedd(0x18f)+_0x5abedd(0x1d2)),db=null;}catch(_0x140ebf){error(_0x5abedd(0x1af)+_0x5abedd(0x1b0)+_0x5abedd(0x1ba)+_0x5abedd(0x146),_0x140ebf);}info(_0x5abedd(0x1b9)+_0x5abedd(0x1d0)+_0x5abedd(0x1ce)+_0x5abedd(0x193)+_0x5abedd(0x13d));}async function backupDB(_0x52e0e8){const _0x302001=_0x68304d;try{if(!await _0x4e3232[_0x302001(0x1a1)](_0x52e0e8))return;const _0x5c621a=_0x28bbc3[_0x302001(0x1a0)](_0x52e0e8),_0x1eef8d=_0x28bbc3['basename'](_0x52e0e8,_0x28bbc3[_0x302001(0x142)](_0x52e0e8)),_0x4c493a=_0x28bbc3[_0x302001(0x14d)](_0x5c621a,_0x1eef8d+_0x302001(0x16a)),_0x423f75=await _0x4e3232[_0x302001(0x1a1)](_0x4c493a)?await _0x4e3232[_0x302001(0x19b)](_0x4c493a):null,_0x28e6c4=_0x423f75?Date['now']()-_0x423f75[_0x302001(0x191)]:Infinity;_0x28e6c4>(0x180c+0x2*-0xd3b+0x282)*(0x1dd+-0x1906+0x71*0x35)*(-0x511*0x3+-0x796+0x1*0x1705)*(0x1995+0x900+-0x1ead)&&(await _0x4e3232[_0x302001(0x1c2)](_0x52e0e8,_0x4c493a,{'overwrite':!![]}),info(_0x302001(0x1b7)+'ackup\x20crea'+'ted\x20at\x20'+_0x4c493a));}catch(_0x610fe6){error(_0x302001(0x1b7)+_0x302001(0x141)+'ed:\x20'+_0x610fe6[_0x302001(0x14a)],_0x610fe6);}}process['once'](_0x68304d(0x1cd),()=>{const _0x57896e=_0x68304d;shutdownDatabase()[_0x57896e(0x196)](()=>process[_0x57896e(0x14f)](0x2317+0x3*-0x985+-0x2c*0x26));}),process[_0x68304d(0x1cb)](_0x68304d(0x1bd),()=>{const _0x4e5cf2=_0x68304d;shutdownDatabase()[_0x4e5cf2(0x196)](()=>process['exit'](0xef7+-0x1939+0xa42));});export{db};