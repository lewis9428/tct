const _0x5d8a7c=_0x1bcd;(function(_0x228359,_0x5ba86e){const _0x50fd0f=_0x1bcd,_0x38f8ae=_0x228359();while(!![]){try{const _0xb3d11a=-parseInt(_0x50fd0f(0x17d))/(0x7cf+-0x1625+0xe57)+parseInt(_0x50fd0f(0x160))/(-0x1f7e+0x1954+0x62c)+-parseInt(_0x50fd0f(0x15f))/(-0x2b*0xc7+0x2*0x115+0x1*0x1f46)+-parseInt(_0x50fd0f(0x141))/(0x15*0x1ca+0x13*-0x185+0x8af*-0x1)*(parseInt(_0x50fd0f(0x16f))/(0x152d+0x655*-0x1+-0x2f7*0x5))+-parseInt(_0x50fd0f(0x194))/(0x1ce+0x1*0x365+-0x1*0x52d)*(parseInt(_0x50fd0f(0xeb))/(0xa4+0x1ac8+0x1b65*-0x1))+-parseInt(_0x50fd0f(0x137))/(0x1*0x1ad7+-0x23f2+-0x1*-0x923)*(parseInt(_0x50fd0f(0x150))/(-0x1a6+0x40*0x39+0xc91*-0x1))+parseInt(_0x50fd0f(0x116))/(-0x1*-0x1467+-0x13e*0xc+-0x1*0x575);if(_0xb3d11a===_0x5ba86e)break;else _0x38f8ae['push'](_0x38f8ae['shift']());}catch(_0x174a22){_0x38f8ae['push'](_0x38f8ae['shift']());}}}(_0x44c8,-0x4c703*-0x5+-0x6b297+-0x3c0cf));import _0x288323 from'sqlite3';function _0x44c8(){const _0x143056=['values','Database\x20c','N/A','size','level\x20TEXT','GER\x20PRIMAR','get','\x20bytes\x20>\x20m','ror:\x20','e\x20memory\x20p','now','CREATE\x20TAB','DB\x20not\x20rea','TO\x20key_val','44141200DVlhoy','_moveToTai','tem\x20\x22','key','\x20item,\x20wil','log','resolve','SIGINT','ted\x20at\x20','ng\x20for\x20ret','Database\x20i','sage)\x20VALU','timestamp','hin\x20memory','utf8','SELECT\x20val','y_timeout\x20','olling\x20bac','ed:\x20','retries','unshift','INSERT\x20OR\x20','ync',')\x20VALUES\x20(','ackup\x20fail','Value\x20for\x20','_removeNod','s\x20(ts\x20INTE','tail','pathExists','key,\x20value','rnal_mode\x20','type','4288gMwnoB','ackup\x20crea','Y\x20KEY,\x20mod','\x22\x20is\x20not\x20s','DB_BATCH_S','run','ose:','O\x20logs\x20(ts','ore\x20WHERE\x20','push','8FEpyqt','delete','TEXT);','y_value_st','estimateSi','module','g\x20persist.','set','ocess\x20comp','_addToTail','DB_FLUSH_I','key\x20\x22','e\x20TEXT);','NTERVAL','stat','10026oDcZQb','scarded\x20af','key\x20=\x20?','Rollback\x20f','ule\x20TEXT,\x20','\x20failed,\x20r','serialized','ype:\x20','slice','nitializat','Database','extname','Write\x20queu','\x22\x20from\x20DB:','LE\x20IF\x20NOT\x20','4284447eJlPRr','2615734WqHWwd','bytes','exit','basename','copy','Final\x20flus','data','s\x20started.','splice','length','dy\x20for\x20get','PRAGMA\x20for','DB\x20flush\x20t','byteLength','PRAGMA\x20syn','3692095SWyDFJ','hutdown\x20pr','erializabl','message','atabase\x20cl','\x20KEY,\x20valu','DELETE\x20FRO','e...','.bak','has','s.\x20Item:\x20','k.\x20Prepari','PROJECT_RO','Database\x20s','256531YLFWTE','head','ion\x20proces','uccessfull','once','shift','.\x20System\x20i','prev','llback:\x20','PRAGMA\x20jou','essfully.','value','ocess\x20init','map','maxBytes','DB\x20init\x20er','ry.','next','level,\x20mes','=\x2010000;','Skipping\x20c','XT\x20PRIMARY','ransaction','6QVaLdE','?,\x20?)','est\x20item\x20t','join','7579684YcTZpj','h\x20complete','finally','get\x20key\x20\x22','leted\x20succ','IZE','COMMIT;','exec','\x20operation','INSERT\x20INT',',\x20message\x20','finalize','EXISTS\x20key','SIGTERM','ue_store\x20(','anly.','mtimeMs','re\x20(key\x20TE','ache\x20for\x20o','ropped\x20old','_value_sto','saction\x20ro','CRITICAL:\x20','ed\x20by\x20tran','shing\x20queu','dirname','stringify','\x22\x20(','REPLACE\x20IN'];_0x44c8=function(){return _0x143056;};return _0x44c8();}import{open}from'sqlite';import _0x445689 from'fs-extra';import _0x3485b3 from'path';import{getConfig}from'./config.js';import{info,error,warn}from'./logger.js';let db,setStmt,deleteStmt,logStmt,dbReady=![],writeQueue=[],queueBytes=-0x52a+-0xa5f+0xf89*0x1,maxTotalBytes=-0x1a19+-0xa15+0x1*0x242e,isFlushing=![],flushTimer,cache;function estimateQueueItemSize(_0x424007){const _0x29e04a=_0x1bcd,_0xc0554=0xe2d+0x1cb3+0x2a90*-0x1;switch(_0x424007[_0x29e04a(0x136)]){case _0x29e04a(0x148):return Buffer[_0x29e04a(0x16d)](_0x424007[_0x29e04a(0x119)],_0x29e04a(0x124))+Buffer['byteLength'](_0x424007[_0x29e04a(0x188)],_0x29e04a(0x124))+_0xc0554;case'delete':return Buffer['byteLength'](_0x424007['key'],'utf8')+_0xc0554;case _0x29e04a(0x11b):return Object[_0x29e04a(0x108)](_0x424007[_0x29e04a(0x166)])['reduce']((_0x570cbe,_0x1983f0)=>_0x570cbe+Buffer['byteLength'](String(_0x1983f0),_0x29e04a(0x124)),0xf08+-0x8fd+0x1*-0x60b)+_0xc0554;default:return 0xed*-0xb+0x17*-0x25+0xe02;}}function _0x1bcd(_0x24fe66,_0x2ca173){const _0x3b1a37=_0x44c8();return _0x1bcd=function(_0x296279,_0x230772){_0x296279=_0x296279-(-0x1b*-0x48+0x162+-0x8*0x102);let _0x749213=_0x3b1a37[_0x296279];return _0x749213;},_0x1bcd(_0x24fe66,_0x2ca173);}class MemoryCache{constructor(_0x3f4200){const _0x17e1ef=_0x1bcd;this[_0x17e1ef(0x18b)]=_0x3f4200,this[_0x17e1ef(0x161)]=0x2709+0x16f*0x16+-0x4693,this[_0x17e1ef(0x18a)]=new Map(),this[_0x17e1ef(0x17e)]={'prev':null,'next':null},this[_0x17e1ef(0x132)]={'prev':null,'next':null},this[_0x17e1ef(0x17e)][_0x17e1ef(0x18e)]=this['tail'],this['tail'][_0x17e1ef(0x184)]=this['head'];}static[_0x5d8a7c(0x145)+'ze'](_0xd4585b,_0x230a0b){const _0x1a8152=_0x5d8a7c,_0x5a6d35=Buffer['byteLength'](String(_0xd4585b),_0x1a8152(0x124)),_0x1716d6=Buffer[_0x1a8152(0x16d)](_0x230a0b??'','utf8');return _0x5a6d35+_0x1716d6+(-0xe99+-0xa5d+-0x39a*-0x7);}[_0x5d8a7c(0x130)+'e'](_0x53201d){const _0x1fc4b4=_0x5d8a7c;_0x53201d[_0x1fc4b4(0x184)][_0x1fc4b4(0x18e)]=_0x53201d[_0x1fc4b4(0x18e)],_0x53201d[_0x1fc4b4(0x18e)]['prev']=_0x53201d[_0x1fc4b4(0x184)];}[_0x5d8a7c(0x14a)](_0xdff2f6){const _0x5e8fa8=_0x5d8a7c;_0xdff2f6[_0x5e8fa8(0x184)]=this[_0x5e8fa8(0x132)]['prev'],_0xdff2f6[_0x5e8fa8(0x18e)]=this[_0x5e8fa8(0x132)],this[_0x5e8fa8(0x132)]['prev'][_0x5e8fa8(0x18e)]=_0xdff2f6,this[_0x5e8fa8(0x132)][_0x5e8fa8(0x184)]=_0xdff2f6;}[_0x5d8a7c(0x117)+'l'](_0x222486){this['_removeNod'+'e'](_0x222486),this['_addToTail'](_0x222486);}[_0x5d8a7c(0x178)](_0x26f630){const _0x4b3fb2=_0x5d8a7c;return this['map'][_0x4b3fb2(0x178)](_0x26f630);}[_0x5d8a7c(0x10e)](_0x27a13b){const _0x548c27=_0x5d8a7c,_0x3a4f65=this[_0x548c27(0x18a)][_0x548c27(0x10e)](_0x27a13b);if(!_0x3a4f65)return undefined;return this[_0x548c27(0x117)+'l'](_0x3a4f65),_0x3a4f65[_0x548c27(0x188)];}[_0x5d8a7c(0x148)](_0x4741c9,_0x2833ce,_0x1c637b){const _0x1f0d10=_0x5d8a7c,_0x1ea792=this[_0x1f0d10(0x18a)]['get'](_0x4741c9),_0x185996=MemoryCache[_0x1f0d10(0x145)+'ze'](_0x4741c9,_0x1c637b);if(_0x185996>this[_0x1f0d10(0x18b)]){warn(_0x1f0d10(0x191)+_0x1f0d10(0xfd)+'versized\x20i'+_0x1f0d10(0x118)+_0x4741c9+_0x1f0d10(0x106)+_0x185996+(_0x1f0d10(0x10f)+'ax\x20')+this[_0x1f0d10(0x18b)]+')');if(_0x1ea792)this[_0x1f0d10(0x142)](_0x4741c9);return;}if(_0x1ea792)this[_0x1f0d10(0x161)]-=_0x1ea792['size'],_0x1ea792['value']=_0x2833ce,_0x1ea792[_0x1f0d10(0x156)]=_0x1c637b,_0x1ea792[_0x1f0d10(0x10b)]=_0x185996,this['bytes']+=_0x185996,this[_0x1f0d10(0x117)+'l'](_0x1ea792);else{const _0x509bb4={'key':_0x4741c9,'value':_0x2833ce,'serialized':_0x1c637b,'size':_0x185996,'prev':null,'next':null};this['map'][_0x1f0d10(0x148)](_0x4741c9,_0x509bb4),this['_addToTail'](_0x509bb4),this['bytes']+=_0x185996;}while(this[_0x1f0d10(0x161)]>this['maxBytes']){const _0x1d185e=this[_0x1f0d10(0x17e)][_0x1f0d10(0x18e)];if(_0x1d185e===this['tail'])break;this[_0x1f0d10(0x142)](_0x1d185e[_0x1f0d10(0x119)]);}}[_0x5d8a7c(0x142)](_0x460fcd){const _0x1fac91=_0x5d8a7c,_0x2a2d02=this[_0x1fac91(0x18a)][_0x1fac91(0x10e)](_0x460fcd);if(!_0x2a2d02)return;this['_removeNod'+'e'](_0x2a2d02),this[_0x1fac91(0x18a)]['delete'](_0x460fcd),this[_0x1fac91(0x161)]-=_0x2a2d02[_0x1fac91(0x10b)];}}function enforceMemoryLimit(){const _0x310e00=_0x5d8a7c;while(cache['bytes']+queueBytes>maxTotalBytes&&writeQueue['length']>-0x890*-0x1+-0x17d+-0x713){const _0x15f216=writeQueue[_0x310e00(0x182)]();_0x15f216[_0x310e00(0x10b)]&&(queueBytes-=_0x15f216[_0x310e00(0x10b)]),warn(_0x310e00(0x15c)+_0x310e00(0x111)+'ressure:\x20D'+_0x310e00(0xfe)+_0x310e00(0x196)+'o\x20stay\x20wit'+_0x310e00(0x123)+'\x20limits.\x20T'+_0x310e00(0x157)+_0x15f216[_0x310e00(0x136)]+',\x20Key:\x20'+(_0x15f216['key']||_0x310e00(0x10a)));}}export async function initializeDatabase(){const _0x1c089f=_0x5d8a7c;info(_0x1c089f(0x120)+_0x1c089f(0x159)+_0x1c089f(0x17f)+_0x1c089f(0x167)+'..');try{flushTimer&&(clearInterval(flushTimer),flushTimer=null);const _0x34e468=getConfig();maxTotalBytes=_0x34e468['DB_CACHE_M'+'AX_BYTES'],cache=new MemoryCache(maxTotalBytes);const _0x46589c=_0x34e468[_0x1c089f(0x17b)+'OT'],_0xaabeb4=_0x3485b3[_0x1c089f(0x11c)](_0x46589c,_0x34e468['DB_PATH']);_0x445689['ensureDirS'+_0x1c089f(0x12c)](_0xaabeb4);const _0x8ff286=_0x34e468['DB_NAME'],_0x30c3e0=_0x3485b3[_0x1c089f(0xea)](_0xaabeb4,_0x8ff286);await backupDB(_0x30c3e0),db=await open({'filename':_0x30c3e0,'driver':_0x288323[_0x1c089f(0x15a)]}),await db['exec'](_0x1c089f(0x186)+_0x1c089f(0x135)+'=\x20WAL;'),await db['exec'](_0x1c089f(0x16e)+'chronous\x20='+'\x20NORMAL;'),await db[_0x1c089f(0xf2)]('PRAGMA\x20bus'+_0x1c089f(0x126)+_0x1c089f(0x190)),await db['exec'](_0x1c089f(0x16b)+'eign_keys\x20'+'=\x20ON;'),await applyMigrations(),await prepareStatements(),dbReady=!![],writeQueue=[],queueBytes=-0x231c+0xdaf+0x449*0x5;const _0x1b34cd=_0x34e468[_0x1c089f(0x14b)+_0x1c089f(0x14e)];flushTimer=setInterval(()=>flushQueue(),_0x1b34cd),info(_0x1c089f(0x17c)+_0x1c089f(0x180)+'y\x20initiali'+'zed\x20at\x20'+_0x30c3e0+(_0x1c089f(0x183)+'s\x20ready.'));}catch(_0x5daf0b){error(_0x1c089f(0x18c)+_0x1c089f(0x110)+(_0x5daf0b?.[_0x1c089f(0x172)]||_0x5daf0b),_0x5daf0b);throw _0x5daf0b;}}async function prepareStatements(){const _0x3a5f6c=_0x5d8a7c;setStmt=await db['prepare'](_0x3a5f6c(0x12b)+_0x3a5f6c(0x107)+_0x3a5f6c(0x115)+_0x3a5f6c(0xf9)+_0x3a5f6c(0x134)+_0x3a5f6c(0x12d)+_0x3a5f6c(0x195)),deleteStmt=await db['prepare'](_0x3a5f6c(0x175)+'M\x20key_valu'+'e_store\x20WH'+'ERE\x20key\x20=\x20'+'?'),logStmt=await db['prepare'](_0x3a5f6c(0xf4)+_0x3a5f6c(0x13e)+',\x20module,\x20'+_0x3a5f6c(0x18f)+_0x3a5f6c(0x121)+'ES\x20(?,\x20?,\x20'+_0x3a5f6c(0x195));}async function applyMigrations(){const _0x2e3d9a=_0x5d8a7c;await db[_0x2e3d9a(0xf2)]('CREATE\x20TAB'+_0x2e3d9a(0x15e)+_0x2e3d9a(0xf7)+_0x2e3d9a(0xff)+_0x2e3d9a(0xfc)+_0x2e3d9a(0x192)+_0x2e3d9a(0x174)+_0x2e3d9a(0x14d)),await db[_0x2e3d9a(0xf2)](_0x2e3d9a(0x113)+'LE\x20IF\x20NOT\x20'+'EXISTS\x20log'+_0x2e3d9a(0x131)+_0x2e3d9a(0x10d)+_0x2e3d9a(0x139)+_0x2e3d9a(0x154)+_0x2e3d9a(0x10c)+_0x2e3d9a(0xf5)+_0x2e3d9a(0x143));}async function flushQueue(){const _0x1d531b=_0x5d8a7c;if(!dbReady||isFlushing||writeQueue[_0x1d531b(0x169)]===-0x2467+0x1c2d+0x27*0x36)return;const _0x27e778=writeQueue[-0x1*0x2611+0x5e3*0x3+0x1468];if(_0x27e778[_0x1d531b(0x129)]>-0xe99*-0x1+-0x9ee+-0x1*0x4ab&&Date['now']()-_0x27e778['timestamp']<0x1ff2+0x1*0xf2e+-0x2368)return;isFlushing=!![];const _0x1b56a8=writeQueue[_0x1d531b(0x168)](-0xeb9*-0x1+0x37*-0xb3+0x17bc,getConfig()[_0x1d531b(0x13b)+_0x1d531b(0xf0)]),_0x27853d=_0x1b56a8['reduce']((_0x396195,_0x28ee39)=>_0x396195+(_0x28ee39[_0x1d531b(0x10b)]||-0x596+-0x2646+0xe*0x322),0x152b*-0x1+0x2049+0x58f*-0x2);try{await db[_0x1d531b(0xf2)]('BEGIN\x20TRAN'+'SACTION;');for(const _0x1c6dba of _0x1b56a8){try{switch(_0x1c6dba[_0x1d531b(0x136)]){case _0x1d531b(0x148):await setStmt[_0x1d531b(0x13c)](_0x1c6dba[_0x1d531b(0x119)],_0x1c6dba[_0x1d531b(0x188)]);break;case _0x1d531b(0x142):await deleteStmt['run'](_0x1c6dba['key']);break;case _0x1d531b(0x11b):await logStmt['run'](_0x1c6dba['data']['ts'],_0x1c6dba['data'][_0x1d531b(0x146)],_0x1c6dba['data']['level'],_0x1c6dba[_0x1d531b(0x166)][_0x1d531b(0x172)]);break;}}catch(_0x3851f3){error('Failed\x20to\x20'+'process\x20DB'+_0x1d531b(0x11a)+'l\x20be\x20handl'+_0x1d531b(0x102)+_0x1d531b(0x100)+_0x1d531b(0x185)+JSON[_0x1d531b(0x105)](_0x1c6dba),_0x3851f3);throw _0x3851f3;}}await db[_0x1d531b(0xf2)](_0x1d531b(0xf1)),queueBytes-=_0x27853d;}catch(_0x1339e1){error(_0x1d531b(0x16c)+_0x1d531b(0x193)+_0x1d531b(0x155)+_0x1d531b(0x127)+_0x1d531b(0x17a)+_0x1d531b(0x11f)+_0x1d531b(0x18d),_0x1339e1);try{await db['exec']('ROLLBACK;');}catch(_0x187493){error(_0x1d531b(0x153)+'ailed:',_0x187493);}const _0x11b56b=Date['now'](),_0x19495c=[];for(const _0x1087ab of _0x1b56a8){_0x1087ab['retries']=(_0x1087ab[_0x1d531b(0x129)]||-0x1*-0x2275+-0x1c09*-0x1+0x13*-0x34a)+(-0x92*0x3+-0x7b5*0x2+0x5*0x36d),_0x1087ab[_0x1d531b(0x122)]=_0x11b56b,_0x1087ab[_0x1d531b(0x129)]<-0x2*-0x1039+0xd09+0x7*-0x67f?_0x19495c[_0x1d531b(0x140)](_0x1087ab):error(_0x1d531b(0x101)+'DB\x20item\x20di'+_0x1d531b(0x151)+'ter\x20multip'+'le\x20failure'+_0x1d531b(0x179)+JSON[_0x1d531b(0x105)](_0x1087ab));}_0x19495c[_0x1d531b(0x169)]>-0x29b*-0xb+0x1b1*0x11+-0x1*0x396a&&writeQueue[_0x1d531b(0x12a)](..._0x19495c);}finally{isFlushing=![];}}export async function get(_0x3e9c79){const _0x550b1b=_0x5d8a7c;if(cache[_0x550b1b(0x178)](_0x3e9c79))return cache[_0x550b1b(0x10e)](_0x3e9c79);if(!dbReady)return warn(_0x550b1b(0x114)+_0x550b1b(0x16a)+_0x550b1b(0xf3)+'.'),undefined;try{const _0x4d4baf=await db[_0x550b1b(0x10e)](_0x550b1b(0x125)+'ue\x20FROM\x20ke'+_0x550b1b(0x144)+_0x550b1b(0x13f)+_0x550b1b(0x152),_0x3e9c79);if(_0x4d4baf?.[_0x550b1b(0x188)]){const _0x16ef0b=JSON['parse'](_0x4d4baf[_0x550b1b(0x188)]);return cache[_0x550b1b(0x148)](_0x3e9c79,_0x16ef0b,_0x4d4baf[_0x550b1b(0x188)]),_0x16ef0b;}}catch(_0x2aa2d9){error('Failed\x20to\x20'+_0x550b1b(0xee)+_0x3e9c79+(_0x550b1b(0x15d)+'\x20')+_0x2aa2d9[_0x550b1b(0x172)],_0x2aa2d9);}return undefined;}export function set(_0x53c6d3,_0x51ac4a){const _0x2bcd05=_0x5d8a7c;if(_0x51ac4a===undefined){del(_0x53c6d3);return;}let _0x53f7cf;try{_0x53f7cf=JSON[_0x2bcd05(0x105)](_0x51ac4a);}catch(_0xfa92f1){error(_0x2bcd05(0x12f)+_0x2bcd05(0x14c)+_0x53c6d3+(_0x2bcd05(0x13a)+_0x2bcd05(0x171)+'e;\x20skippin'+_0x2bcd05(0x147)),_0xfa92f1);return;}cache[_0x2bcd05(0x148)](_0x53c6d3,_0x51ac4a,_0x53f7cf);const _0x18b12e={'type':_0x2bcd05(0x148),'key':_0x53c6d3,'value':_0x53f7cf,'retries':0x0,'timestamp':Date[_0x2bcd05(0x112)]()};_0x18b12e['size']=estimateQueueItemSize(_0x18b12e),queueBytes+=_0x18b12e[_0x2bcd05(0x10b)],writeQueue['push'](_0x18b12e),enforceMemoryLimit(),writeQueue[_0x2bcd05(0x169)]>=getConfig()['DB_BATCH_S'+_0x2bcd05(0xf0)]&&flushQueue();}export function del(_0x262663){const _0x42e918=_0x5d8a7c;cache[_0x42e918(0x142)](_0x262663);const _0x4f1527={'type':_0x42e918(0x142),'key':_0x262663,'retries':0x0,'timestamp':Date[_0x42e918(0x112)]()};_0x4f1527['size']=estimateQueueItemSize(_0x4f1527),queueBytes+=_0x4f1527[_0x42e918(0x10b)],writeQueue[_0x42e918(0x140)](_0x4f1527),enforceMemoryLimit(),writeQueue[_0x42e918(0x169)]>=getConfig()[_0x42e918(0x13b)+'IZE']&&flushQueue();}export function logToDB(module,_0x18edc2,_0xd63bf8){const _0x4863b1=_0x5d8a7c,_0x481af9={'ts':Date[_0x4863b1(0x112)](),'module':module,'level':_0x18edc2,'message':String(_0xd63bf8)[_0x4863b1(0x158)](-0x476+0x4*0xd3+0x12a,-0x63d*0x5+0x1b43+-0x1*-0xbbe)},_0x4186f1={'type':_0x4863b1(0x11b),'data':_0x481af9,'retries':0x0,'timestamp':Date[_0x4863b1(0x112)]()};_0x4186f1['size']=estimateQueueItemSize(_0x4186f1),queueBytes+=_0x4186f1[_0x4863b1(0x10b)],writeQueue['push'](_0x4186f1),enforceMemoryLimit();}export async function shutdownDatabase(){const _0x1a9020=_0x5d8a7c;info(_0x1a9020(0x17c)+_0x1a9020(0x170)+_0x1a9020(0x189)+'iated.\x20Flu'+_0x1a9020(0x103)+_0x1a9020(0x176)),dbReady=![];flushTimer&&(clearInterval(flushTimer),flushTimer=null);await flushQueue(),await flushQueue(),info(_0x1a9020(0x165)+_0x1a9020(0xec)+'d.');if(db)try{if(setStmt)await setStmt[_0x1a9020(0xf6)]();if(deleteStmt)await deleteStmt[_0x1a9020(0xf6)]();if(logStmt)await logStmt['finalize']();await db['close'](),info(_0x1a9020(0x109)+'onnection\x20'+'closed\x20cle'+_0x1a9020(0xfa)),db=null;}catch(_0x3a2c4f){error('Error\x20duri'+'ng\x20final\x20d'+_0x1a9020(0x173)+_0x1a9020(0x13d),_0x3a2c4f);}info(_0x1a9020(0x17c)+_0x1a9020(0x170)+_0x1a9020(0x149)+_0x1a9020(0xef)+_0x1a9020(0x187));}async function backupDB(_0x1f427f){const _0x127174=_0x5d8a7c;try{if(!await _0x445689[_0x127174(0x133)](_0x1f427f))return;const _0x1a3e9b=_0x3485b3[_0x127174(0x104)](_0x1f427f),_0x191a5b=_0x3485b3[_0x127174(0x163)](_0x1f427f,_0x3485b3[_0x127174(0x15b)](_0x1f427f)),_0x4d1669=_0x3485b3[_0x127174(0xea)](_0x1a3e9b,_0x191a5b+_0x127174(0x177)),_0x22b8ee=await _0x445689[_0x127174(0x133)](_0x4d1669)?await _0x445689[_0x127174(0x14f)](_0x4d1669):null,_0x1ca1ee=_0x22b8ee?Date['now']()-_0x22b8ee[_0x127174(0xfb)]:Infinity;_0x1ca1ee>(0x2e3*-0x7+-0x5e4+0x1a31)*(-0x4*-0x392+0x4*-0x74a+0x2*0x78e)*(-0x13fc+-0xb*-0x371+0xf*-0x12d)*(-0x77+-0x2616+0x2a75*0x1)&&(await _0x445689[_0x127174(0x164)](_0x1f427f,_0x4d1669,{'overwrite':!![]}),info('Database\x20b'+_0x127174(0x138)+_0x127174(0x11e)+_0x4d1669));}catch(_0x3503f8){error('Database\x20b'+_0x127174(0x12e)+_0x127174(0x128)+_0x3503f8[_0x127174(0x172)],_0x3503f8);}}process[_0x5d8a7c(0x181)](_0x5d8a7c(0x11d),()=>{const _0x496915=_0x5d8a7c;shutdownDatabase()[_0x496915(0xed)](()=>process['exit'](0x23b5+0x1d60+0x4115*-0x1));}),process[_0x5d8a7c(0x181)](_0x5d8a7c(0xf8),()=>{const _0x218a1f=_0x5d8a7c;shutdownDatabase()['finally'](()=>process[_0x218a1f(0x162)](-0x4ab*-0x7+0x1718+-0x1297*0x3));});export{db};