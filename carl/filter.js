const _0x368b49=_0x19a6;(function(_0x2e1f70,_0x10d151){const _0x30f08a=_0x19a6,_0x4150dd=_0x2e1f70();while(!![]){try{const _0x42f8d8=-parseInt(_0x30f08a(0x1e5))/(-0x202*-0xd+0x1a49+-0x3462)*(-parseInt(_0x30f08a(0x2a5))/(0x1*-0x1bdc+0x188f+0x34f))+-parseInt(_0x30f08a(0x243))/(-0x5d4+0xa3*0xc+0x1*-0x1cd)*(parseInt(_0x30f08a(0x1a3))/(0x1*-0x1b9d+0xea3+0xcfe*0x1))+parseInt(_0x30f08a(0x26b))/(-0x14f4+-0x1eb7+-0x33b*-0x10)*(-parseInt(_0x30f08a(0x2b8))/(0xd02+0x16f*-0x5+0x1*-0x5d1))+parseInt(_0x30f08a(0x352))/(0x54*0x49+0x1*0x53b+-0x1d28)*(-parseInt(_0x30f08a(0x217))/(-0x162*-0xa+0x1a*0xbf+-0x2132))+-parseInt(_0x30f08a(0x1db))/(0x1738+0x8*0x1d5+-0x25d7)+parseInt(_0x30f08a(0x1c3))/(-0xca6+-0x25a7+0x3257)+parseInt(_0x30f08a(0x1b0))/(-0x19ad+0x801*-0x1+0x21b9)*(parseInt(_0x30f08a(0x1a8))/(-0x1de0+0x2de*-0x1+-0x1*-0x20ca));if(_0x42f8d8===_0x10d151)break;else _0x4150dd['push'](_0x4150dd['shift']());}catch(_0x5bd424){_0x4150dd['push'](_0x4150dd['shift']());}}}(_0xb515,-0x64d23+0x149672+-0x22b5e));import{getConfig}from'../utils/config.js';import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{getDefault,getConnection}from'../utils/connection.js';import{isadmin}from'../utils/isadmin.js';import*as _0x36980f from'../utils/groups.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';export const name=_0x368b49(0x249);export const version=_0x368b49(0x1f0);export const priority=-0x8f*0x1d+0x1a73*0x1+-0x9c8;export const configKeys=['FILTERS'];export const commands=[_0x368b49(0x249),'glistfilte'+'r','gdelfilter',_0x368b49(0x2b3)+'s','gdelf'];function clampTypingMs(_0x54a133){const _0x22ac29=_0x368b49,_0x5c38a9=Number(_0x54a133);if(!Number[_0x22ac29(0x26a)](_0x5c38a9)||isNaN(_0x5c38a9))return 0x18f5+0xb41+-0x2436;if(_0x5c38a9<=0xc7c+-0x7aa*-0x1+-0x1426)return-0xc22+0x1a74+-0xe52;if(_0x5c38a9>-0x1e18+-0x5b37*0x1+0xb3e7)return 0x17*0x20b+0x1a2e*-0x1+0x25c9;return Math[_0x22ac29(0x2b7)](_0x5c38a9);}function sleep(_0x260e41){return new Promise(_0x3544be=>setTimeout(_0x3544be,_0x260e41));}async function simulateTypingAndWait(_0x28d2a8,_0x4d6392,_0x52d162){const _0x492ee2=_0x368b49;if(!_0x52d162||_0x52d162<=-0x204d*0x1+-0x1948+0x3995*0x1)return;try{if(_0x28d2a8&&typeof _0x28d2a8['sendPresen'+_0x492ee2(0x1f2)]==='function')try{await _0x28d2a8['sendPresen'+_0x492ee2(0x1f2)](_0x492ee2(0x20c),_0x4d6392);}catch(_0x5a417c){}}catch(_0x363c70){}try{await sleep(_0x52d162);}catch(_0x390d3c){}try{if(_0x28d2a8&&typeof _0x28d2a8[_0x492ee2(0x2c5)+_0x492ee2(0x1f2)]===_0x492ee2(0x34d))try{await _0x28d2a8[_0x492ee2(0x2c5)+'ceUpdate']('paused',_0x4d6392);}catch(_0x4199c6){}}catch(_0x1c473c){}}function ensureArray(_0x5487bb){const _0x677b48=_0x368b49;if(!_0x5487bb)return[];if(Array[_0x677b48(0x1a4)](_0x5487bb))return _0x5487bb;return[String(_0x5487bb)];}function uniqArray(_0x1a484f){const _0x49d7e3=_0x368b49,_0x4c4aee=new Set(),_0x457f20=[];for(const _0x466c20 of _0x1a484f){const _0xbbc3c3=String(_0x466c20||'')[_0x49d7e3(0x34e)]();if(!_0xbbc3c3)continue;!_0x4c4aee[_0x49d7e3(0x272)](_0xbbc3c3)&&(_0x4c4aee['add'](_0xbbc3c3),_0x457f20[_0x49d7e3(0x306)](_0xbbc3c3));}return _0x457f20;}function escapeRegex(_0x4cde8a){const _0x9bef2f=_0x368b49;return _0x4cde8a[_0x9bef2f(0x1d1)](/[.*+?^${}()|[\]\\]/g,_0x9bef2f(0x259));}function wildcardToRegexPattern(_0x348b5b){const _0x540020=_0x368b49,_0x5f15ef=_0x348b5b[_0x540020(0x2b2)]('*')[_0x540020(0x1eb)](_0x4e3b06=>escapeRegex(_0x4e3b06));return'\x5cb'+_0x5f15ef['join'](_0x540020(0x1c1))+'\x5cb';}function clampConfigTypingMs(){const _0x122a4a=_0x368b49;try{const _0x426186=getConfig()||{},_0x250624=_0x426186['FILTERS']&&typeof _0x426186[_0x122a4a(0x202)]===_0x122a4a(0x24b)?_0x426186[_0x122a4a(0x202)]:{};return clampTypingMs(_0x250624['TYPING_SIM'+'_MS']);}catch(_0x32375a){return-0x3*-0x22a+-0x1872+0x2*0x8fa;}}let botRef=null,sendApi=null;async function sendText(_0x886f4,_0x433455,_0x123ed0,_0x11a170){const _0x59f1fe=_0x368b49;let _0x4240d1=null,_0x1eaf96=null,_0xdd9463=null,_0x773dd7=[];_0x886f4&&typeof _0x886f4===_0x59f1fe(0x24b)&&_0x886f4[_0x59f1fe(0x268)]&&_0x886f4[_0x59f1fe(0x2e3)]?(_0x4240d1=_0x886f4,_0x1eaf96=_0x433455,_0xdd9463=_0x123ed0,_0x773dd7=Array[_0x59f1fe(0x1a4)](_0x11a170)?_0x11a170:[]):(_0x1eaf96=_0x886f4,_0xdd9463=_0x433455,_0x773dd7=Array[_0x59f1fe(0x1a4)](_0x123ed0)?_0x123ed0:[]);if(!_0xdd9463)return;if(!_0x1eaf96){warn(_0x59f1fe(0x2e2)+_0x59f1fe(0x2d4)+'alled\x20with'+'out\x20target'+'Jid');return;}const _0x6970f2={'text':String(_0xdd9463)};if(Array['isArray'](_0x773dd7)&&_0x773dd7['length'])_0x6970f2[_0x59f1fe(0x327)]=_0x773dd7;try{if(!sendApi){warn(_0x59f1fe(0x2e2)+_0x59f1fe(0x1d2)+_0x59f1fe(0x21f));return;}const _0x231352=clampConfigTypingMs();if(_0x231352>-0x4*0x313+0x202f+-0x13e3)try{await simulateTypingAndWait(botRef?.[_0x59f1fe(0x1cf)],_0x1eaf96,_0x231352);}catch(_0x4bca49){warn('[gfilter]\x20'+_0x59f1fe(0x2c9)+'pingAndWai'+_0x59f1fe(0x2f8)+(_0x4bca49?.['message']||_0x4bca49));}if(_0x4240d1&&typeof _0x4240d1[_0x59f1fe(0x1ce)]===_0x59f1fe(0x34d))try{await _0x4240d1['reply']({'text':String(_0xdd9463),'mentions':_0x6970f2['mentions']||[]});return;}catch(_0x43c561){try{await sendApi(_0x1eaf96,_0x6970f2);return;}catch(_0x1f57bf){warn('[gfilter]\x20'+'fallback\x20b'+'are\x20send\x20a'+_0x59f1fe(0x275)+_0x59f1fe(0x257)+_0x59f1fe(0x24a)+':\x20'+(_0x1f57bf?.[_0x59f1fe(0x2e3)]||_0x1f57bf));return;}}try{await sendApi(_0x1eaf96,_0x6970f2);}catch(_0xd345c7){warn('[gfilter]\x20'+'sendText\x20f'+_0x59f1fe(0x214)+_0x1eaf96+':\x20'+(_0xd345c7?.[_0x59f1fe(0x2e3)]||_0xd345c7));}}catch(_0x3fb2ff){warn('[gfilter]\x20'+'sendText\x20u'+_0x59f1fe(0x2ae)+_0x59f1fe(0x1fe)+(_0x3fb2ff?.[_0x59f1fe(0x2e3)]||_0x3fb2ff));}}async function tableExists(_0x577ae0){const _0x1e9558=_0x368b49;try{const _0x388d17=await db[_0x1e9558(0x322)](_0x1e9558(0x254)+_0x1e9558(0x1e3)+_0x1e9558(0x2eb)+_0x1e9558(0x2e6)+_0x1e9558(0x2ac)+_0x1e9558(0x2b0),[_0x577ae0]);return!!_0x388d17;}catch(_0x128351){return warn('[gfilter]\x20'+_0x1e9558(0x2f4)+_0x1e9558(0x2b4)+(_0x128351?.['message']||_0x128351)),![];}}async function getTableColumns(_0x43b224){const _0x4bb75e=_0x368b49;try{const _0x41b65a=await db['all'](_0x4bb75e(0x1ae)+'le_info('+_0x43b224+')');return(_0x41b65a||[])[_0x4bb75e(0x1eb)](_0x77c7a=>_0x77c7a[_0x4bb75e(0x356)]);}catch(_0x24940e){return warn('[gfilter]\x20'+_0x4bb75e(0x344)+'lumns\x20erro'+_0x4bb75e(0x1a5)+_0x43b224+':\x20'+(_0x24940e?.[_0x4bb75e(0x2e3)]||_0x24940e)),[];}}function resolveChatJidFromRow(_0xecc3ad){const _0x599794=_0x368b49,_0x5c55e7=[_0x599794(0x32f),_0x599794(0x2e4),_0x599794(0x2ed),_0x599794(0x2c8),'chat',_0x599794(0x308)];for(const _0x5ce63a of _0x5c55e7)if(_0x5ce63a in _0xecc3ad&&_0xecc3ad[_0x5ce63a])return String(_0xecc3ad[_0x5ce63a]);for(const _0x454090 of Object[_0x599794(0x245)](_0xecc3ad)){const _0x5b0eb7=_0xecc3ad[_0x454090];if(typeof _0x5b0eb7===_0x599794(0x26e)&&_0x5b0eb7[_0x599794(0x2dd)]('@'))return _0x5b0eb7;}return null;}function resolveTriggerFromRow(_0x5ad8eb){const _0x5a9597=_0x368b49,_0x2ffe18=[_0x5a9597(0x267),'trig','keyword',_0x5a9597(0x279),_0x5a9597(0x227)];for(const _0x1f8585 of _0x2ffe18)if(_0x1f8585 in _0x5ad8eb&&_0x5ad8eb[_0x1f8585])return String(_0x5ad8eb[_0x1f8585]);for(const _0x2a4779 of Object['keys'](_0x5ad8eb)){const _0x209b5a=_0x5ad8eb[_0x2a4779];if(typeof _0x209b5a===_0x5a9597(0x26e)&&!_0x209b5a[_0x5a9597(0x2dd)]('@')&&_0x209b5a[_0x5a9597(0x232)]<0x24bf+-0x1d5+-0x10df*0x2)return _0x209b5a;}return null;}function resolveResponsesFromRow(_0x5d3d4c){const _0x539a3e=_0x368b49,_0x360722=[_0x539a3e(0x246),_0x539a3e(0x30f),_0x539a3e(0x1ce),_0x539a3e(0x28b),_0x539a3e(0x342),'value',_0x539a3e(0x2e3)];for(const _0x394648 of _0x360722)if(_0x394648 in _0x5d3d4c&&_0x5d3d4c[_0x394648]!=null)return _0x5d3d4c[_0x394648];for(const _0x1dc170 of Object['keys'](_0x5d3d4c)){const _0x29e17c=_0x5d3d4c[_0x1dc170];if(typeof _0x29e17c===_0x539a3e(0x26e)&&(_0x29e17c[_0x539a3e(0x34e)]()[_0x539a3e(0x34a)]('!')||_0x29e17c[_0x539a3e(0x34e)]()['includes']('\x0a')||_0x29e17c[_0x539a3e(0x34e)]()[_0x539a3e(0x34a)]('[')))return _0x29e17c;}return null;}function _0xb515(){const _0x202909=['d\x20INTEGER\x20','\x22\x20->\x20','ponseMessa','and\x20GLOBAL','_index\x20FRO','roundrobin','M\x20filters\x20','RENAME\x20TO\x20','T\x20\x27[]\x27','exec','Deleted\x20','migration\x20','\x20\x20\x20\x20\x20\x20crea','completed;','a\x20line\x20`gp','s|all>','replies','igger1,tri','M\x20filters','\x20renamed\x20t','o\x20restrict','toLowerCas','O\x20filters_','.\x20Please\x20c','!response2','ULL','next','DELETE\x20FRO','GLOBAL\x20(al','regex:','extendedTe','malizeExis','find','lowerToOri','stringify','ection(s)\x20','fromMe','pickRespon','filters_ba','resolveNam','INTEGER\x20DE','caption','853274CMTESp','\x20connectio','s\x20a\x20full\x20J','filter','nodes','integrated','p-jid|alia','e=\x27table\x27\x20','response1\x0a','nexpected\x20','\x20for\x20chat\x20','AND\x20name=?','heck\x20/setd','split','gdelfilter','s\x20error:\x20','created_by','\x20empty;\x20fa','floor','132qaIIkw','L\x20filters\x20','_filters_c','MatchFromF','\x20for\x20','dex,\x20creat','\x20TEXT\x20DEFA','every','\x20filters\x20f','\x20old\x20table','\x20\x20\x20\x20\x20\x20chat','PRIMARY\x20KE','\x22.\x20Use\x20gro','sendPresen','lling\x20back','lters_uniq','jid','simulateTy','set','onical\x20sch','delete','\x20@\x20','\x20<group-ji','jid);','CREATE\x20UNI','listTrigge','irmation','<trigger1,','sendText\x20c','\x20to\x20ctx.ke','selectedBu','endsWith','AhoCorasic','l\x20groups)','readAndNor','splice','lfilter\x20tr','includes','post-swap\x20','selectedRo','Usage:\x20gde','\x20to\x20','[gfilter]\x20','message','chatid','multiple\x20t','\x20WHERE\x20typ','values','\x20DEFAULT\x200',':\x20\x22','IMARY\x20KEY\x20','ite_master','ed_by,\x20cre','chat_id','wId','trigger1,t','created\x20fi','tries\x20from','QUE\x20INDEX\x20','er\x20failed\x20','tableExist','argets','concat','invalid\x20st','t\x20error:\x20','\x20TO\x20filter','idx\x20create','er,\x20chat_j','conversati','STS\x20idx_fi','\x20\x20\x20\x20rr_ind','\x20created_b','legacy\x20fil','hat_jid,\x20t','INTEGER\x20PR','E\x20filters\x20','xcluded.cr','\x27[]\x27,\x0a\x20\x20\x20\x20','push','\x0a\x20\x20\x20\x20\x20\x20\x20\x20i','room','entries','r);',',\x20?)','T\x20NULL,\x0a\x20\x20',',\x0a\x20\x20','oup(s).','response','XT\x20NOT\x20NUL','failed\x20for','EXISTS\x20idx','ror:\x20','REATE\x20TABL','\x20filters:\x20','Handler\x20er','getBotJid(','cleaned\x20up','fault\x20conn','sendMessag','TINCT\x20trig','\x20gfilter\x20<','\x20first.','triggers','gration','now','er\x20TEXT\x20NO','get','RESPONSE_M','TEXT\x20DEFAU','ckup_','EMENT,\x0a\x20\x20\x20','mentions','n(s).\x20Use\x20','Saved\x20','finalize','\x20detected\x20','or\x20','glistfilte','sort','chat_jid','y.remoteJi','lfilter\x20al','ase.\x20Rows\x20','LE\x20IF\x20NOT\x20','NOT\x20NULL,\x0a','\x0a!response','trimStart','singleSele','ex\x20INTEGER',',\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ID.','search','onForChat\x20','build','t\x20connecti','E\x20filters_','s\x20table','y,\x20created','body','INSERT\x20INT','getTableCo','(chat_jid,','eated_at;','ters\x20SET\x20r','PRAGMA\x20for','\x20\x20UNIQUE(c','startsWith','participan','id|all>`\x20t','function','trim','ilters\x20WHE','ng\x20safe\x20mi','PDATE\x20SET\x0a','10669197uKnMMD','\x20filter\x20en','ly\x20include','UPDATE\x20fil','name','w\x20filters\x20','responses,','\x0a\x20\x20\x20\x20\x20\x20\x20\x20C','s\x20failed:\x20','ted_at\x20=\x20e','\x20\x20\x20\x20\x20\x20\x20\x20re','_at)\x0a\x20\x20\x20\x20\x20','gger)\x20DO\x20U','\x22\x20-\x20','rr_index','on(s):\x20','8452qOJlkU','isArray','r\x20for\x20','ters(chat_','r_index\x20=\x20','12BdZGhy','all','Could\x20not\x20','getAutomat','ses,\x20rr_in','k\x20matching','PRAGMA\x20tab','timestamp','41496697qjUDFD','\x200,\x0a\x20\x20\x20\x20\x20\x20','ma\x20fatal','filters','EX\x20IF\x20NOT\x20','d\x20=\x20?\x20ORDE','\x20\x20\x20\x20\x20trigg','swap\x20table','?,\x20?,\x20?,\x200','CREATE\x20TAB',':\x20gdelfilt',':\x20<alias|j','add','changes','ADD\x20COLUMN','\x20\x20\x20\x20\x20\x20);','fail','\x5cw*','=\x20OFF;','6612520RXjIUa','FAULT\x200','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20gfilter\x20','umn\x20','shift','ss\x20your\x20de','creator','ALUES\x20(?,\x20','catch','ger\x20FROM\x20f','reply','sock','R\x20BY\x20trigg','replace','no\x20sendApi','ated_at)\x20V','join','L\x20DEFAULT\x20','?,\x20?,\x200,\x20?','substring','\x20gp:\x20<grou','er\x20trigger','imageMessa','11786265VVnqGK','(trigger,\x20','ters\x20table','elfilter\x20a','create','(\x0a\x20\x20\x20\x20\x20\x20\x20\x20','created_at','parse','e\x20FROM\x20sql','\x20\x20\x20created','1ukrPGK','loaded\x20','output','o\x20backup','\x20target\x20gr','added\x20miss','map','test','as|jid|all','EGER\x20DEFAU','>]\x0aOr:\x20gde','2.2.0','Usage\x20(PM)','ceUpdate','ce\x20error:\x20','id,\x20trigge','from','getUniqueJ','ncrement\x20f','\x20\x20\x20\x20\x20','\x20\x20\x20\x20UNIQUE','RE\x20chat_ji','\x20\x20\x20\x20\x20ON\x20CO','uded.creat','\x20chat_jid\x20','error:\x20','videoMessa','rigger2>\x0a!','ema)','FILTERS','hat\x20ON\x20fil','ters\x20from\x20','ur\x20default','SELECT\x20res','Y\x20AUTOINCR','run','LT\x200,\x0a\x20\x20\x20\x20','delete\x20all','deleted\x20','composing','keyword','oUserJid','rsForChat\x20','IF\x20NOT\x20EXI','ted_at\x20INT','Deleted\x20AL','created\x20ne','ailed\x20to\x20','saved\x20filt','rr_index\x20i','8YWnToT','chat_jid,\x20','Usage\x20(PM\x20','\x0aOptionall','\x20failed:\x20','SELECT\x20DIS',',\x20?,\x20?)\x0a\x20\x20','\x20rr_index,','\x20available','ailed:\x20','global\x20by\x20','=\x20?\x20AND\x20tr','idx:\x20','slice','gger2\x20[gp:','resolve\x20yo','phrase','ponses,\x20rr','\x20alias/jid','Unknown\x20gp','ers(chat_j','WHERE\x20chat','ALTER\x20TABL','remoteJid','clear','time','er:\x20\x22','length','\x20to\x20add\x20al','seMessage','up\x20admin):','findStored','ll\x20\x20\x20(ERAS','@g.us','ue\x20ON\x20filt','random','normalizeT','\x20[gp:\x20<ali','\x20excluded.','ttonId','ODE','ias\x20or\x20pas','keywords','initialize','3fffGOa','without\x20UN','keys','responses','text','Usage\x20(gro','gfilter','lso\x20failed','object','llback','sponses\x20TE','xtMessage','CREATE\x20IND','ids','new\x20(trigg','\x20trigger)\x0a','EXISTS\x20fil','SELECT\x20nam','Failed\x20to\x20','gdelf','\x20failure\x20a','from\x20datab','\x5c$&','buttonsRes','rigger)\x0a\x20\x20','listRespon',')\x20returned','\x20filter(s)','deleteFilt','ND\x20trigger','DB)','ers\x20failed','prepare','d\x20for\x20conf','ters_new\x20(','\x20fatal','trigger','key','efault\x20val','isFinite','279625bqpDiv','insert\x20nor','d\x20IN\x20(?,\x20?','string','ES\x20ALL\x20fil','\x20=\x20?\x20LIMIT','ctReply','has','ups\x20helper','removed:\x20','fter\x20reply','_jid\x20TEXT\x20','TEXT\x20NOT\x20N','rr_index\x20=','word','setdefault'];_0xb515=function(){return _0x202909;};return _0xb515();}async function readAndNormalizeExistingFilters(){const _0x4d35fd=_0x368b49;try{const _0x90fbb7=await db['all']('SELECT\x20*\x20F'+'ROM\x20filter'+'s'),_0x3ab503=new Map();for(const _0x4557fc of _0x90fbb7||[]){const _0x5b30db=resolveTriggerFromRow(_0x4557fc)||'',_0xa2d68d=resolveChatJidFromRow(_0x4557fc)||'';if(!_0x5b30db||!_0xa2d68d)continue;const _0x42d00a=resolveResponsesFromRow(_0x4557fc),_0x5b4e35=normalizeResponseValue(_0x42d00a),_0x1c215c=_0x4557fc[_0x4d35fd(0x2b5)]||_0x4557fc[_0x4d35fd(0x1ca)]||_0x4557fc['author']||'';let _0x45d0e3=Number(_0x4557fc[_0x4d35fd(0x1e1)]||_0x4557fc['ts']||_0x4557fc[_0x4d35fd(0x1af)]||_0x4557fc[_0x4d35fd(0x230)]||0x1331*-0x2+0x11*0x17+-0xf*-0x275);if(!_0x45d0e3)_0x45d0e3=Math[_0x4d35fd(0x2b7)](Date[_0x4d35fd(0x320)]()/(-0xd*-0x109+0x12a5+-0x1c32));const _0x18576f=_0xa2d68d+'||'+_0x5b30db;if(!_0x3ab503['has'](_0x18576f))_0x3ab503[_0x4d35fd(0x2ca)](_0x18576f,{'trigger':_0x5b30db,'chat_jid':_0xa2d68d,'responses':_0x5b4e35[_0x4d35fd(0x224)](),'created_by':_0x1c215c,'created_at':_0x45d0e3});else{const _0x27cf22=_0x3ab503[_0x4d35fd(0x322)](_0x18576f);_0x27cf22[_0x4d35fd(0x246)]=uniqArray(_0x27cf22[_0x4d35fd(0x246)][_0x4d35fd(0x2f6)](_0x5b4e35)),_0x27cf22['created_by']=_0x27cf22['created_by']||_0x1c215c,_0x27cf22[_0x4d35fd(0x1e1)]=Math['max'](_0x27cf22[_0x4d35fd(0x1e1)]||0x7*-0x6d+0x74e+-0x453,_0x45d0e3||0x97a*-0x4+-0x85+-0x1*-0x266d);}}return Array[_0x4d35fd(0x1f5)](_0x3ab503[_0x4d35fd(0x2e7)]());}catch(_0x424d87){return warn(_0x4d35fd(0x2e2)+_0x4d35fd(0x2da)+_0x4d35fd(0x29a)+'tingFilter'+_0x4d35fd(0x19b)+(_0x424d87?.[_0x4d35fd(0x2e3)]||_0x424d87)),[];}}async function ensureSchema(){const _0x395e7=_0x368b49,_0x3f4b7d={'id':_0x395e7(0x302)+_0x395e7(0x2ea)+'AUTOINCREM'+'ENT','trigger':_0x395e7(0x277)+_0x395e7(0x294),'chat_jid':_0x395e7(0x277)+'ULL','responses':'TEXT\x20NOT\x20N'+'ULL\x20DEFAUL'+_0x395e7(0x283),'rr_index':_0x395e7(0x2a3)+_0x395e7(0x1c4),'created_by':_0x395e7(0x324)+'LT\x20\x27\x27','created_at':_0x395e7(0x2a3)+_0x395e7(0x1c4)};try{const _0xf5d16b=await tableExists(_0x395e7(0x1b3));if(!_0xf5d16b){const _0x3f1b39=Object[_0x395e7(0x309)](_0x3f4b7d)[_0x395e7(0x1eb)](([_0xa8de45,_0x454ec0])=>_0xa8de45+'\x20'+_0x454ec0)[_0x395e7(0x1d4)](_0x395e7(0x30d));await db[_0x395e7(0x284)](_0x395e7(0x19a)+_0x395e7(0x314)+_0x395e7(0x303)+_0x395e7(0x1e0)+'\x20\x20'+_0x3f1b39+(_0x395e7(0x339)+_0x395e7(0x349)+_0x395e7(0x301)+_0x395e7(0x25b)+'\x20\x20\x20\x20\x20\x20);\x0a\x20'+_0x395e7(0x1f8)));try{await db[_0x395e7(0x284)](_0x395e7(0x24f)+_0x395e7(0x1b4)+_0x395e7(0x312)+'_filters_c'+'hat\x20ON\x20fil'+'ters(chat_'+_0x395e7(0x2cf));}catch(_0x54a6fc){}try{await db[_0x395e7(0x284)]('CREATE\x20UNI'+_0x395e7(0x2f2)+'IF\x20NOT\x20EXI'+_0x395e7(0x2fd)+'lters_uniq'+_0x395e7(0x239)+_0x395e7(0x22b)+_0x395e7(0x1f4)+_0x395e7(0x30a));}catch(_0x416f0){}info(_0x395e7(0x2e2)+_0x395e7(0x213)+_0x395e7(0x357)+'table\x20(can'+_0x395e7(0x2cb)+_0x395e7(0x201));return;}const _0x26d1e2=await getTableColumns(_0x395e7(0x1b3)),_0x6caf0b=[];for(const _0x3343ca of Object[_0x395e7(0x245)](_0x3f4b7d)){if(!_0x26d1e2[_0x395e7(0x2dd)](_0x3343ca))_0x6caf0b[_0x395e7(0x306)](_0x3343ca);}if(_0x6caf0b[_0x395e7(0x232)]===-0x1*0xc6d+0x1*-0xd55+0x19c2){try{await db[_0x395e7(0x284)](_0x395e7(0x24f)+_0x395e7(0x1b4)+'EXISTS\x20idx'+_0x395e7(0x2ba)+_0x395e7(0x203)+_0x395e7(0x1a6)+_0x395e7(0x2cf));}catch(_0x274365){warn(_0x395e7(0x2e2)+_0x395e7(0x2fa)+':\x20'+(_0x274365?.['message']||_0x274365));}try{await db[_0x395e7(0x284)](_0x395e7(0x2d0)+_0x395e7(0x2f2)+_0x395e7(0x210)+_0x395e7(0x2fd)+_0x395e7(0x2c7)+_0x395e7(0x239)+_0x395e7(0x22b)+_0x395e7(0x1f4)+_0x395e7(0x30a));}catch(_0x23423a){warn(_0x395e7(0x2e2)+'unique\x20idx'+':\x20'+(_0x23423a?.[_0x395e7(0x2e3)]||_0x23423a));}return;}const _0x2a8079=_0x6caf0b[_0x395e7(0x2bf)](_0x11cc04=>!['id',_0x395e7(0x267),_0x395e7(0x32f)]['includes'](_0x11cc04));if(_0x2a8079){for(const _0x5f4f06 of _0x6caf0b){try{const _0x1678bd=_0x3f4b7d[_0x5f4f06],_0x5e291a=_0x1678bd[_0x395e7(0x2b2)]('\x20')['slice'](0x7*-0x4ff+-0x2443+0x473d)[_0x395e7(0x1d4)]('\x20');await db[_0x395e7(0x284)](_0x395e7(0x22d)+'E\x20filters\x20'+_0x395e7(0x1be)+'\x20'+_0x5f4f06+'\x20'+_0x5e291a),info('[gfilter]\x20'+_0x395e7(0x1ea)+'ing\x20column'+'\x20'+_0x5f4f06+('\x20to\x20filter'+_0x395e7(0x340)));}catch(_0x316152){warn(_0x395e7(0x2e2)+'adding\x20col'+_0x395e7(0x1c7)+_0x5f4f06+'\x20failed:\x20'+(_0x316152?.[_0x395e7(0x2e3)]||_0x316152));}}try{await db[_0x395e7(0x284)]('CREATE\x20IND'+_0x395e7(0x1b4)+_0x395e7(0x312)+_0x395e7(0x2ba)+'hat\x20ON\x20fil'+_0x395e7(0x1a6)+_0x395e7(0x2cf));}catch(_0x10ed9e){warn(_0x395e7(0x2e2)+_0x395e7(0x2fa)+':\x20'+(_0x10ed9e?.[_0x395e7(0x2e3)]||_0x10ed9e));}try{await db[_0x395e7(0x284)](_0x395e7(0x2d0)+_0x395e7(0x2f2)+_0x395e7(0x210)+'STS\x20idx_fi'+'lters_uniq'+'ue\x20ON\x20filt'+_0x395e7(0x22b)+_0x395e7(0x1f4)+_0x395e7(0x30a));}catch(_0x20546c){warn(_0x395e7(0x2e2)+'unique\x20idx'+':\x20'+(_0x20546c?.[_0x395e7(0x2e3)]||_0x20546c));}return;}info(_0x395e7(0x2e2)+_0x395e7(0x300)+_0x395e7(0x1dd)+_0x395e7(0x32b)+'-\x20performi'+_0x395e7(0x350)+_0x395e7(0x31f));const _0x1cd058=await readAndNormalizeExistingFilters();await db[_0x395e7(0x284)]('PRAGMA\x20for'+'eign_keys\x20'+_0x395e7(0x1c2));try{await db[_0x395e7(0x284)](_0x395e7(0x1b9)+_0x395e7(0x333)+_0x395e7(0x253)+_0x395e7(0x265)+_0x395e7(0x307)+_0x395e7(0x27b)+'PRIMARY\x20KE'+_0x395e7(0x207)+_0x395e7(0x326)+_0x395e7(0x1b6)+_0x395e7(0x321)+_0x395e7(0x30c)+'\x20\x20\x20\x20\x20\x20chat'+_0x395e7(0x276)+_0x395e7(0x334)+_0x395e7(0x19d)+'sponses\x20TE'+_0x395e7(0x310)+_0x395e7(0x1d5)+_0x395e7(0x305)+_0x395e7(0x2fe)+_0x395e7(0x338)+'\x20DEFAULT\x200'+_0x395e7(0x339)+_0x395e7(0x2b5)+_0x395e7(0x2be)+'ULT\x20\x27\x27,\x0a\x20\x20'+_0x395e7(0x287)+_0x395e7(0x211)+_0x395e7(0x1ee)+_0x395e7(0x209)+_0x395e7(0x1f9)+_0x395e7(0x345)+_0x395e7(0x252)+_0x395e7(0x1bf));}catch(_0x5a158d){await db['exec'](_0x395e7(0x1b9)+_0x395e7(0x333)+_0x395e7(0x253)+_0x395e7(0x265)+_0x395e7(0x307)+'d\x20INTEGER\x20'+_0x395e7(0x2c3)+_0x395e7(0x207)+_0x395e7(0x326)+'\x20\x20\x20\x20\x20trigg'+_0x395e7(0x321)+_0x395e7(0x30c)+_0x395e7(0x2c2)+_0x395e7(0x276)+'NOT\x20NULL,\x0a'+'\x20\x20\x20\x20\x20\x20\x20\x20re'+_0x395e7(0x24d)+_0x395e7(0x310)+_0x395e7(0x1d5)+_0x395e7(0x305)+'\x20\x20\x20\x20rr_ind'+_0x395e7(0x338)+_0x395e7(0x2e8)+_0x395e7(0x339)+_0x395e7(0x2b5)+_0x395e7(0x2be)+'ULT\x20\x27\x27,\x0a\x20\x20'+_0x395e7(0x287)+_0x395e7(0x211)+_0x395e7(0x1ee)+'LT\x200\x0a\x20\x20\x20\x20\x20'+'\x20);'),warn('[gfilter]\x20'+_0x395e7(0x2f0)+'lters_new\x20'+_0x395e7(0x244)+'IQUE\x20as\x20fa'+_0x395e7(0x24c));}const _0x37e3c9=await db[_0x395e7(0x263)](_0x395e7(0x343)+_0x395e7(0x291)+_0x395e7(0x251)+_0x395e7(0x2fb)+'id,\x20respon'+_0x395e7(0x1ac)+_0x395e7(0x2bd)+_0x395e7(0x2ec)+_0x395e7(0x1d3)+_0x395e7(0x1cb)+_0x395e7(0x1d6)+_0x395e7(0x30b));try{for(const _0x2b6584 of _0x1cd058){const _0x4ad710=JSON[_0x395e7(0x29d)](ensureArray(_0x2b6584[_0x395e7(0x246)]||[]));try{await _0x37e3c9[_0x395e7(0x208)](_0x2b6584[_0x395e7(0x267)],_0x2b6584[_0x395e7(0x32f)],_0x4ad710,_0x2b6584[_0x395e7(0x2b5)]||'',Number(_0x2b6584[_0x395e7(0x1e1)]||Math[_0x395e7(0x2b7)](Date[_0x395e7(0x320)]()/(0x45f*0x1+-0x1e72+0x1dfb))));}catch(_0x38383d){warn('[gfilter]\x20'+'could\x20not\x20'+_0x395e7(0x26c)+'malized\x20ro'+'w\x20'+_0x2b6584[_0x395e7(0x32f)]+'@'+_0x2b6584[_0x395e7(0x267)]+':\x20'+(_0x38383d?.['message']||_0x38383d));}}}finally{try{await _0x37e3c9[_0x395e7(0x32a)]();}catch(_0x49e28d){}}try{const _0x212d15=_0x395e7(0x2a1)+_0x395e7(0x325)+Math[_0x395e7(0x2b7)](Date[_0x395e7(0x320)]()/(-0x1*0x1d91+-0x1*-0x1a6b+0x25a*0x3));await db[_0x395e7(0x284)](_0x395e7(0x22d)+_0x395e7(0x303)+_0x395e7(0x282)+_0x212d15+';'),await db['exec'](_0x395e7(0x22d)+_0x395e7(0x33f)+'new\x20RENAME'+_0x395e7(0x2f9)+'s;');try{await db[_0x395e7(0x284)](_0x395e7(0x24f)+'EX\x20IF\x20NOT\x20'+_0x395e7(0x312)+_0x395e7(0x2ba)+'hat\x20ON\x20fil'+_0x395e7(0x1a6)+'jid);');}catch(_0x48fad5){warn(_0x395e7(0x2e2)+_0x395e7(0x2de)+_0x395e7(0x223)+(_0x48fad5?.[_0x395e7(0x2e3)]||_0x48fad5));}try{await db[_0x395e7(0x284)]('CREATE\x20UNI'+_0x395e7(0x2f2)+_0x395e7(0x210)+_0x395e7(0x2fd)+_0x395e7(0x2c7)+'ue\x20ON\x20filt'+_0x395e7(0x22b)+_0x395e7(0x1f4)+_0x395e7(0x30a));}catch(_0x1be9f7){warn(_0x395e7(0x2e2)+'post-swap\x20'+'unique\x20idx'+':\x20'+(_0x1be9f7?.[_0x395e7(0x2e3)]||_0x1be9f7));}info(_0x395e7(0x2e2)+_0x395e7(0x286)+_0x395e7(0x288)+_0x395e7(0x2c1)+_0x395e7(0x28e)+_0x395e7(0x1e8));}catch(_0x3fea2d){warn(_0x395e7(0x2e2)+_0x395e7(0x1b7)+'s\x20failed:\x20'+(_0x3fea2d?.['message']||_0x3fea2d));throw _0x3fea2d;}finally{await db[_0x395e7(0x284)](_0x395e7(0x348)+'eign_keys\x20'+'=\x20ON;');}}catch(_0x473d33){error(_0x473d33,_0x395e7(0x2e2)+'ensureSche'+_0x395e7(0x1b2));throw _0x473d33;}}function normalizeResponseValue(_0x586c46){const _0x4954d4=_0x368b49;if(_0x586c46==null)return[];if(Array['isArray'](_0x586c46))return uniqArray(_0x586c46);if(typeof _0x586c46===_0x4954d4(0x26e)){let _0x2bef04=_0x586c46[_0x4954d4(0x1d1)](/\r/g,'');const _0x55e0ed=_0x2bef04['trim']();if(_0x55e0ed[_0x4954d4(0x34a)]('['))try{const _0x50ee52=JSON[_0x4954d4(0x1e2)](_0x55e0ed);if(Array['isArray'](_0x50ee52))return uniqArray(_0x50ee52[_0x4954d4(0x1eb)](_0x4e29ee=>String(_0x4e29ee||'')));}catch(_0x597bf9){}_0x2bef04=_0x2bef04['replace'](/^\s*\n+/,'')['replace'](/\n+\s*$/,'');const _0x4377f9=_0x2bef04[_0x4954d4(0x2b2)]('\x0a'),_0x3a3455=_0x4377f9['some'](_0x55fea7=>_0x55fea7[_0x4954d4(0x336)]()[_0x4954d4(0x34a)]('!'));if(_0x3a3455){const _0xe16bfb=[];let _0x1eb177=null;for(const _0x54da2a of _0x4377f9){if(_0x54da2a[_0x4954d4(0x336)]()[_0x4954d4(0x34a)]('!')){const _0x927f95=_0x54da2a['replace'](/^\s*!/,''),_0x1f2d92=_0x927f95['replace'](/\s+$/,'');_0x1eb177=_0x1f2d92,_0xe16bfb[_0x4954d4(0x306)](_0x1eb177);}else{const _0x228cdc=_0x54da2a[_0x4954d4(0x1d1)](/\s+$/,'');if(_0x1eb177===null)_0x1eb177=_0x228cdc,_0xe16bfb[_0x4954d4(0x306)](_0x1eb177);else{const _0x239541=_0xe16bfb[_0x4954d4(0x232)]-(0x1c71+-0x672+0x2*-0xaff);_0xe16bfb[_0x239541]=_0xe16bfb[_0x239541]+'\x0a'+_0x228cdc,_0x1eb177=_0xe16bfb[_0x239541];}}}return uniqArray(_0xe16bfb[_0x4954d4(0x1eb)](_0x52b114=>String(_0x52b114||'')[_0x4954d4(0x34e)]()));}else{const _0x2c8f51=_0x4377f9[_0x4954d4(0x1eb)](_0x55245c=>_0x55245c[_0x4954d4(0x1d1)](/\s+$/,''))[_0x4954d4(0x1d4)]('\x0a')[_0x4954d4(0x34e)]();if(!_0x2c8f51)return[];return[_0x2c8f51];}}return[];}async function upsertFilterRow(_0x1f57a4,_0x3eb802,_0x35256e,_0x2a8466){const _0x12062a=_0x368b49;try{const _0x1c6508=Math[_0x12062a(0x2b7)](Date['now']()/(-0x1e90+0x90c+0x196c)),_0x413b60=JSON[_0x12062a(0x29d)](uniqArray(ensureArray(_0x35256e)['map'](_0x7952d3=>String(_0x7952d3)['trim']())[_0x12062a(0x2a8)](Boolean)));await db['run']('INSERT\x20INT'+'O\x20filters\x20'+_0x12062a(0x1dc)+_0x12062a(0x218)+_0x12062a(0x199)+_0x12062a(0x21e)+_0x12062a(0x2ff)+_0x12062a(0x341)+_0x12062a(0x19e)+'\x20\x20VALUES\x20('+_0x12062a(0x1b8)+_0x12062a(0x21d)+_0x12062a(0x1fb)+'NFLICT(cha'+'t_jid,\x20tri'+_0x12062a(0x19f)+_0x12062a(0x351)+'\x20\x20\x20\x20\x20\x20\x20\x20\x20r'+'esponses\x20='+_0x12062a(0x23d)+_0x12062a(0x199)+_0x12062a(0x1c5)+_0x12062a(0x278)+_0x12062a(0x1b1)+_0x12062a(0x1e4)+'_by\x20=\x20excl'+_0x12062a(0x1fc)+'ed_by,\x0a\x20\x20\x20'+'\x20\x20\x20\x20\x20\x20crea'+_0x12062a(0x19c)+_0x12062a(0x304)+_0x12062a(0x346),[_0x3eb802,_0x1f57a4,_0x413b60,_0x2a8466||'',_0x1c6508]);try{automatonCache['clear']();}catch(_0x18ebe8){}return info(_0x12062a(0x2e2)+_0x12062a(0x215)+_0x12062a(0x231)+_0x3eb802+_0x12062a(0x27c)+_0x1f57a4),!![];}catch(_0x5afea2){return error(_0x5afea2,_0x12062a(0x2e2)+'upsertFilt'+_0x12062a(0x2f3)+'for\x20'+_0x3eb802+_0x12062a(0x2cd)+_0x1f57a4),![];}}async function deleteFilters(_0x194f06,_0x28dffe){const _0x1fb09e=_0x368b49;if(!Array[_0x1fb09e(0x1a4)](_0x28dffe)||_0x28dffe[_0x1fb09e(0x232)]===0x68*0x49+-0x647*0x5+-0x1*-0x1bb)return-0x62e+-0x9*0x3d9+-0x1f*-0x151;try{let _0x36251e=0x131+-0x2b*0xb+0x3*0x38;for(const _0x1d4b45 of _0x28dffe){const _0x3d5ae5=await db[_0x1fb09e(0x208)](_0x1fb09e(0x296)+_0x1fb09e(0x281)+_0x1fb09e(0x22c)+'_jid\x20=\x20?\x20A'+_0x1fb09e(0x260)+'\x20=\x20?',[_0x194f06,_0x1d4b45]);if(_0x3d5ae5?.[_0x1fb09e(0x1bd)])_0x36251e+=_0x3d5ae5[_0x1fb09e(0x1bd)];info(_0x1fb09e(0x2e2)+_0x1fb09e(0x20b)+_0x1d4b45+_0x1fb09e(0x2cd)+_0x194f06);}try{automatonCache[_0x1fb09e(0x22f)]();}catch(_0x4afda3){}return _0x36251e;}catch(_0x1a1835){return error(_0x1a1835,'[gfilter]\x20'+_0x1fb09e(0x25f)+_0x1fb09e(0x262)+_0x1fb09e(0x2bc)+_0x194f06),-0x5*-0x60d+-0xe5*-0x17+-0x32d4*0x1;}}async function listTriggersForChat(_0x4f73ba){const _0x14d290=_0x368b49;try{const _0x40e219=await db['all'](_0x14d290(0x21c)+_0x14d290(0x31b)+_0x14d290(0x1cd)+_0x14d290(0x34f)+_0x14d290(0x1fa)+_0x14d290(0x1b5)+_0x14d290(0x1d0)+'er',[_0x4f73ba]);return(_0x40e219||[])[_0x14d290(0x1eb)](_0x462954=>_0x462954[_0x14d290(0x267)]);}catch(_0x27c53d){return warn(_0x27c53d,_0x14d290(0x2e2)+_0x14d290(0x2d1)+_0x14d290(0x20f)+_0x14d290(0x311)+'\x20'+_0x4f73ba),[];}}async function pickResponseAndAdvance(_0x2ebd29,_0x1a202d,_0x54af9e=_0x368b49(0x280)){const _0x4babcf=_0x368b49;try{const _0x47bbb2=await db[_0x4babcf(0x322)](_0x4babcf(0x206)+_0x4babcf(0x228)+_0x4babcf(0x27f)+_0x4babcf(0x281)+_0x4babcf(0x22c)+'_jid\x20=\x20?\x20A'+_0x4babcf(0x260)+_0x4babcf(0x270)+'\x201',[_0x2ebd29,_0x1a202d]);if(!_0x47bbb2)return null;let _0x2e8f3c=[];try{_0x2e8f3c=JSON['parse'](_0x47bbb2[_0x4babcf(0x246)]||'[]');}catch{_0x2e8f3c=ensureArray(_0x47bbb2[_0x4babcf(0x246)]);}_0x2e8f3c=ensureArray(_0x2e8f3c);if(!_0x2e8f3c[_0x4babcf(0x232)])return null;if((_0x54af9e||'')['toLowerCas'+'e']()===_0x4babcf(0x23a)){const _0xb861cc=Math['floor'](Math['random']()*_0x2e8f3c[_0x4babcf(0x232)]);return _0x2e8f3c[_0xb861cc];}const _0x22d91f=Number(_0x47bbb2[_0x4babcf(0x1a1)]||-0x16a*-0x11+-0xbfd+-0xc0d),_0x110b44=_0x2e8f3c[_0x22d91f%_0x2e8f3c['length']];try{await db[_0x4babcf(0x208)](_0x4babcf(0x355)+_0x4babcf(0x347)+_0x4babcf(0x1a7)+'(rr_index\x20'+'+\x201)\x20WHERE'+_0x4babcf(0x1fd)+_0x4babcf(0x222)+'igger\x20=\x20?',[_0x2ebd29,_0x1a202d]);}catch(_0x35bdb8){warn(_0x4babcf(0x2e2)+_0x4babcf(0x216)+_0x4babcf(0x1f7)+_0x4babcf(0x220)+(_0x35bdb8?.[_0x4babcf(0x2e3)]||_0x35bdb8));}return _0x110b44;}catch(_0x583268){return warn('[gfilter]\x20'+_0x4babcf(0x2a0)+'seAndAdvan'+_0x4babcf(0x1f3)+(_0x583268?.[_0x4babcf(0x2e3)]||_0x583268)),null;}}function parseFilterCommandText(_0x54e1e4){const _0x489209=_0x368b49;if(!_0x54e1e4)return null;const _0x166782=_0x54e1e4['split'](/\r?\n/)[_0x489209(0x1eb)](_0x1493f0=>_0x1493f0[_0x489209(0x1d1)](/\r/g,''));if(!_0x166782['length'])return null;let _0x493bbe=(_0x166782[-0x7e9+0x630*-0x1+0xe19]||'')[_0x489209(0x34e)](),_0x325816=_0x166782['slice'](-0x2267*-0x1+-0x2e9*0xb+-0x263),_0x1976ec=null;const _0x16cebd=_0x493bbe['match'](/^(.*?)(?:\s*,\s*|\s+)?gp[:\s]*([^\s,]+)\s*$/i);_0x16cebd&&(_0x493bbe=(_0x16cebd[-0x1*0x127a+0x15c8*-0x1+0x2843]||'')['trim'](),_0x1976ec=(_0x16cebd[0x1f9a+-0x1ac6+-0x269*0x2]||'')['trim']());if(!_0x1976ec&&_0x325816&&_0x325816[_0x489209(0x232)]){let _0x3faecf=-(0x1df*0x9+0xcb0+-0xec3*0x2);for(let _0x5a6a8a=_0x325816['length']-(-0x2232+0x3d0*0x6+0xb53);_0x5a6a8a>=0x1461+0x7*-0x3ec+0x713;_0x5a6a8a--){if(String(_0x325816[_0x5a6a8a]||'')[_0x489209(0x34e)]()[_0x489209(0x232)]>-0xb6*-0x2c+0x1c*0xf+0x62*-0x56){_0x3faecf=_0x5a6a8a;break;}}if(_0x3faecf>=-0x23dd+-0x1245+0x3622){const _0x464647=String(_0x325816[_0x3faecf]||'')['trim'](),_0xe0ba6b=_0x464647['match'](/^gp[:\s]*([^\s,]+)\s*$/i);_0xe0ba6b&&(_0x1976ec=(_0xe0ba6b[0x37*-0x69+-0x2*-0x31d+0x2*0x82b]||'')['trim'](),_0x325816[_0x489209(0x2db)](_0x3faecf,0x17df+-0x124a*-0x1+-0x2a28));}}let _0x3295a9=_0x493bbe[_0x489209(0x34e)]()[_0x489209(0x2b2)](/\s+/)[_0x489209(0x2a8)](Boolean);if(_0x3295a9[_0x489209(0x232)]&&_0x3295a9[-0x201b+-0x3b*-0x35+-0x26*-0x86][_0x489209(0x290)+'e']()===_0x489209(0x249))_0x3295a9['shift']();const _0x565959=_0x3295a9[_0x489209(0x1d4)]('\x20')[_0x489209(0x34e)]();let _0x27031a=[];_0x565959&&(_0x565959[_0x489209(0x2dd)](',')?_0x27031a=_0x565959[_0x489209(0x2b2)](',')['map'](_0x5772d3=>_0x5772d3[_0x489209(0x34e)]())[_0x489209(0x2a8)](Boolean):_0x27031a=_0x565959[_0x489209(0x2b2)](/\s+/)['map'](_0x7e9524=>_0x7e9524[_0x489209(0x34e)]())['filter'](Boolean));const _0xd980c6=_0x325816;if(!_0xd980c6['length'])return{'triggers':_0x27031a,'responses':[],'gp':_0x1976ec};const _0x5df04b=_0xd980c6[_0x489209(0x1d4)]('\x0a'),_0x399b6e=normalizeResponseValue(_0x5df04b);return{'triggers':_0x27031a,'responses':_0x399b6e,'gp':_0x1976ec};}function getMessageText(_0x2c0210){const _0x50e1e5=_0x368b49;if(!_0x2c0210||!_0x2c0210[_0x50e1e5(0x2e3)])return'';const _0x287748=_0x2c0210[_0x50e1e5(0x2e3)];if(_0x287748[_0x50e1e5(0x2fc)+'on'])return _0x287748[_0x50e1e5(0x2fc)+'on'];if(_0x287748[_0x50e1e5(0x299)+_0x50e1e5(0x24e)]?.[_0x50e1e5(0x247)])return _0x287748['extendedTe'+'xtMessage']['text'];if(_0x287748[_0x50e1e5(0x1da)+'ge']?.[_0x50e1e5(0x2a4)])return _0x287748[_0x50e1e5(0x1da)+'ge'][_0x50e1e5(0x2a4)];if(_0x287748[_0x50e1e5(0x1ff)+'ge']?.[_0x50e1e5(0x2a4)])return _0x287748[_0x50e1e5(0x1ff)+'ge'][_0x50e1e5(0x2a4)];if(_0x287748[_0x50e1e5(0x25a)+_0x50e1e5(0x27d)+'ge']?.[_0x50e1e5(0x2d6)+_0x50e1e5(0x23e)])return _0x287748[_0x50e1e5(0x25a)+_0x50e1e5(0x27d)+'ge'][_0x50e1e5(0x2d6)+_0x50e1e5(0x23e)];if(_0x287748['listRespon'+_0x50e1e5(0x234)]?.[_0x50e1e5(0x337)+_0x50e1e5(0x271)]?.[_0x50e1e5(0x2df)+_0x50e1e5(0x2ee)])return _0x287748[_0x50e1e5(0x25c)+'seMessage'][_0x50e1e5(0x337)+_0x50e1e5(0x271)][_0x50e1e5(0x2df)+'wId'];return'';}const processedMessageKeys=new Map(),DEDUPE_TTL=(-0x1c*0x97+-0xba2+0x1c44)*(0x22d8+0x8*-0xd0+-0x1870);function makeDedupeKey(_0x45dae6){const _0x4c9129=_0x368b49,_0x402ba6=_0x45dae6?.[_0x4c9129(0x268)];if(!_0x402ba6)return null;const _0x15ed17=_0x402ba6['id']||_0x402ba6?.[_0x4c9129(0x34b)+'t']||'',_0x4d8115=_0x402ba6['remoteJid']||'';return _0x4d8115+'::'+_0x15ed17;}function isMsgProcessed(_0x482ecc){const _0x35464d=_0x368b49;return _0x482ecc&&processedMessageKeys[_0x35464d(0x272)](_0x482ecc);}function markMsgProcessed(_0x44814d){const _0x44eb69=_0x368b49;if(!_0x44814d)return;processedMessageKeys['has'](_0x44814d)&&clearTimeout(processedMessageKeys[_0x44eb69(0x322)](_0x44814d));const _0x2d2b9b=setTimeout(()=>processedMessageKeys[_0x44eb69(0x2cc)](_0x44814d),DEDUPE_TTL);processedMessageKeys[_0x44eb69(0x2ca)](_0x44814d,_0x2d2b9b);}class Aho{constructor(){const _0x26b885=_0x368b49;this[_0x26b885(0x2a9)]=[{'next':Object[_0x26b885(0x1df)](null),'fail':0x0,'output':[]}];}[_0x368b49(0x33d)](_0x6a6550){const _0x14f983=_0x368b49;this['nodes']=[{'next':Object['create'](null),'fail':0x0,'output':[]}];for(const _0x1b004b of _0x6a6550){let _0x561029=-0xe1f+0x1e3e+-0x101f;for(let _0x25535e=-0x2*0x7a+-0xb*-0x145+-0xd03;_0x25535e<_0x1b004b[_0x14f983(0x232)];_0x25535e++){const _0x5a8e0d=_0x1b004b[_0x25535e];!this['nodes'][_0x561029][_0x14f983(0x295)][_0x5a8e0d]&&(this[_0x14f983(0x2a9)][_0x561029][_0x14f983(0x295)][_0x5a8e0d]=this[_0x14f983(0x2a9)][_0x14f983(0x232)],this[_0x14f983(0x2a9)][_0x14f983(0x306)]({'next':Object[_0x14f983(0x1df)](null),'fail':0x0,'output':[]})),_0x561029=this[_0x14f983(0x2a9)][_0x561029]['next'][_0x5a8e0d];}this[_0x14f983(0x2a9)][_0x561029][_0x14f983(0x1e7)]['push'](_0x1b004b);}const _0x1c40fa=[];for(const _0x52b8b3 in this['nodes'][0x1df+0x4*0x3f5+-0x11b3][_0x14f983(0x295)]){const _0x28f9e8=this[_0x14f983(0x2a9)][0x1*0x95b+-0x2*0xe9e+0x13e1][_0x14f983(0x295)][_0x52b8b3];this['nodes'][_0x28f9e8]['fail']=0xd48+-0x15f4+0x8ac,_0x1c40fa[_0x14f983(0x306)](_0x28f9e8);}while(_0x1c40fa[_0x14f983(0x232)]){const _0x14352f=_0x1c40fa[_0x14f983(0x1c8)]();for(const _0x5dc2ba in this['nodes'][_0x14352f][_0x14f983(0x295)]){const _0xf80e66=this[_0x14f983(0x2a9)][_0x14352f][_0x14f983(0x295)][_0x5dc2ba];let _0x525eff=this['nodes'][_0x14352f]['fail'];while(_0x525eff&&!this[_0x14f983(0x2a9)][_0x525eff][_0x14f983(0x295)][_0x5dc2ba])_0x525eff=this[_0x14f983(0x2a9)][_0x525eff][_0x14f983(0x1c0)];if(this['nodes'][_0x525eff][_0x14f983(0x295)][_0x5dc2ba])this[_0x14f983(0x2a9)][_0xf80e66][_0x14f983(0x1c0)]=this[_0x14f983(0x2a9)][_0x525eff]['next'][_0x5dc2ba];else this['nodes'][_0xf80e66]['fail']=-0x1b1e+0xdc4+0x2*0x6ad;this['nodes'][_0xf80e66][_0x14f983(0x1e7)]['push'](...this[_0x14f983(0x2a9)][this[_0x14f983(0x2a9)][_0xf80e66][_0x14f983(0x1c0)]][_0x14f983(0x1e7)]),_0x1c40fa['push'](_0xf80e66);}}}[_0x368b49(0x33b)](_0x15374e){const _0xcfd57e=_0x368b49,_0x1c4ecb=[];let _0x2615c6=0x404+-0xee0+-0x8b*-0x14;for(let _0x360a6c=0x1*-0x1fac+0x1fb5+-0x9;_0x360a6c<_0x15374e[_0xcfd57e(0x232)];_0x360a6c++){const _0x57a1bc=_0x15374e[_0x360a6c];while(_0x2615c6&&!this[_0xcfd57e(0x2a9)][_0x2615c6][_0xcfd57e(0x295)][_0x57a1bc])_0x2615c6=this['nodes'][_0x2615c6][_0xcfd57e(0x1c0)];if(this[_0xcfd57e(0x2a9)][_0x2615c6][_0xcfd57e(0x295)][_0x57a1bc])_0x2615c6=this[_0xcfd57e(0x2a9)][_0x2615c6][_0xcfd57e(0x295)][_0x57a1bc];else _0x2615c6=-0x1*0x3be+-0xbfd+0xfbb;if(this[_0xcfd57e(0x2a9)][_0x2615c6][_0xcfd57e(0x1e7)]['length'])for(const _0x38fea0 of this['nodes'][_0x2615c6][_0xcfd57e(0x1e7)]){_0x1c4ecb[_0xcfd57e(0x306)]({'keyword':_0x38fea0,'index':_0x360a6c-_0x38fea0[_0xcfd57e(0x232)]+(0xac*0x3+-0x131d+0x111a)});}}return _0x1c4ecb;}}const automatonCache=new Map();async function getAutomatonForChat(_0x1a668e){const _0x4ec6c7=_0x368b49;if(!_0x1a668e)return null;if(automatonCache[_0x4ec6c7(0x272)](_0x1a668e))return automatonCache[_0x4ec6c7(0x322)](_0x1a668e);try{const _0xe30e0a=await db[_0x4ec6c7(0x1a9)](_0x4ec6c7(0x21c)+'TINCT\x20trig'+_0x4ec6c7(0x1cd)+_0x4ec6c7(0x34f)+_0x4ec6c7(0x1fa)+_0x4ec6c7(0x26d)+')',[_0x1a668e,'*']),_0x29bd8f=(_0xe30e0a||[])[_0x4ec6c7(0x1eb)](_0x176119=>String(_0x176119[_0x4ec6c7(0x267)]||'')[_0x4ec6c7(0x34e)]())['filter'](Boolean),_0x5f0b48=_0x29bd8f[_0x4ec6c7(0x2a8)](_0x3bad7c=>{const _0x463c2d=_0x4ec6c7,_0x3f19b1=String(_0x3bad7c)[_0x463c2d(0x34e)]()[_0x463c2d(0x290)+'e']();if(_0x3f19b1['startsWith'](_0x463c2d(0x298)))return![];if(_0x3bad7c[_0x463c2d(0x2dd)]('*'))return![];return!![];}),_0x585a56=_0x5f0b48[_0x4ec6c7(0x1eb)](_0x4f467f=>_0x4f467f[_0x4ec6c7(0x290)+'e']()),_0x266c28=new Map();for(let _0x515330=0x44e+-0x12*-0x1ce+-0x24ca;_0x515330<_0x5f0b48['length'];_0x515330++){_0x266c28[_0x4ec6c7(0x2ca)](_0x585a56[_0x515330],_0x5f0b48[_0x515330]);}const _0x1671e2=new Aho();if(_0x585a56[_0x4ec6c7(0x232)])_0x1671e2[_0x4ec6c7(0x33d)](_0x585a56);const _0x12dcc8={'ac':_0x1671e2,'keywords':_0x585a56,'lowerToOrig':_0x266c28};return automatonCache[_0x4ec6c7(0x2ca)](_0x1a668e,_0x12dcc8),_0x12dcc8;}catch(_0xe80353){return warn('[gfilter]\x20'+_0x4ec6c7(0x1ab)+_0x4ec6c7(0x33c)+_0x4ec6c7(0x311)+'\x20'+_0x1a668e+':\x20'+(_0xe80353?.[_0x4ec6c7(0x2e3)]||_0xe80353)),null;}}async function findStoredMatchFromFindings(_0x265c64=[]){const _0x3632b2=_0x368b49;try{const _0x15fad6=await listSudo();if(!Array[_0x3632b2(0x1a4)](_0x15fad6)||_0x15fad6[_0x3632b2(0x232)]===0x793*0x1+-0x1a65+0x1b6*0xb)return null;const _0x2f850b=new Set(_0x15fad6[_0x3632b2(0x1eb)](String));for(const _0x14dd8c of _0x265c64||[]){if(!_0x14dd8c||typeof _0x14dd8c['jid']!==_0x3632b2(0x26e))continue;const _0x470b93=normalizeToJid(_0x14dd8c[_0x3632b2(0x2c8)]);if(_0x470b93&&_0x2f850b[_0x3632b2(0x272)](_0x470b93))return _0x470b93;if(_0x2f850b['has'](_0x14dd8c[_0x3632b2(0x2c8)]))return _0x14dd8c[_0x3632b2(0x2c8)];const _0x31d2ff=String(_0x14dd8c[_0x3632b2(0x2c8)])['split']('@')[0x4a*0x29+0x1da5+0x1*-0x297f][_0x3632b2(0x2b2)](':')[0x1*0x1a21+0x13e*-0x1a+-0x1*-0x62b];if(_0x31d2ff)for(const _0x203be7 of _0x15fad6){const _0x48a9eb=String(_0x203be7)['split']('@')[0x214*0xe+-0x2464+0x74c];if(_0x48a9eb&&_0x48a9eb===_0x31d2ff)return _0x203be7;}}return null;}catch(_0x5e6f93){return warn(_0x3632b2(0x2e2)+_0x3632b2(0x236)+_0x3632b2(0x2bb)+'indings\x20er'+_0x3632b2(0x313)+(_0x5e6f93?.['message']||_0x5e6f93)),null;}}export async function initialize(_0x32e8ca){const _0xb5ec18=_0x368b49;botRef=_0x32e8ca;if(botRef){if(typeof botRef[_0xb5ec18(0x31a)+'e']==='function')sendApi=async(_0x530747,_0x37af7a)=>await botRef[_0xb5ec18(0x31a)+'e'](_0x530747,_0x37af7a);else botRef[_0xb5ec18(0x1cf)]&&typeof botRef[_0xb5ec18(0x1cf)][_0xb5ec18(0x31a)+'e']===_0xb5ec18(0x34d)?sendApi=async(_0x3f06d2,_0x19bca5)=>await botRef['sock'][_0xb5ec18(0x31a)+'e'](_0x3f06d2,_0x19bca5):sendApi=null;}try{await ensureSchema(),info(_0xb5ec18(0x2e2)+'initialize'+'d\x20(sudo\x20+\x20'+'bot-state\x20'+_0xb5ec18(0x2aa)+')');}catch(_0x36dd0d){error(_0x36dd0d,_0xb5ec18(0x2e2)+_0xb5ec18(0x242)+_0xb5ec18(0x266));throw _0x36dd0d;}}function _0x19a6(_0x4eab18,_0x1b6534){const _0x505aeb=_0xb515();return _0x19a6=function(_0x55df08,_0x1beb5c){_0x55df08=_0x55df08-(-0xd21+0x2481+-0x15c7*0x1);let _0x4ff900=_0x505aeb[_0x55df08];return _0x4ff900;},_0x19a6(_0x4eab18,_0x1b6534);}function detectCommandNameFromCmdText(_0x10bb70){const _0x5bd517=_0x368b49;if(!_0x10bb70)return null;const _0x1541da=_0x10bb70[_0x5bd517(0x34e)]();if(!_0x1541da)return null;return _0x1541da['split'](/\s+/)[-0xca+0x708+0x22*-0x2f][_0x5bd517(0x290)+'e']();}export async function onMessage(_0x3435b4){const _0x38d11f=_0x368b49;try{if(!_0x3435b4||!_0x3435b4[_0x38d11f(0x268)]||!_0x3435b4[_0x38d11f(0x2e3)])return;const _0x1124d5=makeDedupeKey(_0x3435b4);if(!_0x1124d5)return;if(isMsgProcessed(_0x1124d5))return;markMsgProcessed(_0x1124d5);const _0x2520d6=getMessageText(_0x3435b4);if(!_0x2520d6)return;const _0x103d4a=_0x3435b4[_0x38d11f(0x268)][_0x38d11f(0x22e)],_0x3c4dac=typeof _0x103d4a==='string'&&_0x103d4a[_0x38d11f(0x2d7)](_0x38d11f(0x238)),_0x181bbc=_0x3435b4[_0x38d11f(0x268)]&&(_0x3435b4['key'][_0x38d11f(0x34b)+'t']||_0x3435b4[_0x38d11f(0x268)]['from']||_0x3435b4['key']['remoteJid'])||'',_0x3e5f0b=(_0x181bbc||'')['split']('@')[-0x1653+0x2*-0x38d+0x1b*0x117];let _0x5f316d=![];if(_0x3c4dac)try{_0x5f316d=await isadmin(botRef,_0x3435b4);}catch(_0x21f950){_0x5f316d=![];}if(_0x3435b4['isCommand']){const _0xe16120=typeof _0x3435b4[_0x38d11f(0x247)]==='string'&&_0x3435b4[_0x38d11f(0x247)]['trim']()[_0x38d11f(0x232)]?_0x3435b4[_0x38d11f(0x247)][_0x38d11f(0x34e)]():_0x2520d6[_0x38d11f(0x34e)](),_0x36d853=detectCommandNameFromCmdText(_0xe16120);if(!_0x36d853)return;if(!_0x36d853[_0x38d11f(0x34a)]('g'))return;if(!_0x3c4dac){const _0x47dc79=Boolean(_0x3435b4[_0x38d11f(0x268)]['fromMe']);let _0xd393d7=null;if(_0x47dc79){const _0x76350a=getBotJid();!_0x76350a?(warn(_0x38d11f(0x2e2)+_0x38d11f(0x317)+_0x38d11f(0x25d)+_0x38d11f(0x2b6)+_0x38d11f(0x2c6)+_0x38d11f(0x2d5)+_0x38d11f(0x330)+_0x38d11f(0x264)+_0x38d11f(0x2d2)),_0xd393d7=_0x3435b4[_0x38d11f(0x268)][_0x38d11f(0x22e)]):_0xd393d7=_0x76350a;}else{let _0x7b4c37=![];try{_0x7b4c37=await isSudo(botRef,_0x3435b4);}catch(_0x2141b2){_0x7b4c37=![];}if(!_0x7b4c37)return;const _0x456d85=userJidFromCtx(_0x3435b4)||{'findings':[]},_0x2cad80=await findStoredMatchFromFindings(_0x456d85['findings']||[]);if(!_0x2cad80)return;_0xd393d7=_0x2cad80;}const _0x371041=parseFilterCommandText(_0xe16120||_0x2520d6);if(_0x36d853===_0x38d11f(0x249)){if(!_0x371041||!_0x371041[_0x38d11f(0x31e)][_0x38d11f(0x232)]||!_0x371041['responses'][_0x38d11f(0x232)]){await sendText(_0x3435b4,_0xd393d7,_0x38d11f(0x219)+_0x38d11f(0x221)+'default):\x0a'+_0x38d11f(0x31c)+_0x38d11f(0x2ef)+_0x38d11f(0x200)+_0x38d11f(0x2ad)+_0x38d11f(0x293)+_0x38d11f(0x21a)+'y\x20include\x20'+_0x38d11f(0x289)+_0x38d11f(0x1bb)+_0x38d11f(0x34c)+_0x38d11f(0x28f)+_0x38d11f(0x1e9)+_0x38d11f(0x30e));return;}let _0x378d4f=[];if(_0x371041['gp']){const _0x4feca4=_0x371041['gp'][_0x38d11f(0x34e)]();if(_0x4feca4[_0x38d11f(0x290)+'e']()===_0x38d11f(0x1a9))_0x378d4f=await _0x36980f[_0x38d11f(0x1f6)+_0x38d11f(0x250)]();else{const _0x40474c=await _0x36980f[_0x38d11f(0x2a2)+'e'](_0x4feca4);if(_0x40474c)_0x378d4f=[_0x40474c];else{if(_0x4feca4['includes']('@'))_0x378d4f=[_0x36980f[_0x38d11f(0x23b)+_0x38d11f(0x20e)](_0x4feca4)];else{await sendText(_0x3435b4,_0xd393d7,_0x38d11f(0x22a)+_0x38d11f(0x229)+_0x38d11f(0x2e9)+_0x4feca4+(_0x38d11f(0x2c4)+_0x38d11f(0x273)+_0x38d11f(0x233)+_0x38d11f(0x240)+_0x38d11f(0x2a7)+_0x38d11f(0x33a)));return;}}}}else _0x378d4f=['*'];let _0x57ac8c=-0x1037+0x3b*-0x26+0x18f9;for(const _0xaa399d of uniqArray(_0x378d4f)){for(const _0x41f120 of _0x371041[_0x38d11f(0x31e)]){const _0xf50cc=await upsertFilterRow(_0xaa399d,_0x41f120,_0x371041[_0x38d11f(0x246)],_0x181bbc||'');if(_0xf50cc)_0x57ac8c++;}}await sendText(_0x3435b4,_0xd393d7,_0x38d11f(0x329)+_0x57ac8c+('\x20filter(s)'+_0x38d11f(0x2e1))+(_0x378d4f[_0x38d11f(0x232)]===-0x5db+0x1f6e+0x886*-0x3?_0x378d4f[-0x533+0xc2a+-0x6f7]:'multiple\x20t'+_0x38d11f(0x2f5)));return;}if(_0x36d853===_0x38d11f(0x32d)+'r'){const _0x14179b=(parseFilterCommandText(_0xe16120||_0x2520d6)||{})['gp'],_0x5664aa=_0x14179b?_0x14179b[_0x38d11f(0x290)+'e']()===_0x38d11f(0x1a9)?'*':await _0x36980f[_0x38d11f(0x2a2)+'e'](_0x14179b)||_0x36980f[_0x38d11f(0x23b)+_0x38d11f(0x20e)](_0x14179b):'*',_0x31a8d3=await listTriggersForChat(_0x5664aa);await sendText(_0x3435b4,_0xd393d7,_0x38d11f(0x2e2)+_0x31a8d3[_0x38d11f(0x232)]+('\x20filters\x20f'+_0x38d11f(0x32c))+(_0x5664aa==='*'?_0x38d11f(0x297)+_0x38d11f(0x2d9):_0x5664aa));if(!_0x31a8d3[_0x38d11f(0x232)])return;let _0x32916c='';for(const _0x22ce77 of _0x31a8d3){const _0x36011a='â€¢\x20'+_0x22ce77+'\x0a';(_0x32916c+_0x36011a)[_0x38d11f(0x232)]>-0x380*0x7+-0x1ff3+0x3*0x14c5&&(await sendText(_0x3435b4,_0xd393d7,_0x32916c[_0x38d11f(0x34e)]()),_0x32916c=''),_0x32916c+=_0x36011a;}if(_0x32916c[_0x38d11f(0x34e)]())await sendText(_0x3435b4,_0xd393d7,_0x32916c[_0x38d11f(0x34e)]());return;}if(_0x36d853===_0x38d11f(0x2b3)||_0x36d853==='gdelfilter'+'s'||_0x36d853===_0x38d11f(0x256)){const _0x1b188=(_0x2520d6||'')[_0x38d11f(0x2b2)](/\r?\n/)['map'](_0x260f9d=>_0x260f9d['trim']());let _0x5ebcac=null;if(_0x1b188[_0x38d11f(0x232)]>0x55*-0x6f+0x17cb+0x5*0x29d&&!_0x1b188[0x2*0xa9b+-0x1f0b+0x1*0x9d6]['toLowerCas'+'e']()[_0x38d11f(0x34a)]('gp'))_0x5ebcac=_0x1b188[0x167a+0x1e13+-0x4c*0xb1];else{const _0x25100b=_0xe16120['trim']()[_0x38d11f(0x2b2)](/\s+/);_0x25100b['shift'](),_0x5ebcac=_0x25100b['join']('\x20')['trim']();}const _0x2f02d5=_0x1b188[_0x38d11f(0x224)](0x2615+0x97b+-0x2f8f*0x1)[_0x38d11f(0x29b)](_0x5e0636=>/^gp[:\s]/i[_0x38d11f(0x1ec)](_0x5e0636));let _0x37f36b=_0x2f02d5?_0x2f02d5[_0x38d11f(0x1d1)](/^gp[:\s]+/i,'')[_0x38d11f(0x34e)]():null;const _0x1e42c6=(_0x5ebcac||'')[_0x38d11f(0x2b2)](',')['map'](_0x303ca4=>_0x303ca4[_0x38d11f(0x34e)]())[_0x38d11f(0x2a8)](Boolean);if(!_0x1e42c6[_0x38d11f(0x232)]){await sendText(_0x3435b4,_0xd393d7,_0x38d11f(0x1f1)+_0x38d11f(0x1ba)+_0x38d11f(0x1d9)+'1,trigger2'+_0x38d11f(0x23c)+_0x38d11f(0x1ed)+_0x38d11f(0x1ef)+_0x38d11f(0x331)+'l\x20(deletes'+'\x20everythin'+'g\x20globally'+')');return;}if(_0x1e42c6[_0x38d11f(0x232)]===0x9b2*0x1+-0x7aa+0x207*-0x1&&_0x1e42c6[0x1*-0x2ed+-0x1414+-0x27*-0x97][_0x38d11f(0x290)+'e']()===_0x38d11f(0x1a9))try{const _0x1d2bd7=await db[_0x38d11f(0x208)](_0x38d11f(0x296)+'M\x20filters'),_0xe75c82=_0x1d2bd7?.['changes']||0x17*-0x3c+-0x5*0x793+0x2b43;try{automatonCache[_0x38d11f(0x22f)]();}catch(_0x22f09e){}await sendText(_0x3435b4,_0xd393d7,_0x38d11f(0x212)+'L\x20filters\x20'+_0x38d11f(0x258)+_0x38d11f(0x332)+_0x38d11f(0x274)+_0xe75c82);return;}catch(_0xe89c8d){await sendText(_0x3435b4,_0xd393d7,'Failed\x20to\x20'+_0x38d11f(0x20a)+_0x38d11f(0x315)+(_0xe89c8d?.[_0x38d11f(0x2e3)]||_0xe89c8d));return;}let _0x52012e=[];if(_0x37f36b){if(_0x37f36b['toLowerCas'+'e']()===_0x38d11f(0x1a9))_0x52012e=await _0x36980f[_0x38d11f(0x1f6)+_0x38d11f(0x250)]();else{const _0x8efd0e=await _0x36980f['resolveNam'+'e'](_0x37f36b);if(_0x8efd0e)_0x52012e=[_0x8efd0e];else{if(_0x37f36b['includes']('@'))_0x52012e=[_0x36980f['normalizeT'+_0x38d11f(0x20e)](_0x37f36b)];else{await sendText(_0x3435b4,_0xd393d7,_0x38d11f(0x22a)+_0x38d11f(0x229)+_0x38d11f(0x2e9)+_0x37f36b+'\x22.');return;}}}}else _0x52012e=['*'];let _0x9273f7=0x1*0x1919+0xf1*-0x1d+0xbc*0x3;for(const _0x25c745 of uniqArray(_0x52012e)){const _0x180cc6=await deleteFilters(_0x25c745,_0x1e42c6);_0x9273f7+=_0x180cc6;}await sendText(_0x3435b4,_0xd393d7,'Deleted\x20'+_0x9273f7+(_0x38d11f(0x353)+_0x38d11f(0x2f1)+'\x20')+(_0x52012e['length']===0xc*-0xe1+0x1dfe+-0x1371?_0x52012e[0x18e3+-0x1744+-0x19f]:_0x38d11f(0x2e5)+_0x38d11f(0x2f5)));return;}return;}if(_0x3c4dac){if(!_0x5f316d)return;const _0x25f5a9=typeof _0x3435b4['text']===_0x38d11f(0x26e)&&_0x3435b4[_0x38d11f(0x247)][_0x38d11f(0x34e)]()[_0x38d11f(0x232)]?_0x3435b4['text'][_0x38d11f(0x34e)]():_0x2520d6[_0x38d11f(0x34e)](),_0x3c4f0c=detectCommandNameFromCmdText(_0x25f5a9);if(!_0x3c4f0c)return;let _0x509a64;try{_0x509a64=await getDefault(_0x3e5f0b)[_0x38d11f(0x1cc)](()=>null);}catch(_0x44ad98){_0x509a64=null;}if(!_0x509a64||Array[_0x38d11f(0x1a4)](_0x509a64)&&_0x509a64[_0x38d11f(0x232)]===0x6a9+0x819+-0xec2){await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x1aa)+_0x38d11f(0x226)+_0x38d11f(0x205)+'\x20connectio'+_0x38d11f(0x328)+_0x38d11f(0x27a)+_0x38d11f(0x31d));return;}const _0x5087fc=Array[_0x38d11f(0x1a4)](_0x509a64)?_0x509a64:[_0x509a64];let _0x3d1511=[];for(const _0x29825d of _0x5087fc){try{const _0x5d9de7=await getConnection(_0x29825d)[_0x38d11f(0x1cc)](()=>null);if(Array['isArray'](_0x5d9de7))_0x3d1511['push'](..._0x5d9de7);else{if(_0x5d9de7)_0x3d1511[_0x38d11f(0x306)](String(_0x5d9de7));}}catch(_0x2f5744){}}_0x3d1511=uniqArray(_0x3d1511);if(!_0x3d1511[_0x38d11f(0x232)]){await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x1aa)+_0x38d11f(0x226)+_0x38d11f(0x205)+_0x38d11f(0x2a6)+'n(s):\x20'+_0x5087fc[_0x38d11f(0x1d4)](',\x20')+(_0x38d11f(0x292)+_0x38d11f(0x2b1)+_0x38d11f(0x269)+'ue(s).'));return;}if(_0x3c4f0c===_0x38d11f(0x249)){const _0x429804=parseFilterCommandText(_0x25f5a9||_0x2520d6);if(!_0x429804||!_0x429804[_0x38d11f(0x31e)][_0x38d11f(0x232)]||!_0x429804['responses'][_0x38d11f(0x232)]){await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x248)+_0x38d11f(0x235)+_0x38d11f(0x1c6)+_0x38d11f(0x2d3)+'trigger2>\x0a'+'!response1'+_0x38d11f(0x335)+'2\x0aOptional'+_0x38d11f(0x354)+_0x38d11f(0x1d8)+_0x38d11f(0x2ab)+_0x38d11f(0x28a));return;}if(_0x429804['gp']){let _0xd69a9a=[];const _0x15e779=_0x429804['gp']['trim']();if(_0x15e779[_0x38d11f(0x290)+'e']()===_0x38d11f(0x1a9))_0xd69a9a=await _0x36980f[_0x38d11f(0x1f6)+_0x38d11f(0x250)]();else{const _0x514bd1=await _0x36980f[_0x38d11f(0x2a2)+'e'](_0x15e779);if(_0x514bd1)_0xd69a9a=[_0x514bd1];else{if(_0x15e779['includes']('@'))_0xd69a9a=[_0x36980f[_0x38d11f(0x23b)+_0x38d11f(0x20e)](_0x15e779)];else{await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x22a)+_0x38d11f(0x229)+_0x38d11f(0x2e9)+_0x15e779+'\x22.');return;}}}let _0x70f567=0x4f9+0x5*0x3e1+-0x185e;for(const _0x50a89e of uniqArray(_0xd69a9a)){for(const _0x3e71fd of _0x429804[_0x38d11f(0x31e)]){const _0x182d90=await upsertFilterRow(_0x50a89e,_0x3e71fd,_0x429804[_0x38d11f(0x246)],_0x181bbc||'');if(_0x182d90)_0x70f567++;}}await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x329)+_0x70f567+(_0x38d11f(0x25e)+'\x20to\x20')+(_0xd69a9a['length']===-0x130b+0x4d0+0xe3c?_0xd69a9a[0x1*-0x139d+-0x1c43*0x1+0x2fe0]:'multiple\x20t'+_0x38d11f(0x2f5)));return;}let _0x2e4c41=0x2f*0xca+-0x65a+0x7*-0x464;for(const _0x4c39cc of _0x3d1511){for(const _0x37cf10 of _0x429804['triggers']){const _0x579394=await upsertFilterRow(_0x4c39cc,_0x37cf10,_0x429804['responses'],_0x181bbc||'');if(_0x579394)_0x2e4c41++;}}await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x329)+_0x2e4c41+(_0x38d11f(0x353)+'tries\x20to\x20y'+'our\x20defaul'+_0x38d11f(0x33e)+_0x38d11f(0x1a2))+_0x3d1511[_0x38d11f(0x1d4)](',\x20'));return;}if(_0x3c4f0c===_0x38d11f(0x32d)+'r'){const _0x47fa05=new Set();for(const _0x23ffca of _0x3d1511){const _0xcec65c=await listTriggersForChat(_0x23ffca);for(const _0x8635e2 of _0xcec65c)_0x47fa05[_0x38d11f(0x1bc)](_0x8635e2);}const _0xc78ab8=await listTriggersForChat('*');for(const _0xc4a648 of _0xc78ab8||[])_0x47fa05[_0x38d11f(0x1bc)](_0xc4a648);const _0x41eb03=Array['from'](_0x47fa05)[_0x38d11f(0x32e)]();await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x2e2)+_0x38d11f(0x1e6)+_0x41eb03[_0x38d11f(0x232)]+(_0x38d11f(0x2c0)+'or\x20your\x20de'+'fault\x20conn'+_0x38d11f(0x29e)+_0x38d11f(0x27e)));if(!_0x41eb03['length'])return;let _0x4aa0e5='';for(const _0x332443 of _0x41eb03){const _0xfdaed6='â€¢\x20'+_0x332443+'\x0a';(_0x4aa0e5+_0xfdaed6)[_0x38d11f(0x232)]>0x17e2+0xb*-0x17+-0x7*0x26f&&(await sendText(_0x3435b4,_0x103d4a,_0x4aa0e5[_0x38d11f(0x34e)]()),_0x4aa0e5=''),_0x4aa0e5+=_0xfdaed6;}if(_0x4aa0e5[_0x38d11f(0x34e)]())await sendText(_0x3435b4,_0x103d4a,_0x4aa0e5[_0x38d11f(0x34e)]());return;}if(_0x3c4f0c==='gdelfilter'||_0x3c4f0c===_0x38d11f(0x2b3)+'s'||_0x3c4f0c===_0x38d11f(0x256)){const _0x38eeea=(_0x2520d6||'')[_0x38d11f(0x2b2)](/\r?\n/)[_0x38d11f(0x1eb)](_0x114fd9=>_0x114fd9[_0x38d11f(0x34e)]());let _0x5a5374=null;if(_0x38eeea[_0x38d11f(0x232)]>0x56c+0x166c+-0x1bd7&&!_0x38eeea[-0x11ed+0x747+0xaa7][_0x38d11f(0x290)+'e']()['startsWith']('gp'))_0x5a5374=_0x38eeea[-0x3*-0x3d7+0xbf7+-0x177b];else{const _0x4ff57b=(_0x25f5a9||_0x2520d6)[_0x38d11f(0x34e)]()[_0x38d11f(0x2b2)](/\s+/);_0x4ff57b[_0x38d11f(0x1c8)](),_0x5a5374=_0x4ff57b[_0x38d11f(0x1d4)]('\x20')[_0x38d11f(0x34e)]();}const _0x71aefd=_0x38eeea[_0x38d11f(0x224)](0x1fcd+0x1f6+-0x3a*0x95)[_0x38d11f(0x29b)](_0x453887=>/^gp[:\s]/i[_0x38d11f(0x1ec)](_0x453887));let _0x1dfbea=_0x71aefd?_0x71aefd['replace'](/^gp[:\s]+/i,'')[_0x38d11f(0x34e)]():null;const _0x5313bd=(_0x5a5374||'')[_0x38d11f(0x2b2)](',')[_0x38d11f(0x1eb)](_0x165ed6=>_0x165ed6[_0x38d11f(0x34e)]())[_0x38d11f(0x2a8)](Boolean);if(!_0x5313bd[_0x38d11f(0x232)]){await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x2e0)+_0x38d11f(0x2dc)+_0x38d11f(0x28c)+_0x38d11f(0x225)+_0x38d11f(0x2ce)+'d|alias|al'+'l>]\x0aOr:\x20gd'+_0x38d11f(0x1de)+_0x38d11f(0x237)+_0x38d11f(0x26f)+_0x38d11f(0x204)+_0x38d11f(0x261));return;}if(_0x5313bd['length']===0x16cc*0x1+-0x1a5f+-0x394*-0x1&&_0x5313bd[-0x19e3+-0x244a*-0x1+-0xa67][_0x38d11f(0x290)+'e']()===_0x38d11f(0x1a9))try{const _0x27f807=await db[_0x38d11f(0x208)]('DELETE\x20FRO'+_0x38d11f(0x28d)),_0x363d7e=_0x27f807?.[_0x38d11f(0x1bd)]||-0xf*-0x1bb+-0x4f*-0x53+0x17*-0x23e;try{automatonCache[_0x38d11f(0x22f)]();}catch(_0x4bb884){}await sendText(_0x3435b4,_0x103d4a,'Deleted\x20AL'+_0x38d11f(0x2b9)+_0x38d11f(0x258)+_0x38d11f(0x332)+_0x38d11f(0x274)+_0x363d7e);return;}catch(_0x414fd9){await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x255)+_0x38d11f(0x20a)+_0x38d11f(0x315)+(_0x414fd9?.[_0x38d11f(0x2e3)]||_0x414fd9));return;}if(_0x1dfbea){let _0x470523=[];if(_0x1dfbea['toLowerCas'+'e']()==='all')_0x470523=await _0x36980f[_0x38d11f(0x1f6)+'ids']();else{const _0x87a8fa=await _0x36980f[_0x38d11f(0x2a2)+'e'](_0x1dfbea);if(_0x87a8fa)_0x470523=[_0x87a8fa];else{if(_0x1dfbea[_0x38d11f(0x2dd)]('@'))_0x470523=[_0x36980f[_0x38d11f(0x23b)+_0x38d11f(0x20e)](_0x1dfbea)];else{await sendText(_0x3435b4,_0x103d4a,'Unknown\x20gp'+_0x38d11f(0x229)+_0x38d11f(0x2e9)+_0x1dfbea+'\x22.');return;}}}let _0x414006=-0xb39*-0x2+0x2*0xb53+-0x2d18;for(const _0x4b512a of uniqArray(_0x470523)){const _0x4914c7=await deleteFilters(_0x4b512a,_0x5313bd);_0x414006+=_0x4914c7;}await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x285)+_0x414006+(_0x38d11f(0x2c0)+'rom\x20')+(_0x470523['length']===0x14ed*-0x1+0x309*-0x5+0x241b?_0x470523[-0x1*0x1105+-0x2426*0x1+-0xd*-0x417]:_0x38d11f(0x2e5)+_0x38d11f(0x2f5)));return;}else{let _0x5649e0=0xae6*0x3+-0x45*0x8+-0x1e8a;for(const _0x4b847f of _0x3d1511){const _0x3ecc5b=await deleteFilters(_0x4b847f,_0x5313bd);_0x5649e0+=_0x3ecc5b;}await sendText(_0x3435b4,_0x103d4a,_0x38d11f(0x285)+_0x5649e0+(_0x38d11f(0x353)+'tries\x20acro'+_0x38d11f(0x1c9)+_0x38d11f(0x319)+'ection(s):'+'\x20')+_0x3d1511[_0x38d11f(0x1d4)](',\x20'));return;}}return;}}if(_0x3c4dac){if(_0x3435b4[_0x38d11f(0x268)][_0x38d11f(0x29f)])return;const _0x2704bf=_0x103d4a,_0x40154a=getMessageText(_0x3435b4);if(!_0x40154a)return;const _0x4e0b17=String(_0x40154a||''),_0x4f85de=await db[_0x38d11f(0x1a9)]('SELECT\x20DIS'+'TINCT\x20trig'+'ger\x20FROM\x20f'+'ilters\x20WHE'+_0x38d11f(0x1fa)+_0x38d11f(0x26d)+')',[_0x2704bf,'*']);if(!_0x4f85de||_0x4f85de[_0x38d11f(0x232)]===0x1a11+0x283+-0x1c94)return;const _0x10fe08=(_0x4f85de||[])[_0x38d11f(0x1eb)](_0x304d7f=>String(_0x304d7f[_0x38d11f(0x267)]||'')[_0x38d11f(0x34e)]())[_0x38d11f(0x2a8)](Boolean),_0x4e6417=[],_0x133289=[],_0x302d6a=[];for(const _0x228b22 of _0x10fe08){const _0x5b7e5c=String(_0x228b22)[_0x38d11f(0x34e)]()['toLowerCas'+'e']();if(_0x5b7e5c['startsWith']('regex:')){_0x302d6a[_0x38d11f(0x306)](_0x228b22[_0x38d11f(0x1d7)](-0x5f8+0x148f+-0xe91));continue;}if(_0x228b22[_0x38d11f(0x2dd)]('*')){_0x133289[_0x38d11f(0x306)](_0x228b22);continue;}_0x4e6417[_0x38d11f(0x306)](_0x228b22);}const _0x1ab542=new Set(),_0xc78ae8=getConfig()||{},_0xc63a9a=_0xc78ae8[_0x38d11f(0x202)]&&typeof _0xc78ae8[_0x38d11f(0x202)]===_0x38d11f(0x24b)?_0xc78ae8[_0x38d11f(0x202)]:{},_0x449919=(_0xc63a9a[_0x38d11f(0x323)+_0x38d11f(0x23f)]||'roundrobin')[_0x38d11f(0x290)+'e']();let _0x450f06=null;if(_0x4e6417[_0x38d11f(0x232)]>0xcb6+-0x1271+0x5bb)try{const _0x71056c=await getAutomatonForChat(_0x2704bf);if(_0x71056c&&_0x71056c['ac']&&_0x71056c[_0x38d11f(0x241)]&&_0x71056c[_0x38d11f(0x241)][_0x38d11f(0x232)]){const _0x3f6d36=_0x4e0b17['toLowerCas'+'e'](),_0x12218a=_0x71056c['ac'][_0x38d11f(0x33b)](_0x3f6d36);for(const _0x8502f of _0x12218a){const _0x53e74e=_0x8502f[_0x38d11f(0x20d)],_0x29a260=_0x8502f['index'],_0x219b53=_0x29a260+_0x53e74e[_0x38d11f(0x232)],_0x4c5ad3=_0x29a260===0x1ed*-0x7+0x1fbd+-0x1242||!/\w/[_0x38d11f(0x1ec)](_0x3f6d36[_0x29a260-(-0xcd6+-0x2309*-0x1+-0x1632)]),_0x1809bb=_0x219b53===_0x3f6d36[_0x38d11f(0x232)]||!/\w/[_0x38d11f(0x1ec)](_0x3f6d36[_0x219b53]);if(_0x4c5ad3&&_0x1809bb){const _0x46e7ec=_0x71056c[_0x38d11f(0x29c)+'g'][_0x38d11f(0x322)](_0x53e74e)||null;if(_0x46e7ec){_0x450f06=_0x46e7ec;break;}}}}else for(const _0x4e0e1e of _0x4e6417){const _0x32c789=new RegExp('\x5cb'+escapeRegex(String(_0x4e0e1e))+'\x5cb','i');if(_0x32c789[_0x38d11f(0x1ec)](_0x4e0b17)){_0x450f06=_0x4e0e1e;break;}}}catch(_0x12eda3){warn('[gfilter]\x20'+_0x38d11f(0x2d8)+_0x38d11f(0x1ad)+_0x38d11f(0x21b)+(_0x12eda3?.['message']||_0x12eda3));for(const _0x39194a of _0x4e6417){try{const _0x485f13=new RegExp('\x5cb'+escapeRegex(String(_0x39194a))+'\x5cb','i');if(_0x485f13[_0x38d11f(0x1ec)](_0x4e0b17)){_0x450f06=_0x39194a;break;}}catch(_0x41414c){}}}if(!_0x450f06&&_0x133289[_0x38d11f(0x232)]>-0x13b5+-0x58+0x3*0x6af)for(const _0x53e22c of _0x133289){try{const _0x4ce9b3=new RegExp(wildcardToRegexPattern(_0x53e22c),'i');if(_0x4ce9b3[_0x38d11f(0x1ec)](_0x4e0b17)){_0x450f06=_0x53e22c;break;}}catch(_0x20b76f){if(_0x4e0b17[_0x38d11f(0x290)+'e']()[_0x38d11f(0x2dd)](_0x53e22c['replace'](/\*/g,'')[_0x38d11f(0x290)+'e']())){_0x450f06=_0x53e22c;break;}}}if(!_0x450f06&&_0x302d6a[_0x38d11f(0x232)]>0x251f+-0x97f+-0x1ba0)for(const _0x44c140 of _0x302d6a){try{const _0x5a4d83=new RegExp(_0x44c140,'i');if(_0x5a4d83[_0x38d11f(0x1ec)](_0x4e0b17)){_0x450f06=_0x38d11f(0x298)+_0x44c140;break;}}catch(_0x759051){warn('[gfilter]\x20'+_0x38d11f(0x2f7)+'ored\x20regex'+_0x38d11f(0x2af)+_0x2704bf+':\x20\x22'+_0x44c140+_0x38d11f(0x1a0)+(_0x759051?.['message']||_0x759051));}}if(_0x450f06){let _0x4bfafb=await pickResponseAndAdvance(_0x2704bf,_0x450f06,_0x449919);if(!_0x4bfafb)_0x4bfafb=await pickResponseAndAdvance('*',_0x450f06,_0x449919);if(!_0x4bfafb)return;if(_0x1ab542['has'](_0x4bfafb))return;await sendText(_0x3435b4,_0x2704bf,_0x4bfafb),_0x1ab542['add'](_0x4bfafb);}}}catch(_0xbf0bbf){error(_0xbf0bbf,_0x38d11f(0x2e2)+_0x38d11f(0x316)+_0x38d11f(0x313)+(_0xbf0bbf?.[_0x38d11f(0x2e3)]||_0xbf0bbf));}}export async function cleanup(){const _0xa81cd2=_0x368b49;for(const _0xc1fdc9 of processedMessageKeys[_0xa81cd2(0x2e7)]())try{clearTimeout(_0xc1fdc9);}catch(_0x2c8db2){}processedMessageKeys[_0xa81cd2(0x22f)](),automatonCache[_0xa81cd2(0x22f)](),botRef=null,sendApi=null,info('[gfilter]\x20'+_0xa81cd2(0x318));}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};