const _0xbbc231=_0x5f15;(function(_0x462bbf,_0x2a277b){const _0x450bec=_0x5f15,_0x4cf741=_0x462bbf();while(!![]){try{const _0x430535=parseInt(_0x450bec(0x2db))/(-0x1*-0x1213+0x1*-0x2c5+-0xf4d*0x1)+-parseInt(_0x450bec(0x1d2))/(0x2572+0x1c57+-0x74f*0x9)*(-parseInt(_0x450bec(0x29c))/(-0x17*-0xb+0x1047+-0x1*0x1141))+parseInt(_0x450bec(0x1e3))/(-0xdf*0x1a+0x2*0x5cf+-0xca*-0xe)+parseInt(_0x450bec(0x295))/(0x75*0x21+-0x1f*0xc7+0x909)*(parseInt(_0x450bec(0x1b4))/(0x238a*0x1+-0x33d*0x1+0x2047*-0x1))+parseInt(_0x450bec(0x2d8))/(-0x4*-0xc1+0x2f*-0x63+0xf30)+parseInt(_0x450bec(0x2c4))/(0x2*0x9df+-0x2043+-0x3*-0x42f)*(parseInt(_0x450bec(0x23a))/(0x17bb+-0xad*0x7+-0x12f7))+-parseInt(_0x450bec(0x210))/(0x16a6+0x1843*-0x1+0x1a7)*(parseInt(_0x450bec(0x260))/(-0x7*0x3fd+-0x1f7d+0x13d1*0x3));if(_0x430535===_0x2a277b)break;else _0x4cf741['push'](_0x4cf741['shift']());}catch(_0x302041){_0x4cf741['push'](_0x4cf741['shift']());}}}(_0x344d,0x1589*-0x83+-0x1*0xc5875+-0x6f5a1*-0x5));import{getConfig}from'../utils/config.js';import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{getDefault,getConnection}from'../utils/connection.js';import{isadmin}from'../utils/isadmin.js';import*as _0xf674dc from'../utils/groups.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';export const name='gfilter';export const version='2.2.0';export const priority=-0x2474+-0x3*0x153+0x28e5;export const configKeys=[_0xbbc231(0x196)];export const commands=['gfilter',_0xbbc231(0x1ff)+'r','gdelfilter','gdelfilter'+'s','gdelf'];function clampTypingMs(_0xa8a6dd){const _0x213887=_0xbbc231,_0x5e9b74=Number(_0xa8a6dd);if(!Number[_0x213887(0x293)](_0x5e9b74)||isNaN(_0x5e9b74))return 0x1a18+-0xe29+-0x1*0xbef;if(_0x5e9b74<=-0x7bd+0x2*-0x732+0x1621)return 0x4e3*-0x5+-0xc*-0x2db+-0x9d5;if(_0x5e9b74>0x1*0x1cef+0x1*-0x1129+-0x2*-0x1769)return-0x526*-0x7+-0x6c8a+0x8318;return Math[_0x213887(0x1fc)](_0x5e9b74);}function sleep(_0x101b79){return new Promise(_0xa77371=>setTimeout(_0xa77371,_0x101b79));}async function simulateTypingAndWait(_0x5981c1,_0x333599,_0x65c2f5){const _0x4af095=_0xbbc231;if(!_0x65c2f5||_0x65c2f5<=-0xa1*-0x10+-0x22*0x7f+0x367*0x2)return;try{if(_0x5981c1&&typeof _0x5981c1[_0x4af095(0x16d)+_0x4af095(0x14b)]===_0x4af095(0x23e))try{await _0x5981c1['sendPresen'+'ceUpdate'](_0x4af095(0x193),_0x333599);}catch(_0x2b0950){}}catch(_0x196098){}try{await sleep(_0x65c2f5);}catch(_0x5e0cb1){}try{if(_0x5981c1&&typeof _0x5981c1[_0x4af095(0x16d)+_0x4af095(0x14b)]===_0x4af095(0x23e))try{await _0x5981c1[_0x4af095(0x16d)+'ceUpdate']('paused',_0x333599);}catch(_0x4285dd){}}catch(_0x28fd5c){}}function ensureArray(_0x114f77){if(!_0x114f77)return[];if(Array['isArray'](_0x114f77))return _0x114f77;return[String(_0x114f77)];}function uniqArray(_0x1335a2){const _0x4e3db3=_0xbbc231,_0x40abc4=new Set(),_0x453b32=[];for(const _0x56395f of _0x1335a2){const _0x2f5acb=String(_0x56395f||'')[_0x4e3db3(0x2ea)]();if(!_0x2f5acb)continue;!_0x40abc4['has'](_0x2f5acb)&&(_0x40abc4[_0x4e3db3(0x2ca)](_0x2f5acb),_0x453b32[_0x4e3db3(0x183)](_0x2f5acb));}return _0x453b32;}function _0x5f15(_0x2da163,_0x2ac69c){const _0x4f4b9c=_0x344d();return _0x5f15=function(_0x12f4ca,_0x332438){_0x12f4ca=_0x12f4ca-(0x6fa+-0x106*0x25+0x2023);let _0x2ad66a=_0x4f4b9c[_0x12f4ca];return _0x2ad66a;},_0x5f15(_0x2da163,_0x2ac69c);}function escapeRegex(_0x3b4abf){return _0x3b4abf['replace'](/[.*+?^${}()|[\]\\]/g,'\x5c$&');}function wildcardToRegexPattern(_0x2911af){const _0x41d79c=_0xbbc231,_0x4f487a=_0x2911af[_0x41d79c(0x28f)]('*')[_0x41d79c(0x2d7)](_0x2aa5e9=>escapeRegex(_0x2aa5e9));return'\x5cb'+_0x4f487a['join'](_0x41d79c(0x14f))+'\x5cb';}function clampConfigTypingMs(){const _0x1806c2=_0xbbc231;try{const _0x2e7070=getConfig()||{},_0x1b6eb7=_0x2e7070[_0x1806c2(0x196)]&&typeof _0x2e7070[_0x1806c2(0x196)]==='object'?_0x2e7070[_0x1806c2(0x196)]:{};return clampTypingMs(_0x1b6eb7[_0x1806c2(0x24d)+'_MS']);}catch(_0x572c66){return 0x89*-0x2a+0x3*-0xc6e+0x3bc4;}}let botRef=null,sendApi=null;async function sendText(_0x1ce6e8,_0xbda612,_0x171e42,_0x2fb2b0){const _0x3f45a3=_0xbbc231;let _0x2f6b7c=null,_0x578656=null,_0x1323b3=null,_0x37f878=[];_0x1ce6e8&&typeof _0x1ce6e8===_0x3f45a3(0x218)&&_0x1ce6e8[_0x3f45a3(0x1b8)]&&_0x1ce6e8[_0x3f45a3(0x2f8)]?(_0x2f6b7c=_0x1ce6e8,_0x578656=_0xbda612,_0x1323b3=_0x171e42,_0x37f878=Array[_0x3f45a3(0x18c)](_0x2fb2b0)?_0x2fb2b0:[]):(_0x578656=_0x1ce6e8,_0x1323b3=_0xbda612,_0x37f878=Array[_0x3f45a3(0x18c)](_0x171e42)?_0x171e42:[]);if(!_0x1323b3)return;if(!_0x578656){warn(_0x3f45a3(0x17e)+_0x3f45a3(0x2d6)+_0x3f45a3(0x208)+_0x3f45a3(0x147)+_0x3f45a3(0x22e));return;}const _0xfeca71={'text':String(_0x1323b3)};if(Array[_0x3f45a3(0x18c)](_0x37f878)&&_0x37f878[_0x3f45a3(0x21e)])_0xfeca71[_0x3f45a3(0x1d7)]=_0x37f878;try{if(!sendApi){warn(_0x3f45a3(0x17e)+'no\x20sendApi'+_0x3f45a3(0x28e));return;}const _0x87c3d9=clampConfigTypingMs();if(_0x87c3d9>-0x1*0x17c7+-0x1*0x205f+-0x3826*-0x1)try{await simulateTypingAndWait(botRef?.[_0x3f45a3(0x21b)],_0x578656,_0x87c3d9);}catch(_0x418b24){warn(_0x3f45a3(0x17e)+_0x3f45a3(0x1af)+_0x3f45a3(0x2ab)+_0x3f45a3(0x16f)+(_0x418b24?.[_0x3f45a3(0x2f8)]||_0x418b24));}if(_0x2f6b7c&&typeof _0x2f6b7c[_0x3f45a3(0x2b1)]===_0x3f45a3(0x23e))try{await _0x2f6b7c['reply']({'text':String(_0x1323b3),'mentions':_0xfeca71['mentions']||[]});return;}catch(_0x267c06){try{await sendApi(_0x578656,_0xfeca71);return;}catch(_0x42bec6){warn(_0x3f45a3(0x17e)+_0x3f45a3(0x2d4)+_0x3f45a3(0x1be)+_0x3f45a3(0x2ac)+_0x3f45a3(0x294)+_0x3f45a3(0x157)+':\x20'+(_0x42bec6?.[_0x3f45a3(0x2f8)]||_0x42bec6));return;}}try{await sendApi(_0x578656,_0xfeca71);}catch(_0x5571a4){warn('[gfilter]\x20'+'sendText\x20f'+'ailed\x20to\x20'+_0x578656+':\x20'+(_0x5571a4?.[_0x3f45a3(0x2f8)]||_0x5571a4));}}catch(_0x188a38){warn('[gfilter]\x20'+_0x3f45a3(0x285)+_0x3f45a3(0x1b6)+_0x3f45a3(0x213)+(_0x188a38?.['message']||_0x188a38));}}async function tableExists(_0x1a87f3){const _0x18e30c=_0xbbc231;try{const _0x817b74=await db[_0x18e30c(0x28d)]('SELECT\x20nam'+_0x18e30c(0x2b2)+_0x18e30c(0x25d)+_0x18e30c(0x290)+_0x18e30c(0x203)+_0x18e30c(0x1a9),[_0x1a87f3]);return!!_0x817b74;}catch(_0x43d396){return warn(_0x18e30c(0x17e)+'tableExist'+_0x18e30c(0x26c)+(_0x43d396?.[_0x18e30c(0x2f8)]||_0x43d396)),![];}}async function getTableColumns(_0x22d7a2){const _0x3511dc=_0xbbc231;try{const _0x3d9e65=await db[_0x3511dc(0x1ef)](_0x3511dc(0x184)+_0x3511dc(0x215)+_0x22d7a2+')');return(_0x3d9e65||[])[_0x3511dc(0x2d7)](_0x458083=>_0x458083[_0x3511dc(0x273)]);}catch(_0x3ccc1f){return warn('[gfilter]\x20'+_0x3511dc(0x191)+_0x3511dc(0x22b)+_0x3511dc(0x14c)+_0x22d7a2+':\x20'+(_0x3ccc1f?.[_0x3511dc(0x2f8)]||_0x3ccc1f)),[];}}function resolveChatJidFromRow(_0x3cec49){const _0x53f92f=_0xbbc231,_0x1f52f6=[_0x53f92f(0x27f),'chatid',_0x53f92f(0x161),'jid',_0x53f92f(0x1f2),_0x53f92f(0x246)];for(const _0x4c0498 of _0x1f52f6)if(_0x4c0498 in _0x3cec49&&_0x3cec49[_0x4c0498])return String(_0x3cec49[_0x4c0498]);for(const _0x484c02 of Object[_0x53f92f(0x2e5)](_0x3cec49)){const _0x274cae=_0x3cec49[_0x484c02];if(typeof _0x274cae==='string'&&_0x274cae['includes']('@'))return _0x274cae;}return null;}function resolveTriggerFromRow(_0x41d4db){const _0x2749a4=_0xbbc231,_0x134b95=[_0x2749a4(0x249),'trig',_0x2749a4(0x27d),_0x2749a4(0x19d),_0x2749a4(0x288)];for(const _0x145d25 of _0x134b95)if(_0x145d25 in _0x41d4db&&_0x41d4db[_0x145d25])return String(_0x41d4db[_0x145d25]);for(const _0x57bf08 of Object[_0x2749a4(0x2e5)](_0x41d4db)){const _0x2891eb=_0x41d4db[_0x57bf08];if(typeof _0x2891eb===_0x2749a4(0x253)&&!_0x2891eb['includes']('@')&&_0x2891eb[_0x2749a4(0x21e)]<-0x4*-0x2b3+-0x7*0x40d+0x12bb)return _0x2891eb;}return null;}function _0x344d(){const _0x15cb3d=['FAULT\x200','FILTERS','wId','T\x20NULL,\x0a\x20\x20','responses','imageMessa','rigger2>\x0a!','L\x20DEFAULT\x20','word','Deleted\x20','d\x20(sudo\x20+\x20','\x20\x20UNIQUE(c','NFLICT(cha','xcluded.cr','\x20first.','find','er\x20failed\x20','responses,','rom\x20','er,\x20chat_j','AND\x20name=?','\x20filters\x20f','r);','ias\x20or\x20pas','ex\x20INTEGER','gger)\x20DO\x20U','simulateTy','irmation','elfilter\x20a','ailed:\x20','\x20<group-ji','6lpqFqY','\x20empty;\x20fa','nexpected\x20','.\x20Please\x20c','key','ODE','umn\x20','y\x20include\x20','ttonId','malized\x20ro','are\x20send\x20a','concat','efault\x20val','IF\x20NOT\x20EXI','eign_keys\x20','PRAGMA\x20for','filters','ilters\x20WHE','\x20to\x20ctx.ke','d\x20IN\x20(?,\x20?','\x20[gp:\x20<ali','\x20\x20\x20\x20\x20ON\x20CO','sendMessag','igger1,tri','finalize','ters\x20from\x20','ted_at\x20INT','prepare','values','ection(s)\x20','465644azJcht','filter','t\x20connecti','value','delete\x20all','mentions','ase.\x20Rows\x20','esponses\x20=','RESPONSE_M','xtMessage','y.remoteJi','(trigger,\x20','replies','creator','a\x20line\x20`gp','M\x20filters','singleSele','767620RZNtJL','ce\x20error:\x20','Y\x20AUTOINCR','regex:','fail','\x27[]\x27,\x0a\x20\x20\x20\x20','\x0a!response','\x20=\x20?','completed;','onical\x20sch','saved\x20filt','unique\x20idx','all','response','response1\x0a','chat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','rsForChat\x20','insert\x20nor','(rr_index\x20','ckup_','\x20renamed\x20t','o\x20restrict','from','\x20filter\x20en','floor','CREATE\x20UNI','\x20to\x20','glistfilte','L\x20filters\x20','\x20@\x20','l\x20(deletes','e=\x27table\x27\x20','k\x20matching','<trigger1,','n(s):\x20','\x22\x20-\x20','alled\x20with','and\x20GLOBAL','ENT','hat\x20ON\x20fil','l\x20groups)','ters\x20SET\x20r','shift','fault\x20conn','10RUuiGm','ULL\x20DEFAUL','create','error:\x20','\x20\x20\x20\x20rr_ind','le_info(','\x20TO\x20filter','TINCT\x20trig','object','>]\x0aOr:\x20gde','PDATE\x20SET\x0a','sock','or\x20','\x20old\x20table','length','ids','\x20to\x20add\x20al','multiple\x20t','catch','w\x20filters\x20','ed_by,\x20cre','sort','LT\x200,\x0a\x20\x20\x20\x20','ID.','for\x20','seMessage','s|all>','lumns\x20erro','Handler\x20er','\x20detected\x20','Jid','\x20filter(s)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20i','\x20\x20\x20created','rigger)\x0a\x20\x20','includes','argets','parse','ULT\x20\x27\x27,\x0a\x20\x20','igger\x20=\x20?','ups\x20helper','index','1445256NZDeef','join','EX\x20IF\x20NOT\x20','buttonsRes','function','run','or\x20your\x20de','lters_uniq','\x20\x20\x20\x20\x20trigg','ponseMessa','d\x20for\x20conf','ponses,\x20rr','room','jid','from\x20datab','trigger','filters_ba','M\x20filters\x20','gger2\x20[gp:','TYPING_SIM','MatchFromF','UPDATE\x20fil','trigger1,t','slice','extendedTe','string','rr_index\x20=','\x20\x20\x20\x20\x20\x20\x20\x20\x20r','selectedBu','exec','ALUES\x20(?,\x20','LT\x20\x27\x27','global\x20by\x20','ror:\x20','EGER\x20DEFAU','ite_master','EMENT,\x0a\x20\x20\x20','XT\x20NOT\x20NUL','28763801UHkpkk','ly\x20include','(\x0a\x20\x20\x20\x20\x20\x20\x20\x20','d\x20=\x20?\x20ORDE','uded.creat','trimStart','table\x20(can','ses,\x20rr_in','y,\x20created','has','substring','\x20\x20\x20\x20\x20','s\x20error:\x20','\x0a\x20gfilter\x20','post-swap\x20','bot-state\x20','without\x20UN',',\x20?)','resolveNam','name','output','idx\x20create','clear','sponses\x20TE','\x200,\x0a\x20\x20\x20\x20\x20\x20','indings\x20er','ored\x20regex','_jid\x20=\x20?\x20A','rr_index','keyword','ur\x20default','chat_jid','next','triggers','chat_jid,\x20','roundrobin','ue\x20ON\x20filt','sendText\x20u','\x22\x20->\x20','_filters_c','phrase','ensureSche','ers\x20failed','TEXT\x20NOT\x20N',':\x20<alias|j','get','\x20available','split','\x20WHERE\x20typ','every','\x20everythin','isFinite','\x20failure\x20a','1373870CJpGqd','lowerToOri','entries','d\x20INTEGER\x20','Could\x20not\x20','\x20created_b','replace','9NLJiwf','Usage\x20(gro','gration','caption','ctReply','selectedRo','?,\x20?,\x20?,\x200','ADD\x20COLUMN','integrated','timestamp','_by\x20=\x20excl','E\x20filters\x20','tingFilter','ND\x20trigger','keywords','pingAndWai','fter\x20reply','\x0aOptionall','gdelf','initialize','dex,\x20creat','reply','e\x20FROM\x20sql','deleteFilt','\x20excluded.','ted_at\x20=\x20e','\x20\x20\x20\x20\x20\x20\x20\x20re','d|alias|al','ll\x20\x20\x20(ERAS','Usage:\x20gde','now','Usage\x20(PM\x20','ue(s).','=\x20OFF;','er\x20TEXT\x20NO','ters_new\x20(','set','\x20\x20VALUES\x20(','startsWith','failed\x20for','16jzHCnL','ULL','TEXT\x20DEFAU','E\x20filters_','tries\x20to\x20y','ed_by,\x0a\x20\x20\x20','add','pickRespon','NOT\x20NULL,\x0a','R\x20BY\x20trigg','deleted\x20','STS\x20idx_fi','o\x20backup','=\x20?\x20AND\x20tr','CREATE\x20IND','endsWith','fallback\x20b','_jid\x20TEXT\x20','sendText\x20c','map','8160789EziIxK','ters\x20table','s\x20failed:\x20','711956bfzwgb','build','test','Failed\x20to\x20','ROM\x20filter',')\x20returned','AhoCorasic','INSERT\x20INT','INTEGER\x20DE','lling\x20back','keys','\x20\x20\x20\x20UNIQUE','\x20TEXT\x20DEFA','IMARY\x20KEY\x20','removed:\x20','trim',',\x0a\x20\x20\x20\x20\x20\x20\x20\x20','seAndAdvan','random','trigger2>\x0a','QUE\x20INDEX\x20','DELETE\x20FRO','lfilter\x20tr','\x20chat_jid\x20','Saved\x20','readAndNor','toLowerCas','oup(s).','created\x20ne','message','\x20);','RE\x20chat_ji','match','normalizeT','onForChat\x20','added\x20miss','setdefault','id,\x20respon','participan','GLOBAL\x20(al','id,\x20trigge','\x20DEFAULT\x200','\x20filters:\x20','created_at','ing\x20column','out\x20target','@g.us','legacy\x20fil','id|all>`\x20t','ceUpdate','r\x20for\x20','new\x20(trigg','jid);','\x5cw*','Deleted\x20AL','O\x20filters_','er\x20trigger','\x20failed:\x20','idx:\x20','ers(chat_j','gdelfilter','lso\x20failed',',\x0a\x20\x20','getUniqueJ','PRIMARY\x20KE','changes','LT\x200\x0a\x20\x20\x20\x20\x20','videoMessa','WHERE\x20chat','EXISTS\x20fil','INTEGER\x20PR','chat_id','SELECT\x20res','eated_at;','\x0a\x20\x20\x20\x20\x20\x20\x20\x20C','\x20=\x20?\x20LIMIT','\x20for\x20chat\x20','\x20gp:\x20<grou','ters(chat_','created_by','default):\x0a','\x20trigger)\x0a','\x20\x20\x20\x20\x20\x20);','sendPresen','ncrement\x20f','t\x20error:\x20',',\x20?,\x20?)\x0a\x20\x20','\x20fatal','SELECT\x20DIS','remoteJid','-\x20performi','oUserJid','findStored','ated_at)\x20V',':\x20\x22','\x20alias/jid','gfilter','max','g\x20globally','LE\x20IF\x20NOT\x20','[gfilter]\x20','text','ALTER\x20TABL','EXISTS\x20idx','?,\x20?,\x200,\x20?','push','PRAGMA\x20tab','nodes','getBotJid(','Unknown\x20gp','stringify','(chat_jid,','conversati','\x20\x20\x20\x20\x20\x20crea','isArray','tries\x20acro','listRespon','_at)\x0a\x20\x20\x20\x20\x20','ma\x20fatal','getTableCo','listTrigge','composing','cleaned\x20up'];_0x344d=function(){return _0x15cb3d;};return _0x344d();}function resolveResponsesFromRow(_0x2bd92c){const _0x1ebfe9=_0xbbc231,_0x39c718=[_0x1ebfe9(0x199),_0x1ebfe9(0x1f0),_0x1ebfe9(0x2b1),_0x1ebfe9(0x1de),'body',_0x1ebfe9(0x1d5),_0x1ebfe9(0x2f8)];for(const _0x45b367 of _0x39c718)if(_0x45b367 in _0x2bd92c&&_0x2bd92c[_0x45b367]!=null)return _0x2bd92c[_0x45b367];for(const _0x4beeb6 of Object[_0x1ebfe9(0x2e5)](_0x2bd92c)){const _0x5f4523=_0x2bd92c[_0x4beeb6];if(typeof _0x5f4523===_0x1ebfe9(0x253)&&(_0x5f4523[_0x1ebfe9(0x2ea)]()[_0x1ebfe9(0x2c2)]('!')||_0x5f4523['trim']()[_0x1ebfe9(0x233)]('\x0a')||_0x5f4523['trim']()[_0x1ebfe9(0x2c2)]('[')))return _0x5f4523;}return null;}async function readAndNormalizeExistingFilters(){const _0x5061ac=_0xbbc231;try{const _0x55280b=await db[_0x5061ac(0x1ef)]('SELECT\x20*\x20F'+_0x5061ac(0x2df)+'s'),_0x466538=new Map();for(const _0x20d78f of _0x55280b||[]){const _0x146407=resolveTriggerFromRow(_0x20d78f)||'',_0x1b16c0=resolveChatJidFromRow(_0x20d78f)||'';if(!_0x146407||!_0x1b16c0)continue;const _0x362392=resolveResponsesFromRow(_0x20d78f),_0x4cac44=normalizeResponseValue(_0x362392),_0x53272d=_0x20d78f[_0x5061ac(0x169)]||_0x20d78f[_0x5061ac(0x1df)]||_0x20d78f['author']||'';let _0x5b1a44=Number(_0x20d78f[_0x5061ac(0x145)]||_0x20d78f['ts']||_0x20d78f[_0x5061ac(0x2a5)]||_0x20d78f['time']||0x3d*0x11+-0x1937+-0x7e*-0x2b);if(!_0x5b1a44)_0x5b1a44=Math[_0x5061ac(0x1fc)](Date[_0x5061ac(0x2ba)]()/(0x1659+-0x16c6+0x455));const _0x682ea7=_0x1b16c0+'||'+_0x146407;if(!_0x466538[_0x5061ac(0x269)](_0x682ea7))_0x466538[_0x5061ac(0x2c0)](_0x682ea7,{'trigger':_0x146407,'chat_jid':_0x1b16c0,'responses':_0x4cac44[_0x5061ac(0x251)](),'created_by':_0x53272d,'created_at':_0x5b1a44});else{const _0x3b073a=_0x466538[_0x5061ac(0x28d)](_0x682ea7);_0x3b073a['responses']=uniqArray(_0x3b073a[_0x5061ac(0x199)][_0x5061ac(0x1bf)](_0x4cac44)),_0x3b073a['created_by']=_0x3b073a[_0x5061ac(0x169)]||_0x53272d,_0x3b073a[_0x5061ac(0x145)]=Math[_0x5061ac(0x17b)](_0x3b073a['created_at']||-0x9cf+-0xff3*0x1+-0x19c2*-0x1,_0x5b1a44||-0x239*0xd+-0x18ce+-0x1*-0x35b3);}}return Array[_0x5061ac(0x1fa)](_0x466538['values']());}catch(_0x124bb7){return warn(_0x5061ac(0x17e)+_0x5061ac(0x2f4)+'malizeExis'+_0x5061ac(0x2a8)+_0x5061ac(0x2da)+(_0x124bb7?.['message']||_0x124bb7)),[];}}async function ensureSchema(){const _0x4437cd=_0xbbc231,_0x528703={'id':_0x4437cd(0x160)+_0x4437cd(0x2e8)+'AUTOINCREM'+_0x4437cd(0x20a),'trigger':_0x4437cd(0x28b)+_0x4437cd(0x2c5),'chat_jid':_0x4437cd(0x28b)+_0x4437cd(0x2c5),'responses':_0x4437cd(0x28b)+_0x4437cd(0x211)+'T\x20\x27[]\x27','rr_index':'INTEGER\x20DE'+_0x4437cd(0x195),'created_by':_0x4437cd(0x2c6)+_0x4437cd(0x259),'created_at':_0x4437cd(0x2e3)+_0x4437cd(0x195)};try{const _0xe62b95=await tableExists(_0x4437cd(0x1c4));if(!_0xe62b95){const _0x5e9003=Object[_0x4437cd(0x297)](_0x528703)[_0x4437cd(0x2d7)](([_0x25f76e,_0x3064d7])=>_0x25f76e+'\x20'+_0x3064d7)[_0x4437cd(0x23b)](_0x4437cd(0x158));await db[_0x4437cd(0x257)](_0x4437cd(0x164)+'REATE\x20TABL'+_0x4437cd(0x2a7)+_0x4437cd(0x262)+'\x20\x20'+_0x5e9003+(_0x4437cd(0x2eb)+_0x4437cd(0x1a0)+'hat_jid,\x20t'+_0x4437cd(0x232)+'\x20\x20\x20\x20\x20\x20);\x0a\x20'+_0x4437cd(0x26b)));try{await db[_0x4437cd(0x257)](_0x4437cd(0x2d2)+_0x4437cd(0x23c)+_0x4437cd(0x181)+_0x4437cd(0x287)+_0x4437cd(0x20b)+_0x4437cd(0x168)+_0x4437cd(0x14e));}catch(_0x324d6e){}try{await db[_0x4437cd(0x257)]('CREATE\x20UNI'+_0x4437cd(0x2ef)+_0x4437cd(0x1c1)+_0x4437cd(0x2cf)+_0x4437cd(0x241)+_0x4437cd(0x284)+_0x4437cd(0x155)+_0x4437cd(0x142)+'r);');}catch(_0x37cd5f){}info(_0x4437cd(0x17e)+_0x4437cd(0x2f7)+_0x4437cd(0x223)+_0x4437cd(0x266)+_0x4437cd(0x1ec)+'ema)');return;}const _0x5bdd17=await getTableColumns(_0x4437cd(0x1c4)),_0x3f397d=[];for(const _0xd801fe of Object['keys'](_0x528703)){if(!_0x5bdd17['includes'](_0xd801fe))_0x3f397d[_0x4437cd(0x183)](_0xd801fe);}if(_0x3f397d[_0x4437cd(0x21e)]===-0x162b+0x2*-0x780+0x252b){try{await db[_0x4437cd(0x257)](_0x4437cd(0x2d2)+_0x4437cd(0x23c)+_0x4437cd(0x181)+_0x4437cd(0x287)+_0x4437cd(0x20b)+_0x4437cd(0x168)+_0x4437cd(0x14e));}catch(_0x39aca9){warn(_0x4437cd(0x17e)+_0x4437cd(0x275)+':\x20'+(_0x39aca9?.['message']||_0x39aca9));}try{await db['exec'](_0x4437cd(0x1fd)+_0x4437cd(0x2ef)+'IF\x20NOT\x20EXI'+'STS\x20idx_fi'+'lters_uniq'+'ue\x20ON\x20filt'+_0x4437cd(0x155)+_0x4437cd(0x142)+_0x4437cd(0x1ab));}catch(_0x50def4){warn(_0x4437cd(0x17e)+'unique\x20idx'+':\x20'+(_0x50def4?.['message']||_0x50def4));}return;}const _0x3db4f3=_0x3f397d[_0x4437cd(0x291)](_0x577a87=>!['id','trigger',_0x4437cd(0x27f)][_0x4437cd(0x233)](_0x577a87));if(_0x3db4f3){for(const _0x4efd0a of _0x3f397d){try{const _0x52590c=_0x528703[_0x4efd0a],_0xba3007=_0x52590c['split']('\x20')['slice'](-0x10de+0xf4b+-0x194*-0x1)[_0x4437cd(0x23b)]('\x20');await db['exec']('ALTER\x20TABL'+_0x4437cd(0x2a7)+_0x4437cd(0x2a3)+'\x20'+_0x4efd0a+'\x20'+_0xba3007),info(_0x4437cd(0x17e)+_0x4437cd(0x2fe)+_0x4437cd(0x146)+'\x20'+_0x4efd0a+('\x20to\x20filter'+'s\x20table'));}catch(_0x2252bc){warn('[gfilter]\x20'+'adding\x20col'+_0x4437cd(0x1ba)+_0x4efd0a+_0x4437cd(0x153)+(_0x2252bc?.[_0x4437cd(0x2f8)]||_0x2252bc));}}try{await db[_0x4437cd(0x257)](_0x4437cd(0x2d2)+_0x4437cd(0x23c)+_0x4437cd(0x181)+'_filters_c'+_0x4437cd(0x20b)+'ters(chat_'+'jid);');}catch(_0x2c3aab){warn('[gfilter]\x20'+'idx\x20create'+':\x20'+(_0x2c3aab?.[_0x4437cd(0x2f8)]||_0x2c3aab));}try{await db[_0x4437cd(0x257)](_0x4437cd(0x1fd)+_0x4437cd(0x2ef)+_0x4437cd(0x1c1)+_0x4437cd(0x2cf)+_0x4437cd(0x241)+'ue\x20ON\x20filt'+_0x4437cd(0x155)+_0x4437cd(0x142)+_0x4437cd(0x1ab));}catch(_0x29c93b){warn('[gfilter]\x20'+_0x4437cd(0x1ee)+':\x20'+(_0x29c93b?.[_0x4437cd(0x2f8)]||_0x29c93b));}return;}info('[gfilter]\x20'+_0x4437cd(0x149)+_0x4437cd(0x2d9)+_0x4437cd(0x22d)+_0x4437cd(0x174)+'ng\x20safe\x20mi'+_0x4437cd(0x29e));const _0x527f7e=await readAndNormalizeExistingFilters();await db[_0x4437cd(0x257)](_0x4437cd(0x1c3)+_0x4437cd(0x1c2)+_0x4437cd(0x2bd));try{await db[_0x4437cd(0x257)]('CREATE\x20TAB'+'LE\x20IF\x20NOT\x20'+_0x4437cd(0x15f)+_0x4437cd(0x2bf)+_0x4437cd(0x230)+_0x4437cd(0x298)+_0x4437cd(0x15a)+_0x4437cd(0x1e5)+_0x4437cd(0x25e)+_0x4437cd(0x242)+_0x4437cd(0x2be)+_0x4437cd(0x198)+'\x20\x20\x20\x20\x20\x20chat'+'_jid\x20TEXT\x20'+'NOT\x20NULL,\x0a'+'\x20\x20\x20\x20\x20\x20\x20\x20re'+'sponses\x20TE'+'XT\x20NOT\x20NUL'+_0x4437cd(0x19c)+_0x4437cd(0x1e8)+_0x4437cd(0x214)+_0x4437cd(0x1ad)+_0x4437cd(0x143)+_0x4437cd(0x2eb)+_0x4437cd(0x169)+_0x4437cd(0x2e7)+_0x4437cd(0x236)+_0x4437cd(0x18b)+'ted_at\x20INT'+_0x4437cd(0x25c)+_0x4437cd(0x226)+_0x4437cd(0x2e6)+_0x4437cd(0x189)+_0x4437cd(0x16b)+_0x4437cd(0x16c));}catch(_0x191de8){await db['exec']('CREATE\x20TAB'+_0x4437cd(0x17d)+_0x4437cd(0x15f)+_0x4437cd(0x2bf)+_0x4437cd(0x230)+'d\x20INTEGER\x20'+_0x4437cd(0x15a)+_0x4437cd(0x1e5)+'EMENT,\x0a\x20\x20\x20'+'\x20\x20\x20\x20\x20trigg'+_0x4437cd(0x2be)+_0x4437cd(0x198)+'\x20\x20\x20\x20\x20\x20chat'+_0x4437cd(0x2d5)+_0x4437cd(0x2cc)+_0x4437cd(0x2b6)+_0x4437cd(0x277)+_0x4437cd(0x25f)+'L\x20DEFAULT\x20'+_0x4437cd(0x1e8)+_0x4437cd(0x214)+'ex\x20INTEGER'+_0x4437cd(0x143)+_0x4437cd(0x2eb)+_0x4437cd(0x169)+'\x20TEXT\x20DEFA'+_0x4437cd(0x236)+'\x20\x20\x20\x20\x20\x20crea'+_0x4437cd(0x1ce)+_0x4437cd(0x25c)+_0x4437cd(0x15c)+_0x4437cd(0x2f9)),warn(_0x4437cd(0x17e)+'created\x20fi'+'lters_new\x20'+_0x4437cd(0x270)+'IQUE\x20as\x20fa'+'llback');}const _0x40b858=await db[_0x4437cd(0x1cf)](_0x4437cd(0x2e2)+_0x4437cd(0x151)+_0x4437cd(0x14d)+_0x4437cd(0x1a8)+_0x4437cd(0x13f)+_0x4437cd(0x267)+_0x4437cd(0x2b0)+_0x4437cd(0x224)+_0x4437cd(0x177)+_0x4437cd(0x258)+_0x4437cd(0x182)+_0x4437cd(0x271));try{for(const _0x37bfbd of _0x527f7e){const _0x46976c=JSON[_0x4437cd(0x188)](ensureArray(_0x37bfbd[_0x4437cd(0x199)]||[]));try{await _0x40b858[_0x4437cd(0x23f)](_0x37bfbd[_0x4437cd(0x249)],_0x37bfbd[_0x4437cd(0x27f)],_0x46976c,_0x37bfbd[_0x4437cd(0x169)]||'',Number(_0x37bfbd['created_at']||Math[_0x4437cd(0x1fc)](Date[_0x4437cd(0x2ba)]()/(0x1aec+0x1f00+0x4*-0xd81))));}catch(_0x50e1a9){warn(_0x4437cd(0x17e)+'could\x20not\x20'+_0x4437cd(0x1f5)+_0x4437cd(0x1bd)+'w\x20'+_0x37bfbd[_0x4437cd(0x27f)]+'@'+_0x37bfbd[_0x4437cd(0x249)]+':\x20'+(_0x50e1a9?.[_0x4437cd(0x2f8)]||_0x50e1a9));}}}finally{try{await _0x40b858[_0x4437cd(0x1cc)]();}catch(_0x39c6ef){}}try{const _0x3726fe=_0x4437cd(0x24a)+_0x4437cd(0x1f7)+Math[_0x4437cd(0x1fc)](Date[_0x4437cd(0x2ba)]()/(-0x1075+-0x2b*0x5c+0x23d1));await db[_0x4437cd(0x257)](_0x4437cd(0x180)+'E\x20filters\x20'+'RENAME\x20TO\x20'+_0x3726fe+';'),await db[_0x4437cd(0x257)]('ALTER\x20TABL'+_0x4437cd(0x2c7)+'new\x20RENAME'+_0x4437cd(0x216)+'s;');try{await db[_0x4437cd(0x257)](_0x4437cd(0x2d2)+_0x4437cd(0x23c)+_0x4437cd(0x181)+'_filters_c'+_0x4437cd(0x20b)+_0x4437cd(0x168)+_0x4437cd(0x14e));}catch(_0x1bfa76){warn('[gfilter]\x20'+_0x4437cd(0x26e)+_0x4437cd(0x154)+(_0x1bfa76?.[_0x4437cd(0x2f8)]||_0x1bfa76));}try{await db['exec'](_0x4437cd(0x1fd)+_0x4437cd(0x2ef)+_0x4437cd(0x1c1)+'STS\x20idx_fi'+_0x4437cd(0x241)+_0x4437cd(0x284)+'ers(chat_j'+_0x4437cd(0x142)+_0x4437cd(0x1ab));}catch(_0x105209){warn(_0x4437cd(0x17e)+_0x4437cd(0x26e)+'unique\x20idx'+':\x20'+(_0x105209?.[_0x4437cd(0x2f8)]||_0x105209));}info(_0x4437cd(0x17e)+'migration\x20'+_0x4437cd(0x1eb)+_0x4437cd(0x21d)+_0x4437cd(0x1f8)+_0x4437cd(0x2d0));}catch(_0x147afb){warn(_0x4437cd(0x17e)+'swap\x20table'+_0x4437cd(0x2da)+(_0x147afb?.[_0x4437cd(0x2f8)]||_0x147afb));throw _0x147afb;}finally{await db['exec']('PRAGMA\x20for'+_0x4437cd(0x1c2)+'=\x20ON;');}}catch(_0x28648b){error(_0x28648b,_0x4437cd(0x17e)+_0x4437cd(0x289)+_0x4437cd(0x190));throw _0x28648b;}}function normalizeResponseValue(_0x48d3ee){const _0x5f357a=_0xbbc231;if(_0x48d3ee==null)return[];if(Array[_0x5f357a(0x18c)](_0x48d3ee))return uniqArray(_0x48d3ee);if(typeof _0x48d3ee==='string'){let _0x1d1278=_0x48d3ee[_0x5f357a(0x29b)](/\r/g,'');const _0xedc061=_0x1d1278[_0x5f357a(0x2ea)]();if(_0xedc061[_0x5f357a(0x2c2)]('['))try{const _0x2ca792=JSON[_0x5f357a(0x235)](_0xedc061);if(Array['isArray'](_0x2ca792))return uniqArray(_0x2ca792[_0x5f357a(0x2d7)](_0x33b679=>String(_0x33b679||'')));}catch(_0x469788){}_0x1d1278=_0x1d1278[_0x5f357a(0x29b)](/^\s*\n+/,'')['replace'](/\n+\s*$/,'');const _0x11bb3c=_0x1d1278[_0x5f357a(0x28f)]('\x0a'),_0x546f4a=_0x11bb3c['some'](_0x39a330=>_0x39a330[_0x5f357a(0x265)]()['startsWith']('!'));if(_0x546f4a){const _0x51c5d5=[];let _0x4cd0bf=null;for(const _0x240a7b of _0x11bb3c){if(_0x240a7b[_0x5f357a(0x265)]()[_0x5f357a(0x2c2)]('!')){const _0xf0ceba=_0x240a7b[_0x5f357a(0x29b)](/^\s*!/,''),_0x388c66=_0xf0ceba[_0x5f357a(0x29b)](/\s+$/,'');_0x4cd0bf=_0x388c66,_0x51c5d5[_0x5f357a(0x183)](_0x4cd0bf);}else{const _0x36e59e=_0x240a7b[_0x5f357a(0x29b)](/\s+$/,'');if(_0x4cd0bf===null)_0x4cd0bf=_0x36e59e,_0x51c5d5[_0x5f357a(0x183)](_0x4cd0bf);else{const _0x283b4b=_0x51c5d5[_0x5f357a(0x21e)]-(0x1e5c+-0x968+-0x14f3*0x1);_0x51c5d5[_0x283b4b]=_0x51c5d5[_0x283b4b]+'\x0a'+_0x36e59e,_0x4cd0bf=_0x51c5d5[_0x283b4b];}}}return uniqArray(_0x51c5d5['map'](_0x1679d4=>String(_0x1679d4||'')['trim']()));}else{const _0x108441=_0x11bb3c[_0x5f357a(0x2d7)](_0x19122c=>_0x19122c[_0x5f357a(0x29b)](/\s+$/,''))[_0x5f357a(0x23b)]('\x0a')[_0x5f357a(0x2ea)]();if(!_0x108441)return[];return[_0x108441];}}return[];}async function upsertFilterRow(_0x2222cd,_0x3d24e7,_0x4a71bc,_0x42c281){const _0x2a4fbd=_0xbbc231;try{const _0x444d7e=Math[_0x2a4fbd(0x1fc)](Date[_0x2a4fbd(0x2ba)]()/(-0x5ee+-0x20*-0x79+-0x2*0x2a5)),_0x384f20=JSON[_0x2a4fbd(0x188)](uniqArray(ensureArray(_0x4a71bc)[_0x2a4fbd(0x2d7)](_0x1e50a1=>String(_0x1e50a1)[_0x2a4fbd(0x2ea)]())[_0x2a4fbd(0x1d3)](Boolean)));await db['run']('INSERT\x20INT'+'O\x20filters\x20'+_0x2a4fbd(0x1dd)+_0x2a4fbd(0x282)+_0x2a4fbd(0x1a6)+'\x20rr_index,'+_0x2a4fbd(0x29a)+_0x2a4fbd(0x268)+_0x2a4fbd(0x18f)+_0x2a4fbd(0x2c1)+_0x2a4fbd(0x2a2)+_0x2a4fbd(0x170)+_0x2a4fbd(0x1c9)+_0x2a4fbd(0x1a1)+'t_jid,\x20tri'+_0x2a4fbd(0x1ae)+_0x2a4fbd(0x21a)+_0x2a4fbd(0x255)+_0x2a4fbd(0x1d9)+_0x2a4fbd(0x2b4)+_0x2a4fbd(0x1a6)+_0x2a4fbd(0x1f3)+_0x2a4fbd(0x254)+_0x2a4fbd(0x278)+_0x2a4fbd(0x231)+_0x2a4fbd(0x2a6)+_0x2a4fbd(0x264)+_0x2a4fbd(0x2c9)+_0x2a4fbd(0x18b)+_0x2a4fbd(0x2b5)+_0x2a4fbd(0x1a2)+_0x2a4fbd(0x163),[_0x3d24e7,_0x2222cd,_0x384f20,_0x42c281||'',_0x444d7e]);try{automatonCache[_0x2a4fbd(0x276)]();}catch(_0x1cd864){}return info('[gfilter]\x20'+_0x2a4fbd(0x1ed)+'er:\x20\x22'+_0x3d24e7+_0x2a4fbd(0x286)+_0x2222cd),!![];}catch(_0x160889){return error(_0x160889,_0x2a4fbd(0x17e)+'upsertFilt'+_0x2a4fbd(0x1a5)+_0x2a4fbd(0x228)+_0x3d24e7+_0x2a4fbd(0x201)+_0x2222cd),![];}}async function deleteFilters(_0x269204,_0x4f63a7){const _0x44d280=_0xbbc231;if(!Array[_0x44d280(0x18c)](_0x4f63a7)||_0x4f63a7[_0x44d280(0x21e)]===0x92a*-0x4+0x1319*0x2+0x1*-0x18a)return 0x5b*-0x66+0x269f+0x1*-0x25d;try{let _0x1ff632=-0x5df+-0x3f2*0x4+0x15a7*0x1;for(const _0x110be2 of _0x4f63a7){const _0x36b908=await db[_0x44d280(0x23f)](_0x44d280(0x2f0)+_0x44d280(0x24b)+_0x44d280(0x15e)+_0x44d280(0x27b)+_0x44d280(0x2a9)+_0x44d280(0x1ea),[_0x269204,_0x110be2]);if(_0x36b908?.[_0x44d280(0x15b)])_0x1ff632+=_0x36b908[_0x44d280(0x15b)];info('[gfilter]\x20'+_0x44d280(0x2ce)+_0x110be2+_0x44d280(0x201)+_0x269204);}try{automatonCache[_0x44d280(0x276)]();}catch(_0x10323a){}return _0x1ff632;}catch(_0x1e550c){return error(_0x1e550c,_0x44d280(0x17e)+_0x44d280(0x2b3)+_0x44d280(0x28a)+'\x20for\x20'+_0x269204),-0x563*-0x1+0x38b+-0x8ee;}}async function listTriggersForChat(_0x40a723){const _0x49e68c=_0xbbc231;try{const _0x3bca28=await db[_0x49e68c(0x1ef)](_0x49e68c(0x172)+'TINCT\x20trig'+'ger\x20FROM\x20f'+_0x49e68c(0x1c5)+'RE\x20chat_ji'+_0x49e68c(0x263)+_0x49e68c(0x2cd)+'er',[_0x40a723]);return(_0x3bca28||[])[_0x49e68c(0x2d7)](_0x372f99=>_0x372f99[_0x49e68c(0x249)]);}catch(_0x336880){return warn(_0x336880,_0x49e68c(0x17e)+_0x49e68c(0x192)+_0x49e68c(0x1f4)+_0x49e68c(0x2c3)+'\x20'+_0x40a723),[];}}async function pickResponseAndAdvance(_0x4ba789,_0x2d67cf,_0x4fd392=_0xbbc231(0x283)){const _0x23a8e8=_0xbbc231;try{const _0xc9fd01=await db[_0x23a8e8(0x28d)](_0x23a8e8(0x162)+_0x23a8e8(0x245)+'_index\x20FRO'+_0x23a8e8(0x24b)+_0x23a8e8(0x15e)+_0x23a8e8(0x27b)+_0x23a8e8(0x2a9)+_0x23a8e8(0x165)+'\x201',[_0x4ba789,_0x2d67cf]);if(!_0xc9fd01)return null;let _0x24f471=[];try{_0x24f471=JSON[_0x23a8e8(0x235)](_0xc9fd01[_0x23a8e8(0x199)]||'[]');}catch{_0x24f471=ensureArray(_0xc9fd01[_0x23a8e8(0x199)]);}_0x24f471=ensureArray(_0x24f471);if(!_0x24f471['length'])return null;if((_0x4fd392||'')[_0x23a8e8(0x2f5)+'e']()===_0x23a8e8(0x2ed)){const _0x438460=Math[_0x23a8e8(0x1fc)](Math[_0x23a8e8(0x2ed)]()*_0x24f471['length']);return _0x24f471[_0x438460];}const _0x52f39c=Number(_0xc9fd01[_0x23a8e8(0x27c)]||-0x1a77+-0x7b*0x4a+0x1*0x3e05),_0x5c951=_0x24f471[_0x52f39c%_0x24f471[_0x23a8e8(0x21e)]];try{await db[_0x23a8e8(0x23f)](_0x23a8e8(0x24f)+_0x23a8e8(0x20d)+'r_index\x20=\x20'+_0x23a8e8(0x1f6)+'+\x201)\x20WHERE'+_0x23a8e8(0x2f2)+_0x23a8e8(0x2d1)+_0x23a8e8(0x237),[_0x4ba789,_0x2d67cf]);}catch(_0x4756be){warn(_0x23a8e8(0x17e)+'rr_index\x20i'+_0x23a8e8(0x16e)+_0x23a8e8(0x1b2)+(_0x4756be?.[_0x23a8e8(0x2f8)]||_0x4756be));}return _0x5c951;}catch(_0x3e2df8){return warn(_0x23a8e8(0x17e)+_0x23a8e8(0x2cb)+_0x23a8e8(0x2ec)+_0x23a8e8(0x1e4)+(_0x3e2df8?.[_0x23a8e8(0x2f8)]||_0x3e2df8)),null;}}function parseFilterCommandText(_0x2e832f){const _0xdf3f1a=_0xbbc231;if(!_0x2e832f)return null;const _0x15d115=_0x2e832f[_0xdf3f1a(0x28f)](/\r?\n/)[_0xdf3f1a(0x2d7)](_0x39d56f=>_0x39d56f['replace'](/\r/g,''));if(!_0x15d115[_0xdf3f1a(0x21e)])return null;let _0x26ad9d=(_0x15d115[0x129*-0xe+0x5e5+0xa59]||'')[_0xdf3f1a(0x2ea)](),_0x505ed9=_0x15d115['slice'](-0x4a2*0x5+-0x4cd*-0x1+0x125e),_0x49193b=null;const _0x542a05=_0x26ad9d[_0xdf3f1a(0x2fb)](/^(.*?)(?:\s*,\s*|\s+)?gp[:\s]*([^\s,]+)\s*$/i);_0x542a05&&(_0x26ad9d=(_0x542a05[0x3e*-0x11+-0xe4f+0x7*0x2a2]||'')[_0xdf3f1a(0x2ea)](),_0x49193b=(_0x542a05[0xf+-0x2113+0x2106*0x1]||'')[_0xdf3f1a(0x2ea)]());if(!_0x49193b&&_0x505ed9&&_0x505ed9[_0xdf3f1a(0x21e)]){let _0x4bdb67=-(-0x1471+0x25a2+-0x1130);for(let _0xdd10a6=_0x505ed9[_0xdf3f1a(0x21e)]-(0x48d+0x74d+-0xbd9);_0xdd10a6>=0x1a93*0x1+0x1*0x1526+-0x1*0x2fb9;_0xdd10a6--){if(String(_0x505ed9[_0xdd10a6]||'')[_0xdf3f1a(0x2ea)]()[_0xdf3f1a(0x21e)]>-0x977*-0x3+-0x448*0x5+-0x1*0x6fd){_0x4bdb67=_0xdd10a6;break;}}if(_0x4bdb67>=-0xf7b+0xa7b*0x3+-0xff6){const _0x2c8e7e=String(_0x505ed9[_0x4bdb67]||'')[_0xdf3f1a(0x2ea)](),_0x6083a9=_0x2c8e7e['match'](/^gp[:\s]*([^\s,]+)\s*$/i);_0x6083a9&&(_0x49193b=(_0x6083a9[0x2474*0x1+-0x11d1+0x13e*-0xf]||'')['trim'](),_0x505ed9['splice'](_0x4bdb67,-0x657*0x3+0x1b*-0x2f+0x17fb));}}let _0x104fcc=_0x26ad9d['trim']()[_0xdf3f1a(0x28f)](/\s+/)[_0xdf3f1a(0x1d3)](Boolean);if(_0x104fcc[_0xdf3f1a(0x21e)]&&_0x104fcc[-0x1e5e+-0x108d+0x2eeb][_0xdf3f1a(0x2f5)+'e']()===_0xdf3f1a(0x17a))_0x104fcc[_0xdf3f1a(0x20e)]();const _0x3edc0a=_0x104fcc['join']('\x20')['trim']();let _0x5e24da=[];_0x3edc0a&&(_0x3edc0a['includes'](',')?_0x5e24da=_0x3edc0a[_0xdf3f1a(0x28f)](',')['map'](_0xf2adb=>_0xf2adb['trim']())[_0xdf3f1a(0x1d3)](Boolean):_0x5e24da=_0x3edc0a[_0xdf3f1a(0x28f)](/\s+/)[_0xdf3f1a(0x2d7)](_0x2d9592=>_0x2d9592[_0xdf3f1a(0x2ea)]())['filter'](Boolean));const _0xadb30b=_0x505ed9;if(!_0xadb30b[_0xdf3f1a(0x21e)])return{'triggers':_0x5e24da,'responses':[],'gp':_0x49193b};const _0x3b3d77=_0xadb30b[_0xdf3f1a(0x23b)]('\x0a'),_0x1ae517=normalizeResponseValue(_0x3b3d77);return{'triggers':_0x5e24da,'responses':_0x1ae517,'gp':_0x49193b};}function getMessageText(_0x2f57a9){const _0x454f7c=_0xbbc231;if(!_0x2f57a9||!_0x2f57a9['message'])return'';const _0x54dade=_0x2f57a9[_0x454f7c(0x2f8)];if(_0x54dade[_0x454f7c(0x18a)+'on'])return _0x54dade[_0x454f7c(0x18a)+'on'];if(_0x54dade[_0x454f7c(0x252)+_0x454f7c(0x1db)]?.[_0x454f7c(0x17f)])return _0x54dade[_0x454f7c(0x252)+_0x454f7c(0x1db)][_0x454f7c(0x17f)];if(_0x54dade[_0x454f7c(0x19a)+'ge']?.[_0x454f7c(0x29f)])return _0x54dade[_0x454f7c(0x19a)+'ge'][_0x454f7c(0x29f)];if(_0x54dade['videoMessa'+'ge']?.[_0x454f7c(0x29f)])return _0x54dade[_0x454f7c(0x15d)+'ge'][_0x454f7c(0x29f)];if(_0x54dade[_0x454f7c(0x23d)+_0x454f7c(0x243)+'ge']?.['selectedBu'+'ttonId'])return _0x54dade[_0x454f7c(0x23d)+_0x454f7c(0x243)+'ge'][_0x454f7c(0x256)+_0x454f7c(0x1bc)];if(_0x54dade[_0x454f7c(0x18e)+_0x454f7c(0x229)]?.['singleSele'+_0x454f7c(0x2a0)]?.['selectedRo'+'wId'])return _0x54dade[_0x454f7c(0x18e)+'seMessage'][_0x454f7c(0x1e2)+'ctReply'][_0x454f7c(0x2a1)+_0x454f7c(0x197)];return'';}const processedMessageKeys=new Map(),DEDUPE_TTL=(-0x1558*0x1+-0x33d*0x7+-0x8f*-0x4f)*(0x16*-0x2c+-0x1a83+0x2233);function makeDedupeKey(_0x4404db){const _0x349aeb=_0xbbc231,_0x9b9c5e=_0x4404db?.[_0x349aeb(0x1b8)];if(!_0x9b9c5e)return null;const _0xfd670f=_0x9b9c5e['id']||_0x9b9c5e?.['participan'+'t']||'',_0x556a30=_0x9b9c5e[_0x349aeb(0x173)]||'';return _0x556a30+'::'+_0xfd670f;}function isMsgProcessed(_0x9c822){const _0x1ebc7a=_0xbbc231;return _0x9c822&&processedMessageKeys[_0x1ebc7a(0x269)](_0x9c822);}function markMsgProcessed(_0x4aca94){const _0x1c39c4=_0xbbc231;if(!_0x4aca94)return;processedMessageKeys[_0x1c39c4(0x269)](_0x4aca94)&&clearTimeout(processedMessageKeys[_0x1c39c4(0x28d)](_0x4aca94));const _0x41613b=setTimeout(()=>processedMessageKeys['delete'](_0x4aca94),DEDUPE_TTL);processedMessageKeys[_0x1c39c4(0x2c0)](_0x4aca94,_0x41613b);}class Aho{constructor(){const _0x49b099=_0xbbc231;this[_0x49b099(0x185)]=[{'next':Object['create'](null),'fail':0x0,'output':[]}];}[_0xbbc231(0x2dc)](_0x1635cf){const _0x3d817c=_0xbbc231;this['nodes']=[{'next':Object['create'](null),'fail':0x0,'output':[]}];for(const _0x4ec8f6 of _0x1635cf){let _0x217960=-0x21eb*-0x1+0x133b*0x1+-0x3526;for(let _0x90f896=0xdb0+0x1ca5+0x2a55*-0x1;_0x90f896<_0x4ec8f6[_0x3d817c(0x21e)];_0x90f896++){const _0x68eaac=_0x4ec8f6[_0x90f896];!this[_0x3d817c(0x185)][_0x217960][_0x3d817c(0x280)][_0x68eaac]&&(this['nodes'][_0x217960]['next'][_0x68eaac]=this[_0x3d817c(0x185)][_0x3d817c(0x21e)],this['nodes'][_0x3d817c(0x183)]({'next':Object[_0x3d817c(0x212)](null),'fail':0x0,'output':[]})),_0x217960=this[_0x3d817c(0x185)][_0x217960][_0x3d817c(0x280)][_0x68eaac];}this[_0x3d817c(0x185)][_0x217960]['output'][_0x3d817c(0x183)](_0x4ec8f6);}const _0x285b33=[];for(const _0x19f972 in this['nodes'][-0x1124+-0x1ec8+0x2fec][_0x3d817c(0x280)]){const _0x4ed63c=this[_0x3d817c(0x185)][0x1*-0x2001+0x839+0x17c8][_0x3d817c(0x280)][_0x19f972];this[_0x3d817c(0x185)][_0x4ed63c][_0x3d817c(0x1e7)]=-0x1309+0x208f*0x1+0xd86*-0x1,_0x285b33[_0x3d817c(0x183)](_0x4ed63c);}while(_0x285b33[_0x3d817c(0x21e)]){const _0x4f42e3=_0x285b33[_0x3d817c(0x20e)]();for(const _0x4bff7b in this[_0x3d817c(0x185)][_0x4f42e3][_0x3d817c(0x280)]){const _0x424efa=this['nodes'][_0x4f42e3]['next'][_0x4bff7b];let _0x7e4db2=this[_0x3d817c(0x185)][_0x4f42e3][_0x3d817c(0x1e7)];while(_0x7e4db2&&!this[_0x3d817c(0x185)][_0x7e4db2][_0x3d817c(0x280)][_0x4bff7b])_0x7e4db2=this[_0x3d817c(0x185)][_0x7e4db2]['fail'];if(this[_0x3d817c(0x185)][_0x7e4db2][_0x3d817c(0x280)][_0x4bff7b])this[_0x3d817c(0x185)][_0x424efa]['fail']=this[_0x3d817c(0x185)][_0x7e4db2]['next'][_0x4bff7b];else this[_0x3d817c(0x185)][_0x424efa]['fail']=0x49*0x7+0xdb4+-0xfb3;this[_0x3d817c(0x185)][_0x424efa]['output'][_0x3d817c(0x183)](...this[_0x3d817c(0x185)][this[_0x3d817c(0x185)][_0x424efa][_0x3d817c(0x1e7)]][_0x3d817c(0x274)]),_0x285b33[_0x3d817c(0x183)](_0x424efa);}}}['search'](_0x14d562){const _0x418875=_0xbbc231,_0x156d6f=[];let _0x4ee579=-0x2016+0x2*0x6d9+0x1264;for(let _0x57de8e=0x1679*-0x1+-0x134d+-0x2*-0x14e3;_0x57de8e<_0x14d562['length'];_0x57de8e++){const _0x54dddd=_0x14d562[_0x57de8e];while(_0x4ee579&&!this['nodes'][_0x4ee579]['next'][_0x54dddd])_0x4ee579=this[_0x418875(0x185)][_0x4ee579][_0x418875(0x1e7)];if(this[_0x418875(0x185)][_0x4ee579][_0x418875(0x280)][_0x54dddd])_0x4ee579=this[_0x418875(0x185)][_0x4ee579][_0x418875(0x280)][_0x54dddd];else _0x4ee579=0x1*-0x1a05+0x1a0+0x1865;if(this[_0x418875(0x185)][_0x4ee579]['output'][_0x418875(0x21e)])for(const _0x83d740 of this[_0x418875(0x185)][_0x4ee579][_0x418875(0x274)]){_0x156d6f[_0x418875(0x183)]({'keyword':_0x83d740,'index':_0x57de8e-_0x83d740['length']+(0x457*-0x4+-0x4c*0x7a+-0x4df*-0xb)});}}return _0x156d6f;}}const automatonCache=new Map();async function getAutomatonForChat(_0x408bd5){const _0x5f4af9=_0xbbc231;if(!_0x408bd5)return null;if(automatonCache[_0x5f4af9(0x269)](_0x408bd5))return automatonCache[_0x5f4af9(0x28d)](_0x408bd5);try{const _0x2334f1=await db[_0x5f4af9(0x1ef)]('SELECT\x20DIS'+_0x5f4af9(0x217)+'ger\x20FROM\x20f'+_0x5f4af9(0x1c5)+_0x5f4af9(0x2fa)+_0x5f4af9(0x1c7)+')',[_0x408bd5,'*']),_0x45a6ea=(_0x2334f1||[])[_0x5f4af9(0x2d7)](_0x274dea=>String(_0x274dea[_0x5f4af9(0x249)]||'')['trim']())['filter'](Boolean),_0x2addb9=_0x45a6ea[_0x5f4af9(0x1d3)](_0x3b01cd=>{const _0x4f0dbf=_0x5f4af9,_0xe7684=String(_0x3b01cd)[_0x4f0dbf(0x2ea)]()['toLowerCas'+'e']();if(_0xe7684[_0x4f0dbf(0x2c2)](_0x4f0dbf(0x1e6)))return![];if(_0x3b01cd[_0x4f0dbf(0x233)]('*'))return![];return!![];}),_0x2d285d=_0x2addb9['map'](_0x15aa8d=>_0x15aa8d['toLowerCas'+'e']()),_0x2802ff=new Map();for(let _0x398d0f=0xa3d+0x1*0xaeb+-0x2a5*0x8;_0x398d0f<_0x2addb9[_0x5f4af9(0x21e)];_0x398d0f++){_0x2802ff[_0x5f4af9(0x2c0)](_0x2d285d[_0x398d0f],_0x2addb9[_0x398d0f]);}const _0x434fc8=new Aho();if(_0x2d285d['length'])_0x434fc8[_0x5f4af9(0x2dc)](_0x2d285d);const _0x11496e={'ac':_0x434fc8,'keywords':_0x2d285d,'lowerToOrig':_0x2802ff};return automatonCache[_0x5f4af9(0x2c0)](_0x408bd5,_0x11496e),_0x11496e;}catch(_0x14e7bc){return warn(_0x5f4af9(0x17e)+'getAutomat'+_0x5f4af9(0x2fd)+_0x5f4af9(0x2c3)+'\x20'+_0x408bd5+':\x20'+(_0x14e7bc?.[_0x5f4af9(0x2f8)]||_0x14e7bc)),null;}}async function findStoredMatchFromFindings(_0x5856a1=[]){const _0x102cc8=_0xbbc231;try{const _0x1f4c49=await listSudo();if(!Array['isArray'](_0x1f4c49)||_0x1f4c49[_0x102cc8(0x21e)]===0x29*0x9f+0x2086+-0x39fd)return null;const _0x58c180=new Set(_0x1f4c49[_0x102cc8(0x2d7)](String));for(const _0x2badcc of _0x5856a1||[]){if(!_0x2badcc||typeof _0x2badcc[_0x102cc8(0x247)]!==_0x102cc8(0x253))continue;const _0x3b13eb=normalizeToJid(_0x2badcc['jid']);if(_0x3b13eb&&_0x58c180[_0x102cc8(0x269)](_0x3b13eb))return _0x3b13eb;if(_0x58c180[_0x102cc8(0x269)](_0x2badcc[_0x102cc8(0x247)]))return _0x2badcc[_0x102cc8(0x247)];const _0x692ab1=String(_0x2badcc[_0x102cc8(0x247)])[_0x102cc8(0x28f)]('@')[-0x12d3*0x2+-0x182a+0x3dd0][_0x102cc8(0x28f)](':')[-0x6d7+0x9d2+-0x2fb];if(_0x692ab1)for(const _0x2c486a of _0x1f4c49){const _0x49d185=String(_0x2c486a)['split']('@')[-0x1582*0x1+-0x138*-0x5+0xf6a*0x1];if(_0x49d185&&_0x49d185===_0x692ab1)return _0x2c486a;}}return null;}catch(_0x494ed5){return warn(_0x102cc8(0x17e)+_0x102cc8(0x176)+_0x102cc8(0x24e)+_0x102cc8(0x279)+_0x102cc8(0x25b)+(_0x494ed5?.[_0x102cc8(0x2f8)]||_0x494ed5)),null;}}export async function initialize(_0xe905cd){const _0x4de424=_0xbbc231;botRef=_0xe905cd;if(botRef){if(typeof botRef['sendMessag'+'e']==='function')sendApi=async(_0x511994,_0x5b3b68)=>await botRef['sendMessag'+'e'](_0x511994,_0x5b3b68);else botRef[_0x4de424(0x21b)]&&typeof botRef[_0x4de424(0x21b)]['sendMessag'+'e']===_0x4de424(0x23e)?sendApi=async(_0xcd4e9,_0x10e1c2)=>await botRef['sock'][_0x4de424(0x1ca)+'e'](_0xcd4e9,_0x10e1c2):sendApi=null;}try{await ensureSchema(),info(_0x4de424(0x17e)+_0x4de424(0x2af)+_0x4de424(0x19f)+_0x4de424(0x26f)+_0x4de424(0x2a4)+')');}catch(_0x5868b0){error(_0x5868b0,_0x4de424(0x17e)+_0x4de424(0x2af)+_0x4de424(0x171));throw _0x5868b0;}}function detectCommandNameFromCmdText(_0x4f6750){const _0x3a3502=_0xbbc231;if(!_0x4f6750)return null;const _0x3961ad=_0x4f6750[_0x3a3502(0x2ea)]();if(!_0x3961ad)return null;return _0x3961ad[_0x3a3502(0x28f)](/\s+/)[0x1*0x9d6+0x29*-0x22+0x232*-0x2]['toLowerCas'+'e']();}export async function onMessage(_0xd2e9da){const _0x516c43=_0xbbc231;try{if(!_0xd2e9da||!_0xd2e9da[_0x516c43(0x1b8)]||!_0xd2e9da[_0x516c43(0x2f8)])return;const _0x1326be=makeDedupeKey(_0xd2e9da);if(!_0x1326be)return;if(isMsgProcessed(_0x1326be))return;markMsgProcessed(_0x1326be);const _0x3b9726=getMessageText(_0xd2e9da);if(!_0x3b9726)return;const _0x5ca242=_0xd2e9da[_0x516c43(0x1b8)][_0x516c43(0x173)],_0x47f6c9=typeof _0x5ca242===_0x516c43(0x253)&&_0x5ca242[_0x516c43(0x2d3)](_0x516c43(0x148)),_0x19c821=_0xd2e9da[_0x516c43(0x1b8)]&&(_0xd2e9da['key'][_0x516c43(0x140)+'t']||_0xd2e9da[_0x516c43(0x1b8)][_0x516c43(0x1fa)]||_0xd2e9da[_0x516c43(0x1b8)]['remoteJid'])||'',_0x30e61b=(_0x19c821||'')['split']('@')[0x1fff*0x1+0x2543*0x1+0x5*-0xdda];let _0x344c0e=![];if(_0x47f6c9)try{_0x344c0e=await isadmin(botRef,_0xd2e9da);}catch(_0x57a735){_0x344c0e=![];}if(_0xd2e9da['isCommand']){const _0x5cec2b=typeof _0xd2e9da[_0x516c43(0x17f)]===_0x516c43(0x253)&&_0xd2e9da[_0x516c43(0x17f)][_0x516c43(0x2ea)]()[_0x516c43(0x21e)]?_0xd2e9da[_0x516c43(0x17f)]['trim']():_0x3b9726[_0x516c43(0x2ea)](),_0x5f3017=detectCommandNameFromCmdText(_0x5cec2b);if(!_0x5f3017)return;if(!_0x5f3017[_0x516c43(0x2c2)]('g'))return;if(!_0x47f6c9){const _0x51c0fd=Boolean(_0xd2e9da[_0x516c43(0x1b8)]['fromMe']);let _0xd7126f=null;if(_0x51c0fd){const _0x5ad312=getBotJid();!_0x5ad312?(warn(_0x516c43(0x17e)+_0x516c43(0x186)+_0x516c43(0x2e0)+_0x516c43(0x1b5)+_0x516c43(0x2e4)+_0x516c43(0x1c6)+_0x516c43(0x1dc)+_0x516c43(0x244)+_0x516c43(0x1b0)),_0xd7126f=_0xd2e9da[_0x516c43(0x1b8)][_0x516c43(0x173)]):_0xd7126f=_0x5ad312;}else{let _0x1670de=![];try{_0x1670de=await isSudo(botRef,_0xd2e9da);}catch(_0x489565){_0x1670de=![];}if(!_0x1670de)return;const _0x8cef11=userJidFromCtx(_0xd2e9da)||{'findings':[]},_0x8fc274=await findStoredMatchFromFindings(_0x8cef11['findings']||[]);if(!_0x8fc274)return;_0xd7126f=_0x8fc274;}const _0x515ef3=parseFilterCommandText(_0x5cec2b||_0x3b9726);if(_0x5f3017==='gfilter'){if(!_0x515ef3||!_0x515ef3[_0x516c43(0x281)][_0x516c43(0x21e)]||!_0x515ef3[_0x516c43(0x199)][_0x516c43(0x21e)]){await sendText(_0xd2e9da,_0xd7126f,_0x516c43(0x2bb)+_0x516c43(0x25a)+_0x516c43(0x16a)+'\x20gfilter\x20<'+_0x516c43(0x250)+_0x516c43(0x19b)+_0x516c43(0x1f1)+'!response2'+_0x516c43(0x2ad)+_0x516c43(0x1bb)+_0x516c43(0x1e0)+_0x516c43(0x28c)+_0x516c43(0x14a)+_0x516c43(0x1f9)+'\x20target\x20gr'+_0x516c43(0x2f6));return;}let _0x2d166b=[];if(_0x515ef3['gp']){const _0x537cf5=_0x515ef3['gp'][_0x516c43(0x2ea)]();if(_0x537cf5['toLowerCas'+'e']()===_0x516c43(0x1ef))_0x2d166b=await _0xf674dc[_0x516c43(0x159)+'ids']();else{const _0x5ca54e=await _0xf674dc[_0x516c43(0x272)+'e'](_0x537cf5);if(_0x5ca54e)_0x2d166b=[_0x5ca54e];else{if(_0x537cf5[_0x516c43(0x233)]('@'))_0x2d166b=[_0xf674dc['normalizeT'+_0x516c43(0x175)](_0x537cf5)];else{await sendText(_0xd2e9da,_0xd7126f,_0x516c43(0x187)+_0x516c43(0x179)+_0x516c43(0x178)+_0x537cf5+('\x22.\x20Use\x20gro'+_0x516c43(0x238)+_0x516c43(0x220)+_0x516c43(0x1ac)+'s\x20a\x20full\x20J'+_0x516c43(0x227)));return;}}}}else _0x2d166b=['*'];let _0x29eafb=0xb*0x7f+-0xa*0x4d+0x13*-0x21;for(const _0x3b84f8 of uniqArray(_0x2d166b)){for(const _0x38d7f5 of _0x515ef3[_0x516c43(0x281)]){const _0x4b9010=await upsertFilterRow(_0x3b84f8,_0x38d7f5,_0x515ef3[_0x516c43(0x199)],_0x19c821||'');if(_0x4b9010)_0x29eafb++;}}await sendText(_0xd2e9da,_0xd7126f,_0x516c43(0x2f3)+_0x29eafb+('\x20filter(s)'+_0x516c43(0x1fe))+(_0x2d166b[_0x516c43(0x21e)]===-0x1e25+0x7f*0x2+0x4*0x74a?_0x2d166b[0x1566+-0x515*-0x4+0x2fb*-0xe]:_0x516c43(0x221)+'argets'));return;}if(_0x5f3017===_0x516c43(0x1ff)+'r'){const _0x54cf1c=(parseFilterCommandText(_0x5cec2b||_0x3b9726)||{})['gp'],_0xc57cb9=_0x54cf1c?_0x54cf1c['toLowerCas'+'e']()===_0x516c43(0x1ef)?'*':await _0xf674dc[_0x516c43(0x272)+'e'](_0x54cf1c)||_0xf674dc[_0x516c43(0x2fc)+_0x516c43(0x175)](_0x54cf1c):'*',_0x3668ab=await listTriggersForChat(_0xc57cb9);await sendText(_0xd2e9da,_0xd7126f,_0x516c43(0x17e)+_0x3668ab['length']+(_0x516c43(0x1aa)+_0x516c43(0x21c))+(_0xc57cb9==='*'?_0x516c43(0x141)+_0x516c43(0x20c):_0xc57cb9));if(!_0x3668ab[_0x516c43(0x21e)])return;let _0x89da88='';for(const _0x5c4987 of _0x3668ab){const _0x16b723='•\x20'+_0x5c4987+'\x0a';(_0x89da88+_0x16b723)[_0x516c43(0x21e)]>-0x84d+0x1483+-0x65a&&(await sendText(_0xd2e9da,_0xd7126f,_0x89da88['trim']()),_0x89da88=''),_0x89da88+=_0x16b723;}if(_0x89da88[_0x516c43(0x2ea)]())await sendText(_0xd2e9da,_0xd7126f,_0x89da88[_0x516c43(0x2ea)]());return;}if(_0x5f3017===_0x516c43(0x156)||_0x5f3017===_0x516c43(0x156)+'s'||_0x5f3017===_0x516c43(0x2ae)){const _0x5c264e=(_0x3b9726||'')[_0x516c43(0x28f)](/\r?\n/)[_0x516c43(0x2d7)](_0xeaad29=>_0xeaad29[_0x516c43(0x2ea)]());let _0x32174d=null;if(_0x5c264e[_0x516c43(0x21e)]>-0x86e*0x2+0x5*-0x3fd+0x7*0x542&&!_0x5c264e[0x1*0xe6b+-0xf4a+0xe0][_0x516c43(0x2f5)+'e']()[_0x516c43(0x2c2)]('gp'))_0x32174d=_0x5c264e[-0xb*0x2f+0xa81+-0xa7*0xd];else{const _0x95c0f9=_0x5cec2b[_0x516c43(0x2ea)]()[_0x516c43(0x28f)](/\s+/);_0x95c0f9[_0x516c43(0x20e)](),_0x32174d=_0x95c0f9[_0x516c43(0x23b)]('\x20')['trim']();}const _0x5dc141=_0x5c264e['slice'](0x1*0x169d+0x7a4*-0x2+-0x4*0x1d5)[_0x516c43(0x1a4)](_0x4fdd2e=>/^gp[:\s]/i['test'](_0x4fdd2e));let _0x2af4af=_0x5dc141?_0x5dc141[_0x516c43(0x29b)](/^gp[:\s]+/i,'')[_0x516c43(0x2ea)]():null;const _0x52ea88=(_0x32174d||'')['split'](',')['map'](_0x33c7b2=>_0x33c7b2[_0x516c43(0x2ea)]())[_0x516c43(0x1d3)](Boolean);if(!_0x52ea88[_0x516c43(0x21e)]){await sendText(_0xd2e9da,_0xd7126f,'Usage\x20(PM)'+':\x20gdelfilt'+_0x516c43(0x152)+'1,trigger2'+_0x516c43(0x1c8)+'as|jid|all'+_0x516c43(0x219)+'lfilter\x20al'+_0x516c43(0x202)+_0x516c43(0x292)+_0x516c43(0x17c)+')');return;}if(_0x52ea88[_0x516c43(0x21e)]===0x59*-0x1+-0x1330+0x138a&&_0x52ea88[0x1b09+-0x88d+-0x5b*0x34][_0x516c43(0x2f5)+'e']()===_0x516c43(0x1ef))try{const _0x7b0413=await db[_0x516c43(0x23f)](_0x516c43(0x2f0)+_0x516c43(0x1e1)),_0x42392a=_0x7b0413?.[_0x516c43(0x15b)]||0x4*0x22c+-0x24c4+0x1c14;try{automatonCache['clear']();}catch(_0x3b6ee6){}await sendText(_0xd2e9da,_0xd7126f,_0x516c43(0x150)+_0x516c43(0x200)+_0x516c43(0x248)+_0x516c43(0x1d8)+_0x516c43(0x2e9)+_0x42392a);return;}catch(_0x19e6f6){await sendText(_0xd2e9da,_0xd7126f,'Failed\x20to\x20'+_0x516c43(0x1d6)+_0x516c43(0x144)+(_0x19e6f6?.['message']||_0x19e6f6));return;}let _0x515b6c=[];if(_0x2af4af){if(_0x2af4af[_0x516c43(0x2f5)+'e']()===_0x516c43(0x1ef))_0x515b6c=await _0xf674dc[_0x516c43(0x159)+_0x516c43(0x21f)]();else{const _0x402ce1=await _0xf674dc[_0x516c43(0x272)+'e'](_0x2af4af);if(_0x402ce1)_0x515b6c=[_0x402ce1];else{if(_0x2af4af[_0x516c43(0x233)]('@'))_0x515b6c=[_0xf674dc['normalizeT'+_0x516c43(0x175)](_0x2af4af)];else{await sendText(_0xd2e9da,_0xd7126f,_0x516c43(0x187)+_0x516c43(0x179)+_0x516c43(0x178)+_0x2af4af+'\x22.');return;}}}}else _0x515b6c=['*'];let _0x66d0dd=-0xce*0x19+-0x1575+0x2993;for(const _0x2079b3 of uniqArray(_0x515b6c)){const _0x33d116=await deleteFilters(_0x2079b3,_0x52ea88);_0x66d0dd+=_0x33d116;}await sendText(_0xd2e9da,_0xd7126f,'Deleted\x20'+_0x66d0dd+(_0x516c43(0x1fb)+'tries\x20from'+'\x20')+(_0x515b6c[_0x516c43(0x21e)]===0x37b*0x9+-0x1*-0x449+-0x239b?_0x515b6c[-0x4a5+-0x23c9*-0x1+0x2*-0xf92]:'multiple\x20t'+_0x516c43(0x234)));return;}return;}if(_0x47f6c9){if(!_0x344c0e)return;const _0x40e8f6=typeof _0xd2e9da['text']===_0x516c43(0x253)&&_0xd2e9da[_0x516c43(0x17f)][_0x516c43(0x2ea)]()[_0x516c43(0x21e)]?_0xd2e9da[_0x516c43(0x17f)][_0x516c43(0x2ea)]():_0x3b9726[_0x516c43(0x2ea)](),_0x169fa0=detectCommandNameFromCmdText(_0x40e8f6);if(!_0x169fa0)return;let _0x5d5acb;try{_0x5d5acb=await getDefault(_0x30e61b)[_0x516c43(0x222)](()=>null);}catch(_0x2d721e){_0x5d5acb=null;}if(!_0x5d5acb||Array[_0x516c43(0x18c)](_0x5d5acb)&&_0x5d5acb[_0x516c43(0x21e)]===-0xff4+-0xd*-0x40+-0xc*-0x10f){await sendText(_0xd2e9da,_0x5ca242,'Could\x20not\x20'+'resolve\x20yo'+'ur\x20default'+'\x20connectio'+'n(s).\x20Use\x20'+_0x516c43(0x2ff)+_0x516c43(0x1a3));return;}const _0xe324d6=Array[_0x516c43(0x18c)](_0x5d5acb)?_0x5d5acb:[_0x5d5acb];let _0x55e8a8=[];for(const _0x160a60 of _0xe324d6){try{const _0x5240ab=await getConnection(_0x160a60)[_0x516c43(0x222)](()=>null);if(Array[_0x516c43(0x18c)](_0x5240ab))_0x55e8a8['push'](..._0x5240ab);else{if(_0x5240ab)_0x55e8a8[_0x516c43(0x183)](String(_0x5240ab));}}catch(_0x21499e){}}_0x55e8a8=uniqArray(_0x55e8a8);if(!_0x55e8a8['length']){await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x299)+'resolve\x20yo'+_0x516c43(0x27e)+'\x20connectio'+_0x516c43(0x206)+_0xe324d6[_0x516c43(0x23b)](',\x20')+(_0x516c43(0x1b7)+'heck\x20/setd'+_0x516c43(0x1c0)+_0x516c43(0x2bc)));return;}if(_0x169fa0===_0x516c43(0x17a)){const _0x368a65=parseFilterCommandText(_0x40e8f6||_0x3b9726);if(!_0x368a65||!_0x368a65['triggers'][_0x516c43(0x21e)]||!_0x368a65['responses'][_0x516c43(0x21e)]){await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x29d)+'up\x20admin):'+_0x516c43(0x26d)+_0x516c43(0x205)+_0x516c43(0x2ee)+'!response1'+_0x516c43(0x1e9)+'2\x0aOptional'+_0x516c43(0x261)+_0x516c43(0x167)+'p-jid|alia'+_0x516c43(0x22a));return;}if(_0x368a65['gp']){let _0x3f32db=[];const _0x23fac7=_0x368a65['gp'][_0x516c43(0x2ea)]();if(_0x23fac7[_0x516c43(0x2f5)+'e']()===_0x516c43(0x1ef))_0x3f32db=await _0xf674dc[_0x516c43(0x159)+_0x516c43(0x21f)]();else{const _0x3cc58a=await _0xf674dc[_0x516c43(0x272)+'e'](_0x23fac7);if(_0x3cc58a)_0x3f32db=[_0x3cc58a];else{if(_0x23fac7['includes']('@'))_0x3f32db=[_0xf674dc[_0x516c43(0x2fc)+_0x516c43(0x175)](_0x23fac7)];else{await sendText(_0xd2e9da,_0x5ca242,'Unknown\x20gp'+_0x516c43(0x179)+_0x516c43(0x178)+_0x23fac7+'\x22.');return;}}}let _0x4c5fd4=0x25f8+0xd17*0x1+-0x330f;for(const _0x1ff847 of uniqArray(_0x3f32db)){for(const _0xc10d2 of _0x368a65[_0x516c43(0x281)]){const _0x4db022=await upsertFilterRow(_0x1ff847,_0xc10d2,_0x368a65[_0x516c43(0x199)],_0x19c821||'');if(_0x4db022)_0x4c5fd4++;}}await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x2f3)+_0x4c5fd4+(_0x516c43(0x22f)+'\x20to\x20')+(_0x3f32db[_0x516c43(0x21e)]===0x4*0x466+0x11df*0x1+-0x2376?_0x3f32db[0x2514+0x21b1+-0x46c5]:_0x516c43(0x221)+_0x516c43(0x234)));return;}let _0x5dccfd=0x2b*0xc7+0xfab+0xc46*-0x4;for(const _0x45cf34 of _0x55e8a8){for(const _0x5f60f5 of _0x368a65[_0x516c43(0x281)]){const _0x21c8db=await upsertFilterRow(_0x45cf34,_0x5f60f5,_0x368a65[_0x516c43(0x199)],_0x19c821||'');if(_0x21c8db)_0x5dccfd++;}}await sendText(_0xd2e9da,_0x5ca242,'Saved\x20'+_0x5dccfd+(_0x516c43(0x1fb)+_0x516c43(0x2c8)+'our\x20defaul'+_0x516c43(0x1d4)+'on(s):\x20')+_0x55e8a8[_0x516c43(0x23b)](',\x20'));return;}if(_0x169fa0===_0x516c43(0x1ff)+'r'){const _0x2ced7c=new Set();for(const _0x832b54 of _0x55e8a8){const _0x4c1523=await listTriggersForChat(_0x832b54);for(const _0x4bd682 of _0x4c1523)_0x2ced7c[_0x516c43(0x2ca)](_0x4bd682);}const _0x11c11e=await listTriggersForChat('*');for(const _0x46d5d3 of _0x11c11e||[])_0x2ced7c[_0x516c43(0x2ca)](_0x46d5d3);const _0x5183a7=Array[_0x516c43(0x1fa)](_0x2ced7c)[_0x516c43(0x225)]();await sendText(_0xd2e9da,_0x5ca242,'[gfilter]\x20'+'loaded\x20'+_0x5183a7['length']+(_0x516c43(0x1aa)+_0x516c43(0x240)+_0x516c43(0x20f)+_0x516c43(0x1d1)+_0x516c43(0x209)));if(!_0x5183a7[_0x516c43(0x21e)])return;let _0x289d68='';for(const _0x3dbfb7 of _0x5183a7){const _0x2ba84f='•\x20'+_0x3dbfb7+'\x0a';(_0x289d68+_0x2ba84f)[_0x516c43(0x21e)]>0x23cc+-0x631*-0x1+-0x2421&&(await sendText(_0xd2e9da,_0x5ca242,_0x289d68[_0x516c43(0x2ea)]()),_0x289d68=''),_0x289d68+=_0x2ba84f;}if(_0x289d68[_0x516c43(0x2ea)]())await sendText(_0xd2e9da,_0x5ca242,_0x289d68[_0x516c43(0x2ea)]());return;}if(_0x169fa0===_0x516c43(0x156)||_0x169fa0==='gdelfilter'+'s'||_0x169fa0===_0x516c43(0x2ae)){const _0x1e0ce0=(_0x3b9726||'')[_0x516c43(0x28f)](/\r?\n/)['map'](_0x41215c=>_0x41215c[_0x516c43(0x2ea)]());let _0x408ad2=null;if(_0x1e0ce0[_0x516c43(0x21e)]>0x2a7+0x66e+0x1*-0x914&&!_0x1e0ce0[0x2042*-0x1+0x8e*0x1+0x1fb5][_0x516c43(0x2f5)+'e']()[_0x516c43(0x2c2)]('gp'))_0x408ad2=_0x1e0ce0[-0x167a+-0x213+0x7*0x382];else{const _0x23d70c=(_0x40e8f6||_0x3b9726)[_0x516c43(0x2ea)]()[_0x516c43(0x28f)](/\s+/);_0x23d70c['shift'](),_0x408ad2=_0x23d70c['join']('\x20')[_0x516c43(0x2ea)]();}const _0x1027af=_0x1e0ce0['slice'](-0x10df*-0x2+-0x11e5+-0xfd8)[_0x516c43(0x1a4)](_0x3f1163=>/^gp[:\s]/i['test'](_0x3f1163));let _0x318bf3=_0x1027af?_0x1027af[_0x516c43(0x29b)](/^gp[:\s]+/i,'')['trim']():null;const _0x4c2aa1=(_0x408ad2||'')[_0x516c43(0x28f)](',')[_0x516c43(0x2d7)](_0x59a065=>_0x59a065['trim']())[_0x516c43(0x1d3)](Boolean);if(!_0x4c2aa1[_0x516c43(0x21e)]){await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x2b9)+_0x516c43(0x2f1)+_0x516c43(0x1cb)+_0x516c43(0x24c)+_0x516c43(0x1b3)+_0x516c43(0x2b7)+'l>]\x0aOr:\x20gd'+_0x516c43(0x1b1)+_0x516c43(0x2b8)+'ES\x20ALL\x20fil'+_0x516c43(0x1cd)+'DB)');return;}if(_0x4c2aa1[_0x516c43(0x21e)]===-0x1*-0x1+0x1*0x1fd5+0x1d*-0x119&&_0x4c2aa1[0xb55+-0x1*0x1b7+-0x4cf*0x2]['toLowerCas'+'e']()===_0x516c43(0x1ef))try{const _0x37ff17=await db[_0x516c43(0x23f)](_0x516c43(0x2f0)+'M\x20filters'),_0x13f2c8=_0x37ff17?.['changes']||0xb*0x15d+-0x3*-0x61b+0x854*-0x4;try{automatonCache[_0x516c43(0x276)]();}catch(_0x29eb03){}await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x150)+_0x516c43(0x200)+_0x516c43(0x248)+_0x516c43(0x1d8)+_0x516c43(0x2e9)+_0x13f2c8);return;}catch(_0x32c130){await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x2de)+_0x516c43(0x1d6)+'\x20filters:\x20'+(_0x32c130?.['message']||_0x32c130));return;}if(_0x318bf3){let _0x284437=[];if(_0x318bf3[_0x516c43(0x2f5)+'e']()===_0x516c43(0x1ef))_0x284437=await _0xf674dc[_0x516c43(0x159)+'ids']();else{const _0x3f80b2=await _0xf674dc[_0x516c43(0x272)+'e'](_0x318bf3);if(_0x3f80b2)_0x284437=[_0x3f80b2];else{if(_0x318bf3[_0x516c43(0x233)]('@'))_0x284437=[_0xf674dc[_0x516c43(0x2fc)+_0x516c43(0x175)](_0x318bf3)];else{await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x187)+_0x516c43(0x179)+_0x516c43(0x178)+_0x318bf3+'\x22.');return;}}}let _0x509107=0x1e4c+-0x1a8+-0x1ca4;for(const _0x29a5c2 of uniqArray(_0x284437)){const _0x2fbeeb=await deleteFilters(_0x29a5c2,_0x4c2aa1);_0x509107+=_0x2fbeeb;}await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x19e)+_0x509107+(_0x516c43(0x1aa)+_0x516c43(0x1a7))+(_0x284437[_0x516c43(0x21e)]===0x321+0x1a1+-0x4c1*0x1?_0x284437[-0x3d*-0x70+-0x1*-0x20ff+-0x3baf]:'multiple\x20t'+'argets'));return;}else{let _0x2a3e6e=-0xef9+0x2338+-0x143f;for(const _0x2e4973 of _0x55e8a8){const _0x30bc8c=await deleteFilters(_0x2e4973,_0x4c2aa1);_0x2a3e6e+=_0x30bc8c;}await sendText(_0xd2e9da,_0x5ca242,_0x516c43(0x19e)+_0x2a3e6e+('\x20filter\x20en'+_0x516c43(0x18d)+'ss\x20your\x20de'+_0x516c43(0x20f)+'ection(s):'+'\x20')+_0x55e8a8['join'](',\x20'));return;}}return;}}if(_0x47f6c9){if(_0xd2e9da[_0x516c43(0x1b8)]['fromMe'])return;const _0x3568c7=_0x5ca242,_0x437c40=getMessageText(_0xd2e9da);if(!_0x437c40)return;const _0x427c1b=String(_0x437c40||''),_0x3a1ee5=await db[_0x516c43(0x1ef)](_0x516c43(0x172)+_0x516c43(0x217)+'ger\x20FROM\x20f'+'ilters\x20WHE'+_0x516c43(0x2fa)+_0x516c43(0x1c7)+')',[_0x3568c7,'*']);if(!_0x3a1ee5||_0x3a1ee5['length']===0x1373+0x75*-0x2f+0xa*0x34)return;const _0x4c513b=(_0x3a1ee5||[])['map'](_0x147b41=>String(_0x147b41['trigger']||'')[_0x516c43(0x2ea)]())['filter'](Boolean),_0xb6d5cd=[],_0xe638=[],_0xcef7ed=[];for(const _0x5ead11 of _0x4c513b){const _0x4e1342=String(_0x5ead11)[_0x516c43(0x2ea)]()[_0x516c43(0x2f5)+'e']();if(_0x4e1342['startsWith']('regex:')){_0xcef7ed[_0x516c43(0x183)](_0x5ead11[_0x516c43(0x26a)](0x16ee+-0x17*0x165+-0x92b*-0x1));continue;}if(_0x5ead11[_0x516c43(0x233)]('*')){_0xe638[_0x516c43(0x183)](_0x5ead11);continue;}_0xb6d5cd[_0x516c43(0x183)](_0x5ead11);}const _0x5bfeb4=new Set(),_0x476793=getConfig()||{},_0x1bd56c=_0x476793[_0x516c43(0x196)]&&typeof _0x476793[_0x516c43(0x196)]===_0x516c43(0x218)?_0x476793['FILTERS']:{},_0x313bc5=(_0x1bd56c[_0x516c43(0x1da)+_0x516c43(0x1b9)]||'roundrobin')[_0x516c43(0x2f5)+'e']();let _0x223be4=null;if(_0xb6d5cd[_0x516c43(0x21e)]>-0x22d*-0x1+-0x419+0x1ec)try{const _0x178055=await getAutomatonForChat(_0x3568c7);if(_0x178055&&_0x178055['ac']&&_0x178055[_0x516c43(0x2aa)]&&_0x178055[_0x516c43(0x2aa)][_0x516c43(0x21e)]){const _0x295c66=_0x427c1b['toLowerCas'+'e'](),_0x5b3968=_0x178055['ac']['search'](_0x295c66);for(const _0x14492d of _0x5b3968){const _0x447218=_0x14492d[_0x516c43(0x27d)],_0x365cb2=_0x14492d[_0x516c43(0x239)],_0x205352=_0x365cb2+_0x447218['length'],_0x34c94f=_0x365cb2===-0x1d89+0xf58+0xe31||!/\w/[_0x516c43(0x2dd)](_0x295c66[_0x365cb2-(0x1*0x3c4+-0x22*-0x8a+-0x5*0x46b)]),_0xf665c9=_0x205352===_0x295c66[_0x516c43(0x21e)]||!/\w/['test'](_0x295c66[_0x205352]);if(_0x34c94f&&_0xf665c9){const _0x5b40e0=_0x178055[_0x516c43(0x296)+'g'][_0x516c43(0x28d)](_0x447218)||null;if(_0x5b40e0){_0x223be4=_0x5b40e0;break;}}}}else for(const _0x184c1d of _0xb6d5cd){const _0x20dad0=new RegExp('\x5cb'+escapeRegex(String(_0x184c1d))+'\x5cb','i');if(_0x20dad0['test'](_0x427c1b)){_0x223be4=_0x184c1d;break;}}}catch(_0x45489f){warn('[gfilter]\x20'+_0x516c43(0x2e1)+_0x516c43(0x204)+_0x516c43(0x153)+(_0x45489f?.[_0x516c43(0x2f8)]||_0x45489f));for(const _0x17fb92 of _0xb6d5cd){try{const _0x5b973d=new RegExp('\x5cb'+escapeRegex(String(_0x17fb92))+'\x5cb','i');if(_0x5b973d[_0x516c43(0x2dd)](_0x427c1b)){_0x223be4=_0x17fb92;break;}}catch(_0x61f25c){}}}if(!_0x223be4&&_0xe638[_0x516c43(0x21e)]>0xd78*-0x1+-0x923*-0x3+-0xdf1)for(const _0x698ce9 of _0xe638){try{const _0x12e065=new RegExp(wildcardToRegexPattern(_0x698ce9),'i');if(_0x12e065[_0x516c43(0x2dd)](_0x427c1b)){_0x223be4=_0x698ce9;break;}}catch(_0x4b7a41){if(_0x427c1b[_0x516c43(0x2f5)+'e']()[_0x516c43(0x233)](_0x698ce9[_0x516c43(0x29b)](/\*/g,'')[_0x516c43(0x2f5)+'e']())){_0x223be4=_0x698ce9;break;}}}if(!_0x223be4&&_0xcef7ed[_0x516c43(0x21e)]>-0x89*0x19+-0xe*-0x2ab+-0x17f9)for(const _0x495629 of _0xcef7ed){try{const _0x2412b4=new RegExp(_0x495629,'i');if(_0x2412b4['test'](_0x427c1b)){_0x223be4=_0x516c43(0x1e6)+_0x495629;break;}}catch(_0x2adde4){warn(_0x516c43(0x17e)+'invalid\x20st'+_0x516c43(0x27a)+_0x516c43(0x166)+_0x3568c7+_0x516c43(0x178)+_0x495629+_0x516c43(0x207)+(_0x2adde4?.['message']||_0x2adde4));}}if(_0x223be4){let _0x5dc7f7=await pickResponseAndAdvance(_0x3568c7,_0x223be4,_0x313bc5);if(!_0x5dc7f7)_0x5dc7f7=await pickResponseAndAdvance('*',_0x223be4,_0x313bc5);if(!_0x5dc7f7)return;if(_0x5bfeb4[_0x516c43(0x269)](_0x5dc7f7))return;await sendText(_0xd2e9da,_0x3568c7,_0x5dc7f7),_0x5bfeb4['add'](_0x5dc7f7);}}}catch(_0x4d6254){error(_0x4d6254,_0x516c43(0x17e)+_0x516c43(0x22c)+'ror:\x20'+(_0x4d6254?.[_0x516c43(0x2f8)]||_0x4d6254));}}export async function cleanup(){const _0x59b746=_0xbbc231;for(const _0x3080c4 of processedMessageKeys[_0x59b746(0x1d0)]())try{clearTimeout(_0x3080c4);}catch(_0x213038){}processedMessageKeys[_0x59b746(0x276)](),automatonCache[_0x59b746(0x276)](),botRef=null,sendApi=null,info(_0x59b746(0x17e)+_0x59b746(0x194));}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};