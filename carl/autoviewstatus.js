const _0x2a5085=_0x58ca;(function(_0x542c0e,_0x2c60fd){const _0x3b9fbc=_0x58ca,_0x3ff069=_0x542c0e();while(!![]){try{const _0xa646ef=parseInt(_0x3b9fbc(0xc0))/(0x22f8+0x178a+-0x3a81)*(parseInt(_0x3b9fbc(0xf1))/(-0xc40+0xefb*0x2+-0x11b4))+-parseInt(_0x3b9fbc(0x121))/(0x1b88+-0x7*0x4aa+0x521)+-parseInt(_0x3b9fbc(0xe7))/(0x1ff*-0x3+-0xf9*0x25+0x29fe)+-parseInt(_0x3b9fbc(0x8a))/(-0x13d*-0x19+-0x10cd+-0x149*0xb)*(-parseInt(_0x3b9fbc(0x101))/(-0x1322+0x2557+-0x122f))+parseInt(_0x3b9fbc(0x10b))/(-0xdf2*0x2+-0xed+-0x68*-0x47)*(-parseInt(_0x3b9fbc(0xf8))/(-0x14b2+0xefe*-0x1+0x23b8))+parseInt(_0x3b9fbc(0xed))/(-0x6*-0x46f+-0x2414+-0x1e7*-0x5)+parseInt(_0x3b9fbc(0xbc))/(0x1b8a+-0x1c8f+0x1*0x10f)*(parseInt(_0x3b9fbc(0x124))/(0x118c+-0x81*-0x35+-0x2c36));if(_0xa646ef===_0x2c60fd)break;else _0x3ff069['push'](_0x3ff069['shift']());}catch(_0x1cb982){_0x3ff069['push'](_0x3ff069['shift']());}}}(_0x3f64,-0x11e1fa+-0x1*-0x667ba+0x177c14));import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';function _0x3f64(){const _0x390615=['has','has\x20no\x20col',')\x20DO\x20UPDAT','7qyFKxu',':\x20initiali','autoviewst','e\x20error:\x20',',\x20updated_','TO\x20statusv','caption','only):\x0a','xtMessage','selectedRo','no\x20column','ALTER\x20TABL','ailed:\x20','undefined','setZone','ble\x20for\x20co','atusview_p','zoneName','umn:\x20','tatus\x20stat','string','wId','3498006DujuKf','updated_at','1.0.4','127039PwdcqO','xcluded.up','>\x20disable\x0a','function','ue\x20FROM\x20st','all','toLocaleSt','conversati','extendedTe','wer','REPLACE\x20IN',':\x20sendConf','\x20\x20\x20\x20key\x20TE','refs\x20WHERE','map','sendMessag','led\x27\x20LIMIT','dated_at','zed.','ring','\x20key=\x27enab','key','\x20?)','SELECT\x20val','remoteJid','\x20\x20\x20updated','TEXT\x20NOT\x20N','e)\x20VALUES\x20','exec','value','read','\x20INTEGER\x20D','ew_prefs\x20(','E\x20SET\x20valu','0\x0a\x20\x20\x20\x20\x20\x20);','floor','d:\x20','\x20KEY,\x0a\x20\x20\x20\x20','run','res\x20bot\x20in','hod\x20availa','\x27,\x27false\x27,','1220iJTuBd','EXISTS\x20sta','false','status-vie','llback\x20fai','imageMessa','tatus]\x20ena','selectedBu','tatus\x20off|','>\x20show\x20sta','led:\x20','error:\x20','\x20failed:\x20','efault\x20ena',':\x20viewed\x20s',':\x20inner\x20lo','INSERT\x20OR\x20','CONDS','isValid','sock','gistration','led\x20to\x20ena','tatus]\x20dis','O\x20statusvi','ew_prefs\x20A',':\x20saveEnab','\x0aTimezone:','ble',':\x20cleanup\x20','NFLICT(key','efsTable\x20e','enable','Usage\x20(PM\x20','\x20at\x20','prefs\x27)','ED_WITH_SE','\x20autoviews','isCommand','(key,\x20valu','\x20(\x27enabled','INSERT\x20INT','DISABLED','nfirmation','ner\x20(bot\x20J','name','message','led\x27','psert','led\x20to\x20dis','key,\x20value','500zwdoEp','R\x20DEFAULT\x20','us\x20\x20\x20\x20\x20\x20\x20-','bled','725074jgINZr','stance','nable\x20\x20\x20\x20-','iew_prefs\x20','umn','onfig\x20erro','EFAULT\x200','messages.u','eply\x20to\x20ow','listRespon','seMessage','Status\x20Vie','tatus]\x20fai','tus\x20as\x20rea','length',':\x20failed\x20t',':\x20ensurePr','AUTOVIEWST','[autoviews','ledToDb\x20er','state','adcast','ID\x20unavail','ledFromDb\x20','ttonId','delete','.upsert\x20ha',':\x20messages','_at\x20INTEGE','E\x20statusvi','buttonsRes','CREATE\x20TAB','readMessag','wer.initia','\x20\x20\x20\x20value\x20','dated_at=e','PRAGMA\x20tab',',\x27false\x27)','off','5539948TAyJMK','text',':\x20ensure\x20d','ATUS','trim','participan','10865556wbImdx','ndler\x20erro','>\x20enable\x0a','ponseMessa','4SkmVhH','get','split',':\x20cleaned\x20','LE\x20IF\x20NOT\x20','ULL,\x0a\x20\x20\x20\x20\x20',':\x20cannot\x20r','10206696fXiLYK','videoMessa',':\x20DB\x20init\x20','true','r:\x20','DATETIME_M','o\x20add\x20upda','catch','tatus\x20on|e','33906AQlkJV','tatusview_','irmation\x20f','at)\x20VALUES','includes','disable\x20\x20-','now'];_0x3f64=function(){return _0x390615;};return _0x3f64();}import{db}from'../utils/database.js';import{isSudo}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';import{isJidGroup}from'@whiskeysockets/baileys';export const name=_0x2a5085(0x8d)+_0x2a5085(0x12d);export const version=_0x2a5085(0x123);export const priority=-0x97*-0xb+-0x23ea+0x1d72;export const configKeys=[_0x2a5085(0xd1)+'ATUS'];export const commands=[_0x2a5085(0x10d)+'atus'];let botRef=null,DEFAULT_TIMEZONE='Africa/Nai'+'robi',CFG={'AUTOVIEWSTATUS':![]},shuttingDown=![],messageHandler=null;function refreshConfig(){const _0x565449=_0x2a5085;try{const _0x16c963=typeof getConfig==='function'?getConfig()||{}:{};CFG[_0x565449(0xd1)+'ATUS']=typeof _0x16c963[_0x565449(0xd1)+'ATUS']!==_0x565449(0x118)?!!_0x16c963['AUTOVIEWST'+_0x565449(0xea)]:CFG[_0x565449(0xd1)+_0x565449(0xea)];}catch(_0x16152d){warn(name+(':\x20refreshC'+_0x565449(0xc5)+_0x565449(0xfc))+(_0x16152d?.[_0x565449(0xb7)]||_0x16152d));}}try{hotReloadConfig&&hotReloadConfig(()=>{refreshConfig();});}catch(_0xa95a46){warn(name+(':\x20hotReloa'+'dConfig\x20re'+_0x2a5085(0x9e)+_0x2a5085(0x96))+(_0xa95a46?.[_0x2a5085(0xb7)]||_0xa95a46));}refreshConfig();async function ensurePrefsTable(){const _0x15c2b5=_0x2a5085;try{let _0x3d50a8=[];try{const _0x3ab73c=await db[_0x15c2b5(0x129)](_0x15c2b5(0xe4)+'le_info(\x27s'+_0x15c2b5(0x102)+_0x15c2b5(0xac));_0x3d50a8=(_0x3ab73c||[])[_0x15c2b5(0x132)](_0x25f8b8=>_0x25f8b8[_0x15c2b5(0xb6)]);}catch(_0x4079bc){_0x3d50a8=[];}if(!_0x3d50a8['length'])await db[_0x15c2b5(0x140)](_0x15c2b5(0xdf)+_0x15c2b5(0xf5)+_0x15c2b5(0x8b)+'tusview_pr'+'efs\x20(\x0a\x20\x20\x20\x20'+_0x15c2b5(0x130)+'XT\x20PRIMARY'+_0x15c2b5(0x85)+_0x15c2b5(0xe2)+_0x15c2b5(0x13e)+_0x15c2b5(0xf6)+_0x15c2b5(0x13d)+_0x15c2b5(0xdc)+_0x15c2b5(0xbd)+_0x15c2b5(0x82)),_0x3d50a8=[_0x15c2b5(0x139),_0x15c2b5(0x7d),_0x15c2b5(0x122)];else{if(!_0x3d50a8['includes']('updated_at'))try{await db[_0x15c2b5(0x86)](_0x15c2b5(0x116)+_0x15c2b5(0xdd)+_0x15c2b5(0xa2)+'DD\x20COLUMN\x20'+_0x15c2b5(0x122)+_0x15c2b5(0x7f)+_0x15c2b5(0xc6));}catch(_0x26c50e){warn(name+(_0x15c2b5(0xcf)+_0x15c2b5(0xfe)+'ted_at\x20col'+_0x15c2b5(0x11d))+(_0x26c50e?.[_0x15c2b5(0xb7)]||_0x26c50e));}}try{const _0x38066e=await db[_0x15c2b5(0xf2)](_0x15c2b5(0x13b)+_0x15c2b5(0x128)+_0x15c2b5(0x11b)+_0x15c2b5(0x131)+_0x15c2b5(0x138)+_0x15c2b5(0xb8));if(!_0x38066e){const _0x535b5e=Math[_0x15c2b5(0x83)](Date[_0x15c2b5(0x107)]()/(-0xcfa+0x166*-0xe+0x2476));try{await db['run'](_0x15c2b5(0xb2)+_0x15c2b5(0xa1)+_0x15c2b5(0x80)+_0x15c2b5(0xbb)+_0x15c2b5(0x10f)+'at)\x20VALUES'+'\x20(\x27enabled'+_0x15c2b5(0x89)+_0x15c2b5(0x13a),[_0x535b5e]);}catch(_0x3ac34f){try{await db[_0x15c2b5(0x86)]('INSERT\x20OR\x20'+_0x15c2b5(0x12e)+_0x15c2b5(0x110)+_0x15c2b5(0xc3)+_0x15c2b5(0xb0)+_0x15c2b5(0x13f)+'(\x27enabled\x27'+_0x15c2b5(0xe5));}catch(_0x495bb3){warn(name+(_0x15c2b5(0xcf)+'o\x20insert\x20d'+_0x15c2b5(0x97)+'bled\x20row:\x20')+(_0x495bb3?.[_0x15c2b5(0xb7)]||_0x495bb3));}}}}catch(_0x2a63b5){warn(name+(_0x15c2b5(0xe9)+_0x15c2b5(0x97)+'bled\x20row\x20f'+_0x15c2b5(0x117))+(_0x2a63b5?.[_0x15c2b5(0xb7)]||_0x2a63b5));}}catch(_0x418691){warn(name+(_0x15c2b5(0xd0)+_0x15c2b5(0xa8)+'rror:\x20')+(_0x418691?.[_0x15c2b5(0xb7)]||_0x418691));throw _0x418691;}}async function readEnabledFromDb(){const _0x58a737=_0x2a5085;try{const _0x56a985=await db[_0x58a737(0xf2)](_0x58a737(0x13b)+'ue\x20FROM\x20st'+_0x58a737(0x11b)+_0x58a737(0x131)+_0x58a737(0x138)+_0x58a737(0x134)+'\x201');if(!_0x56a985)return![];const _0x48f7d1=String(_0x56a985['value'])['toLowerCas'+'e']();return _0x48f7d1==='true'||_0x48f7d1==='1';}catch(_0x3dd347){return warn(name+(':\x20readEnab'+_0x58a737(0xd7)+_0x58a737(0x95))+(_0x3dd347?.[_0x58a737(0xb7)]||_0x3dd347)),![];}}async function saveEnabledToDb(_0x173fe4){const _0x213406=_0x2a5085;try{const _0xec6bdb=_0x173fe4?_0x213406(0xfb):_0x213406(0x8c),_0x2b4177=Math[_0x213406(0x83)](Date[_0x213406(0x107)]()/(-0x1*0xd8a+0xd3b+0x1*0x437));return await db['run']('INSERT\x20INT'+_0x213406(0xa1)+_0x213406(0x80)+_0x213406(0xbb)+',\x20updated_'+_0x213406(0x104)+_0x213406(0xb1)+'\x27,\x20?,\x20?)\x0a\x20'+'\x20\x20\x20\x20\x20ON\x20CO'+_0x213406(0xa7)+_0x213406(0x10a)+_0x213406(0x81)+'e=excluded'+'.value,\x20up'+_0x213406(0xe3)+_0x213406(0x125)+_0x213406(0x135),[_0xec6bdb,_0x2b4177]),!![];}catch(_0x3596f){const _0x3c5002=String(_0x3596f?.[_0x213406(0xb7)]||'')['toLowerCas'+'e']();if(_0x3c5002['includes'](_0x213406(0x109)+_0x213406(0xc4))||_0x3c5002[_0x213406(0x105)](_0x213406(0x115)))try{return await db[_0x213406(0x86)](_0x213406(0x9a)+'REPLACE\x20IN'+_0x213406(0x110)+_0x213406(0xc3)+_0x213406(0xb0)+'e)\x20VALUES\x20'+'(\x27enabled\x27'+',\x20?)',[_0x173fe4?_0x213406(0xfb):_0x213406(0x8c)]),!![];}catch(_0x189299){return warn(name+(':\x20saveEnab'+'ledToDb\x20fa'+_0x213406(0x8e)+_0x213406(0x94))+(_0x189299?.[_0x213406(0xb7)]||_0x189299)),![];}return warn(name+(_0x213406(0xa3)+_0x213406(0xd3)+'ror:\x20')+(_0x3596f?.[_0x213406(0xb7)]||_0x3596f)),![];}}function formatTimestamp(_0x46dbeb=Date[_0x2a5085(0x107)](),_0x33e074=DEFAULT_TIMEZONE){const _0x3ef157=_0x2a5085;try{const _0x47397b=DateTime['fromMillis'](_0x46dbeb)[_0x3ef157(0x119)](_0x33e074);if(!_0x47397b[_0x3ef157(0x9c)])return new Date(_0x46dbeb)[_0x3ef157(0x12a)+_0x3ef157(0x137)]();return _0x47397b[_0x3ef157(0x12a)+_0x3ef157(0x137)](DateTime[_0x3ef157(0xfd)+_0x3ef157(0xad)+_0x3ef157(0x9b)])+'\x20('+_0x47397b[_0x3ef157(0x11c)]+')';}catch(_0x115a64){return new Date(_0x46dbeb)[_0x3ef157(0x12a)+_0x3ef157(0x137)]();}}function createMessageHandler(){return async function _0x1c509b(_0x41213c){const _0x18dc81=_0x58ca;try{if(shuttingDown)return;refreshConfig();const _0x451d7d=await readEnabledFromDb();if(!_0x451d7d)return;const {messages:_0x520413}=_0x41213c||{};if(!Array['isArray'](_0x520413)||_0x520413['length']===-0xd76+-0x94*-0x3d+0x1*-0x15ce)return;for(const _0xc4aa9c of _0x520413){try{if(!_0xc4aa9c||!_0xc4aa9c[_0x18dc81(0x139)])continue;const _0x2ffe5a=_0xc4aa9c[_0x18dc81(0x139)][_0x18dc81(0x13c)]||_0xc4aa9c['remoteJid']||'',_0x10fa09=_0xc4aa9c['key'][_0x18dc81(0xec)+'t']||null;if(_0x2ffe5a!=='status@bro'+_0x18dc81(0xd5)||!_0x10fa09)continue;const _0x3a5122=formatTimestamp(Date[_0x18dc81(0x107)](),DEFAULT_TIMEZONE);info(name+(_0x18dc81(0x98)+'tatus\x20from'+'\x20')+_0x10fa09+_0x18dc81(0xab)+_0x3a5122);try{if(typeof botRef?.[_0x18dc81(0x9d)]?.[_0x18dc81(0xe0)+'es']===_0x18dc81(0x127))await botRef[_0x18dc81(0x9d)][_0x18dc81(0xe0)+'es']([_0xc4aa9c[_0x18dc81(0x139)]]);else{if(typeof botRef?.[_0x18dc81(0x9d)]?.[_0x18dc81(0x7e)]==='function')await botRef[_0x18dc81(0x9d)][_0x18dc81(0x7e)]([_0xc4aa9c['key']]);else typeof botRef?.[_0x18dc81(0xe0)+'es']===_0x18dc81(0x127)&&await botRef[_0x18dc81(0xe0)+'es']([_0xc4aa9c['key']]);}}catch(_0x3cd430){warn(name+(_0x18dc81(0xcf)+'o\x20mark\x20sta'+_0x18dc81(0xcd)+_0x18dc81(0x84))+(_0x3cd430?.['message']||_0x3cd430));}}catch(_0x139a2e){warn(name+(_0x18dc81(0x99)+'op\x20error:\x20')+(_0x139a2e?.[_0x18dc81(0xb7)]||_0x139a2e));}}}catch(_0x1324f9){warn(name+(_0x18dc81(0xdb)+_0x18dc81(0xda)+_0x18dc81(0xee)+_0x18dc81(0xfc))+(_0x1324f9?.[_0x18dc81(0xb7)]||_0x1324f9));}};}function _0x58ca(_0x3356d1,_0x17684b){const _0x53ba50=_0x3f64();return _0x58ca=function(_0x2c442a,_0x379b59){_0x2c442a=_0x2c442a-(0x451*0x7+0x6f+-0x1e29);let _0x3da90f=_0x53ba50[_0x2c442a];return _0x3da90f;},_0x58ca(_0x3356d1,_0x17684b);}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(0x1*-0x13c7+0x7*-0x159+0x755*0x4)*(0x9d*0xc+-0x1e6f*-0x1+-0x21e3);function markCmdProcessed(_0x2c0740){const _0x251780=_0x2a5085;if(!_0x2c0740)return;if(processedCmdKeys[_0x251780(0x108)](_0x2c0740))try{clearTimeout(processedCmdKeys[_0x251780(0xf2)](_0x2c0740));}catch(_0x49029d){};const _0x253a9e=setTimeout(()=>processedCmdKeys[_0x251780(0xd9)](_0x2c0740),CMD_DEDUPE_TTL_MS);processedCmdKeys['set'](_0x2c0740,_0x253a9e);}function isCmdProcessed(_0x4418d2){const _0x2f281b=_0x2a5085;return _0x4418d2&&processedCmdKeys[_0x2f281b(0x108)](_0x4418d2);}export async function onMessage(_0x38f676){const _0x2ef01e=_0x2a5085;try{if(!_0x38f676||!_0x38f676['key']||!_0x38f676[_0x2ef01e(0xb7)]||!_0x38f676[_0x2ef01e(0xaf)])return;if(isJidGroup(_0x38f676[_0x2ef01e(0x139)][_0x2ef01e(0x13c)]))return;const _0x27a099=_0x38f676['key']['fromMe'],_0x4815a3=await isSudo(botRef,_0x38f676)[_0x2ef01e(0xff)](()=>![]);if(!_0x27a099&&!_0x4815a3)return;let _0x351b1e;if(_0x27a099){_0x351b1e=getBotJid();if(!_0x351b1e){warn(name+(_0x2ef01e(0xf7)+_0x2ef01e(0xc8)+_0x2ef01e(0xb5)+_0x2ef01e(0xd6)+'able).'));return;}}else _0x351b1e=_0x38f676[_0x2ef01e(0x139)]['remoteJid'];const _0x27f037=String(_0x38f676['key'][_0x2ef01e(0x13c)]||'')+'::'+String(_0x38f676[_0x2ef01e(0x139)]['id']||_0x38f676[_0x2ef01e(0x139)]['participan'+'t']||'');if(isCmdProcessed(_0x27f037))return;markCmdProcessed(_0x27f037);const _0x3054c0=typeof _0x38f676[_0x2ef01e(0xe8)]===_0x2ef01e(0x11f)&&_0x38f676[_0x2ef01e(0xe8)]['trim']()[_0x2ef01e(0xce)]?_0x38f676['text'][_0x2ef01e(0xeb)]():function _0x58cf47(_0xa2606b){const _0x4c03aa=_0x2ef01e;if(!_0xa2606b||!_0xa2606b[_0x4c03aa(0xb7)])return'';const _0xb243b=_0xa2606b[_0x4c03aa(0xb7)];if(_0xb243b[_0x4c03aa(0x12b)+'on'])return _0xb243b[_0x4c03aa(0x12b)+'on'];if(_0xb243b[_0x4c03aa(0x12c)+_0x4c03aa(0x113)]?.[_0x4c03aa(0xe8)])return _0xb243b[_0x4c03aa(0x12c)+'xtMessage'][_0x4c03aa(0xe8)];if(_0xb243b[_0x4c03aa(0x8f)+'ge']?.[_0x4c03aa(0x111)])return _0xb243b[_0x4c03aa(0x8f)+'ge']['caption'];if(_0xb243b[_0x4c03aa(0xf9)+'ge']?.['caption'])return _0xb243b['videoMessa'+'ge'][_0x4c03aa(0x111)];if(_0xb243b['buttonsRes'+_0x4c03aa(0xf0)+'ge']?.['selectedBu'+'ttonId'])return _0xb243b[_0x4c03aa(0xde)+'ponseMessa'+'ge'][_0x4c03aa(0x91)+_0x4c03aa(0xd8)];if(_0xb243b[_0x4c03aa(0xc9)+_0x4c03aa(0xca)]?.['singleSele'+'ctReply']?.['selectedRo'+'wId'])return _0xb243b[_0x4c03aa(0xc9)+_0x4c03aa(0xca)]['singleSele'+'ctReply'][_0x4c03aa(0x114)+_0x4c03aa(0x120)];return'';}(_0x38f676)||'';if(!_0x3054c0)return;const _0x49aa39=(_0x3054c0[_0x2ef01e(0xf3)](/\r?\n/)[-0x10f4+-0x1f21+0x3015]||'')['trim'](),_0xbe44bc=_0x49aa39[_0x2ef01e(0xf3)](/\s+/),_0x53d22a=(_0xbe44bc[-0x48b*0x5+-0x22bd+0x3974]||'')['toLowerCas'+'e']();if(!commands[_0x2ef01e(0x105)](_0x53d22a))return;const _0x25aad6=(_0xbe44bc[0x1dd8+-0xc37+0x2f*-0x60]||'')['toLowerCas'+'e']();if(['on',_0x2ef01e(0xa9),_0x2ef01e(0xfb),'1'][_0x2ef01e(0x105)](_0x25aad6)){const _0xa88b34=await saveEnabledToDb(!![]);if(_0xa88b34)await sendConfirmation(_0x351b1e,'[autoviews'+_0x2ef01e(0x90)+_0x2ef01e(0xbf));else await sendConfirmation(_0x351b1e,'[autoviews'+_0x2ef01e(0xcc)+_0x2ef01e(0x9f)+_0x2ef01e(0xa5));return;}if([_0x2ef01e(0xe6),'disable',_0x2ef01e(0x8c),'0'][_0x2ef01e(0x105)](_0x25aad6)){const _0x106589=await saveEnabledToDb(![]);if(_0x106589)await sendConfirmation(_0x351b1e,_0x2ef01e(0xd2)+_0x2ef01e(0xa0)+'abled');else await sendConfirmation(_0x351b1e,_0x2ef01e(0xd2)+_0x2ef01e(0xcc)+_0x2ef01e(0xba)+'able');return;}if(_0x25aad6==='status'||_0x25aad6===_0x2ef01e(0xd4)||!_0x25aad6){const _0x1106e8=await readEnabledFromDb(),_0x2ebb6c=_0x1106e8?'ENABLED':_0x2ef01e(0xb3);await sendConfirmation(_0x351b1e,_0x2ef01e(0xcb)+'wer\x0a\x0aState'+':\x20'+_0x2ebb6c+(_0x2ef01e(0xa4)+'\x20')+DEFAULT_TIMEZONE);return;}await sendConfirmation(_0x351b1e,_0x2ef01e(0xaa)+_0x2ef01e(0x112)+(_0x2ef01e(0xae)+_0x2ef01e(0x100)+_0x2ef01e(0xc2)+_0x2ef01e(0xef))+(_0x2ef01e(0xae)+_0x2ef01e(0x92)+_0x2ef01e(0x106)+_0x2ef01e(0x126))+('\x20autoviews'+_0x2ef01e(0x11e)+_0x2ef01e(0xbe)+_0x2ef01e(0x93)+'te'));}catch(_0x3c10da){warn(name+(':\x20onMessag'+_0x2ef01e(0x10e))+(_0x3c10da?.[_0x2ef01e(0xb7)]||_0x3c10da));}}async function sendConfirmation(_0x47dd84,_0x24e3f3){const _0x172d0e=_0x2a5085;try{if(!_0x47dd84)return;if(botRef&&botRef['sock']&&typeof botRef[_0x172d0e(0x9d)][_0x172d0e(0x133)+'e']===_0x172d0e(0x127))await botRef[_0x172d0e(0x9d)][_0x172d0e(0x133)+'e'](_0x47dd84,{'text':_0x24e3f3});else botRef&&typeof botRef[_0x172d0e(0x133)+'e']===_0x172d0e(0x127)?await botRef[_0x172d0e(0x133)+'e'](_0x47dd84,{'text':_0x24e3f3}):warn(name+(':\x20no\x20sendM'+'essage\x20met'+_0x172d0e(0x88)+_0x172d0e(0x11a)+_0x172d0e(0xb4)));}catch(_0x2af9ac){warn(name+(_0x172d0e(0x12f)+_0x172d0e(0x103)+_0x172d0e(0x117))+(_0x2af9ac?.[_0x172d0e(0xb7)]||_0x2af9ac));}}export async function initialize(_0x29581b){const _0xf468d8=_0x2a5085;if(!_0x29581b)throw new Error(_0xf468d8(0x8d)+_0xf468d8(0xe1)+'lize\x20requi'+_0xf468d8(0x87)+_0xf468d8(0xc1));botRef=_0x29581b,shuttingDown=![],refreshConfig(),await ensurePrefsTable()['catch'](_0x487df4=>{const _0x3b0d09=_0xf468d8;warn(name+(_0x3b0d09(0xfa)+'failed:\x20')+(_0x487df4?.[_0x3b0d09(0xb7)]||_0x487df4));}),messageHandler=createMessageHandler(),startManagedListener({'botRef':botRef,'eventName':'messages.u'+_0xf468d8(0xb9),'handler':messageHandler,'moduleName':name}),info(name+(_0xf468d8(0x10c)+_0xf468d8(0x136)));}export async function cleanup(){const _0x46ef4a=_0x2a5085;try{stopManagedListener(name,_0x46ef4a(0xc7)+'psert'),shuttingDown=!![],messageHandler=null;}catch(_0x3f56dd){warn(name+(_0x46ef4a(0xa6)+_0x46ef4a(0x95))+(_0x3f56dd?.[_0x46ef4a(0xb7)]||_0x3f56dd));}finally{botRef=null,info(name+(_0x46ef4a(0xf4)+'up'));}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};