const _0x38da5b=_0x52c1;(function(_0x3ae741,_0x4eb4ef){const _0x3636a2=_0x52c1,_0x448397=_0x3ae741();while(!![]){try{const _0x425111=-parseInt(_0x3636a2(0x23c))/(0x4ca+0x118f+-0x2c*0x82)*(parseInt(_0x3636a2(0x1fc))/(0x2*0x1247+-0xc30+-0x185c))+-parseInt(_0x3636a2(0x1a4))/(0x7de+0x1*0x17b+0x956*-0x1)*(parseInt(_0x3636a2(0x1ea))/(0x53*0x61+-0xa40+-0x11*0x13f))+-parseInt(_0x3636a2(0x1b0))/(0x1d50+0x5b+-0xed3*0x2)+parseInt(_0x3636a2(0x1a1))/(0x3*-0x4e9+0x1*0x17b+0x6a3*0x2)*(parseInt(_0x3636a2(0x1ec))/(0x1*0x19df+-0x1*0x5d2+-0xa03*0x2))+-parseInt(_0x3636a2(0x23e))/(-0x733+-0xef1+0x162c)*(parseInt(_0x3636a2(0x1f5))/(0x4db*0x1+0x1c*-0x119+0x19ea))+-parseInt(_0x3636a2(0x1fe))/(0x256c+0xe35+0x2f*-0x119)+-parseInt(_0x3636a2(0x18a))/(-0xe2c+-0xd*-0x20f+-0xc8c)*(-parseInt(_0x3636a2(0x1cd))/(0x2476+0xa64+-0x1767*0x2));if(_0x425111===_0x4eb4ef)break;else _0x448397['push'](_0x448397['shift']());}catch(_0xdd7a04){_0x448397['push'](_0x448397['shift']());}}}(_0x40f7,0x3dd2d*-0x1+-0x4c930+0xbe1b8));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name=_0x38da5b(0x193);export const version=_0x38da5b(0x1a6)+_0x38da5b(0x1f2);export const priority=0x2e*0xca+0xf0f+-0x3301;export const commands=[_0x38da5b(0x193),'resetspam'];export const configKeys=[_0x38da5b(0x240)];let botRef=null,sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(0x1741+0xa39+-0x10ae*0x2)*(0xe3*0x28+0x4*-0x6fd+-0x39c),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(-0x10a2+0xca*0x1d+0xa*-0x9f)*(-0xef5+0x399*0xa+-0x111d*0x1),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(-0x3a*-0x7+0x1*0xd71+-0xf00)*(0x105*0x12+0xe72*0x1+-0x20b4)*(-0x21c4+-0x2*0xb53+0x38a6)*(0x1879+0x181a+0x2d*-0x113)*(-0x2b*-0xe7+-0x7da+-0x1b0b),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x38da5b(0x1dc)+_0x38da5b(0x215)+'ing.\x20Remai'+_0x38da5b(0x1e4)+_0x38da5b(0x1c9)+'ings}','WARNING_TTL_MS':0xc350};function _0x40f7(){const _0x2081be=['cement.\x20DB','HOLD','onfig\x20erro','isCommand','d\x20spam.','Y_MS','KICK_ON_SP','e\x20FROM\x20sql','\x20WHERE\x20cha','nabled\x20DB\x20','\x20enabled\x20F','\x20failed\x20to','COMMIT;','_jid,\x20enab','sAt','replace','endsWith',']\x20migrateS','Y,\x20enabled','includes','le_info(','\x20\x20ON\x20CONFL','WARNING_ME','SPAM_WINDO','ngs','SELECT\x20nam','split','CREATE\x20TAB','warnExpire','109Mouxjc','o\x20create\x20','2240IHtHTn','L_MS','SPAM','lastWarnAt','ot\x20instanc','o\x20disable\x20','resetspam','rows','.\x20Threshol','push','\x20(chat_id\x20','participan','chat_id','sock','enabled','roup.','anti-spam\x20','m\x20DISABLED','WARNING_TT','not\x20availa','T\x20chat_id,','m\x20for\x20this','trim','xtMessage','text','ENABLED',']\x20getChatE','group.','AND\x20name=?','ns=','nti-spam\x20(','up.','from','string','W_MS','\x20WHERE\x20typ',']\x20failed\x20t','187396CDHDmk','fromMe','SSAGE','o\x20kick\x20','isArray',']\x20Failed\x20t','\x20VALUES\x20(?','SELECT\x20*\x20F','SELECT\x20ena','antispam','clear','INSERT\x20OR\x20','MAX_WARNIN',']\x20Migratio',']\x20Ensuring','t_jid\x20=\x20?','messages.u','has','\x20LIMIT\x201','ROM\x20',']\x20onMessag','andler\x20inn',':\x20sendApi\x20','2874letnmx','sIfNeeded\x20',']\x20Created\x20','3FDqBaZ',']\x20stopMana','2.0.0-inme','->\x20chat_ji','REPLACE\x20IN','name','filter','stringify',']\x20handleMe','{warnings}','\x20exists\x20wi','max','2062660cYGVHB','bled;','antispam.i','✔️\x20Please\x20@','abled\x20=\x20ex','groupParti','values','WARN_EXPIR','remove','ms,\x20maxWar','ALTER\x20TABL','ailed:\x20','warnCount','(DB\x20error)','message','psert','off',']\x20rawMessa','error\x20for\x20','✔️\x20Anti-spa','remoteJid','OWN_MS','\x20within\x20','d\x20columns.','\x20failed:\x20','ngs:\x20{warn',']\x20kicked\x20','cid','@g.us','852XGYIvr','EXISTS\x20',']\x20setChatE','nabled\x20INT','set','forEach','exec','ite_master',']\x20kickUser',']\x20refreshC','ARY\x20KEY,\x20e','delete','m\x20warnings','TO\x20','for\x20this\x20g','⚠️\x20{user},\x20',']\x20sendText','E\x20TO\x20','\x20user(s).','chat_jid','contextInf','\x20group:\x20',']\x20Migrated','ning\x20warni','\x20reset\x20for',',\x20enabled)','catch','extendedTe','sendMessag','1412008QvoLyQ','length','3269SObfvL','\x20warnings.','gedListene','users\x20to\x20r','_new\x20RENAM','_new\x20(chat','mory','LE\x20IF\x20NOT\x20','\x20removed\x20f','11322MKaqoy','\x0aConfig:\x20','slice','ICT(chat_j','requires\x20b','get',',\x20?)\x20\x0a\x20\x20\x20\x20','1834jvyKpz','cluded.ena','37190HdasRa','SPAM_COOLD','ate','mory\x20enfor','toLowerCas','⚠️\x20Failed\x20t','show','keys','timestamps','n\x20of\x20','map','INSERT\x20INT',']\x20tableExi','m\x20ENABLED\x20','\x20from\x20','th\x20expecte',']\x20cleaned\x20','run','key','\x20(chat_jid','r\x20failed:\x20','SACTION;','\x20holds\x20onl','stop\x20spamm',']\x20initiali','DROP\x20TABLE','DISABLED','find','bled\x20FROM\x20','EGER);','ATE\x20SET\x20en','SPAM_THRES','led)\x20SELEC'];_0x40f7=function(){return _0x2081be;};return _0x40f7();}function refreshConfig(){const _0x5dbdb9=_0x38da5b;try{const _0x396503=getConfig?.()?.['SPAM']||{};Object['keys'](CFG)[_0x5dbdb9(0x1d2)](_0x2a85f0=>{if(_0x396503[_0x2a85f0]!==undefined)CFG[_0x2a85f0]=_0x396503[_0x2a85f0];}),CFG[_0x5dbdb9(0x21d)+'HOLD']=Math[_0x5dbdb9(0x1af)](0x1*-0x1655+0x5e*0x59+-0xa58,Number(CFG[_0x5dbdb9(0x21d)+_0x5dbdb9(0x220)])||-0x1*0x19c+0x1*0x17c2+-0x1620),CFG['SPAM_WINDO'+'W_MS']=Math[_0x5dbdb9(0x1af)](0xaea+0x9b7+-0x14a1,Number(CFG['SPAM_WINDO'+_0x5dbdb9(0x187)])||(-0x21df+0xc6d+-0x44c*-0x5)*(0x260b+0x21e*-0x3+-0x1bc9)),CFG[_0x5dbdb9(0x1ff)+'OWN_MS']=Math[_0x5dbdb9(0x1af)](0x2205+-0x5*-0x2a2+-0x2f2f*0x1,Number(CFG[_0x5dbdb9(0x1ff)+_0x5dbdb9(0x1c5)])||0xecc+-0x489+-0x65b),CFG[_0x5dbdb9(0x196)+'GS']=Math[_0x5dbdb9(0x1af)](-0x1*-0x1115+-0x2a1*-0x8+-0x32d*0xc,Number(CFG[_0x5dbdb9(0x196)+'GS'])||-0x8f0+0x221e+-0x1*0x192b),CFG[_0x5dbdb9(0x1b7)+'Y_MS']=Math[_0x5dbdb9(0x1af)](-0x1e7*0xd+0xd3f+0x69*0x1c,Number(CFG[_0x5dbdb9(0x1b7)+'Y_MS'])||(0x3*-0x69d+-0x222b*-0x1+0x1*-0xe4d)*(0x3*0xba6+-0xb14+-0x17c6)*(-0x4c6+-0x1539+0x1a3b)*(0x1c82+-0x1*0xdbd+0xe89*-0x1)*(-0xcde+-0x12b1+0x2377)),CFG[_0x5dbdb9(0x250)+_0x5dbdb9(0x23f)]=Math[_0x5dbdb9(0x1af)](-0x1dd0+-0x1d*0x51+-0x26fd*-0x1,Number(CFG['WARNING_TT'+_0x5dbdb9(0x23f)])||0x6b73+0xe3*-0xc1+0x10300),CFG[_0x5dbdb9(0x225)+'AM']=!!CFG[_0x5dbdb9(0x225)+'AM'];}catch(_0x1549ee){warn('['+name+(_0x5dbdb9(0x1d6)+_0x5dbdb9(0x221)+'r:\x20')+(_0x1549ee?.[_0x5dbdb9(0x1be)]||_0x1549ee));}}function _0x52c1(_0x1dbe46,_0x41a836){const _0x12fd1e=_0x40f7();return _0x52c1=function(_0x5bfccb,_0x421104){_0x5bfccb=_0x5bfccb-(0x74*0x7+0x3a5*0x9+-0x2272);let _0x4ee7c8=_0x12fd1e[_0x5bfccb];return _0x4ee7c8;},_0x52c1(_0x1dbe46,_0x41a836);}const TABLE_SETTINGS='spam_setti'+_0x38da5b(0x237);async function tableExists(_0x4cd2e1){const _0x558ff9=_0x38da5b;try{const _0x4a39f2=await db[_0x558ff9(0x1fa)](_0x558ff9(0x238)+_0x558ff9(0x226)+_0x558ff9(0x1d4)+_0x558ff9(0x188)+'e=\x27table\x27\x20'+_0x558ff9(0x25a),[_0x4cd2e1]);return!!_0x4a39f2;}catch(_0x5274d1){return warn('['+name+(_0x558ff9(0x20a)+'sts(')+_0x4cd2e1+')\x20error:\x20'+(_0x5274d1?.[_0x558ff9(0x1be)]||_0x5274d1)),![];}}async function getTableColumns(_0x49a7ef){const _0x2c3030=_0x38da5b;try{const _0x1a22dd=await db[_0x2c3030(0x1d3)]('PRAGMA\x20tab'+_0x2c3030(0x233)+_0x49a7ef+');'),_0xdf76ce=Array['isArray'](_0x1a22dd)?_0x1a22dd:_0x1a22dd&&_0x1a22dd[_0x2c3030(0x245)]?_0x1a22dd['rows']:[];return _0xdf76ce[_0x2c3030(0x208)](_0x19fa37=>_0x19fa37[_0x2c3030(0x1a9)]||_0x19fa37['column_nam'+'e']||_0x19fa37[_0x2c3030(0x1cb)]);}catch(_0x337700){try{const _0xbf6675=await db[_0x2c3030(0x1fa)](_0x2c3030(0x191)+_0x2c3030(0x19d)+_0x49a7ef+_0x2c3030(0x19c));return _0xbf6675?Object[_0x2c3030(0x205)](_0xbf6675):[];}catch(_0x40978d){return[];}}}async function migrateSpamSettingsIfNeeded(){const _0x375e50=_0x38da5b,_0x15f679=await tableExists(TABLE_SETTINGS);if(!_0x15f679)try{await db[_0x375e50(0x1d3)](_0x375e50(0x23a)+_0x375e50(0x1f3)+_0x375e50(0x1ce)+TABLE_SETTINGS+(_0x375e50(0x211)+'\x20TEXT\x20PRIM'+_0x375e50(0x1d7)+_0x375e50(0x1d0)+_0x375e50(0x21b))),info('['+name+(_0x375e50(0x1a3)+'table\x20')+TABLE_SETTINGS);return;}catch(_0x3a8c99){warn('['+name+(_0x375e50(0x18f)+_0x375e50(0x23d))+TABLE_SETTINGS+':\x20'+(_0x3a8c99?.[_0x375e50(0x1be)]||_0x3a8c99));return;}try{const _0x28d173=await db[_0x375e50(0x1d3)]('PRAGMA\x20tab'+_0x375e50(0x233)+TABLE_SETTINGS+');');let _0x5f1efb=[];if(Array[_0x375e50(0x18e)](_0x28d173))_0x5f1efb=_0x28d173['map'](_0x42aad4=>_0x42aad4['name']||_0x42aad4[-0x337*-0x1+0x1d2+-0x38*0x17])['filter'](Boolean);else{if(_0x28d173&&Array[_0x375e50(0x18e)](_0x28d173[_0x375e50(0x245)]))_0x5f1efb=_0x28d173[_0x375e50(0x245)]['map'](_0x27a322=>_0x27a322['name'])[_0x375e50(0x1aa)](Boolean);else try{const _0x11f31b=await db[_0x375e50(0x1fa)](_0x375e50(0x191)+'ROM\x20'+TABLE_SETTINGS+_0x375e50(0x19c));_0x5f1efb=_0x11f31b?Object[_0x375e50(0x205)](_0x11f31b):[];}catch(_0x2bc2d1){_0x5f1efb=[];}}const _0x4771f6=_0x5f1efb[_0x375e50(0x208)](_0x1c9c91=>String(_0x1c9c91)[_0x375e50(0x202)+'e']()),_0x184813=_0x4771f6[_0x375e50(0x232)](_0x375e50(0x1e0)),_0x286598=_0x4771f6[_0x375e50(0x232)](_0x375e50(0x24c)),_0x1fa96f=_0x4771f6[_0x375e50(0x232)](_0x375e50(0x24a));if(_0x184813&&_0x286598)return;if(!_0x184813&&_0x1fa96f)try{await db[_0x375e50(0x1d3)]('BEGIN\x20TRAN'+_0x375e50(0x213)),await db[_0x375e50(0x1d3)](_0x375e50(0x23a)+'LE\x20IF\x20NOT\x20'+_0x375e50(0x1ce)+TABLE_SETTINGS+('_new\x20(chat'+'_jid\x20TEXT\x20'+'PRIMARY\x20KE'+_0x375e50(0x231)+'\x20INTEGER);'));const _0x44fcf9=_0x286598;_0x44fcf9?await db[_0x375e50(0x1d3)]('INSERT\x20OR\x20'+_0x375e50(0x1a8)+_0x375e50(0x1da)+TABLE_SETTINGS+(_0x375e50(0x1f1)+'_jid,\x20enab'+_0x375e50(0x21e)+'T\x20chat_id,'+_0x375e50(0x229)+_0x375e50(0x19d))+TABLE_SETTINGS+';'):await db[_0x375e50(0x1d3)](_0x375e50(0x195)+_0x375e50(0x1a8)+_0x375e50(0x1da)+TABLE_SETTINGS+(_0x375e50(0x1f1)+_0x375e50(0x22c)+'led)\x20SELEC'+_0x375e50(0x252)+'\x200\x20FROM\x20')+TABLE_SETTINGS+';');await db[_0x375e50(0x1d3)](_0x375e50(0x217)+'\x20'+TABLE_SETTINGS+';'),await db[_0x375e50(0x1d3)](_0x375e50(0x1ba)+'E\x20'+TABLE_SETTINGS+(_0x375e50(0x1f0)+_0x375e50(0x1de))+TABLE_SETTINGS+';'),await db[_0x375e50(0x1d3)](_0x375e50(0x22b)),info('['+name+(_0x375e50(0x1e3)+'\x20')+TABLE_SETTINGS+(_0x375e50(0x248)+_0x375e50(0x1a7)+'d)'));return;}catch(_0x35377a){try{await db['exec']('ROLLBACK;');}catch(_0x4b958e){}warn('['+name+(_0x375e50(0x197)+_0x375e50(0x207))+TABLE_SETTINGS+_0x375e50(0x1c8)+(_0x35377a?.[_0x375e50(0x1be)]||_0x35377a));return;}if(!_0x184813||!_0x286598)try{await db[_0x375e50(0x1d3)](_0x375e50(0x23a)+_0x375e50(0x1f3)+_0x375e50(0x1ce)+TABLE_SETTINGS+(_0x375e50(0x211)+'\x20TEXT\x20PRIM'+_0x375e50(0x1d7)+'nabled\x20INT'+_0x375e50(0x21b))),info('['+name+']\x20Ensured\x20'+TABLE_SETTINGS+(_0x375e50(0x1ae)+_0x375e50(0x20d)+_0x375e50(0x1c7)));}catch(_0x28ad99){warn('['+name+(_0x375e50(0x198)+'\x20')+TABLE_SETTINGS+('\x20columns\x20f'+_0x375e50(0x1bb))+(_0x28ad99?.[_0x375e50(0x1be)]||_0x28ad99));}}catch(_0x2ad638){warn('['+name+(_0x375e50(0x230)+'pamSetting'+_0x375e50(0x1a2)+'error:\x20')+(_0x2ad638?.[_0x375e50(0x1be)]||_0x2ad638));}}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x25da50=_0x38da5b;if(!botRef)return;if(typeof botRef[_0x25da50(0x1e9)+'e']==='function')sendApi=async(_0x155e46,_0x571f09)=>await botRef['sendMessag'+'e'](_0x155e46,_0x571f09);else{if(botRef[_0x25da50(0x24b)]&&typeof botRef[_0x25da50(0x24b)][_0x25da50(0x1e9)+'e']==='function')sendApi=async(_0x34f3f0,_0x5ad2f9)=>await botRef['sock'][_0x25da50(0x1e9)+'e'](_0x34f3f0,_0x5ad2f9);else sendApi=null;}}async function sendText(_0x3fd662,_0x1d0862,_0x17771a=[]){const _0x1dbffd=_0x38da5b;if(!_0x1d0862||!_0x3fd662)return null;if(!sendApi)return warn('['+name+(_0x1dbffd(0x1dd)+_0x1dbffd(0x1a0)+_0x1dbffd(0x251)+'ble')),null;try{const _0x3a5be7=typeof _0x1d0862===_0x1dbffd(0x25f)?{'text':_0x1d0862}:_0x1d0862;if(Array[_0x1dbffd(0x18e)](_0x17771a)&&_0x17771a[_0x1dbffd(0x1eb)])_0x3a5be7['mentions']=_0x17771a;return await sendApi(_0x3fd662,_0x3a5be7);}catch(_0x30fae6){return warn('['+name+(_0x1dbffd(0x1dd)+_0x1dbffd(0x22a)+'\x20')+_0x3fd662+':\x20'+(_0x30fae6?.['message']||_0x30fae6)),null;}}async function kickUser(_0x8c54b3,_0x52a876){const _0x3c781=_0x38da5b;try{const _0xb2b5f9=botRef[_0x3c781(0x24b)]?.[_0x3c781(0x1b5)+'cipantsUpd'+'ate']||botRef['groupParti'+'cipantsUpd'+_0x3c781(0x200)];if(_0xb2b5f9)return await _0xb2b5f9(_0x8c54b3,[_0x52a876],_0x3c781(0x1b8)),info('['+name+_0x3c781(0x1ca)+_0x52a876+_0x3c781(0x20c)+_0x8c54b3),!![];return![];}catch(_0x3dd7ee){return warn('['+name+(_0x3c781(0x1d5)+_0x3c781(0x1c8))+(_0x3dd7ee?.[_0x3c781(0x1be)]||_0x3dd7ee)),![];}}async function getChatEnabled(_0x5c1ecd){const _0x440050=_0x38da5b;try{const _0x31605d=await db[_0x440050(0x1fa)](_0x440050(0x192)+_0x440050(0x21a)+TABLE_SETTINGS+(_0x440050(0x227)+_0x440050(0x199)),[_0x5c1ecd]);return _0x31605d?Number(_0x31605d[_0x440050(0x24c)])===0x680+0x1*0x1931+-0x2a4*0xc:![];}catch(_0x9af32f){return warn('['+name+(_0x440050(0x258)+_0x440050(0x228)+_0x440050(0x1c2))+_0x5c1ecd+':\x20'+(_0x9af32f?.[_0x440050(0x1be)]||_0x9af32f)),![];}}async function setChatEnabled(_0x39a043,_0x19d809){const _0x2462ae=_0x38da5b;try{return await db[_0x2462ae(0x20f)](_0x2462ae(0x209)+'O\x20'+TABLE_SETTINGS+(_0x2462ae(0x211)+_0x2462ae(0x1e6)+_0x2462ae(0x190)+_0x2462ae(0x1fb)+_0x2462ae(0x234)+_0x2462ae(0x1f8)+'id)\x20DO\x20UPD'+_0x2462ae(0x21c)+_0x2462ae(0x1b4)+_0x2462ae(0x1fd)+_0x2462ae(0x1b1)),[_0x39a043,_0x19d809?-0x5*0x6d1+-0x1*0xf8c+0x31a2:0x3*-0x4d4+-0x4*0x8a9+0x3120]),!![];}catch(_0x12b1c0){return warn('['+name+(_0x2462ae(0x1cf)+'nabled\x20DB\x20'+_0x2462ae(0x1c2))+_0x39a043+':\x20'+(_0x12b1c0?.[_0x2462ae(0x1be)]||_0x12b1c0)),![];}}function ensureChatMap(_0x3ee478){const _0x12c78c=_0x38da5b;if(!chatUserMap[_0x12c78c(0x19b)](_0x3ee478))chatUserMap['set'](_0x3ee478,new Map());return chatUserMap[_0x12c78c(0x1fa)](_0x3ee478);}function clearChatMemory(_0x5632ab){const _0x179904=_0x38da5b;if(chatUserMap['has'](_0x5632ab))chatUserMap[_0x179904(0x1d8)](_0x5632ab);}async function handleMessageForSpam(_0xfdc3b7){const _0x7d6b9f=_0x38da5b;try{const _0x2bb1e3=String(_0xfdc3b7[_0x7d6b9f(0x210)]?.[_0x7d6b9f(0x1c4)]||'');if(!_0x2bb1e3||!_0x2bb1e3[_0x7d6b9f(0x22f)](_0x7d6b9f(0x1cc)))return;if(_0xfdc3b7[_0x7d6b9f(0x210)]?.[_0x7d6b9f(0x18b)])return;const _0x2e09ec=await getChatEnabled(_0x2bb1e3);if(!_0x2e09ec)return;const _0x4c5452=String(_0xfdc3b7[_0x7d6b9f(0x210)]?.[_0x7d6b9f(0x249)+'t']||_0xfdc3b7[_0x7d6b9f(0x210)]?.[_0x7d6b9f(0x25e)]||'');if(!_0x4c5452)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x2bb1e3,'participant':_0x4c5452},'message':_0xfdc3b7[_0x7d6b9f(0x1be)]}))return;}catch(_0x13ddce){}const _0x50c0e4=Date['now'](),_0x48f8a9=ensureChatMap(_0x2bb1e3);!_0x48f8a9['has'](_0x4c5452)&&_0x48f8a9[_0x7d6b9f(0x1d1)](_0x4c5452,{'timestamps':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x32823=_0x48f8a9[_0x7d6b9f(0x1fa)](_0x4c5452);_0x32823[_0x7d6b9f(0x206)]=(_0x32823[_0x7d6b9f(0x206)]||[])[_0x7d6b9f(0x1aa)](_0x4714c0=>_0x50c0e4-_0x4714c0<=CFG[_0x7d6b9f(0x236)+'W_MS']),_0x32823[_0x7d6b9f(0x206)][_0x7d6b9f(0x247)](_0x50c0e4);if(_0x32823[_0x7d6b9f(0x241)]&&_0x50c0e4-_0x32823['lastWarnAt']<CFG[_0x7d6b9f(0x1ff)+_0x7d6b9f(0x1c5)])return;if((_0x32823[_0x7d6b9f(0x206)]||[])[_0x7d6b9f(0x1eb)]>=CFG[_0x7d6b9f(0x21d)+_0x7d6b9f(0x220)]){_0x32823[_0x7d6b9f(0x241)]=_0x50c0e4;(!_0x32823[_0x7d6b9f(0x23b)+_0x7d6b9f(0x22d)]||_0x32823[_0x7d6b9f(0x23b)+_0x7d6b9f(0x22d)]<=_0x50c0e4)&&(_0x32823[_0x7d6b9f(0x1bc)]=-0x1ff9+-0x147*0x1a+0x412f);_0x32823['warnCount']=(_0x32823[_0x7d6b9f(0x1bc)]||0xaee+-0x14c*-0x1a+0x2ca6*-0x1)+(-0x456+0x1*-0x1c91+0x68*0x51),_0x32823[_0x7d6b9f(0x23b)+_0x7d6b9f(0x22d)]=_0x50c0e4+CFG[_0x7d6b9f(0x1b7)+_0x7d6b9f(0x224)];const _0x42b87d=Math['max'](-0xee9+0x407+0xae2,CFG[_0x7d6b9f(0x196)+'GS']-_0x32823['warnCount']),_0x3b6bdf='@'+_0x4c5452[_0x7d6b9f(0x239)]('@')[0x1bac+0x195*-0x6+-0x166*0xd],_0x26afd8=String(CFG[_0x7d6b9f(0x235)+_0x7d6b9f(0x18c)]||'')[_0x7d6b9f(0x22e)]('{user}',_0x3b6bdf)[_0x7d6b9f(0x22e)](_0x7d6b9f(0x1ad),String(_0x42b87d)),_0x4d403e=await sendText(_0x2bb1e3,{'text':_0x26afd8,'mentions':[_0x4c5452]});_0x4d403e?.[_0x7d6b9f(0x210)]&&CFG[_0x7d6b9f(0x250)+_0x7d6b9f(0x23f)]>-0x53*-0x57+-0xf1*0xd+0x7fc*-0x2&&setTimeout(async()=>{try{await sendText(_0x2bb1e3,{'delete':_0x4d403e['key']});}catch(_0x39e419){}},CFG[_0x7d6b9f(0x250)+_0x7d6b9f(0x23f)]);if(CFG[_0x7d6b9f(0x225)+'AM']&&_0x32823[_0x7d6b9f(0x1bc)]>=CFG[_0x7d6b9f(0x196)+'GS']){const _0x5137e4=await kickUser(_0x2bb1e3,_0x4c5452);_0x5137e4?(_0x48f8a9[_0x7d6b9f(0x1d8)](_0x4c5452),await sendText(_0x2bb1e3,{'text':_0x3b6bdf+(_0x7d6b9f(0x1f4)+'or\x20repeate'+_0x7d6b9f(0x223)),'mentions':[_0x4c5452]})[_0x7d6b9f(0x1e7)](()=>{})):warn('['+name+(_0x7d6b9f(0x189)+_0x7d6b9f(0x18d))+_0x4c5452+_0x7d6b9f(0x20c)+_0x2bb1e3);}}}catch(_0x3898e8){warn('['+name+(_0x7d6b9f(0x1ac)+'ssageForSp'+'am\x20error:\x20')+(_0x3898e8?.[_0x7d6b9f(0x1be)]||_0x3898e8));}}async function rawMessagesUpsertHandler({messages:_0x63d56b}){const _0x183100=_0x38da5b;if(!Array['isArray'](_0x63d56b))return;for(const _0x239515 of _0x63d56b){try{const _0x219354=String(_0x239515[_0x183100(0x210)]?.['remoteJid']||'');if(!_0x219354||!_0x219354[_0x183100(0x22f)](_0x183100(0x1cc)))continue;if(!_0x239515[_0x183100(0x1be)])continue;if(_0x239515[_0x183100(0x210)]?.[_0x183100(0x18b)])continue;const _0xa21b8=_0x219354+'::'+String(_0x239515[_0x183100(0x210)]?.['id']||'')+'::'+String(_0x239515['key']?.[_0x183100(0x249)+'t']||'');if(processedMessageKeys[_0x183100(0x19b)](_0xa21b8))continue;const _0x5bc9cf=setTimeout(()=>processedMessageKeys[_0x183100(0x1d8)](_0xa21b8),DEDUPE_TTL_MS);processedMessageKeys[_0x183100(0x1d1)](_0xa21b8,_0x5bc9cf),await handleMessageForSpam(_0x239515);}catch(_0x316924){warn('['+name+(_0x183100(0x1c1)+'gesUpsertH'+_0x183100(0x19f)+'er\x20error:\x20')+(_0x316924?.[_0x183100(0x1be)]||_0x316924));}}}export async function onMessage(_0xe2a60c){const _0x3b08c1=_0x38da5b;try{if(!_0xe2a60c||!_0xe2a60c[_0x3b08c1(0x210)]||!_0xe2a60c[_0x3b08c1(0x1be)]||!_0xe2a60c[_0x3b08c1(0x222)])return;const _0x106aaf=String(_0xe2a60c['key'][_0x3b08c1(0x1c4)]||'');if(!_0x106aaf['endsWith']('@g.us'))return;if(!await isadmin(botRef,_0xe2a60c))return;const _0x317a32=typeof _0xe2a60c[_0x3b08c1(0x256)]===_0x3b08c1(0x25f)&&_0xe2a60c['text'][_0x3b08c1(0x254)]()[_0x3b08c1(0x1eb)]?_0xe2a60c[_0x3b08c1(0x256)]['trim']():'';if(!_0x317a32)return;const _0x41a160=_0x317a32['split'](/\s+/)[_0x3b08c1(0x1aa)](Boolean);if(!_0x41a160['length'])return;const _0x4e9379=String(_0x41a160[-0x151*0x1+-0x18e7+0x1a38]||'')[_0x3b08c1(0x202)+'e'](),_0xd2350f=_0x41a160[_0x3b08c1(0x1f7)](0x47*-0x8+0x2469+-0x2230);if(!commands[_0x3b08c1(0x232)](_0x4e9379))return;if(_0x4e9379==='antispam'){const _0x4d9947=(_0xd2350f[_0x3b08c1(0x219)](_0x195675=>['on',_0x3b08c1(0x1c0),_0x3b08c1(0x204)][_0x3b08c1(0x232)](String(_0x195675)[_0x3b08c1(0x202)+'e']()))||_0x3b08c1(0x204))['toLowerCas'+'e']();if(_0x4d9947==='on'){const _0x456134=await setChatEnabled(_0x106aaf,!![]);return _0x456134?(clearChatMemory(_0x106aaf),sendText(_0x106aaf,_0x3b08c1(0x1c3)+_0x3b08c1(0x20b)+_0x3b08c1(0x1db)+_0x3b08c1(0x24d))):sendText(_0x106aaf,_0x3b08c1(0x203)+'o\x20enable\x20a'+_0x3b08c1(0x25c)+'DB\x20error).');}else{if(_0x4d9947==='off'){const _0x1c8c82=await setChatEnabled(_0x106aaf,![]);return _0x1c8c82?(clearChatMemory(_0x106aaf),sendText(_0x106aaf,_0x3b08c1(0x1c3)+_0x3b08c1(0x24f)+'\x20for\x20this\x20'+_0x3b08c1(0x259))):sendText(_0x106aaf,_0x3b08c1(0x203)+_0x3b08c1(0x243)+_0x3b08c1(0x24e)+_0x3b08c1(0x1bd)+'.');}else{const _0x1fd53f=await getChatEnabled(_0x106aaf),_0x5b9471={'SPAM_THRESHOLD':CFG[_0x3b08c1(0x21d)+_0x3b08c1(0x220)],'SPAM_WINDOW_MS':CFG[_0x3b08c1(0x236)+_0x3b08c1(0x187)],'SPAM_COOLDOWN_MS':CFG[_0x3b08c1(0x1ff)+_0x3b08c1(0x1c5)],'MAX_WARNINGS':CFG['MAX_WARNIN'+'GS'],'KICK_ON_SPAM':CFG['KICK_ON_SP'+'AM']};return sendText(_0x106aaf,_0x3b08c1(0x1c3)+_0x3b08c1(0x253)+_0x3b08c1(0x1e2)+(_0x1fd53f?_0x3b08c1(0x257):_0x3b08c1(0x218))+_0x3b08c1(0x1f6)+JSON[_0x3b08c1(0x1ab)](_0x5b9471));}}}if(_0x4e9379===_0x3b08c1(0x244)){const _0x4a46f6=_0xe2a60c[_0x3b08c1(0x1be)]?.[_0x3b08c1(0x1e8)+_0x3b08c1(0x255)]?.[_0x3b08c1(0x1e1)+'o']?.['mentionedJ'+'id']||[];if(!_0x4a46f6||_0x4a46f6[_0x3b08c1(0x1eb)]===-0x242d+0x88e+0x935*0x3)return sendText(_0x106aaf,_0x3b08c1(0x1b3)+'mention\x20on'+'e\x20or\x20more\x20'+_0x3b08c1(0x1ef)+'eset\x20their'+'\x20anti-spam'+_0x3b08c1(0x1ed));const _0x3fb486=chatUserMap[_0x3b08c1(0x1fa)](_0x106aaf);for(const _0x2fa4dd of _0x4a46f6){if(_0x3fb486&&_0x3fb486[_0x3b08c1(0x19b)](_0x2fa4dd))_0x3fb486['delete'](_0x2fa4dd);}return sendText(_0x106aaf,'✔️\x20Anti-spa'+_0x3b08c1(0x1d9)+_0x3b08c1(0x1e5)+'\x20mentioned'+_0x3b08c1(0x1df));}}catch(_0x210185){error(_0x210185,'['+name+(_0x3b08c1(0x19e)+'e\x20error:\x20')+(_0x210185?.[_0x3b08c1(0x1be)]||_0x210185));}}export async function initialize(_0x1595c0){const _0x40eb08=_0x38da5b;try{if(!_0x1595c0)throw new Error(_0x40eb08(0x1b2)+'nitialize\x20'+_0x40eb08(0x1f9)+_0x40eb08(0x242)+'e');botRef=_0x1595c0,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),startManagedListener({'botRef':botRef,'eventName':_0x40eb08(0x19a)+_0x40eb08(0x1bf),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(_0x40eb08(0x216)+'zed.\x20In-me'+_0x40eb08(0x201)+_0x40eb08(0x21f)+_0x40eb08(0x214)+'y\x20')+TABLE_SETTINGS+(_0x40eb08(0x246)+'d=')+CFG[_0x40eb08(0x21d)+_0x40eb08(0x220)]+_0x40eb08(0x1c6)+CFG[_0x40eb08(0x236)+_0x40eb08(0x187)]+(_0x40eb08(0x1b9)+_0x40eb08(0x25b))+CFG[_0x40eb08(0x196)+'GS']);}catch(_0x558b45){error(_0x558b45,'['+name+(_0x40eb08(0x216)+'ze\x20fatal:\x20')+(_0x558b45?.[_0x40eb08(0x1be)]||_0x558b45));throw _0x558b45;}}export async function cleanup(){const _0x228f55=_0x38da5b;try{stopManagedListener(name,_0x228f55(0x19a)+_0x228f55(0x1bf));}catch(_0x47f500){warn('['+name+(_0x228f55(0x1a5)+_0x228f55(0x1ee)+_0x228f55(0x212))+(_0x47f500?.['message']||_0x47f500));}for(const _0x39166b of processedMessageKeys[_0x228f55(0x1b6)]())try{clearTimeout(_0x39166b);}catch(_0x2ac046){}processedMessageKeys[_0x228f55(0x194)](),chatUserMap[_0x228f55(0x194)](),botRef=null,sendApi=null,info('['+name+(_0x228f55(0x20e)+_0x228f55(0x25d)));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};