const _0x395abe=_0x3831;(function(_0x348a95,_0x1daae7){const _0x27fe73=_0x3831,_0x3a34d2=_0x348a95();while(!![]){try{const _0x38567d=-parseInt(_0x27fe73(0x1a5))/(-0x78b*0x4+0xde9+0x1044)*(parseInt(_0x27fe73(0x1b3))/(-0xb*0x319+-0x172f+0x3944))+parseInt(_0x27fe73(0x19d))/(-0x1a72+0x15d*-0xd+-0x41*-0xae)*(-parseInt(_0x27fe73(0x214))/(-0x1e65+-0x12b*-0x11+0xa8e))+-parseInt(_0x27fe73(0x1a6))/(0x1a28+-0x560+-0x1*0x14c3)+parseInt(_0x27fe73(0x1f2))/(-0xcf+-0x5be+0x21*0x33)+-parseInt(_0x27fe73(0x19b))/(0x1d72+-0x1*-0xf43+-0x2cae)+parseInt(_0x27fe73(0x16a))/(-0x1227+-0x25cd+0x37fc)+parseInt(_0x27fe73(0x19a))/(-0x1428+-0x21b6+-0x35e7*-0x1)*(parseInt(_0x27fe73(0x1a0))/(-0xc2d*0x3+-0x663+0x157a*0x2));if(_0x38567d===_0x1daae7)break;else _0x3a34d2['push'](_0x3a34d2['shift']());}catch(_0x334033){_0x3a34d2['push'](_0x3a34d2['shift']());}}}(_0xcbe3,0x7106c+0x9540*0xf+-0x4*0x28ff));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name=_0x395abe(0x1e0);export const version=_0x395abe(0x1ee)+_0x395abe(0x1d2);function _0x3831(_0x47ef40,_0x1ff4c7){const _0x2ffa7f=_0xcbe3();return _0x3831=function(_0x3c1e00,_0x309b7b){_0x3c1e00=_0x3c1e00-(-0x11cf+-0x1cf*-0xd+-0x474);let _0x376e41=_0x2ffa7f[_0x3c1e00];return _0x376e41;},_0x3831(_0x47ef40,_0x1ff4c7);}export const priority=0x1*0xc1+0x658+-0x6bf;export const commands=[_0x395abe(0x1e0),_0x395abe(0x16c)];export const configKeys=[_0x395abe(0x195)];let botRef=null,sendApi=null;function _0xcbe3(){const _0x3a746a=[']\x20Migratio','\x20VALUES\x20(?','gedListene',']\x20stopMana','le_info(','remove','has','o\x20disable\x20','exec','sIfNeeded\x20','stop\x20spamm','BEGIN\x20TRAN','{user}','users\x20to\x20r',']\x20cleaned\x20','r:\x20','sendMessag','SACTION;','TO\x20','13219456wyPGiV','e\x20or\x20more\x20','resetspam','rows','\x20(chat_id\x20','n\x20of\x20','\x20INTEGER);','er\x20error:\x20','REPLACE\x20IN','string','chat_jid','ALTER\x20TABL','WARNING_TT','chat_id','SPAM_COOLD','show','ings}','PRAGMA\x20tab','length','cid','messages.u','ENABLED',']\x20tableExi','th\x20expecte','not\x20availa','trim','EXISTS\x20','ROLLBACK;','_jid,\x20enab','max','\x20LIMIT\x201','ATE\x20SET\x20en','COMMIT;','KICK_ON_SP','mentions','->\x20chat_ji',']\x20kicked\x20','LE\x20IF\x20NOT\x20','ARY\x20KEY,\x20e','(DB\x20error)','am\x20error:\x20','Y_MS','bled\x20FROM\x20','SPAM','DROP\x20TABLE','m\x20for\x20this','\x20failed\x20to','mention\x20on','9dFpmAe','6993259gNrAjf','OWN_MS','3RnueDP','\x20anti-spam','id)\x20DO\x20UPD','4140530vSVsyv','SPAM_WINDO','text','off',']\x20handleMe','13761wMwPVu','6785015wGIpUp','get','ROM\x20','ns=','function','\x0aConfig:\x20','enabled','map','ngs','\x20TEXT\x20PRIM','abled\x20=\x20ex','o\x20create\x20','andler\x20inn','62vGwibI','groupParti','@g.us','toLowerCas','ICT(chat_j','endsWith','\x20from\x20','psert','error\x20for\x20','clear','warnExpire',']\x20sendText','✔️\x20Please\x20@',']\x20onMessag','message','ze\x20fatal:\x20','SPAM_THRES','timestamps','remoteJid','ning\x20warni','CREATE\x20TAB',')\x20error:\x20','nabled\x20DB\x20','sock','values','⚠️\x20{user},\x20','nabled\x20INT','e=\x27table\x27\x20',']\x20Created\x20','onfig\x20erro','E\x20TO\x20','mory','\x20(chat_jid','extendedTe','SELECT\x20ena','e\x20FROM\x20sql','_jid\x20TEXT\x20','INSERT\x20OR\x20','WARN_EXPIR','lastWarnAt','set','table\x20','bled;','m\x20DISABLED','\x20warnings.','antispam','\x20exists\x20wi','SSAGE','\x20holds\x20onl','INSERT\x20INT','T\x20chat_id,','HOLD','or\x20repeate','_new\x20(chat','\x20columns\x20f',']\x20migrateS','filter','for\x20this\x20g','ot\x20instanc','2.0.0-inme','r\x20failed:\x20',']\x20refreshC','split','11230344slvMpn','find','delete','W_MS','now','.\x20Threshol',']\x20kickUser','mory\x20enfor','fromMe','gesUpsertH',']\x20Ensuring',']\x20Ensured\x20','m\x20ENABLED\x20','push','ate',']\x20Migrated','sts(',']\x20setChatE','✔️\x20Anti-spa','cluded.ena',']\x20failed\x20t','t_jid\x20=\x20?','xtMessage','\x20reset\x20for',',\x20enabled)','up.','ite_master','cement.\x20DB','key',']\x20Failed\x20t','PRIMARY\x20KE',',\x20?)\x20\x0a\x20\x20\x20\x20',']\x20rawMessa','mentionedJ','645928YCkfnr','replace','ssageForSp','L_MS','EGER);','includes','sAt','forEach','antispam.i','participan','cipantsUpd','o\x20enable\x20a',':\x20sendApi\x20','stringify','name','\x20user(s).','warnCount','contextInf','eset\x20their','isArray','\x20enabled\x20F','zed.\x20In-me','from','anti-spam\x20','keys','MAX_WARNIN','d\x20spam.','spam_setti','requires\x20b','group.'];_0xcbe3=function(){return _0x3a746a;};return _0xcbe3();}const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(-0x246+0x19a0+-0x173c)*(0xe*-0x1c+-0x1201*-0x1+-0xc91),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(0x903+0x1449+-0x5*0x5da)*(0x13d+0xceb+-0xa40),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(0x58a+-0x201a+0x1a97)*(-0x22fe*-0x1+0x1762+0x5*-0xba8)*(0x1*-0x852+0x4*0x180+0x28e*0x1)*(-0xfac+-0xbe0+0x1bc8)*(0xa*0x65+0x11*0x207+-0x2281),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x395abe(0x1cc)+_0x395abe(0x161)+'ing.\x20Remai'+_0x395abe(0x1c6)+'ngs:\x20{warn'+_0x395abe(0x17a),'WARNING_TTL_MS':0xc350};function refreshConfig(){const _0x30a919=_0x395abe;try{const _0x5e28e4=getConfig?.()?.[_0x30a919(0x195)]||{};Object[_0x30a919(0x151)](CFG)[_0x30a919(0x140)](_0x2aa5f0=>{if(_0x5e28e4[_0x2aa5f0]!==undefined)CFG[_0x2aa5f0]=_0x5e28e4[_0x2aa5f0];}),CFG[_0x30a919(0x1c3)+_0x30a919(0x1e6)]=Math[_0x30a919(0x187)](-0x2646+0x225d*-0x1+0x48a4,Number(CFG[_0x30a919(0x1c3)+'HOLD'])||-0xb3f*0x1+-0x5ef+0x16f*0xc),CFG[_0x30a919(0x1a1)+_0x30a919(0x1f5)]=Math[_0x30a919(0x187)](-0x1729+-0xa4e+0x293*0xd,Number(CFG[_0x30a919(0x1a1)+'W_MS'])||(-0xed9*-0x2+0x1f28+-0x3cd0)*(0x24a1+-0xae9+-0x15d0)),CFG[_0x30a919(0x178)+'OWN_MS']=Math[_0x30a919(0x187)](0xa6a*0x1+0x7f*-0x13+-0xb*0x17,Number(CFG[_0x30a919(0x178)+_0x30a919(0x19c)])||-0x1200+0x646+0xae*0x17),CFG[_0x30a919(0x152)+'GS']=Math[_0x30a919(0x187)](0x989*-0x1+0x4*-0x3c6+0x18a2*0x1,Number(CFG[_0x30a919(0x152)+'GS'])||0xc6c+0x1320+-0x1f89),CFG[_0x30a919(0x1d9)+'Y_MS']=Math[_0x30a919(0x187)](0x1*-0x1071+-0x4b*0x3b+-0x6*-0x59f,Number(CFG[_0x30a919(0x1d9)+_0x30a919(0x193)])||(-0xbbe+0x3*0x4c7+-0x290)*(-0x1*-0x65+-0x185*0x13+-0x6*-0x4c3)*(0x263e+0x1*-0x9be+-0x1b*0x10c)*(0x1a50+-0x1*0x1834+-0x1e0)*(-0x1c12*0x1+-0x17*0x161+0x3fb1)),CFG['WARNING_TT'+_0x30a919(0x217)]=Math[_0x30a919(0x187)](-0x1872+-0x167b+0x2eed,Number(CFG[_0x30a919(0x176)+_0x30a919(0x217)])||-0x341*0x1d+-0x1*-0x17e55+-0x5ca8),CFG['KICK_ON_SP'+'AM']=!!CFG['KICK_ON_SP'+'AM'];}catch(_0x229e9f){warn('['+name+(_0x30a919(0x1f0)+_0x30a919(0x1d0)+_0x30a919(0x166))+(_0x229e9f?.['message']||_0x229e9f));}}const TABLE_SETTINGS=_0x395abe(0x154)+_0x395abe(0x1ae);async function tableExists(_0x4c75ce){const _0x27bb7f=_0x395abe;try{const _0x25c328=await db[_0x27bb7f(0x1a7)]('SELECT\x20nam'+_0x27bb7f(0x1d6)+_0x27bb7f(0x20c)+'\x20WHERE\x20typ'+_0x27bb7f(0x1ce)+'AND\x20name=?',[_0x4c75ce]);return!!_0x25c328;}catch(_0x30c159){return warn('['+name+(_0x27bb7f(0x180)+_0x27bb7f(0x202))+_0x4c75ce+_0x27bb7f(0x1c8)+(_0x30c159?.[_0x27bb7f(0x1c1)]||_0x30c159)),![];}}async function getTableColumns(_0x40984b){const _0x4113fa=_0x395abe;try{const _0x567c21=await db['exec'](_0x4113fa(0x17b)+_0x4113fa(0x15b)+_0x40984b+');'),_0x42b33c=Array[_0x4113fa(0x14c)](_0x567c21)?_0x567c21:_0x567c21&&_0x567c21['rows']?_0x567c21['rows']:[];return _0x42b33c[_0x4113fa(0x1ad)](_0x13be52=>_0x13be52[_0x4113fa(0x147)]||_0x13be52['column_nam'+'e']||_0x13be52[_0x4113fa(0x17d)]);}catch(_0x26983e){try{const _0x3f70c5=await db[_0x4113fa(0x1a7)]('SELECT\x20*\x20F'+_0x4113fa(0x1a8)+_0x40984b+_0x4113fa(0x188));return _0x3f70c5?Object[_0x4113fa(0x151)](_0x3f70c5):[];}catch(_0x190d7a){return[];}}}async function migrateSpamSettingsIfNeeded(){const _0x28a2ad=_0x395abe,_0xcd6ebe=await tableExists(TABLE_SETTINGS);if(!_0xcd6ebe)try{await db[_0x28a2ad(0x15f)](_0x28a2ad(0x1c7)+_0x28a2ad(0x18f)+_0x28a2ad(0x184)+TABLE_SETTINGS+('\x20(chat_jid'+_0x28a2ad(0x1af)+_0x28a2ad(0x190)+_0x28a2ad(0x1cd)+_0x28a2ad(0x218))),info('['+name+(_0x28a2ad(0x1cf)+_0x28a2ad(0x1dc))+TABLE_SETTINGS);return;}catch(_0x52f538){warn('['+name+(_0x28a2ad(0x20f)+_0x28a2ad(0x1b1))+TABLE_SETTINGS+':\x20'+(_0x52f538?.[_0x28a2ad(0x1c1)]||_0x52f538));return;}try{const _0x2219f0=await db[_0x28a2ad(0x15f)]('PRAGMA\x20tab'+_0x28a2ad(0x15b)+TABLE_SETTINGS+');');let _0x1a53c0=[];if(Array[_0x28a2ad(0x14c)](_0x2219f0))_0x1a53c0=_0x2219f0['map'](_0x6d4a26=>_0x6d4a26['name']||_0x6d4a26[-0x1*-0x20cc+-0x149*-0x8+0x2b13*-0x1])['filter'](Boolean);else{if(_0x2219f0&&Array['isArray'](_0x2219f0[_0x28a2ad(0x16d)]))_0x1a53c0=_0x2219f0[_0x28a2ad(0x16d)][_0x28a2ad(0x1ad)](_0x43b9bf=>_0x43b9bf[_0x28a2ad(0x147)])[_0x28a2ad(0x1eb)](Boolean);else try{const _0x41eaea=await db['get']('SELECT\x20*\x20F'+_0x28a2ad(0x1a8)+TABLE_SETTINGS+_0x28a2ad(0x188));_0x1a53c0=_0x41eaea?Object['keys'](_0x41eaea):[];}catch(_0x139149){_0x1a53c0=[];}}const _0x139a78=_0x1a53c0[_0x28a2ad(0x1ad)](_0x10f1a6=>String(_0x10f1a6)[_0x28a2ad(0x1b6)+'e']()),_0x1d716a=_0x139a78[_0x28a2ad(0x219)](_0x28a2ad(0x174)),_0x3d79b6=_0x139a78[_0x28a2ad(0x219)](_0x28a2ad(0x1ac)),_0x545434=_0x139a78['includes'](_0x28a2ad(0x177));if(_0x1d716a&&_0x3d79b6)return;if(!_0x1d716a&&_0x545434)try{await db['exec'](_0x28a2ad(0x162)+_0x28a2ad(0x168)),await db[_0x28a2ad(0x15f)](_0x28a2ad(0x1c7)+_0x28a2ad(0x18f)+_0x28a2ad(0x184)+TABLE_SETTINGS+(_0x28a2ad(0x1e8)+_0x28a2ad(0x1d7)+_0x28a2ad(0x210)+'Y,\x20enabled'+_0x28a2ad(0x170)));const _0x118798=_0x3d79b6;_0x118798?await db[_0x28a2ad(0x15f)](_0x28a2ad(0x1d8)+_0x28a2ad(0x172)+_0x28a2ad(0x169)+TABLE_SETTINGS+(_0x28a2ad(0x1e8)+_0x28a2ad(0x186)+'led)\x20SELEC'+_0x28a2ad(0x1e5)+_0x28a2ad(0x14d)+_0x28a2ad(0x1a8))+TABLE_SETTINGS+';'):await db[_0x28a2ad(0x15f)](_0x28a2ad(0x1d8)+'REPLACE\x20IN'+_0x28a2ad(0x169)+TABLE_SETTINGS+(_0x28a2ad(0x1e8)+_0x28a2ad(0x186)+'led)\x20SELEC'+'T\x20chat_id,'+'\x200\x20FROM\x20')+TABLE_SETTINGS+';');await db[_0x28a2ad(0x15f)](_0x28a2ad(0x196)+'\x20'+TABLE_SETTINGS+';'),await db[_0x28a2ad(0x15f)](_0x28a2ad(0x175)+'E\x20'+TABLE_SETTINGS+('_new\x20RENAM'+_0x28a2ad(0x1d1))+TABLE_SETTINGS+';'),await db[_0x28a2ad(0x15f)](_0x28a2ad(0x18a)),info('['+name+(_0x28a2ad(0x201)+'\x20')+TABLE_SETTINGS+(_0x28a2ad(0x16e)+_0x28a2ad(0x18d)+'d)'));return;}catch(_0x5c1193){try{await db[_0x28a2ad(0x15f)](_0x28a2ad(0x185));}catch(_0x453a17){}warn('['+name+(_0x28a2ad(0x157)+_0x28a2ad(0x16f))+TABLE_SETTINGS+'\x20failed:\x20'+(_0x5c1193?.[_0x28a2ad(0x1c1)]||_0x5c1193));return;}if(!_0x1d716a||!_0x3d79b6)try{await db[_0x28a2ad(0x15f)](_0x28a2ad(0x1c7)+_0x28a2ad(0x18f)+_0x28a2ad(0x184)+TABLE_SETTINGS+(_0x28a2ad(0x1d3)+_0x28a2ad(0x1af)+_0x28a2ad(0x190)+_0x28a2ad(0x1cd)+_0x28a2ad(0x218))),info('['+name+_0x28a2ad(0x1fd)+TABLE_SETTINGS+(_0x28a2ad(0x1e1)+_0x28a2ad(0x181)+'d\x20columns.'));}catch(_0x16137e){warn('['+name+(_0x28a2ad(0x1fc)+'\x20')+TABLE_SETTINGS+(_0x28a2ad(0x1e9)+'ailed:\x20')+(_0x16137e?.[_0x28a2ad(0x1c1)]||_0x16137e));}}catch(_0xeaaad7){warn('['+name+(_0x28a2ad(0x1ea)+'pamSetting'+_0x28a2ad(0x160)+'error:\x20')+(_0xeaaad7?.[_0x28a2ad(0x1c1)]||_0xeaaad7));}}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x38f263=_0x395abe;if(!botRef)return;if(typeof botRef[_0x38f263(0x167)+'e']===_0x38f263(0x1aa))sendApi=async(_0x177fad,_0x43e7d7)=>await botRef[_0x38f263(0x167)+'e'](_0x177fad,_0x43e7d7);else{if(botRef['sock']&&typeof botRef[_0x38f263(0x1ca)][_0x38f263(0x167)+'e']===_0x38f263(0x1aa))sendApi=async(_0x54b575,_0x4b44f6)=>await botRef[_0x38f263(0x1ca)][_0x38f263(0x167)+'e'](_0x54b575,_0x4b44f6);else sendApi=null;}}async function sendText(_0x4e2fa2,_0x287f20,_0x59250c=[]){const _0x264c35=_0x395abe;if(!_0x287f20||!_0x4e2fa2)return null;if(!sendApi)return warn('['+name+(_0x264c35(0x1be)+_0x264c35(0x145)+_0x264c35(0x182)+'ble')),null;try{const _0x27d06e=typeof _0x287f20===_0x264c35(0x173)?{'text':_0x287f20}:_0x287f20;if(Array[_0x264c35(0x14c)](_0x59250c)&&_0x59250c[_0x264c35(0x17c)])_0x27d06e[_0x264c35(0x18c)]=_0x59250c;return await sendApi(_0x4e2fa2,_0x27d06e);}catch(_0x5036b4){return warn('['+name+(_0x264c35(0x1be)+_0x264c35(0x198)+'\x20')+_0x4e2fa2+':\x20'+(_0x5036b4?.[_0x264c35(0x1c1)]||_0x5036b4)),null;}}async function kickUser(_0x23d511,_0x5be2f2){const _0x350429=_0x395abe;try{const _0x3f7474=botRef['sock']?.[_0x350429(0x1b4)+_0x350429(0x143)+_0x350429(0x200)]||botRef[_0x350429(0x1b4)+_0x350429(0x143)+_0x350429(0x200)];if(_0x3f7474)return await _0x3f7474(_0x23d511,[_0x5be2f2],_0x350429(0x15c)),info('['+name+_0x350429(0x18e)+_0x5be2f2+_0x350429(0x1b9)+_0x23d511),!![];return![];}catch(_0x1d1e61){return warn('['+name+(_0x350429(0x1f8)+'\x20failed:\x20')+(_0x1d1e61?.[_0x350429(0x1c1)]||_0x1d1e61)),![];}}async function getChatEnabled(_0x1a3be7){const _0x20ff7e=_0x395abe;try{const _0xf8883d=await db['get'](_0x20ff7e(0x1d5)+_0x20ff7e(0x194)+TABLE_SETTINGS+('\x20WHERE\x20cha'+_0x20ff7e(0x207)),[_0x1a3be7]);return _0xf8883d?Number(_0xf8883d[_0x20ff7e(0x1ac)])===-0x54b*-0x1+-0x114d+0xc03:![];}catch(_0x31865b){return warn('['+name+(']\x20getChatE'+_0x20ff7e(0x1c9)+'error\x20for\x20')+_0x1a3be7+':\x20'+(_0x31865b?.['message']||_0x31865b)),![];}}async function setChatEnabled(_0x2a44a1,_0x37346c){const _0x321017=_0x395abe;try{return await db['run'](_0x321017(0x1e4)+'O\x20'+TABLE_SETTINGS+(_0x321017(0x1d3)+_0x321017(0x20a)+_0x321017(0x158)+_0x321017(0x211)+'\x20\x20ON\x20CONFL'+_0x321017(0x1b7)+_0x321017(0x19f)+_0x321017(0x189)+_0x321017(0x1b0)+_0x321017(0x205)+_0x321017(0x1dd)),[_0x2a44a1,_0x37346c?-0x1bb*-0x8+-0x19e4+-0xc0d*-0x1:-0x1*0x3d1+0x613*0x1+0x121*-0x2]),!![];}catch(_0x7b0e56){return warn('['+name+(_0x321017(0x203)+_0x321017(0x1c9)+_0x321017(0x1bb))+_0x2a44a1+':\x20'+(_0x7b0e56?.[_0x321017(0x1c1)]||_0x7b0e56)),![];}}function ensureChatMap(_0x1ae0aa){const _0x9ca5e8=_0x395abe;if(!chatUserMap['has'](_0x1ae0aa))chatUserMap[_0x9ca5e8(0x1db)](_0x1ae0aa,new Map());return chatUserMap['get'](_0x1ae0aa);}function clearChatMemory(_0x1d38a1){const _0x139301=_0x395abe;if(chatUserMap[_0x139301(0x15d)](_0x1d38a1))chatUserMap['delete'](_0x1d38a1);}async function handleMessageForSpam(_0x4b1b29){const _0x120375=_0x395abe;try{const _0x7ecd91=String(_0x4b1b29[_0x120375(0x20e)]?.[_0x120375(0x1c5)]||'');if(!_0x7ecd91||!_0x7ecd91[_0x120375(0x1b8)]('@g.us'))return;if(_0x4b1b29[_0x120375(0x20e)]?.['fromMe'])return;const _0x212255=await getChatEnabled(_0x7ecd91);if(!_0x212255)return;const _0x3b5b2b=String(_0x4b1b29[_0x120375(0x20e)]?.['participan'+'t']||_0x4b1b29[_0x120375(0x20e)]?.[_0x120375(0x14f)]||'');if(!_0x3b5b2b)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x7ecd91,'participant':_0x3b5b2b},'message':_0x4b1b29[_0x120375(0x1c1)]}))return;}catch(_0x22d1d7){}const _0x39081c=Date[_0x120375(0x1f6)](),_0x494cad=ensureChatMap(_0x7ecd91);!_0x494cad[_0x120375(0x15d)](_0x3b5b2b)&&_0x494cad[_0x120375(0x1db)](_0x3b5b2b,{'timestamps':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x1c6331=_0x494cad[_0x120375(0x1a7)](_0x3b5b2b);_0x1c6331[_0x120375(0x1c4)]=(_0x1c6331[_0x120375(0x1c4)]||[])['filter'](_0xb9ed62=>_0x39081c-_0xb9ed62<=CFG['SPAM_WINDO'+'W_MS']),_0x1c6331[_0x120375(0x1c4)][_0x120375(0x1ff)](_0x39081c);if(_0x1c6331[_0x120375(0x1da)]&&_0x39081c-_0x1c6331[_0x120375(0x1da)]<CFG[_0x120375(0x178)+_0x120375(0x19c)])return;if((_0x1c6331['timestamps']||[])['length']>=CFG[_0x120375(0x1c3)+_0x120375(0x1e6)]){_0x1c6331[_0x120375(0x1da)]=_0x39081c;(!_0x1c6331[_0x120375(0x1bd)+_0x120375(0x21a)]||_0x1c6331[_0x120375(0x1bd)+'sAt']<=_0x39081c)&&(_0x1c6331[_0x120375(0x149)]=0x1a72+-0x2553+0x22d*0x5);_0x1c6331[_0x120375(0x149)]=(_0x1c6331[_0x120375(0x149)]||-0x19bf+0x505+0x14ba)+(0x1f*-0x5f+0x2191+-0x160f),_0x1c6331[_0x120375(0x1bd)+_0x120375(0x21a)]=_0x39081c+CFG['WARN_EXPIR'+_0x120375(0x193)];const _0x25745c=Math[_0x120375(0x187)](-0x2*-0x1283+0x86*0x2b+-0x1e*0x1fc,CFG[_0x120375(0x152)+'GS']-_0x1c6331[_0x120375(0x149)]),_0x1ba500='@'+_0x3b5b2b['split']('@')[-0x25d4+0x2100+0x19c*0x3],_0x272db3=String(CFG['WARNING_ME'+_0x120375(0x1e2)]||'')['replace'](_0x120375(0x163),_0x1ba500)[_0x120375(0x215)]('{warnings}',String(_0x25745c)),_0xf54c22=await sendText(_0x7ecd91,{'text':_0x272db3,'mentions':[_0x3b5b2b]});_0xf54c22?.[_0x120375(0x20e)]&&CFG[_0x120375(0x176)+_0x120375(0x217)]>0x21ae+0x1ef2+-0x40a0&&setTimeout(async()=>{const _0x24deb7=_0x120375;try{await sendText(_0x7ecd91,{'delete':_0xf54c22[_0x24deb7(0x20e)]});}catch(_0x3ca018){}},CFG[_0x120375(0x176)+_0x120375(0x217)]);if(CFG[_0x120375(0x18b)+'AM']&&_0x1c6331[_0x120375(0x149)]>=CFG[_0x120375(0x152)+'GS']){const _0x2f4a81=await kickUser(_0x7ecd91,_0x3b5b2b);_0x2f4a81?(_0x494cad[_0x120375(0x1f4)](_0x3b5b2b),await sendText(_0x7ecd91,{'text':_0x1ba500+('\x20removed\x20f'+_0x120375(0x1e7)+_0x120375(0x153)),'mentions':[_0x3b5b2b]})['catch'](()=>{})):warn('['+name+(_0x120375(0x206)+'o\x20kick\x20')+_0x3b5b2b+_0x120375(0x1b9)+_0x7ecd91);}}}catch(_0x4a7051){warn('['+name+(_0x120375(0x1a4)+_0x120375(0x216)+_0x120375(0x192))+(_0x4a7051?.[_0x120375(0x1c1)]||_0x4a7051));}}async function rawMessagesUpsertHandler({messages:_0x49aa8e}){const _0x14bddb=_0x395abe;if(!Array['isArray'](_0x49aa8e))return;for(const _0x145c84 of _0x49aa8e){try{const _0x17f7dd=String(_0x145c84[_0x14bddb(0x20e)]?.[_0x14bddb(0x1c5)]||'');if(!_0x17f7dd||!_0x17f7dd['endsWith'](_0x14bddb(0x1b5)))continue;if(!_0x145c84[_0x14bddb(0x1c1)])continue;if(_0x145c84[_0x14bddb(0x20e)]?.[_0x14bddb(0x1fa)])continue;const _0x35c7c7=_0x17f7dd+'::'+String(_0x145c84[_0x14bddb(0x20e)]?.['id']||'')+'::'+String(_0x145c84[_0x14bddb(0x20e)]?.[_0x14bddb(0x142)+'t']||'');if(processedMessageKeys[_0x14bddb(0x15d)](_0x35c7c7))continue;const _0x2561d9=setTimeout(()=>processedMessageKeys['delete'](_0x35c7c7),DEDUPE_TTL_MS);processedMessageKeys[_0x14bddb(0x1db)](_0x35c7c7,_0x2561d9),await handleMessageForSpam(_0x145c84);}catch(_0x4b96e3){warn('['+name+(_0x14bddb(0x212)+_0x14bddb(0x1fb)+_0x14bddb(0x1b2)+_0x14bddb(0x171))+(_0x4b96e3?.[_0x14bddb(0x1c1)]||_0x4b96e3));}}}export async function onMessage(_0x99394e){const _0x138938=_0x395abe;try{if(!_0x99394e||!_0x99394e[_0x138938(0x20e)]||!_0x99394e['message']||!_0x99394e['isCommand'])return;const _0x52e0c0=String(_0x99394e[_0x138938(0x20e)][_0x138938(0x1c5)]||'');if(!_0x52e0c0[_0x138938(0x1b8)](_0x138938(0x1b5)))return;if(!await isadmin(botRef,_0x99394e))return;const _0x5ac714=typeof _0x99394e[_0x138938(0x1a2)]===_0x138938(0x173)&&_0x99394e['text'][_0x138938(0x183)]()[_0x138938(0x17c)]?_0x99394e[_0x138938(0x1a2)][_0x138938(0x183)]():'';if(!_0x5ac714)return;const _0x4d1b45=_0x5ac714[_0x138938(0x1f1)](/\s+/)[_0x138938(0x1eb)](Boolean);if(!_0x4d1b45[_0x138938(0x17c)])return;const _0x5d117a=String(_0x4d1b45[0x1003*0x1+-0x21*-0x100+-0x1*0x3103]||'')[_0x138938(0x1b6)+'e'](),_0x5afa53=_0x4d1b45['slice'](0x159f*-0x1+-0x1a7c+0x301c);if(!commands[_0x138938(0x219)](_0x5d117a))return;if(_0x5d117a==='antispam'){const _0x5dc63b=(_0x5afa53[_0x138938(0x1f3)](_0x4fdf16=>['on',_0x138938(0x1a3),'show'][_0x138938(0x219)](String(_0x4fdf16)['toLowerCas'+'e']()))||_0x138938(0x179))[_0x138938(0x1b6)+'e']();if(_0x5dc63b==='on'){const _0x3db337=await setChatEnabled(_0x52e0c0,!![]);return _0x3db337?(clearChatMemory(_0x52e0c0),sendText(_0x52e0c0,_0x138938(0x204)+_0x138938(0x1fe)+_0x138938(0x1ec)+'roup.')):sendText(_0x52e0c0,'⚠️\x20Failed\x20t'+_0x138938(0x144)+'nti-spam\x20('+'DB\x20error).');}else{if(_0x5dc63b===_0x138938(0x1a3)){const _0x274bcc=await setChatEnabled(_0x52e0c0,![]);return _0x274bcc?(clearChatMemory(_0x52e0c0),sendText(_0x52e0c0,'✔️\x20Anti-spa'+_0x138938(0x1de)+'\x20for\x20this\x20'+_0x138938(0x156))):sendText(_0x52e0c0,'⚠️\x20Failed\x20t'+_0x138938(0x15e)+_0x138938(0x150)+_0x138938(0x191)+'.');}else{const _0x490aa7=await getChatEnabled(_0x52e0c0),_0x3c8dc8={'SPAM_THRESHOLD':CFG['SPAM_THRES'+_0x138938(0x1e6)],'SPAM_WINDOW_MS':CFG[_0x138938(0x1a1)+'W_MS'],'SPAM_COOLDOWN_MS':CFG[_0x138938(0x178)+_0x138938(0x19c)],'MAX_WARNINGS':CFG[_0x138938(0x152)+'GS'],'KICK_ON_SPAM':CFG[_0x138938(0x18b)+'AM']};return sendText(_0x52e0c0,'✔️\x20Anti-spa'+_0x138938(0x197)+'\x20group:\x20'+(_0x490aa7?_0x138938(0x17f):'DISABLED')+_0x138938(0x1ab)+JSON[_0x138938(0x146)](_0x3c8dc8));}}}if(_0x5d117a===_0x138938(0x16c)){const _0x13e0f5=_0x99394e[_0x138938(0x1c1)]?.[_0x138938(0x1d4)+_0x138938(0x208)]?.[_0x138938(0x14a)+'o']?.[_0x138938(0x213)+'id']||[];if(!_0x13e0f5||_0x13e0f5[_0x138938(0x17c)]===0xabd+-0x100+-0x9bd)return sendText(_0x52e0c0,_0x138938(0x1bf)+_0x138938(0x199)+_0x138938(0x16b)+_0x138938(0x164)+_0x138938(0x14b)+_0x138938(0x19e)+_0x138938(0x1df));const _0x5a0f44=chatUserMap[_0x138938(0x1a7)](_0x52e0c0);for(const _0x5d0013 of _0x13e0f5){if(_0x5a0f44&&_0x5a0f44['has'](_0x5d0013))_0x5a0f44[_0x138938(0x1f4)](_0x5d0013);}return sendText(_0x52e0c0,'✔️\x20Anti-spa'+'m\x20warnings'+_0x138938(0x209)+'\x20mentioned'+_0x138938(0x148));}}catch(_0x28ade6){error(_0x28ade6,'['+name+(_0x138938(0x1c0)+'e\x20error:\x20')+(_0x28ade6?.['message']||_0x28ade6));}}export async function initialize(_0x2bce1a){const _0x46ad4a=_0x395abe;try{if(!_0x2bce1a)throw new Error(_0x46ad4a(0x141)+'nitialize\x20'+_0x46ad4a(0x155)+_0x46ad4a(0x1ed)+'e');botRef=_0x2bce1a,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),startManagedListener({'botRef':botRef,'eventName':'messages.u'+_0x46ad4a(0x1ba),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(']\x20initiali'+_0x46ad4a(0x14e)+_0x46ad4a(0x1f9)+_0x46ad4a(0x20d)+_0x46ad4a(0x1e3)+'y\x20')+TABLE_SETTINGS+(_0x46ad4a(0x1f7)+'d=')+CFG['SPAM_THRES'+_0x46ad4a(0x1e6)]+'\x20within\x20'+CFG['SPAM_WINDO'+_0x46ad4a(0x1f5)]+('ms,\x20maxWar'+_0x46ad4a(0x1a9))+CFG['MAX_WARNIN'+'GS']);}catch(_0x3b2158){error(_0x3b2158,'['+name+(']\x20initiali'+_0x46ad4a(0x1c2))+(_0x3b2158?.[_0x46ad4a(0x1c1)]||_0x3b2158));throw _0x3b2158;}}export async function cleanup(){const _0x187c82=_0x395abe;try{stopManagedListener(name,_0x187c82(0x17e)+_0x187c82(0x1ba));}catch(_0x291390){warn('['+name+(_0x187c82(0x15a)+_0x187c82(0x159)+_0x187c82(0x1ef))+(_0x291390?.[_0x187c82(0x1c1)]||_0x291390));}for(const _0x4b6bcf of processedMessageKeys[_0x187c82(0x1cb)]())try{clearTimeout(_0x4b6bcf);}catch(_0x393599){}processedMessageKeys[_0x187c82(0x1bc)](),chatUserMap[_0x187c82(0x1bc)](),botRef=null,sendApi=null,info('['+name+(_0x187c82(0x165)+_0x187c82(0x20b)));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};