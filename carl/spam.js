const _0x47dd94=_0xe468;(function(_0x533298,_0x25a74b){const _0x5bbd67=_0xe468,_0x3172d2=_0x533298();while(!![]){try{const _0x425c8a=-parseInt(_0x5bbd67(0x1df))/(0x92b+0x3c4*-0x4+0x2*0x2f3)+parseInt(_0x5bbd67(0x17c))/(0x163*-0xe+0x1b7*0xb+0x8f)*(-parseInt(_0x5bbd67(0x173))/(-0xa8a+0x1b*0xad+-0x18a*0x5))+parseInt(_0x5bbd67(0x192))/(0x26f6*-0x1+-0x16f4+0x3dee*0x1)+-parseInt(_0x5bbd67(0x190))/(-0x2a5*-0x7+-0x1*0x11d1+0x1*-0xad)*(-parseInt(_0x5bbd67(0x18d))/(-0x247d+-0x118a*0x1+-0x360d*-0x1))+parseInt(_0x5bbd67(0x1c3))/(-0xf96+0x1bee+-0x41b*0x3)+parseInt(_0x5bbd67(0x1c7))/(0x1*0x1f58+-0x3*0x7a3+-0x867)*(-parseInt(_0x5bbd67(0x210))/(0x1b*-0x9d+-0x10*0xa9+0x1b28))+-parseInt(_0x5bbd67(0x1c9))/(-0x1f*0x17+-0x1*-0x506+-0x233)*(-parseInt(_0x5bbd67(0x215))/(0x1d3+-0x15f1+0x18d*0xd));if(_0x425c8a===_0x25a74b)break;else _0x3172d2['push'](_0x3172d2['shift']());}catch(_0x51cd3f){_0x3172d2['push'](_0x3172d2['shift']());}}}(_0xa866,-0x1*0x9bb+0x4d4f5+-0x5077*0x1));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name=_0x47dd94(0x18c);export const version='2.0.0-inme'+_0x47dd94(0x161);function _0xa866(){const _0x40e477=['PRIMARY\x20KE','30XIhAKV','->\x20chat_ji',']\x20onMessag','Y,\x20enabled','stop\x20spamm','\x20columns\x20f','⚠️\x20Failed\x20t','zed.\x20In-me',']\x20refreshC','INSERT\x20OR\x20','\x20group:\x20','messages.u','filter','sIfNeeded\x20','onfig\x20erro','KICK_ON_SP','enabled','ings}','requires\x20b','catch','WARNING_ME','m\x20warnings','461217tvHcGA','\x0aConfig:\x20','trim','ssageForSp','\x20mentioned','includes','L_MS','replace','text','toLowerCas','\x20WHERE\x20typ','ATE\x20SET\x20en','clear','ARY\x20KEY,\x20e','E\x20TO\x20','✔️\x20Please\x20@','am\x20error:\x20','anti-spam\x20','sAt','m\x20DISABLED','isArray','keys','EGER);',']\x20cleaned\x20','max','from','warnCount','ROM\x20','name','off','has','m\x20for\x20this','error\x20for\x20','lastWarnAt','ns=',']\x20tableExi',']\x20sendText','le_info(','SELECT\x20*\x20F','groupParti','\x20(chat_jid','spam_setti','up.','SPAM_WINDO','mentionedJ','mentions','now','remoteJid','ate','72ZCvzXD','_jid,\x20enab','pamSetting','_new\x20RENAM','ngs','3864102TgMvse','abled\x20=\x20ex','\x20failed:\x20','get','timestamps',',\x20enabled)','nabled\x20INT','_new\x20(chat','CREATE\x20TAB','{user}',']\x20Migratio','WARN_EXPIR','set','gesUpsertH','ble','\x20LIMIT\x201','SPAM_COOLD','INSERT\x20INT',']\x20handleMe','bled\x20FROM\x20','ENABLED','table\x20',']\x20Created\x20','participan','key',']\x20Ensuring','run','PRAGMA\x20tab','TO\x20','m\x20ENABLED\x20',':\x20sendApi\x20','id)\x20DO\x20UPD','W_MS','SELECT\x20nam','function','cipantsUpd','stringify','cid',']\x20initiali','✔️\x20Anti-spa','ning\x20warni','sock',']\x20kickUser','ROLLBACK;',']\x20Ensured\x20','mory',']\x20rawMessa',']\x20kicked\x20','sts(','rows','DB\x20error).','\x20anti-spam','endsWith','or\x20repeate','e\x20or\x20more\x20','show','resetspam','REPLACE\x20IN','BEGIN\x20TRAN','ing.\x20Remai','ms,\x20maxWar','antispam.i','\x20reset\x20for','11292cNntXu','\x20from\x20','MAX_WARNIN','ngs:\x20{warn','mory\x20enfor','r:\x20','chat_id','o\x20create\x20','LE\x20IF\x20NOT\x20','130AaXlEU','\x20\x20ON\x20CONFL','o\x20kick\x20','sendMessag','EXISTS\x20',']\x20migrateS','AND\x20name=?','Y_MS',']\x20Migrated','\x20for\x20this\x20','ICT(chat_j','split','group.','length','WARNING_TT','d\x20columns.','antispam','320244bSPEqj',')\x20error:\x20','HOLD','10oxMvOI','ALTER\x20TABL','959600eiOFrM','\x20within\x20','users\x20to\x20r','cement.\x20DB','th\x20expecte','find','SPAM_THRES','\x20warnings.','o\x20enable\x20a','extendedTe','warnExpire','map','\x20holds\x20onl','bled;','andler\x20inn','string','slice','forEach','led)\x20SELEC','n\x20of\x20','message','chat_jid','roup.','SELECT\x20ena','SSAGE',']\x20failed\x20t','psert','nabled\x20DB\x20','⚠️\x20{user},\x20','COMMIT;','\x20TEXT\x20PRIM',']\x20setChatE','gedListene','delete','cluded.ena','isCommand','e=\x27table\x27\x20','SACTION;','DISABLED','_jid\x20TEXT\x20','exec','SPAM','T\x20chat_id,','ze\x20fatal:\x20','OWN_MS','\x20INTEGER);','DROP\x20TABLE','nitialize\x20','\x20user(s).','651350HmagRY','@g.us','r\x20failed:\x20','remove','494096HAwbCX'];_0xa866=function(){return _0x40e477;};return _0xa866();}export const priority=-0x1*-0x147e+0x1285+-0x1*0x26a9;export const commands=[_0x47dd94(0x18c),_0x47dd94(0x16c)];export const configKeys=[_0x47dd94(0x1bb)];let botRef=null,sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(0xa83+-0x1011+-0x3*-0x1e4)*(-0xdab*-0x2+0x8aa*-0x4+0xb3a),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(0x2267+0x8b*0x40+0x551*-0xd)*(-0x267a*0x1+0x28a+-0x12c*-0x22),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(-0x131f+-0x1*-0x144d+-0x127)*(0x4*-0x2a4+-0x1b67+0x1*0x260f)*(0xc18+0x1b56+-0x1d*0x15a)*(0x1*0x16f+0x267a+-0x27ad)*(-0x12c3+-0x1661+0x2d0c),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x47dd94(0x1ae)+_0x47dd94(0x1cd)+_0x47dd94(0x16f)+_0x47dd94(0x23d)+_0x47dd94(0x176)+_0x47dd94(0x1da),'WARNING_TTL_MS':0xc350};function refreshConfig(){const _0xd2db82=_0x47dd94;try{const _0x20b945=getConfig?.()?.['SPAM']||{};Object[_0xd2db82(0x1f4)](CFG)[_0xd2db82(0x1a3)](_0x22c434=>{if(_0x20b945[_0x22c434]!==undefined)CFG[_0x22c434]=_0x20b945[_0x22c434];}),CFG['SPAM_THRES'+_0xd2db82(0x18f)]=Math[_0xd2db82(0x1f7)](0x3*0xabb+0x2363+0x1*-0x4393,Number(CFG[_0xd2db82(0x198)+_0xd2db82(0x18f)])||-0x12c8+-0x88*-0x7+0x1*0xf16),CFG[_0xd2db82(0x20a)+'W_MS']=Math[_0xd2db82(0x1f7)](0x34f*-0x7+-0x128c+0x29b5,Number(CFG[_0xd2db82(0x20a)+'W_MS'])||(-0x23d*0x2+-0x1a8b+-0x1*-0x1f0f)*(-0x2e6+-0x3*-0x57d+-0x9a9)),CFG[_0xd2db82(0x225)+_0xd2db82(0x1be)]=Math[_0xd2db82(0x1f7)](0x4*0x98e+-0x1250+0x34*-0x62,Number(CFG[_0xd2db82(0x225)+_0xd2db82(0x1be)])||0x25f3+0x626+-0x2831),CFG[_0xd2db82(0x175)+'GS']=Math['max'](-0x27f+-0x1eb3+0x2133,Number(CFG[_0xd2db82(0x175)+'GS'])||0x2525+-0x1642+-0xee0),CFG['WARN_EXPIR'+_0xd2db82(0x183)]=Math['max'](0x7*0x545+-0x56b+0xfbc*-0x2,Number(CFG[_0xd2db82(0x220)+_0xd2db82(0x183)])||(-0x56e+0x13d*-0x7+-0x1c4*-0x8)*(-0x1*0x1021+0x478+0xbc1)*(0xfef+-0x2*-0xc0d+-0x27cd)*(0x350+0x4fc*0x5+-0x1c00)*(-0x140e+-0xa93+0x2289)),CFG[_0xd2db82(0x18a)+_0xd2db82(0x1e5)]=Math[_0xd2db82(0x1f7)](0xe80*-0x2+-0x221d+-0x3f1d*-0x1,Number(CFG[_0xd2db82(0x18a)+_0xd2db82(0x1e5)])||-0x102ba+-0x49c9+0x20fd3),CFG[_0xd2db82(0x1d8)+'AM']=!!CFG['KICK_ON_SP'+'AM'];}catch(_0xd32727){warn('['+name+(_0xd2db82(0x1d1)+_0xd2db82(0x1d7)+_0xd2db82(0x178))+(_0xd32727?.[_0xd2db82(0x1a6)]||_0xd32727));}}const TABLE_SETTINGS=_0x47dd94(0x208)+_0x47dd94(0x214);async function tableExists(_0x2121d){const _0x86e11f=_0x47dd94;try{const _0x2267a7=await db[_0x86e11f(0x218)](_0x86e11f(0x236)+'e\x20FROM\x20sql'+'ite_master'+_0x86e11f(0x1e9)+_0x86e11f(0x1b6)+_0x86e11f(0x182),[_0x2121d]);return!!_0x2267a7;}catch(_0x425a6c){return warn('['+name+(_0x86e11f(0x202)+_0x86e11f(0x164))+_0x2121d+_0x86e11f(0x18e)+(_0x425a6c?.['message']||_0x425a6c)),![];}}async function getTableColumns(_0x2ab421){const _0x406b84=_0x47dd94;try{const _0x362cdb=await db[_0x406b84(0x1ba)](_0x406b84(0x230)+_0x406b84(0x204)+_0x2ab421+');'),_0x38bfc9=Array[_0x406b84(0x1f3)](_0x362cdb)?_0x362cdb:_0x362cdb&&_0x362cdb[_0x406b84(0x165)]?_0x362cdb[_0x406b84(0x165)]:[];return _0x38bfc9['map'](_0x33151d=>_0x33151d['name']||_0x33151d['column_nam'+'e']||_0x33151d[_0x406b84(0x23a)]);}catch(_0x2ed134){try{const _0x499e71=await db['get']('SELECT\x20*\x20F'+_0x406b84(0x1fa)+_0x2ab421+_0x406b84(0x224));return _0x499e71?Object[_0x406b84(0x1f4)](_0x499e71):[];}catch(_0x442687){return[];}}}async function migrateSpamSettingsIfNeeded(){const _0x3e038b=_0x47dd94,_0x25d86d=await tableExists(TABLE_SETTINGS);if(!_0x25d86d)try{await db[_0x3e038b(0x1ba)](_0x3e038b(0x21d)+_0x3e038b(0x17b)+_0x3e038b(0x180)+TABLE_SETTINGS+(_0x3e038b(0x207)+_0x3e038b(0x1b0)+_0x3e038b(0x1ec)+_0x3e038b(0x21b)+'EGER);')),info('['+name+(_0x3e038b(0x22b)+_0x3e038b(0x22a))+TABLE_SETTINGS);return;}catch(_0x2c37a2){warn('['+name+(']\x20Failed\x20t'+_0x3e038b(0x17a))+TABLE_SETTINGS+':\x20'+(_0x2c37a2?.['message']||_0x2c37a2));return;}try{const _0x260224=await db['exec']('PRAGMA\x20tab'+'le_info('+TABLE_SETTINGS+');');let _0x1ea70e=[];if(Array['isArray'](_0x260224))_0x1ea70e=_0x260224[_0x3e038b(0x19d)](_0x287a5b=>_0x287a5b[_0x3e038b(0x1fb)]||_0x287a5b[0x2*0x1294+0x1f85*-0x1+-0x5a2])[_0x3e038b(0x1d5)](Boolean);else{if(_0x260224&&Array[_0x3e038b(0x1f3)](_0x260224[_0x3e038b(0x165)]))_0x1ea70e=_0x260224[_0x3e038b(0x165)][_0x3e038b(0x19d)](_0x369702=>_0x369702[_0x3e038b(0x1fb)])['filter'](Boolean);else try{const _0x78a88=await db['get'](_0x3e038b(0x205)+_0x3e038b(0x1fa)+TABLE_SETTINGS+'\x20LIMIT\x201');_0x1ea70e=_0x78a88?Object[_0x3e038b(0x1f4)](_0x78a88):[];}catch(_0x46cc55){_0x1ea70e=[];}}const _0x429c9b=_0x1ea70e[_0x3e038b(0x19d)](_0x141b4e=>String(_0x141b4e)['toLowerCas'+'e']()),_0x1c334a=_0x429c9b[_0x3e038b(0x1e4)](_0x3e038b(0x1a7)),_0x3d903a=_0x429c9b[_0x3e038b(0x1e4)](_0x3e038b(0x1d9)),_0x4775f4=_0x429c9b[_0x3e038b(0x1e4)](_0x3e038b(0x179));if(_0x1c334a&&_0x3d903a)return;if(!_0x1c334a&&_0x4775f4)try{await db[_0x3e038b(0x1ba)](_0x3e038b(0x16e)+_0x3e038b(0x1b7)),await db[_0x3e038b(0x1ba)]('CREATE\x20TAB'+_0x3e038b(0x17b)+_0x3e038b(0x180)+TABLE_SETTINGS+(_0x3e038b(0x21c)+_0x3e038b(0x1b9)+_0x3e038b(0x1c8)+_0x3e038b(0x1cc)+_0x3e038b(0x1bf)));const _0x3d8140=_0x3d903a;_0x3d8140?await db[_0x3e038b(0x1ba)](_0x3e038b(0x1d2)+_0x3e038b(0x16d)+'TO\x20'+TABLE_SETTINGS+(_0x3e038b(0x21c)+_0x3e038b(0x211)+_0x3e038b(0x1a4)+_0x3e038b(0x1bc)+'\x20enabled\x20F'+_0x3e038b(0x1fa))+TABLE_SETTINGS+';'):await db['exec'](_0x3e038b(0x1d2)+_0x3e038b(0x16d)+_0x3e038b(0x231)+TABLE_SETTINGS+('_new\x20(chat'+_0x3e038b(0x211)+'led)\x20SELEC'+_0x3e038b(0x1bc)+'\x200\x20FROM\x20')+TABLE_SETTINGS+';');await db[_0x3e038b(0x1ba)](_0x3e038b(0x1c0)+'\x20'+TABLE_SETTINGS+';'),await db['exec'](_0x3e038b(0x191)+'E\x20'+TABLE_SETTINGS+(_0x3e038b(0x213)+_0x3e038b(0x1ed))+TABLE_SETTINGS+';'),await db[_0x3e038b(0x1ba)](_0x3e038b(0x1af)),info('['+name+(_0x3e038b(0x184)+'\x20')+TABLE_SETTINGS+('\x20(chat_id\x20'+_0x3e038b(0x1ca)+'d)'));return;}catch(_0x411695){try{await db[_0x3e038b(0x1ba)](_0x3e038b(0x15f));}catch(_0x31750d){}warn('['+name+(_0x3e038b(0x21f)+_0x3e038b(0x1a5))+TABLE_SETTINGS+_0x3e038b(0x217)+(_0x411695?.[_0x3e038b(0x1a6)]||_0x411695));return;}if(!_0x1c334a||!_0x3d903a)try{await db[_0x3e038b(0x1ba)](_0x3e038b(0x21d)+_0x3e038b(0x17b)+'EXISTS\x20'+TABLE_SETTINGS+(_0x3e038b(0x207)+_0x3e038b(0x1b0)+'ARY\x20KEY,\x20e'+'nabled\x20INT'+_0x3e038b(0x1f5))),info('['+name+_0x3e038b(0x160)+TABLE_SETTINGS+('\x20exists\x20wi'+_0x3e038b(0x196)+_0x3e038b(0x18b)));}catch(_0x591003){warn('['+name+(_0x3e038b(0x22e)+'\x20')+TABLE_SETTINGS+(_0x3e038b(0x1ce)+'ailed:\x20')+(_0x591003?.[_0x3e038b(0x1a6)]||_0x591003));}}catch(_0x35cdae){warn('['+name+(_0x3e038b(0x181)+_0x3e038b(0x212)+_0x3e038b(0x1d6)+'error:\x20')+(_0x35cdae?.[_0x3e038b(0x1a6)]||_0x35cdae));}}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x21ffd8=_0x47dd94;if(!botRef)return;if(typeof botRef[_0x21ffd8(0x17f)+'e']===_0x21ffd8(0x237))sendApi=async(_0x8cf4a3,_0x5ec41e)=>await botRef[_0x21ffd8(0x17f)+'e'](_0x8cf4a3,_0x5ec41e);else{if(botRef[_0x21ffd8(0x23e)]&&typeof botRef[_0x21ffd8(0x23e)][_0x21ffd8(0x17f)+'e']===_0x21ffd8(0x237))sendApi=async(_0x4b9a6d,_0x1c4881)=>await botRef['sock'][_0x21ffd8(0x17f)+'e'](_0x4b9a6d,_0x1c4881);else sendApi=null;}}async function sendText(_0xc52a46,_0x4135db,_0x2a2aa8=[]){const _0x4e8759=_0x47dd94;if(!_0x4135db||!_0xc52a46)return null;if(!sendApi)return warn('['+name+(_0x4e8759(0x203)+_0x4e8759(0x233)+'not\x20availa'+_0x4e8759(0x223))),null;try{const _0x2a536d=typeof _0x4135db===_0x4e8759(0x1a1)?{'text':_0x4135db}:_0x4135db;if(Array[_0x4e8759(0x1f3)](_0x2a2aa8)&&_0x2a2aa8[_0x4e8759(0x189)])_0x2a536d[_0x4e8759(0x20c)]=_0x2a2aa8;return await sendApi(_0xc52a46,_0x2a536d);}catch(_0x106383){return warn('['+name+(']\x20sendText'+'\x20failed\x20to'+'\x20')+_0xc52a46+':\x20'+(_0x106383?.[_0x4e8759(0x1a6)]||_0x106383)),null;}}async function kickUser(_0x3181f0,_0x51a137){const _0x801d54=_0x47dd94;try{const _0x88cdb2=botRef[_0x801d54(0x23e)]?.[_0x801d54(0x206)+_0x801d54(0x238)+_0x801d54(0x20f)]||botRef[_0x801d54(0x206)+_0x801d54(0x238)+_0x801d54(0x20f)];if(_0x88cdb2)return await _0x88cdb2(_0x3181f0,[_0x51a137],_0x801d54(0x1c6)),info('['+name+_0x801d54(0x163)+_0x51a137+_0x801d54(0x174)+_0x3181f0),!![];return![];}catch(_0xfd8345){return warn('['+name+(_0x801d54(0x15e)+'\x20failed:\x20')+(_0xfd8345?.[_0x801d54(0x1a6)]||_0xfd8345)),![];}}async function getChatEnabled(_0x4a366a){const _0x545ec6=_0x47dd94;try{const _0x11c73d=await db[_0x545ec6(0x218)](_0x545ec6(0x1a9)+_0x545ec6(0x228)+TABLE_SETTINGS+('\x20WHERE\x20cha'+'t_jid\x20=\x20?'),[_0x4a366a]);return _0x11c73d?Number(_0x11c73d[_0x545ec6(0x1d9)])===0x150f*0x1+0x1941+-0x2e4f:![];}catch(_0xadd705){return warn('['+name+(']\x20getChatE'+_0x545ec6(0x1ad)+'error\x20for\x20')+_0x4a366a+':\x20'+(_0xadd705?.[_0x545ec6(0x1a6)]||_0xadd705)),![];}}async function setChatEnabled(_0x377860,_0x36ff30){const _0x5d68cb=_0x47dd94;try{return await db[_0x5d68cb(0x22f)](_0x5d68cb(0x226)+'O\x20'+TABLE_SETTINGS+(_0x5d68cb(0x207)+_0x5d68cb(0x21a)+'\x20VALUES\x20(?'+',\x20?)\x20\x0a\x20\x20\x20\x20'+_0x5d68cb(0x17d)+_0x5d68cb(0x186)+_0x5d68cb(0x234)+_0x5d68cb(0x1ea)+_0x5d68cb(0x216)+_0x5d68cb(0x1b4)+_0x5d68cb(0x19f)),[_0x377860,_0x36ff30?-0x2218+0x3*-0x277+0x297e:-0x161c+-0xe97+0x24b3]),!![];}catch(_0x93ca95){return warn('['+name+(_0x5d68cb(0x1b1)+_0x5d68cb(0x1ad)+_0x5d68cb(0x1ff))+_0x377860+':\x20'+(_0x93ca95?.['message']||_0x93ca95)),![];}}function ensureChatMap(_0x55e107){const _0x4d43fd=_0x47dd94;if(!chatUserMap[_0x4d43fd(0x1fd)](_0x55e107))chatUserMap[_0x4d43fd(0x221)](_0x55e107,new Map());return chatUserMap[_0x4d43fd(0x218)](_0x55e107);}function clearChatMemory(_0x526713){const _0x3f9735=_0x47dd94;if(chatUserMap['has'](_0x526713))chatUserMap[_0x3f9735(0x1b3)](_0x526713);}async function handleMessageForSpam(_0x2cd660){const _0x399b67=_0x47dd94;try{const _0x594e5b=String(_0x2cd660[_0x399b67(0x22d)]?.[_0x399b67(0x20e)]||'');if(!_0x594e5b||!_0x594e5b[_0x399b67(0x168)](_0x399b67(0x1c4)))return;if(_0x2cd660[_0x399b67(0x22d)]?.['fromMe'])return;const _0x162f91=await getChatEnabled(_0x594e5b);if(!_0x162f91)return;const _0x428672=String(_0x2cd660[_0x399b67(0x22d)]?.['participan'+'t']||_0x2cd660[_0x399b67(0x22d)]?.[_0x399b67(0x1f8)]||'');if(!_0x428672)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x594e5b,'participant':_0x428672},'message':_0x2cd660[_0x399b67(0x1a6)]}))return;}catch(_0x2af1d6){}const _0xf62544=Date[_0x399b67(0x20d)](),_0x580476=ensureChatMap(_0x594e5b);!_0x580476[_0x399b67(0x1fd)](_0x428672)&&_0x580476[_0x399b67(0x221)](_0x428672,{'timestamps':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x59d238=_0x580476[_0x399b67(0x218)](_0x428672);_0x59d238[_0x399b67(0x219)]=(_0x59d238[_0x399b67(0x219)]||[])[_0x399b67(0x1d5)](_0x5536a2=>_0xf62544-_0x5536a2<=CFG[_0x399b67(0x20a)+_0x399b67(0x235)]),_0x59d238[_0x399b67(0x219)]['push'](_0xf62544);if(_0x59d238[_0x399b67(0x200)]&&_0xf62544-_0x59d238[_0x399b67(0x200)]<CFG[_0x399b67(0x225)+_0x399b67(0x1be)])return;if((_0x59d238[_0x399b67(0x219)]||[])['length']>=CFG[_0x399b67(0x198)+_0x399b67(0x18f)]){_0x59d238[_0x399b67(0x200)]=_0xf62544;(!_0x59d238[_0x399b67(0x19c)+_0x399b67(0x1f1)]||_0x59d238[_0x399b67(0x19c)+_0x399b67(0x1f1)]<=_0xf62544)&&(_0x59d238[_0x399b67(0x1f9)]=0x3*0x291+-0xbd9+0x1*0x426);_0x59d238[_0x399b67(0x1f9)]=(_0x59d238['warnCount']||0x2709+0xe67+-0x2d0*0x13)+(0x22fb+0x19*0xca+-0x36b4),_0x59d238[_0x399b67(0x19c)+'sAt']=_0xf62544+CFG[_0x399b67(0x220)+'Y_MS'];const _0x37e394=Math[_0x399b67(0x1f7)](0xcfc+0x26b*-0x1+-0xa91,CFG[_0x399b67(0x175)+'GS']-_0x59d238[_0x399b67(0x1f9)]),_0x165fec='@'+_0x428672[_0x399b67(0x187)]('@')[0x160a+-0x2161+0xb57],_0x4d3cdf=String(CFG[_0x399b67(0x1dd)+_0x399b67(0x1aa)]||'')['replace'](_0x399b67(0x21e),_0x165fec)[_0x399b67(0x1e6)]('{warnings}',String(_0x37e394)),_0xac78a1=await sendText(_0x594e5b,{'text':_0x4d3cdf,'mentions':[_0x428672]});_0xac78a1?.[_0x399b67(0x22d)]&&CFG['WARNING_TT'+'L_MS']>-0x7+0x2441+-0x243a&&setTimeout(async()=>{const _0x1a5841=_0x399b67;try{await sendText(_0x594e5b,{'delete':_0xac78a1[_0x1a5841(0x22d)]});}catch(_0x313765){}},CFG[_0x399b67(0x18a)+'L_MS']);if(CFG[_0x399b67(0x1d8)+'AM']&&_0x59d238['warnCount']>=CFG[_0x399b67(0x175)+'GS']){const _0x29506b=await kickUser(_0x594e5b,_0x428672);_0x29506b?(_0x580476['delete'](_0x428672),await sendText(_0x594e5b,{'text':_0x165fec+('\x20removed\x20f'+_0x399b67(0x169)+'d\x20spam.'),'mentions':[_0x428672]})[_0x399b67(0x1dc)](()=>{})):warn('['+name+(_0x399b67(0x1ab)+_0x399b67(0x17e))+_0x428672+_0x399b67(0x174)+_0x594e5b);}}}catch(_0x55735e){warn('['+name+(_0x399b67(0x227)+_0x399b67(0x1e2)+_0x399b67(0x1ef))+(_0x55735e?.[_0x399b67(0x1a6)]||_0x55735e));}}async function rawMessagesUpsertHandler({messages:_0x9e0710}){const _0x1087cc=_0x47dd94;if(!Array[_0x1087cc(0x1f3)](_0x9e0710))return;for(const _0x173c8c of _0x9e0710){try{const _0x4525f4=String(_0x173c8c['key']?.[_0x1087cc(0x20e)]||'');if(!_0x4525f4||!_0x4525f4[_0x1087cc(0x168)]('@g.us'))continue;if(!_0x173c8c[_0x1087cc(0x1a6)])continue;if(_0x173c8c[_0x1087cc(0x22d)]?.['fromMe'])continue;const _0x54c52e=_0x4525f4+'::'+String(_0x173c8c[_0x1087cc(0x22d)]?.['id']||'')+'::'+String(_0x173c8c[_0x1087cc(0x22d)]?.[_0x1087cc(0x22c)+'t']||'');if(processedMessageKeys[_0x1087cc(0x1fd)](_0x54c52e))continue;const _0x41f049=setTimeout(()=>processedMessageKeys[_0x1087cc(0x1b3)](_0x54c52e),DEDUPE_TTL_MS);processedMessageKeys[_0x1087cc(0x221)](_0x54c52e,_0x41f049),await handleMessageForSpam(_0x173c8c);}catch(_0x50087c){warn('['+name+(_0x1087cc(0x162)+_0x1087cc(0x222)+_0x1087cc(0x1a0)+'er\x20error:\x20')+(_0x50087c?.[_0x1087cc(0x1a6)]||_0x50087c));}}}export async function onMessage(_0x35a78f){const _0x4f1afb=_0x47dd94;try{if(!_0x35a78f||!_0x35a78f['key']||!_0x35a78f[_0x4f1afb(0x1a6)]||!_0x35a78f[_0x4f1afb(0x1b5)])return;const _0x380ad9=String(_0x35a78f[_0x4f1afb(0x22d)][_0x4f1afb(0x20e)]||'');if(!_0x380ad9[_0x4f1afb(0x168)](_0x4f1afb(0x1c4)))return;if(!await isadmin(botRef,_0x35a78f))return;const _0x340e20=typeof _0x35a78f[_0x4f1afb(0x1e7)]===_0x4f1afb(0x1a1)&&_0x35a78f[_0x4f1afb(0x1e7)]['trim']()[_0x4f1afb(0x189)]?_0x35a78f[_0x4f1afb(0x1e7)][_0x4f1afb(0x1e1)]():'';if(!_0x340e20)return;const _0x460ed4=_0x340e20[_0x4f1afb(0x187)](/\s+/)[_0x4f1afb(0x1d5)](Boolean);if(!_0x460ed4[_0x4f1afb(0x189)])return;const _0x228190=String(_0x460ed4[0x49*-0x1a+0x1*-0xdf7+0x1561]||'')[_0x4f1afb(0x1e8)+'e'](),_0xd519ea=_0x460ed4[_0x4f1afb(0x1a2)](-0x158*-0x4+-0x1a06*-0x1+-0x1f65);if(!commands[_0x4f1afb(0x1e4)](_0x228190))return;if(_0x228190===_0x4f1afb(0x18c)){const _0x2acedf=(_0xd519ea[_0x4f1afb(0x197)](_0x1f578a=>['on',_0x4f1afb(0x1fc),'show']['includes'](String(_0x1f578a)[_0x4f1afb(0x1e8)+'e']()))||_0x4f1afb(0x16b))[_0x4f1afb(0x1e8)+'e']();if(_0x2acedf==='on'){const _0x36db20=await setChatEnabled(_0x380ad9,!![]);return _0x36db20?(clearChatMemory(_0x380ad9),sendText(_0x380ad9,_0x4f1afb(0x23c)+_0x4f1afb(0x232)+'for\x20this\x20g'+_0x4f1afb(0x1a8))):sendText(_0x380ad9,_0x4f1afb(0x1cf)+_0x4f1afb(0x19a)+'nti-spam\x20('+_0x4f1afb(0x166));}else{if(_0x2acedf===_0x4f1afb(0x1fc)){const _0x290b15=await setChatEnabled(_0x380ad9,![]);return _0x290b15?(clearChatMemory(_0x380ad9),sendText(_0x380ad9,_0x4f1afb(0x23c)+_0x4f1afb(0x1f2)+_0x4f1afb(0x185)+_0x4f1afb(0x188))):sendText(_0x380ad9,'⚠️\x20Failed\x20t'+'o\x20disable\x20'+_0x4f1afb(0x1f0)+'(DB\x20error)'+'.');}else{const _0xe545b0=await getChatEnabled(_0x380ad9),_0x508add={'SPAM_THRESHOLD':CFG[_0x4f1afb(0x198)+'HOLD'],'SPAM_WINDOW_MS':CFG['SPAM_WINDO'+_0x4f1afb(0x235)],'SPAM_COOLDOWN_MS':CFG[_0x4f1afb(0x225)+_0x4f1afb(0x1be)],'MAX_WARNINGS':CFG[_0x4f1afb(0x175)+'GS'],'KICK_ON_SPAM':CFG['KICK_ON_SP'+'AM']};return sendText(_0x380ad9,_0x4f1afb(0x23c)+_0x4f1afb(0x1fe)+_0x4f1afb(0x1d3)+(_0xe545b0?_0x4f1afb(0x229):_0x4f1afb(0x1b8))+_0x4f1afb(0x1e0)+JSON[_0x4f1afb(0x239)](_0x508add));}}}if(_0x228190===_0x4f1afb(0x16c)){const _0x36f6a8=_0x35a78f['message']?.[_0x4f1afb(0x19b)+'xtMessage']?.['contextInf'+'o']?.[_0x4f1afb(0x20b)+'id']||[];if(!_0x36f6a8||_0x36f6a8['length']===0x1b9b+-0x39d+-0x2*0xbff)return sendText(_0x380ad9,_0x4f1afb(0x1ee)+'mention\x20on'+_0x4f1afb(0x16a)+_0x4f1afb(0x194)+'eset\x20their'+_0x4f1afb(0x167)+_0x4f1afb(0x199));const _0x387aba=chatUserMap['get'](_0x380ad9);for(const _0x5612a3 of _0x36f6a8){if(_0x387aba&&_0x387aba[_0x4f1afb(0x1fd)](_0x5612a3))_0x387aba[_0x4f1afb(0x1b3)](_0x5612a3);}return sendText(_0x380ad9,_0x4f1afb(0x23c)+_0x4f1afb(0x1de)+_0x4f1afb(0x172)+_0x4f1afb(0x1e3)+_0x4f1afb(0x1c2));}}catch(_0x3761c5){error(_0x3761c5,'['+name+(_0x4f1afb(0x1cb)+'e\x20error:\x20')+(_0x3761c5?.[_0x4f1afb(0x1a6)]||_0x3761c5));}}export async function initialize(_0xe6617a){const _0x20377c=_0x47dd94;try{if(!_0xe6617a)throw new Error(_0x20377c(0x171)+_0x20377c(0x1c1)+_0x20377c(0x1db)+'ot\x20instanc'+'e');botRef=_0xe6617a,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),startManagedListener({'botRef':botRef,'eventName':_0x20377c(0x1d4)+_0x20377c(0x1ac),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(_0x20377c(0x23b)+_0x20377c(0x1d0)+_0x20377c(0x177)+_0x20377c(0x195)+_0x20377c(0x19e)+'y\x20')+TABLE_SETTINGS+('.\x20Threshol'+'d=')+CFG['SPAM_THRES'+_0x20377c(0x18f)]+_0x20377c(0x193)+CFG['SPAM_WINDO'+_0x20377c(0x235)]+(_0x20377c(0x170)+_0x20377c(0x201))+CFG['MAX_WARNIN'+'GS']);}catch(_0xd58c39){error(_0xd58c39,'['+name+(_0x20377c(0x23b)+_0x20377c(0x1bd))+(_0xd58c39?.[_0x20377c(0x1a6)]||_0xd58c39));throw _0xd58c39;}}export async function cleanup(){const _0x2c8487=_0x47dd94;try{stopManagedListener(name,_0x2c8487(0x1d4)+_0x2c8487(0x1ac));}catch(_0x4d620a){warn('['+name+(']\x20stopMana'+_0x2c8487(0x1b2)+_0x2c8487(0x1c5))+(_0x4d620a?.[_0x2c8487(0x1a6)]||_0x4d620a));}for(const _0x25fbcc of processedMessageKeys['values']())try{clearTimeout(_0x25fbcc);}catch(_0x564447){}processedMessageKeys[_0x2c8487(0x1eb)](),chatUserMap[_0x2c8487(0x1eb)](),botRef=null,sendApi=null,info('['+name+(_0x2c8487(0x1f6)+_0x2c8487(0x209)));}function _0xe468(_0x21fdd3,_0x314553){const _0x5a7d73=_0xa866();return _0xe468=function(_0x5102be,_0x5ecd39){_0x5102be=_0x5102be-(0x2094+-0x23d+-0x1cf9);let _0x48b291=_0x5a7d73[_0x5102be];return _0x48b291;},_0xe468(_0x21fdd3,_0x314553);}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};