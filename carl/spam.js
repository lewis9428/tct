const _0x4d7f62=_0x476d;function _0x1b1d(){const _0xf50a18=['lEnabled\x20f','o\x20refresh\x20','string','ings}','KICK_ON_SP','delete','conversati','1189591JSPaNZ','L_MS','show','EXISTS\x20','SELECT\x20val','t_jid)\x20DO\x20','g\x20connecti','SPAM_COOLD','lastWarnAt','ned\x20user(s','\x20GLOBAL\x20(','find','ias|jid]`','pires_at\x20I','l_settings',']\x20initiali','mention\x20a\x20','\x20failed\x20to','nabled\x20fai','Spam\x20warni','am\x20error:\x20','R\x20NOT\x20NULL','\x20=\x20\x27enable','mentions','er_jid\x20TEX','Global\x20spa','xtMessage','timestamps','ble','slice','user\x20to\x20re',']\x20Failed\x20t','You\x20must\x20@','\x20is\x20','s_at=exclu','\x20\x20\x20\x20\x20\x20\x20ON\x20','SPAM','participan','\x20\x20\x20PRIMARY','has','run','sock','enabled','SPAM_WINDO','get','\x20(\x27enabled','\x20(chat_jid','led:\x20','ue)\x20VALUES','resetspam','y)\x20DO\x20UPDA','e\x20a\x20global',')\x20in\x20','l\x20default:','SPAM_THRES','led\x20for\x20','UPDATE\x20SET','imageMessa','split','remove','15316434eLFYKD','HOLD','t_jid\x20=\x20?','LE\x20IF\x20NOT\x20',']\x20getWarni','ngs','\x20(\x0a\x20\x20\x20\x20\x20\x20c','WARN_EXPIR','1307654TxERUR','includes','INSERT\x20INT','nabled\x20INT','ue\x20=\x20exclu','bled\x20FROM\x20','unt\x20INTEGE','NFLICT(cha','hat_id\x20TEX','failed:\x20','p(s)\x20found','global','max','fromMe','push','TEXT);','jid','ze\x20fatal:\x20',']\x20handleMe','Usage:\x20`','|global]`\x20','in\x20PM.','message',']\x20resetWar','Y_MS','pires_at)\x20','selectedBu','or\x20JID:\x20`','15605634WMeons','Global\x20set','t_id=?\x20AND','er_jid)\x20DO','cluded.cou','Handler\x20','isArray','\x20PRIMARY\x20K','boolean','No\x20valid\x20t',']\x20ensureTa','resolveNam','6USrPGz','ponseMessa','d\x20spam.','buttonsRes','now','{user}',']\x20getGloba','WARNING_ME','SELECT\x20ena','\x20TEXT\x20PRIM',']\x20findSudo','4.0.3','`,\x20or\x20`sho','_id,\x20user_','CREATE\x20TAB','ate','Invalid\x20ac','\x20KEY\x20(chat','spam_setti','o\x20default\x20','isCommand','\x20@user\x20[al','SSAGE','W_MS',',\x0a\x20\x20\x20\x20\x20\x20ex','ttonId','s_at;','remoteJid','key','andler\x20inn','spam_warni','mentionedJ','spam.initi','WARNING_TT','groupParti','set\x20their\x20','or\x20repeate','\x20user_jid,','psert','`resetspam',']\x20cleaned\x20','count','ning\x20warni','catch','off','function','exec','connection','values','{warnings}','videoMessa','\x20enabled\x20=','keys','messages.u','for\x20mentio','\x20<action>\x20','or\x20`','\x20WHERE\x20cha','OWN_MS','OFF','length','set','sendMessag','extendedTe','from',']\x20rawMessa','anged\x20by\x20s','\x20failed:\x20','@g.us','er\x20error:\x20','hat_id,\x20us',',\x20enabled)','stop\x20spamm','ue\x20FROM\x20','SELECT\x20cou',':\x20sendApi\x20','10zfeAQz','n\x20set\x20to\x20','ssageForSp','contextInf','cipantsUpd','ARY\x20KEY,\x20e','config:\x20','3zcFQOs','caption','on\x20','INHERITING','nt,\x20expire','w`.','TE\x20SET\x20val',',\x20?)\x20ON\x20CO','ailed:\x20','CONFLICT(c',']\x20getChatE','trim','✔️\x20','`on`,\x20`off','189116KehhxE','\x20count,\x20ex','or:\x20','expires_at','toUpperCas',']\x20stopMana','r\x20failed:\x20','Spam\x20detec','\x20user_jid=','ONFLICT(ke','tion\x20for\x20','T\x20NOT\x20NULL','replace','VALUES\x20(?,','alize\x20requ','zed.\x20Globa','DELETE\x20FRO','⚠️\x20{user},\x20','startsWith','2014999ErKfMx','filter','oup\x20alias\x20','MAX_WARNIN','toLowerCas','gedListene','Unknown\x20gr','\x20set\x20to\x20','\x20removed\x20f',']\x20setGloba','endsWith','4765450ilZQPQ','udo\x20users\x20',']\x20incremen','ing.\x20Remai','text','32kkeDYM','arget\x20grou','gesUpsertH','spam'];_0x1b1d=function(){return _0xf50a18;};return _0x1b1d();}(function(_0x439770,_0x88996){const _0x3033b6=_0x476d,_0x3a475c=_0x439770();while(!![]){try{const _0x5ed5fe=parseInt(_0x3033b6(0x167))/(0x86*-0x43+-0x1471*-0x1+-0xea2*-0x1)+parseInt(_0x3033b6(0x1ab))/(-0x1e81+0x2368+-0x4e5)+parseInt(_0x3033b6(0x12b))/(0x1*0x25dd+-0x1944+0x219*-0x6)*(parseInt(_0x3033b6(0x139))/(-0x1ae9+0x3b8*0x5+-0x1b*-0x4f))+parseInt(_0x3033b6(0x157))/(-0x76b*-0x5+0x240c+0x17e*-0x31)*(parseInt(_0x3033b6(0x1d3))/(-0xbc7+0x3*0x5+-0x9*-0x14e))+parseInt(_0x3033b6(0x14c))/(-0x3b9*-0x4+-0x1b*0x145+-0x2*-0x9b5)*(parseInt(_0x3033b6(0x15c))/(-0x213e+-0x26*-0x51+-0x5*-0x440))+parseInt(_0x3033b6(0x1a3))/(0x1847+-0x4c5*0x2+-0xeb4)*(-parseInt(_0x3033b6(0x124))/(-0x1445+-0x11*0x1bb+0x31ba))+-parseInt(_0x3033b6(0x1c7))/(0x1d*-0x97+-0x4c0+-0x1*-0x15e6);if(_0x5ed5fe===_0x88996)break;else _0x3a475c['push'](_0x3a475c['shift']());}catch(_0x1ca870){_0x3a475c['push'](_0x3a475c['shift']());}}}(_0x1b1d,-0x454f*-0x25+-0x18113a+0x1b6596));import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';function _0x476d(_0xa81787,_0x182364){const _0x5976fe=_0x1b1d();return _0x476d=function(_0x2fda42,_0x25aa85){_0x2fda42=_0x2fda42-(-0x3c1+0x1*0x1ca7+-0x11*0x169);let _0x2dd837=_0x5976fe[_0x2fda42];return _0x2dd837;},_0x476d(_0xa81787,_0x182364);}import{isadmin}from'../utils/isadmin.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import*as _0xd7acc8 from'../utils/groups.js';import{getDefault,getConnection}from'../utils/connection.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name='spam';export const version=_0x4d7f62(0x1de);export const priority=0x22+-0x41b*0x2+-0x1*-0x86e;export const commands=[_0x4d7f62(0x15f),_0x4d7f62(0x198)];export const configKeys=[_0x4d7f62(0x18b)];let botRef=null,GLOBAL_ENABLED=![],sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(-0xadd+0x10*-0x97+0x146b)*(0x4*-0x502+0x10be+-0x732*-0x1),CFG={'SPAM_THRESHOLD':0x5,'SPAM_WINDOW_MS':0xfa0,'SPAM_COOLDOWN_MS':0x1388,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(-0x1*-0x1421+0x13d0+-0x27ea)*(0x954+-0x24e9+0x6d*0x41)*(0x241c+0x87*-0x34+0x2*-0x43a)*(0x1021*0x1+0xde0+-0x1dc5)*(0x5d8+-0x191c+-0xb96*-0x2),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x4d7f62(0x14a)+_0x4d7f62(0x120)+_0x4d7f62(0x15a)+_0x4d7f62(0x102)+'ngs:\x20{warn'+_0x4d7f62(0x163),'WARNING_TTL_MS':0xc350};function refreshConfig(){const _0x4f616d=_0x4d7f62;try{const _0x4bb973=getConfig()?.['SPAM']||{};Object[_0x4f616d(0x10c)](CFG)['forEach'](_0x33d34a=>{if(_0x4bb973[_0x33d34a]!==undefined)CFG[_0x33d34a]=_0x4bb973[_0x33d34a];}),CFG[_0x4f616d(0x19d)+_0x4f616d(0x1a4)]=Number(CFG[_0x4f616d(0x19d)+'HOLD'])||-0x17e*0x16+0x56*-0x2+-0x2185*-0x1,CFG[_0x4f616d(0x192)+'W_MS']=Number(CFG[_0x4f616d(0x192)+'W_MS'])||-0x663*-0x1+0xa02+-0xc5,CFG['SPAM_COOLD'+'OWN_MS']=Number(CFG[_0x4f616d(0x16e)+_0x4f616d(0x112)])||-0x1624+-0xbd6+-0x12*-0x2f9,CFG[_0x4f616d(0x14f)+'GS']=Number(CFG[_0x4f616d(0x14f)+'GS'])||-0xe*-0xe3+-0x2*0x12b9+0x190b,CFG[_0x4f616d(0x1aa)+_0x4f616d(0x1c3)]=Number(CFG[_0x4f616d(0x1aa)+_0x4f616d(0x1c3)])||(0x1*-0x1e8f+0x93d+0x1*0x1559)*(0xb9*0x16+-0x1*-0x20a1+-0x306f)*(0xe7b+-0x765+-0x6da)*(0x12a7+0x1767+-0x6a*0x65)*(0x1097*0x2+-0x7f*0x49+0x6f1*0x1),CFG[_0x4f616d(0xf9)+_0x4f616d(0x168)]=Number(CFG[_0x4f616d(0xf9)+'L_MS'])||0x1189+-0x23fc+0x7*0x56d,CFG['KICK_ON_SP'+'AM']=!!CFG['KICK_ON_SP'+'AM'];}catch(_0x1293e1){warn('['+name+(_0x4f616d(0x186)+_0x4f616d(0x161)+_0x4f616d(0x12a))+(_0x1293e1?.['message']||_0x1293e1));}}const TABLE_GLOBAL='spam_globa'+_0x4d7f62(0x175),TABLE_SETTINGS=_0x4d7f62(0x1e5)+_0x4d7f62(0x1a8),TABLE_WARNINGS=_0x4d7f62(0xf6)+'ngs';async function ensureTables(){const _0x4068b2=_0x4d7f62;try{await db[_0x4068b2(0x106)](_0x4068b2(0x1e1)+_0x4068b2(0x1a6)+_0x4068b2(0x16a)+TABLE_GLOBAL+('\x20(key\x20TEXT'+_0x4068b2(0x1ce)+'EY,\x20value\x20'+_0x4068b2(0x1ba))),await db['exec'](_0x4068b2(0x1e1)+'LE\x20IF\x20NOT\x20'+'EXISTS\x20'+TABLE_SETTINGS+(_0x4068b2(0x195)+_0x4068b2(0x1dc)+_0x4068b2(0x129)+_0x4068b2(0x1ae)+'EGER);')),await db[_0x4068b2(0x106)]('CREATE\x20TAB'+'LE\x20IF\x20NOT\x20'+_0x4068b2(0x16a)+TABLE_WARNINGS+(_0x4068b2(0x1a9)+_0x4068b2(0x1b3)+_0x4068b2(0x144)+',\x0a\x20\x20\x20\x20\x20\x20us'+_0x4068b2(0x17f)+'T\x20NOT\x20NULL'+',\x0a\x20\x20\x20\x20\x20\x20co'+_0x4068b2(0x1b1)+_0x4068b2(0x17c)+'\x20DEFAULT\x200'+_0x4068b2(0xf0)+_0x4068b2(0x174)+'NTEGER\x20NOT'+'\x20NULL,\x0a\x20\x20\x20'+_0x4068b2(0x18d)+_0x4068b2(0x1e4)+_0x4068b2(0x1e0)+'jid)\x0a\x20\x20\x20\x20)'+';'));}catch(_0x1aff80){warn('['+name+(_0x4068b2(0x1d1)+'bles\x20error'+':\x20')+(_0x1aff80?.[_0x4068b2(0x1c1)]||_0x1aff80));}}async function getGlobalEnabled(){const _0x316a0f=_0x4d7f62;try{const _0x142d7e=await db[_0x316a0f(0x193)](_0x316a0f(0x16b)+_0x316a0f(0x121)+TABLE_GLOBAL+('\x20WHERE\x20key'+_0x316a0f(0x17d)+'d\x27'));return _0x142d7e?_0x142d7e['value']==='1':!![];}catch(_0x4ee330){return warn('['+name+(_0x316a0f(0x1d9)+_0x316a0f(0x160)+_0x316a0f(0x133))+(_0x4ee330?.[_0x316a0f(0x1c1)]||_0x4ee330)),!![];}}async function setGlobalEnabled(_0x5e47cf){const _0x7d1dd7=_0x4d7f62;try{return GLOBAL_ENABLED=!!_0x5e47cf,await db[_0x7d1dd7(0x18f)](_0x7d1dd7(0x1ad)+'O\x20'+TABLE_GLOBAL+('\x20(key,\x20val'+_0x7d1dd7(0x197)+_0x7d1dd7(0x194)+'\x27,\x20?)\x20ON\x20C'+_0x7d1dd7(0x142)+_0x7d1dd7(0x199)+_0x7d1dd7(0x131)+_0x7d1dd7(0x1af)+'ded.value;'),[_0x5e47cf?'1':'0']),!![];}catch(_0x38315d){return warn('['+name+(_0x7d1dd7(0x155)+_0x7d1dd7(0x160)+_0x7d1dd7(0x133))+(_0x38315d?.[_0x7d1dd7(0x1c1)]||_0x38315d)),![];}}async function getChatEnabled(_0x2931af){const _0x799afa=_0x4d7f62;try{const _0x28765f=await db[_0x799afa(0x193)](_0x799afa(0x1db)+_0x799afa(0x1b0)+TABLE_SETTINGS+(_0x799afa(0x111)+_0x799afa(0x1a5)),[_0x2931af]);return _0x28765f?Number(_0x28765f[_0x799afa(0x191)])===0x1*0xc21+0xdf1+0x1*-0x1a11:undefined;}catch(_0x4bf7c5){return warn('['+name+(_0x799afa(0x135)+_0x799afa(0x179)+'led\x20for\x20')+_0x2931af+':\x20'+(_0x4bf7c5?.['message']||_0x4bf7c5)),undefined;}}async function setChatEnabled(_0x1bfc8f,_0x97813e){const _0x21caa3=_0x4d7f62;try{return await db[_0x21caa3(0x18f)](_0x21caa3(0x1ad)+'O\x20'+TABLE_SETTINGS+(_0x21caa3(0x195)+_0x21caa3(0x11f)+'\x20VALUES\x20(?'+_0x21caa3(0x132)+_0x21caa3(0x1b2)+_0x21caa3(0x16c)+_0x21caa3(0x19f)+_0x21caa3(0x10b)+'\x20excluded.'+'enabled;'),[_0x1bfc8f,_0x97813e?0x12ea+-0x1902+-0xdf*-0x7:-0x25c9+-0x346*-0xb+0x1c7]),!![];}catch(_0x56c9fd){return warn('['+name+(']\x20setChatE'+'nabled\x20fai'+_0x21caa3(0x19e))+_0x1bfc8f+':\x20'+(_0x56c9fd?.[_0x21caa3(0x1c1)]||_0x56c9fd)),![];}}async function getWarningCountDB(_0x58ba1f,_0x15ad15){const _0x872ea3=_0x4d7f62;try{const _0x31fcec=await db[_0x872ea3(0x193)](_0x872ea3(0x122)+_0x872ea3(0x12f)+'s_at\x20FROM\x20'+TABLE_WARNINGS+(_0x872ea3(0x111)+_0x872ea3(0x1c9)+'\x20user_jid='+'?'),[_0x58ba1f,_0x15ad15]);if(!_0x31fcec)return 0x592+0x2e5*0x3+-0xe41;if(Number(_0x31fcec[_0x872ea3(0x13c)])<=Date[_0x872ea3(0x1d7)]())return await db[_0x872ea3(0x18f)](_0x872ea3(0x149)+'M\x20'+TABLE_WARNINGS+(_0x872ea3(0x111)+'t_id=?\x20AND'+_0x872ea3(0x141)+'?'),[_0x58ba1f,_0x15ad15]),-0x100a+0x7c1+0x849;return Number(_0x31fcec[_0x872ea3(0x101)]||-0x26d6+-0x1*-0x22c6+-0x10*-0x41);}catch(_0xdda79){return warn('['+name+(_0x872ea3(0x1a7)+'ngCountDB\x20'+_0x872ea3(0x1b4))+(_0xdda79?.['message']||_0xdda79)),-0x1d8b+0xefd+0x4da*0x3;}}async function incrementWarningDB(_0xda9438,_0x2ffc35){const _0x550e65=_0x4d7f62;try{const _0x5938ea=await getWarningCountDB(_0xda9438,_0x2ffc35),_0x222087=_0x5938ea+(0x1f7c+0x1bab+-0x3b26),_0x2f92ec=Date['now']()+CFG[_0x550e65(0x1aa)+_0x550e65(0x1c3)];return await db[_0x550e65(0x18f)]('INSERT\x20INT'+'O\x20'+TABLE_WARNINGS+('\x20(chat_id,'+_0x550e65(0xfd)+_0x550e65(0x13a)+_0x550e65(0x1c4)+_0x550e65(0x146)+'\x20?,\x20?,\x20?)\x0a'+_0x550e65(0x18a)+_0x550e65(0x134)+_0x550e65(0x11e)+_0x550e65(0x1ca)+'\x20UPDATE\x20SE'+'T\x20count=ex'+_0x550e65(0x1cb)+_0x550e65(0x12f)+_0x550e65(0x189)+'ded.expire'+_0x550e65(0xf2)),[_0xda9438,_0x2ffc35,_0x222087,_0x2f92ec]),_0x222087;}catch(_0x5b0ee8){return warn('['+name+(_0x550e65(0x159)+'tWarningDB'+'\x20failed:\x20')+(_0x5b0ee8?.[_0x550e65(0x1c1)]||_0x5b0ee8)),-0x226f+-0x7*0x524+0x466b;}}async function resetWarningDB(_0x326bf5,_0x23e222){const _0x35d8c0=_0x4d7f62;try{return await db[_0x35d8c0(0x18f)](_0x35d8c0(0x149)+'M\x20'+TABLE_WARNINGS+('\x20WHERE\x20cha'+'t_id=?\x20AND'+_0x35d8c0(0x141)+'?'),[_0x326bf5,_0x23e222]),!![];}catch(_0x48f6cc){return warn('['+name+(_0x35d8c0(0x1c2)+'ningDB\x20fai'+_0x35d8c0(0x196))+(_0x48f6cc?.[_0x35d8c0(0x1c1)]||_0x48f6cc)),![];}}function setupSendApi(){const _0x22d0b7=_0x4d7f62;if(!botRef)return;if(typeof botRef[_0x22d0b7(0x116)+'e']===_0x22d0b7(0x105))sendApi=async(_0x104cf5,_0x1bf3ce)=>await botRef[_0x22d0b7(0x116)+'e'](_0x104cf5,_0x1bf3ce);else{if(botRef[_0x22d0b7(0x190)]&&typeof botRef[_0x22d0b7(0x190)][_0x22d0b7(0x116)+'e']===_0x22d0b7(0x105))sendApi=async(_0x99455a,_0xb39479)=>await botRef[_0x22d0b7(0x190)]['sendMessag'+'e'](_0x99455a,_0xb39479);else sendApi=null;}}async function sendText(_0x311ddf,_0x84343e,_0x4c8331=[]){const _0x35e1c7=_0x4d7f62;if(!_0x84343e||!_0x311ddf)return;if(!sendApi){warn('['+name+(']\x20sendText'+_0x35e1c7(0x123)+'not\x20availa'+_0x35e1c7(0x183)));return;}try{const _0x152f2d=typeof _0x84343e==='string'?{'text':_0x84343e}:_0x84343e;if(Array['isArray'](_0x4c8331)&&_0x4c8331[_0x35e1c7(0x114)])_0x152f2d[_0x35e1c7(0x17e)]=_0x4c8331;return await sendApi(_0x311ddf,_0x152f2d);}catch(_0x36ad71){warn('['+name+(']\x20sendText'+_0x35e1c7(0x178)+'\x20')+_0x311ddf+':\x20'+(_0x36ad71?.[_0x35e1c7(0x1c1)]||_0x36ad71));}}async function sendReply(_0x9b8381,_0x5aeda2,_0x3a8cf8=[]){const _0x2e1b51=_0x4d7f62,_0x1ca991=_0x2e1b51(0x137)+String(_0x5aeda2||'')[_0x2e1b51(0x136)]();return await sendText(_0x9b8381,_0x1ca991,_0x3a8cf8);}async function kickUser(_0x13a2e0,_0x59da11){const _0x186fdb=_0x4d7f62;try{const _0x2b14fc=botRef[_0x186fdb(0x190)]?.[_0x186fdb(0xfa)+_0x186fdb(0x128)+_0x186fdb(0x1e2)]||botRef[_0x186fdb(0xfa)+'cipantsUpd'+'ate'];if(_0x2b14fc)return await _0x2b14fc(_0x13a2e0,[_0x59da11],_0x186fdb(0x1a2)),!![];}catch(_0x1a734b){error(_0x1a734b,'['+name+(']\x20Failed\x20t'+'o\x20kick\x20')+_0x59da11);}return![];}function extractTextFromMessage(_0x259510){const _0x34c2b6=_0x4d7f62;if(!_0x259510||!_0x259510[_0x34c2b6(0x1c1)])return'';const _0x1fe53f=_0x259510['message'];if(_0x1fe53f[_0x34c2b6(0x166)+'on'])return _0x1fe53f['conversati'+'on'];if(_0x1fe53f[_0x34c2b6(0x117)+_0x34c2b6(0x181)]?.[_0x34c2b6(0x15b)])return _0x1fe53f[_0x34c2b6(0x117)+_0x34c2b6(0x181)][_0x34c2b6(0x15b)];if(_0x1fe53f[_0x34c2b6(0x1a0)+'ge']?.['caption'])return _0x1fe53f[_0x34c2b6(0x1a0)+'ge'][_0x34c2b6(0x12c)];if(_0x1fe53f[_0x34c2b6(0x10a)+'ge']?.[_0x34c2b6(0x12c)])return _0x1fe53f[_0x34c2b6(0x10a)+'ge']['caption'];if(_0x1fe53f['buttonsRes'+'ponseMessa'+'ge']?.['selectedBu'+_0x34c2b6(0xf1)])return _0x1fe53f[_0x34c2b6(0x1d6)+_0x34c2b6(0x1d4)+'ge'][_0x34c2b6(0x1c5)+_0x34c2b6(0xf1)];return'';}async function handleMessageForSpam(_0x2606f2){const _0x2f2b04=_0x4d7f62;try{const _0x31eba0=String(_0x2606f2[_0x2f2b04(0xf4)]?.[_0x2f2b04(0xf3)]||''),_0x628dfb=String(_0x2606f2['key']?.[_0x2f2b04(0x18c)+'t']||_0x2606f2[_0x2f2b04(0xf4)]?.['from']||_0x31eba0);if(_0x2606f2[_0x2f2b04(0xf4)]?.[_0x2f2b04(0x1b8)])return;try{if(await isadmin(botRef,_0x2606f2))return;}catch(_0x50d959){}if(!chatUserMap[_0x2f2b04(0x18e)](_0x31eba0))chatUserMap[_0x2f2b04(0x115)](_0x31eba0,new Map());const _0x509370=chatUserMap['get'](_0x31eba0);if(!_0x509370[_0x2f2b04(0x18e)](_0x628dfb))_0x509370[_0x2f2b04(0x115)](_0x628dfb,{'timestamps':[],'lastWarnAt':0x0});const _0x2ed70a=_0x509370[_0x2f2b04(0x193)](_0x628dfb),_0x58e86=Date[_0x2f2b04(0x1d7)]();_0x2ed70a[_0x2f2b04(0x182)]=(_0x2ed70a[_0x2f2b04(0x182)]||[])['filter'](_0x5461cc=>_0x58e86-_0x5461cc<=CFG[_0x2f2b04(0x192)+_0x2f2b04(0xef)]),_0x2ed70a[_0x2f2b04(0x182)][_0x2f2b04(0x1b9)](_0x58e86);if(_0x2ed70a[_0x2f2b04(0x16f)]&&_0x58e86-_0x2ed70a[_0x2f2b04(0x16f)]<CFG[_0x2f2b04(0x16e)+'OWN_MS'])return;if((_0x2ed70a[_0x2f2b04(0x182)]||[])['length']>=CFG[_0x2f2b04(0x19d)+_0x2f2b04(0x1a4)]){_0x2ed70a['lastWarnAt']=_0x58e86;const _0x3a7877=await incrementWarningDB(_0x31eba0,_0x628dfb),_0x287e2f=Math[_0x2f2b04(0x1b7)](0xa8e+0x1*0x1cfa+-0x2788,CFG[_0x2f2b04(0x14f)+'GS']-_0x3a7877),_0xfbd13f='@'+(String(_0x628dfb)[_0x2f2b04(0x1a1)]('@')[0x205d+0x60f+-0x266c]||''),_0x2d8a27=String(CFG[_0x2f2b04(0x1da)+_0x2f2b04(0xee)]||'')[_0x2f2b04(0x145)](_0x2f2b04(0x1d8),_0xfbd13f)[_0x2f2b04(0x145)](_0x2f2b04(0x109),String(_0x287e2f)),_0x2fb0bd=await sendText(_0x31eba0,{'text':_0x2d8a27,'mentions':[_0x628dfb]});_0x2fb0bd?.['key']&&CFG[_0x2f2b04(0xf9)+_0x2f2b04(0x168)]>-0xfa6+0x263*0xa+-0x838&&setTimeout(async()=>{try{await sendText(_0x31eba0,{'delete':_0x2fb0bd['key']});}catch(_0x3e04dd){}},CFG[_0x2f2b04(0xf9)+'L_MS']),CFG[_0x2f2b04(0x164)+'AM']&&_0x3a7877>=CFG[_0x2f2b04(0x14f)+'GS']&&(await kickUser(_0x31eba0,_0x628dfb)&&(await resetWarningDB(_0x31eba0,_0x628dfb)[_0x2f2b04(0x103)](()=>{}),await sendText(_0x31eba0,{'text':_0xfbd13f+(_0x2f2b04(0x154)+_0x2f2b04(0xfc)+_0x2f2b04(0x1d5)),'mentions':[_0x628dfb]})['catch'](()=>{})));}}catch(_0x2c55c0){warn('['+name+(_0x2f2b04(0x1bd)+_0x2f2b04(0x126)+_0x2f2b04(0x17b))+(_0x2c55c0?.[_0x2f2b04(0x1c1)]||_0x2c55c0));}}async function rawMessagesUpsertHandler({messages:_0x2e7950}){const _0x567c12=_0x4d7f62;try{if(!Array['isArray'](_0x2e7950))return;for(const _0x4d52a0 of _0x2e7950){try{const _0x236208=String(_0x4d52a0['key']?.[_0x567c12(0xf3)]||'');if(!_0x236208||!_0x236208[_0x567c12(0x156)](_0x567c12(0x11c)))continue;if(!_0x4d52a0[_0x567c12(0x1c1)])continue;const _0x15c03f=_0x236208+'::'+String(_0x4d52a0['key']?.['id']||'')+'::'+String(_0x4d52a0[_0x567c12(0xf4)]?.[_0x567c12(0x18c)+'t']||'');if(processedMessageKeys[_0x567c12(0x18e)](_0x15c03f))continue;const _0x520350=setTimeout(()=>processedMessageKeys[_0x567c12(0x165)](_0x15c03f),DEDUPE_TTL_MS);processedMessageKeys[_0x567c12(0x115)](_0x15c03f,_0x520350);const _0x530a42=await getChatEnabled(_0x236208),_0x143fb6=typeof _0x530a42===_0x567c12(0x1cf)?_0x530a42:GLOBAL_ENABLED;if(!_0x143fb6)continue;await handleMessageForSpam(_0x4d52a0);}catch(_0x3a17a8){warn('['+name+(_0x567c12(0x119)+_0x567c12(0x15e)+_0x567c12(0xf5)+_0x567c12(0x11d))+(_0x3a17a8?.['message']||_0x3a17a8));}}}catch(_0xaaefd5){warn('['+name+(_0x567c12(0x119)+_0x567c12(0x15e)+'andler\x20err'+_0x567c12(0x13b))+(_0xaaefd5?.[_0x567c12(0x1c1)]||_0xaaefd5));}}async function findSudoerJid(_0x489c84){const _0x13e48f=_0x4d7f62;try{const _0xf15865=userJidFromCtx?.(_0x489c84)||{'findings':[]},_0xa95b86=_0xf15865['findings']||[],_0x2350ba=await listSudo();if(!Array[_0x13e48f(0x1cd)](_0x2350ba)||_0x2350ba[_0x13e48f(0x114)]===-0xac9+-0x1*-0x1dad+-0x34*0x5d)return null;const _0xb1ce91=new Set(_0x2350ba['map'](String));for(const _0x10985a of _0xa95b86||[]){if(!_0x10985a||typeof _0x10985a[_0x13e48f(0x1bb)]!==_0x13e48f(0x162))continue;const _0x22e14a=normalizeToJid(_0x10985a[_0x13e48f(0x1bb)]);if(_0x22e14a&&_0xb1ce91['has'](_0x22e14a))return _0x22e14a;if(_0xb1ce91['has'](_0x10985a[_0x13e48f(0x1bb)]))return _0x10985a[_0x13e48f(0x1bb)];const _0x3b2630=String(_0x10985a[_0x13e48f(0x1bb)])['split']('@')[0x3*-0xc2d+0x1*-0x259b+-0x6*-0xc5b][_0x13e48f(0x1a1)](':')[0x1*0x579+-0x205c+-0x1ae3*-0x1];if(_0x3b2630)for(const _0x2b6958 of _0x2350ba){const _0x1c468b=String(_0x2b6958)[_0x13e48f(0x1a1)]('@')[0xde8+-0x168b+0x43*0x21];if(_0x1c468b&&_0x1c468b===_0x3b2630)return _0x2b6958;}}return null;}catch(_0xcf0f62){return warn('['+name+(_0x13e48f(0x1dd)+'erJid\x20erro'+'r:\x20')+(_0xcf0f62?.['message']||_0xcf0f62)),null;}}export async function onMessage(_0x590033){const _0x3bf5d0=_0x4d7f62;try{if(!_0x590033||!_0x590033[_0x3bf5d0(0xf4)]||!_0x590033[_0x3bf5d0(0x1c1)]||!_0x590033[_0x3bf5d0(0x1e7)])return;const _0x4cfec7=String(_0x590033[_0x3bf5d0(0xf4)]['remoteJid']||''),_0x53f620=_0x4cfec7['endsWith']('@g.us');if(_0x590033[_0x3bf5d0(0xf4)][_0x3bf5d0(0x1b8)]&&_0x53f620)return;const _0x14ccc2=String(extractTextFromMessage(_0x590033)||''),_0x18a216=typeof _0x590033[_0x3bf5d0(0x15b)]===_0x3bf5d0(0x162)&&_0x590033[_0x3bf5d0(0x15b)][_0x3bf5d0(0x136)]()[_0x3bf5d0(0x114)]?_0x590033[_0x3bf5d0(0x15b)][_0x3bf5d0(0x136)]():_0x14ccc2[_0x3bf5d0(0x136)]();if(!_0x18a216)return;const _0x4d4e35=_0x18a216[_0x3bf5d0(0x1a1)](/\s+/)[_0x3bf5d0(0x14d)](Boolean);if(!_0x4d4e35[_0x3bf5d0(0x114)])return;const _0x12f0a3=String(_0x4d4e35[-0x21ed+0x13*-0xec+0xd*0x3f5]||'')['toLowerCas'+'e'](),_0x28f0c6=_0x4d4e35[_0x3bf5d0(0x184)](-0xd*0xc5+0xdd+0x925);if(!commands['includes'](_0x12f0a3))return;const _0x55f58e=_0x4cfec7,_0x48c3a1=_0x53f620,_0x163b61=Boolean(_0x590033[_0x3bf5d0(0xf4)][_0x3bf5d0(0x1b8)]),_0x1b0cc1=_0x163b61?!![]:await isSudo(botRef,_0x590033),_0x498191=_0x48c3a1?await isadmin(botRef,_0x590033):![];if(!_0x48c3a1&&!_0x1b0cc1)return;if(_0x48c3a1&&!_0x498191)return;let _0x578073,_0x38083a=[];const _0xf14eb7=_0x28f0c6['some'](_0x3f6f4f=>String(_0x3f6f4f)[_0x3bf5d0(0x150)+'e']()===_0x3bf5d0(0x1b6));if(_0x48c3a1){_0x578073=_0x55f58e;const _0x4d89a0=String(_0x590033['key']['participan'+'t']||_0x590033[_0x3bf5d0(0xf4)][_0x3bf5d0(0x118)]||''),_0x5968ec=String(_0x4d89a0)[_0x3bf5d0(0x1a1)]('@')[-0xaa9+0xa40+0x69]||'',_0x375588=await getDefault(_0x5968ec)[_0x3bf5d0(0x103)](()=>null);if(!_0x375588||Array[_0x3bf5d0(0x1cd)](_0x375588)&&_0x375588['length']===0x43c*-0x2+-0x1edb+0x2753)return sendReply(_0x578073,'You\x20have\x20n'+_0x3bf5d0(0x1e6)+_0x3bf5d0(0x107)+'\x20set.');const _0x2f4686=Array[_0x3bf5d0(0x1cd)](_0x375588)?_0x375588:[_0x375588];for(const _0x20f7eb of _0x2f4686){try{const _0x27e0a3=await getConnection(_0x20f7eb)[_0x3bf5d0(0x103)](()=>null);if(Array['isArray'](_0x27e0a3))_0x38083a[_0x3bf5d0(0x1b9)](..._0x27e0a3);else{if(_0x27e0a3)_0x38083a[_0x3bf5d0(0x1b9)](String(_0x27e0a3));}}catch(_0x33dce7){warn('['+name+(']\x20resolvin'+_0x3bf5d0(0x16d)+_0x3bf5d0(0x12d))+_0x20f7eb+_0x3bf5d0(0x11b)+(_0x33dce7?.['message']||_0x33dce7));}}_0x38083a=Array[_0x3bf5d0(0x118)](new Set(_0x38083a));}else{_0x578073=_0x163b61?getBotJid()||String(_0x590033[_0x3bf5d0(0xf4)][_0x3bf5d0(0xf3)]||''):await findSudoerJid(_0x590033);if(!_0x578073)return;if(!_0xf14eb7){const _0x83b601=_0x28f0c6[_0x3bf5d0(0x172)](_0xb4e736=>{const _0xcfe642=_0x3bf5d0,_0x5e2b54=String(_0xb4e736||''),_0x12e55c=_0x5e2b54['toLowerCas'+'e']();return _0x12e55c!==_0xcfe642(0x1b6)&&!['on',_0xcfe642(0x104),'show'][_0xcfe642(0x1ac)](_0x12e55c)&&!_0x5e2b54[_0xcfe642(0x14b)]('@');});if(!_0x83b601)return sendReply(_0x578073,_0x3bf5d0(0x1be)+_0x12f0a3+(_0x3bf5d0(0x10f)+'[alias|jid'+_0x3bf5d0(0x1bf)+_0x3bf5d0(0x110))+_0x12f0a3+(_0x3bf5d0(0xed)+_0x3bf5d0(0x173)));const _0x58b415=await _0xd7acc8[_0x3bf5d0(0x1d2)+'e'](_0x83b601)[_0x3bf5d0(0x103)](()=>null),_0x130306=_0x58b415||(_0x83b601[_0x3bf5d0(0x1ac)](_0x3bf5d0(0x11c))?_0x83b601:null);if(!_0x130306)return sendReply(_0x578073,_0x3bf5d0(0x152)+_0x3bf5d0(0x14e)+_0x3bf5d0(0x1c6)+_0x83b601+'`');_0x38083a[_0x3bf5d0(0x1b9)](_0x130306);}}if(_0x12f0a3===_0x3bf5d0(0x15f)){const _0x685080=_0x28f0c6[_0x3bf5d0(0x172)](_0x5380d6=>['on',_0x3bf5d0(0x104),'show'][_0x3bf5d0(0x1ac)](String(_0x5380d6)[_0x3bf5d0(0x150)+'e']()));if(!_0x685080)return sendReply(_0x578073,_0x3bf5d0(0x1e3)+'tion.\x20Use\x20'+_0x3bf5d0(0x138)+_0x3bf5d0(0x1df)+_0x3bf5d0(0x130));const _0x14b266=String(_0x685080)[_0x3bf5d0(0x150)+'e']();if(_0xf14eb7){if(!_0x1b0cc1)return sendReply(_0x578073,_0x3bf5d0(0x1c8)+'tings\x20can\x20'+'only\x20be\x20ch'+_0x3bf5d0(0x11a)+_0x3bf5d0(0x158)+_0x3bf5d0(0x1c0));return await setGlobalEnabled(_0x14b266==='on'),sendReply(_0x578073,_0x3bf5d0(0x180)+'m\x20detectio'+_0x3bf5d0(0x125)+_0x14b266[_0x3bf5d0(0x13d)+'e']()+'.');}if(_0x38083a[_0x3bf5d0(0x114)]===-0x5*0x4b7+0x1eb0+0x71d*-0x1)return sendReply(_0x578073,_0x3bf5d0(0x1d0)+'arget\x20grou'+_0x3bf5d0(0x1b5)+'.');let _0x37e101='';for(const _0x312ac8 of _0x38083a){if(_0x14b266===_0x3bf5d0(0x169)){const _0xef10a6=await getChatEnabled(_0x312ac8),_0xb4c203=_0xef10a6===undefined?_0x3bf5d0(0x12e)+_0x3bf5d0(0x171)+(GLOBAL_ENABLED?'ON':_0x3bf5d0(0x113))+')':_0xef10a6?'ON':_0x3bf5d0(0x113);_0x37e101+=_0x3bf5d0(0x140)+_0x3bf5d0(0x143)+_0x312ac8+_0x3bf5d0(0x188)+_0xb4c203+'.\x0a';}else await setChatEnabled(_0x312ac8,_0x14b266==='on'),_0x37e101+=_0x3bf5d0(0x140)+_0x3bf5d0(0x143)+_0x312ac8+_0x3bf5d0(0x153)+_0x14b266[_0x3bf5d0(0x13d)+'e']()+'.\x0a';}return sendReply(_0x578073,_0x37e101[_0x3bf5d0(0x136)]());}if(_0x12f0a3==='resetspam'){const _0x1a958e=_0x590033[_0x3bf5d0(0x1c1)]?.['extendedTe'+'xtMessage']?.[_0x3bf5d0(0x127)+'o']?.[_0x3bf5d0(0xf7)+'id']||[];if(!_0x1a958e['length'])return sendReply(_0x578073,_0x3bf5d0(0x187)+_0x3bf5d0(0x177)+_0x3bf5d0(0x185)+_0x3bf5d0(0xfb)+'warnings.');if(_0xf14eb7)return sendReply(_0x578073,_0x3bf5d0(0xff)+'`\x20cannot\x20b'+_0x3bf5d0(0x19a)+'\x20action.');if(_0x38083a[_0x3bf5d0(0x114)]===-0x26*-0x5f+-0x14cb+0x6b1)return sendReply(_0x578073,_0x3bf5d0(0x1d0)+_0x3bf5d0(0x15d)+_0x3bf5d0(0x1b5)+'.');let _0x23f7af='';for(const _0x4a5e15 of _0x38083a){for(const _0x3d3e97 of _0x1a958e){await resetWarningDB(_0x4a5e15,_0x3d3e97)[_0x3bf5d0(0x103)](()=>{});}_0x23f7af+=_0x3bf5d0(0x17a)+'ngs\x20reset\x20'+_0x3bf5d0(0x10e)+_0x3bf5d0(0x170)+_0x3bf5d0(0x19b)+_0x4a5e15+'.\x0a';}return sendReply(_0x578073,_0x23f7af[_0x3bf5d0(0x136)]());}}catch(_0x460229){error(_0x460229,_0x3bf5d0(0x1cc)+name+'\x20error:\x20'+(_0x460229?.[_0x3bf5d0(0x1c1)]||_0x460229));}}export async function initialize(_0x44fa2c){const _0xf3c925=_0x4d7f62;try{if(!_0x44fa2c)throw new Error(_0xf3c925(0xf8)+_0xf3c925(0x147)+'ires\x20bot\x20i'+'nstance');botRef=_0x44fa2c,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),GLOBAL_ENABLED=await getGlobalEnabled(),startManagedListener({'botRef':botRef,'eventName':_0xf3c925(0x10d)+_0xf3c925(0xfe),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(_0xf3c925(0x176)+_0xf3c925(0x148)+_0xf3c925(0x19c)+'\x20')+(GLOBAL_ENABLED?'ON':'OFF')+'.');}catch(_0x1962b3){error(_0x1962b3,'['+name+(']\x20initiali'+_0xf3c925(0x1bc))+(_0x1962b3?.['message']||_0x1962b3));throw _0x1962b3;}}export async function cleanup(){const _0x2872ec=_0x4d7f62;try{stopManagedListener(name,_0x2872ec(0x10d)+_0x2872ec(0xfe));}catch(_0xddad8){warn('['+name+(_0x2872ec(0x13e)+_0x2872ec(0x151)+_0x2872ec(0x13f))+(_0xddad8?.[_0x2872ec(0x1c1)]||_0xddad8));}for(const _0x4a0a69 of processedMessageKeys[_0x2872ec(0x108)]())try{clearTimeout(_0x4a0a69);}catch(_0x122667){}processedMessageKeys['clear'](),chatUserMap['clear'](),botRef=null,sendApi=null,info('['+name+(_0x2872ec(0x100)+'up.'));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};