const _0x4038f1=_0x28b9;(function(_0x1e7495,_0x4844db){const _0x56cc51=_0x28b9,_0x2bdfa8=_0x1e7495();while(!![]){try{const _0x54c153=-parseInt(_0x56cc51(0x1e3))/(0x20f8+-0x1618+0xadf*-0x1)+-parseInt(_0x56cc51(0x1d2))/(-0x1bb3+-0x9*0x3e+0x1de3)*(parseInt(_0x56cc51(0x1f0))/(0x23ac*0x1+-0x1c9*-0x6+-0x2e5f))+-parseInt(_0x56cc51(0x23e))/(-0x3*-0x615+0x1*0x1da7+-0x2fe2)+parseInt(_0x56cc51(0x222))/(-0x179f+0x1df+0x1*0x15c5)+parseInt(_0x56cc51(0x21b))/(-0x122*-0x1+0x1c44+-0x1d60)+-parseInt(_0x56cc51(0x1f5))/(0x7c9*-0x3+0x51c*-0x5+0x30ee)+parseInt(_0x56cc51(0x1e4))/(-0x1c03+-0x3*-0xa91+-0x3a8);if(_0x54c153===_0x4844db)break;else _0x2bdfa8['push'](_0x2bdfa8['shift']());}catch(_0x520e27){_0x2bdfa8['push'](_0x2bdfa8['shift']());}}}(_0xf697,0x7e7bd+0x4f1f8+-0x3*0x11ae5));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name=_0x4038f1(0x277);export const version=_0x4038f1(0x1f7)+_0x4038f1(0x226);export const priority=-0x4eb*-0x1+0x7*0x4cd+-0x574*0x7;export const commands=[_0x4038f1(0x277),_0x4038f1(0x281)];export const configKeys=[_0x4038f1(0x212)];let botRef=null,sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(-0x2*-0xd1f+-0x2248+0xae*0xc)*(-0x4d*0x41+0x13a2+0x3d3),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(-0x2e*-0x4+0x23*0xe3+0x1fb7*-0x1)*(-0x9c2*-0x1+-0x18e2+0x1308),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(0x197c+-0x8*-0xe+-0x19e5)*(-0x1*-0x1267+-0x1*0x58+-0x11f7)*(-0x7f1+0x14c1+-0xc94)*(0x1de8*-0x1+0x1*-0x15a9+0x33cd)*(-0x33*-0x71+0x3b9*0x6+-0x28f1),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x4038f1(0x1de)+_0x4038f1(0x1cf)+_0x4038f1(0x1c8)+_0x4038f1(0x1bf)+_0x4038f1(0x26e)+_0x4038f1(0x224),'WARNING_TTL_MS':0xc350};function refreshConfig(){const _0x56ca21=_0x4038f1;try{const _0x376e49=getConfig?.()?.[_0x56ca21(0x212)]||{};Object['keys'](CFG)[_0x56ca21(0x247)](_0x1de8d3=>{if(_0x376e49[_0x1de8d3]!==undefined)CFG[_0x1de8d3]=_0x376e49[_0x1de8d3];}),CFG[_0x56ca21(0x211)+_0x56ca21(0x214)]=Math[_0x56ca21(0x280)](0xfcb+0x1*0x1e95+-0x1*0x2e5f,Number(CFG[_0x56ca21(0x211)+_0x56ca21(0x214)])||0xd5*-0x9+0x10*-0x1eb+0x2633),CFG[_0x56ca21(0x1c2)+_0x56ca21(0x1c1)]=Math['max'](0x904+-0x77a+-0x1*0x18a,Number(CFG['SPAM_WINDO'+_0x56ca21(0x1c1)])||(0x1711+-0x19a9+-0x2a2*-0x1)*(-0x2696+0xceb+0x1d93)),CFG['SPAM_COOLD'+_0x56ca21(0x1c9)]=Math['max'](-0x1d1c+-0x1686*0x1+0x33a2,Number(CFG[_0x56ca21(0x243)+'OWN_MS'])||0x5*-0x197+-0x102d+-0x1*-0x1c08),CFG[_0x56ca21(0x1aa)+'GS']=Math[_0x56ca21(0x280)](0x4c1*0x4+0xe*-0x2b4+0x12d5,Number(CFG['MAX_WARNIN'+'GS'])||0x41f*0x7+0x2087+0x1*-0x3d5d),CFG['WARN_EXPIR'+'Y_MS']=Math[_0x56ca21(0x280)](-0xa9b*-0x3+-0x1*-0x11eb+-0x31bc,Number(CFG['WARN_EXPIR'+_0x56ca21(0x1cc)])||(-0x3af*-0xa+-0xec*0x1b+-0x9*0x153)*(-0x208b+0x13*-0x35+0x2492*0x1)*(-0x1fc0*-0x1+0x1291+-0x3215)*(0x137*0x19+0x1b5e+-0x3981)*(0x2*-0x66e+-0x1a*-0x119+0xbc6*-0x1)),CFG[_0x56ca21(0x27e)+'L_MS']=Math[_0x56ca21(0x280)](0x17d2+0x12*0xd6+0x19*-0x18e,Number(CFG['WARNING_TT'+'L_MS'])||-0xc307*-0x1+0x755*-0x11+-0x2*-0x3e77),CFG[_0x56ca21(0x1dc)+'AM']=!!CFG['KICK_ON_SP'+'AM'];}catch(_0xb75549){warn('['+name+(_0x56ca21(0x1e6)+'onfig\x20erro'+_0x56ca21(0x1ca))+(_0xb75549?.[_0x56ca21(0x229)]||_0xb75549));}}const TABLE_SETTINGS=_0x4038f1(0x251)+_0x4038f1(0x25d);async function tableExists(_0x1f639e){const _0x1d51af=_0x4038f1;try{const _0x544200=await db['get'](_0x1d51af(0x25b)+_0x1d51af(0x1c6)+_0x1d51af(0x1bc)+_0x1d51af(0x26f)+'e=\x27table\x27\x20'+_0x1d51af(0x1fb),[_0x1f639e]);return!!_0x544200;}catch(_0x2ea3d1){return warn('['+name+(_0x1d51af(0x1fc)+'sts(')+_0x1f639e+_0x1d51af(0x220)+(_0x2ea3d1?.[_0x1d51af(0x229)]||_0x2ea3d1)),![];}}async function getTableColumns(_0x4963ea){const _0xede892=_0x4038f1;try{const _0x4e21ea=await db[_0xede892(0x20f)](_0xede892(0x245)+_0xede892(0x26c)+_0x4963ea+');'),_0x2eb4f3=Array[_0xede892(0x1b4)](_0x4e21ea)?_0x4e21ea:_0x4e21ea&&_0x4e21ea[_0xede892(0x270)]?_0x4e21ea[_0xede892(0x270)]:[];return _0x2eb4f3['map'](_0x1e11f3=>_0x1e11f3[_0xede892(0x1f6)]||_0x1e11f3[_0xede892(0x25e)+'e']||_0x1e11f3[_0xede892(0x20b)]);}catch(_0x20a510){try{const _0x432c7f=await db['get']('SELECT\x20*\x20F'+'ROM\x20'+_0x4963ea+'\x20LIMIT\x201');return _0x432c7f?Object[_0xede892(0x1d8)](_0x432c7f):[];}catch(_0x12538f){return[];}}}async function migrateSpamSettingsIfNeeded(){const _0x48455c=_0x4038f1,_0x2dff9d=await tableExists(TABLE_SETTINGS);if(!_0x2dff9d)try{await db[_0x48455c(0x20f)](_0x48455c(0x26b)+_0x48455c(0x1e9)+_0x48455c(0x215)+TABLE_SETTINGS+(_0x48455c(0x204)+_0x48455c(0x1ae)+_0x48455c(0x24a)+_0x48455c(0x24e)+_0x48455c(0x276))),info('['+name+(']\x20Created\x20'+_0x48455c(0x1b7))+TABLE_SETTINGS);return;}catch(_0x6f04f){warn('['+name+(_0x48455c(0x239)+_0x48455c(0x25c))+TABLE_SETTINGS+':\x20'+(_0x6f04f?.['message']||_0x6f04f));return;}try{const _0x27a9fd=await db['exec'](_0x48455c(0x245)+_0x48455c(0x26c)+TABLE_SETTINGS+');');let _0x45960=[];if(Array[_0x48455c(0x1b4)](_0x27a9fd))_0x45960=_0x27a9fd[_0x48455c(0x1be)](_0x4ff9d7=>_0x4ff9d7[_0x48455c(0x1f6)]||_0x4ff9d7[0x1c02+-0xf8a+-0xc77])[_0x48455c(0x27b)](Boolean);else{if(_0x27a9fd&&Array['isArray'](_0x27a9fd['rows']))_0x45960=_0x27a9fd[_0x48455c(0x270)]['map'](_0x295175=>_0x295175[_0x48455c(0x1f6)])['filter'](Boolean);else try{const _0x4c9d2c=await db[_0x48455c(0x237)]('SELECT\x20*\x20F'+_0x48455c(0x256)+TABLE_SETTINGS+_0x48455c(0x1b1));_0x45960=_0x4c9d2c?Object[_0x48455c(0x1d8)](_0x4c9d2c):[];}catch(_0x442846){_0x45960=[];}}const _0x346c55=_0x45960[_0x48455c(0x1be)](_0x1d76df=>String(_0x1d76df)[_0x48455c(0x1c5)+'e']()),_0x11ab80=_0x346c55[_0x48455c(0x1c4)]('chat_jid'),_0x520798=_0x346c55[_0x48455c(0x1c4)](_0x48455c(0x1c0)),_0x38aab9=_0x346c55[_0x48455c(0x1c4)](_0x48455c(0x21a));if(_0x11ab80&&_0x520798)return;if(!_0x11ab80&&_0x38aab9)try{await db[_0x48455c(0x20f)](_0x48455c(0x22f)+_0x48455c(0x279)),await db[_0x48455c(0x20f)](_0x48455c(0x26b)+_0x48455c(0x1e9)+'EXISTS\x20'+TABLE_SETTINGS+(_0x48455c(0x27d)+_0x48455c(0x27c)+_0x48455c(0x1d3)+_0x48455c(0x231)+_0x48455c(0x209)));const _0x538130=_0x520798;_0x538130?await db[_0x48455c(0x20f)]('INSERT\x20OR\x20'+_0x48455c(0x22c)+'TO\x20'+TABLE_SETTINGS+(_0x48455c(0x27d)+'_jid,\x20enab'+'led)\x20SELEC'+_0x48455c(0x1c7)+_0x48455c(0x284)+_0x48455c(0x256))+TABLE_SETTINGS+';'):await db[_0x48455c(0x20f)]('INSERT\x20OR\x20'+_0x48455c(0x22c)+'TO\x20'+TABLE_SETTINGS+(_0x48455c(0x27d)+_0x48455c(0x1b8)+_0x48455c(0x241)+_0x48455c(0x1c7)+_0x48455c(0x1af))+TABLE_SETTINGS+';');await db['exec']('DROP\x20TABLE'+'\x20'+TABLE_SETTINGS+';'),await db[_0x48455c(0x20f)]('ALTER\x20TABL'+'E\x20'+TABLE_SETTINGS+(_0x48455c(0x286)+_0x48455c(0x250))+TABLE_SETTINGS+';'),await db['exec']('COMMIT;'),info('['+name+(_0x48455c(0x23a)+'\x20')+TABLE_SETTINGS+(_0x48455c(0x1bb)+_0x48455c(0x263)+'d)'));return;}catch(_0x10f367){try{await db[_0x48455c(0x20f)](_0x48455c(0x1ce));}catch(_0x2b47ac){}warn('['+name+(_0x48455c(0x1ac)+'n\x20of\x20')+TABLE_SETTINGS+_0x48455c(0x233)+(_0x10f367?.[_0x48455c(0x229)]||_0x10f367));return;}if(!_0x11ab80||!_0x520798)try{await db['exec'](_0x48455c(0x26b)+'LE\x20IF\x20NOT\x20'+_0x48455c(0x215)+TABLE_SETTINGS+(_0x48455c(0x204)+'\x20TEXT\x20PRIM'+_0x48455c(0x24a)+_0x48455c(0x24e)+_0x48455c(0x276))),info('['+name+']\x20Ensured\x20'+TABLE_SETTINGS+(_0x48455c(0x1e7)+_0x48455c(0x1f1)+_0x48455c(0x244)));}catch(_0x460df4){warn('['+name+(_0x48455c(0x21e)+'\x20')+TABLE_SETTINGS+(_0x48455c(0x20d)+_0x48455c(0x225))+(_0x460df4?.['message']||_0x460df4));}}catch(_0x584930){warn('['+name+(_0x48455c(0x1d1)+_0x48455c(0x1ad)+_0x48455c(0x228)+_0x48455c(0x26d))+(_0x584930?.['message']||_0x584930));}}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x26bc0a=_0x4038f1;if(!botRef)return;if(typeof botRef['sendMessag'+'e']==='function')sendApi=async(_0x314bd2,_0x191bb7)=>await botRef[_0x26bc0a(0x1b2)+'e'](_0x314bd2,_0x191bb7);else{if(botRef[_0x26bc0a(0x246)]&&typeof botRef['sock'][_0x26bc0a(0x1b2)+'e']===_0x26bc0a(0x227))sendApi=async(_0x3ef1eb,_0x29e1a5)=>await botRef['sock'][_0x26bc0a(0x1b2)+'e'](_0x3ef1eb,_0x29e1a5);else sendApi=null;}}async function sendText(_0x18f063,_0x4ce6f4,_0x4f4a06=[]){const _0x2f8edb=_0x4038f1;if(!_0x4ce6f4||!_0x18f063)return null;if(!sendApi)return warn('['+name+(_0x2f8edb(0x1df)+_0x2f8edb(0x1ba)+'not\x20availa'+_0x2f8edb(0x1b6))),null;try{const _0x54340d=typeof _0x4ce6f4===_0x2f8edb(0x1a9)?{'text':_0x4ce6f4}:_0x4ce6f4;if(Array[_0x2f8edb(0x1b4)](_0x4f4a06)&&_0x4f4a06[_0x2f8edb(0x1e8)])_0x54340d[_0x2f8edb(0x21c)]=_0x4f4a06;return await sendApi(_0x18f063,_0x54340d);}catch(_0x1aa4f3){return warn('['+name+(_0x2f8edb(0x1df)+_0x2f8edb(0x1ab)+'\x20')+_0x18f063+':\x20'+(_0x1aa4f3?.[_0x2f8edb(0x229)]||_0x1aa4f3)),null;}}async function kickUser(_0x384a7b,_0x1f63cd){const _0x6bfed7=_0x4038f1;try{const _0x279eab=botRef[_0x6bfed7(0x246)]?.[_0x6bfed7(0x1ef)+_0x6bfed7(0x285)+'ate']||botRef[_0x6bfed7(0x1ef)+'cipantsUpd'+_0x6bfed7(0x23c)];if(_0x279eab)return await _0x279eab(_0x384a7b,[_0x1f63cd],_0x6bfed7(0x26a)),info('['+name+_0x6bfed7(0x254)+_0x1f63cd+_0x6bfed7(0x24c)+_0x384a7b),!![];return![];}catch(_0x3bc306){return warn('['+name+(_0x6bfed7(0x1d6)+_0x6bfed7(0x233))+(_0x3bc306?.[_0x6bfed7(0x229)]||_0x3bc306)),![];}}async function getChatEnabled(_0x41e753){const _0x5b70fe=_0x4038f1;try{const _0x401078=await db['get'](_0x5b70fe(0x1f3)+_0x5b70fe(0x1e2)+TABLE_SETTINGS+(_0x5b70fe(0x1db)+_0x5b70fe(0x283)),[_0x41e753]);return _0x401078?Number(_0x401078['enabled'])===0x1c2a+-0x149c+-0x78d:![];}catch(_0x41fbca){return warn('['+name+(']\x20getChatE'+_0x5b70fe(0x1d7)+_0x5b70fe(0x282))+_0x41e753+':\x20'+(_0x41fbca?.[_0x5b70fe(0x229)]||_0x41fbca)),![];}}function _0x28b9(_0x3cd2f2,_0x7208a8){const _0x442964=_0xf697();return _0x28b9=function(_0x137bd1,_0x43cc01){_0x137bd1=_0x137bd1-(0x1a9e+-0x163c+-0x2ba);let _0x35b136=_0x442964[_0x137bd1];return _0x35b136;},_0x28b9(_0x3cd2f2,_0x7208a8);}async function setChatEnabled(_0x25d42f,_0xf23a1e){const _0x53f5f6=_0x4038f1;try{return await db[_0x53f5f6(0x257)](_0x53f5f6(0x27f)+'O\x20'+TABLE_SETTINGS+(_0x53f5f6(0x204)+',\x20enabled)'+_0x53f5f6(0x1ea)+',\x20?)\x20\x0a\x20\x20\x20\x20'+_0x53f5f6(0x265)+_0x53f5f6(0x253)+_0x53f5f6(0x235)+_0x53f5f6(0x1ec)+'abled\x20=\x20ex'+'cluded.ena'+'bled;'),[_0x25d42f,_0xf23a1e?-0x1de6+0x11*0xe3+-0x92*-0x1a:-0x1*-0x45b+0x1214+-0x166f]),!![];}catch(_0x509a6c){return warn('['+name+(_0x53f5f6(0x25a)+_0x53f5f6(0x1d7)+_0x53f5f6(0x282))+_0x25d42f+':\x20'+(_0x509a6c?.['message']||_0x509a6c)),![];}}function ensureChatMap(_0xacc523){const _0x1d4f53=_0x4038f1;if(!chatUserMap[_0x1d4f53(0x278)](_0xacc523))chatUserMap[_0x1d4f53(0x260)](_0xacc523,new Map());return chatUserMap['get'](_0xacc523);}function clearChatMemory(_0x3bb308){const _0x386a0e=_0x4038f1;if(chatUserMap[_0x386a0e(0x278)](_0x3bb308))chatUserMap[_0x386a0e(0x1fe)](_0x3bb308);}async function handleMessageForSpam(_0x3c2a02){const _0x355e06=_0x4038f1;try{const _0x193f76=String(_0x3c2a02['key']?.['remoteJid']||'');if(!_0x193f76||!_0x193f76[_0x355e06(0x1ff)](_0x355e06(0x1cb)))return;if(_0x3c2a02[_0x355e06(0x213)]?.[_0x355e06(0x1b9)])return;const _0x42f599=await getChatEnabled(_0x193f76);if(!_0x42f599)return;const _0xc4b5f=String(_0x3c2a02[_0x355e06(0x213)]?.[_0x355e06(0x1d4)+'t']||_0x3c2a02[_0x355e06(0x213)]?.[_0x355e06(0x21d)]||'');if(!_0xc4b5f)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x193f76,'participant':_0xc4b5f},'message':_0x3c2a02[_0x355e06(0x229)]}))return;}catch(_0x562bd3){}const _0x1247b8=Date[_0x355e06(0x216)](),_0x1be0f0=ensureChatMap(_0x193f76);!_0x1be0f0[_0x355e06(0x278)](_0xc4b5f)&&_0x1be0f0[_0x355e06(0x260)](_0xc4b5f,{'timestamps':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x1ad23d=_0x1be0f0[_0x355e06(0x237)](_0xc4b5f);_0x1ad23d[_0x355e06(0x1b0)]=(_0x1ad23d[_0x355e06(0x1b0)]||[])[_0x355e06(0x27b)](_0x1cdac6=>_0x1247b8-_0x1cdac6<=CFG['SPAM_WINDO'+_0x355e06(0x1c1)]),_0x1ad23d[_0x355e06(0x1b0)][_0x355e06(0x218)](_0x1247b8);if(_0x1ad23d[_0x355e06(0x258)]&&_0x1247b8-_0x1ad23d[_0x355e06(0x258)]<CFG['SPAM_COOLD'+_0x355e06(0x1c9)])return;if((_0x1ad23d['timestamps']||[])[_0x355e06(0x1e8)]>=CFG[_0x355e06(0x211)+_0x355e06(0x214)]){_0x1ad23d['lastWarnAt']=_0x1247b8;(!_0x1ad23d[_0x355e06(0x262)+_0x355e06(0x272)]||_0x1ad23d[_0x355e06(0x262)+'sAt']<=_0x1247b8)&&(_0x1ad23d[_0x355e06(0x1f9)]=-0x836*0x1+-0x31c*-0x1+0x2*0x28d);_0x1ad23d[_0x355e06(0x1f9)]=(_0x1ad23d[_0x355e06(0x1f9)]||-0x7*0x1e7+-0x2046+0x2d97)+(-0xa51+-0x18*0x1b+-0x1d6*-0x7),_0x1ad23d[_0x355e06(0x262)+_0x355e06(0x272)]=_0x1247b8+CFG[_0x355e06(0x261)+'Y_MS'];const _0x2ce81b=Math['max'](-0x3d4+-0x2*-0x1216+0x45*-0x78,CFG[_0x355e06(0x1aa)+'GS']-_0x1ad23d[_0x355e06(0x1f9)]),_0x2406e5='@'+_0xc4b5f[_0x355e06(0x23d)]('@')[-0x6f5+0x14e*0xa+0x1*-0x617],_0x14ea33=String(CFG[_0x355e06(0x22d)+'SSAGE']||'')[_0x355e06(0x22e)](_0x355e06(0x1f2),_0x2406e5)[_0x355e06(0x22e)](_0x355e06(0x1eb),String(_0x2ce81b)),_0x57b693=await sendText(_0x193f76,{'text':_0x14ea33,'mentions':[_0xc4b5f]});_0x57b693?.[_0x355e06(0x213)]&&CFG[_0x355e06(0x27e)+_0x355e06(0x27a)]>0x6aa+0x1f77+0x2621*-0x1&&setTimeout(async()=>{const _0x51d604=_0x355e06;try{await sendText(_0x193f76,{'delete':_0x57b693[_0x51d604(0x213)]});}catch(_0x40be3c){}},CFG[_0x355e06(0x27e)+_0x355e06(0x27a)]);if(CFG[_0x355e06(0x1dc)+'AM']&&_0x1ad23d['warnCount']>=CFG['MAX_WARNIN'+'GS']){const _0x221670=await kickUser(_0x193f76,_0xc4b5f);_0x221670?(_0x1be0f0[_0x355e06(0x1fe)](_0xc4b5f),await sendText(_0x193f76,{'text':_0x2406e5+('\x20removed\x20f'+'or\x20repeate'+_0x355e06(0x25f)),'mentions':[_0xc4b5f]})[_0x355e06(0x232)](()=>{})):warn('['+name+(_0x355e06(0x1ee)+_0x355e06(0x23b))+_0xc4b5f+'\x20from\x20'+_0x193f76);}}}catch(_0x27c375){warn('['+name+(_0x355e06(0x1f8)+'ssageForSp'+_0x355e06(0x230))+(_0x27c375?.['message']||_0x27c375));}}async function rawMessagesUpsertHandler({messages:_0x2f356a}){const _0x56ce7c=_0x4038f1;if(!Array[_0x56ce7c(0x1b4)](_0x2f356a))return;for(const _0x437a66 of _0x2f356a){try{const _0x2327d7=String(_0x437a66['key']?.[_0x56ce7c(0x202)]||'');if(!_0x2327d7||!_0x2327d7[_0x56ce7c(0x1ff)](_0x56ce7c(0x1cb)))continue;if(!_0x437a66[_0x56ce7c(0x229)])continue;if(_0x437a66[_0x56ce7c(0x213)]?.[_0x56ce7c(0x1b9)])continue;const _0x3a5a76=_0x2327d7+'::'+String(_0x437a66['key']?.['id']||'')+'::'+String(_0x437a66['key']?.[_0x56ce7c(0x1d4)+'t']||'');if(processedMessageKeys[_0x56ce7c(0x278)](_0x3a5a76))continue;const _0x5b2e7f=setTimeout(()=>processedMessageKeys[_0x56ce7c(0x1fe)](_0x3a5a76),DEDUPE_TTL_MS);processedMessageKeys['set'](_0x3a5a76,_0x5b2e7f),await handleMessageForSpam(_0x437a66);}catch(_0x12fa16){warn('['+name+(_0x56ce7c(0x1bd)+'gesUpsertH'+_0x56ce7c(0x269)+_0x56ce7c(0x206))+(_0x12fa16?.[_0x56ce7c(0x229)]||_0x12fa16));}}}export async function onMessage(_0x21beb9){const _0x3fffe7=_0x4038f1;try{if(!_0x21beb9||!_0x21beb9[_0x3fffe7(0x213)]||!_0x21beb9[_0x3fffe7(0x229)]||!_0x21beb9[_0x3fffe7(0x207)])return;const _0x577fcc=String(_0x21beb9[_0x3fffe7(0x213)][_0x3fffe7(0x202)]||'');if(!_0x577fcc[_0x3fffe7(0x1ff)](_0x3fffe7(0x1cb)))return;if(!await isadmin(botRef,_0x21beb9))return;const _0x312c48=typeof _0x21beb9['text']==='string'&&_0x21beb9[_0x3fffe7(0x21f)][_0x3fffe7(0x1cd)]()[_0x3fffe7(0x1e8)]?_0x21beb9[_0x3fffe7(0x21f)][_0x3fffe7(0x1cd)]():'';if(!_0x312c48)return;const _0x21fef0=_0x312c48['split'](/\s+/)[_0x3fffe7(0x27b)](Boolean);if(!_0x21fef0['length'])return;const _0x1b38e3=String(_0x21fef0[0x3*0x3c4+0x517+-0x1063]||'')[_0x3fffe7(0x1c5)+'e'](),_0x5edffb=_0x21fef0[_0x3fffe7(0x240)](-0x10*0xf2+-0x7e*-0xc+0x3*0x313);if(!commands[_0x3fffe7(0x1c4)](_0x1b38e3))return;if(_0x1b38e3===_0x3fffe7(0x277)){const _0x4d023c=(_0x5edffb[_0x3fffe7(0x271)](_0x44098b=>['on',_0x3fffe7(0x1f4),_0x3fffe7(0x1ed)][_0x3fffe7(0x1c4)](String(_0x44098b)[_0x3fffe7(0x1c5)+'e']()))||_0x3fffe7(0x1ed))[_0x3fffe7(0x1c5)+'e']();if(_0x4d023c==='on'){const _0x50f9fe=await setChatEnabled(_0x577fcc,!![]);return _0x50f9fe?(clearChatMemory(_0x577fcc),sendText(_0x577fcc,_0x3fffe7(0x274)+'m\x20ENABLED\x20'+_0x3fffe7(0x236)+_0x3fffe7(0x1d0))):sendText(_0x577fcc,_0x3fffe7(0x1e1)+_0x3fffe7(0x219)+_0x3fffe7(0x24f)+_0x3fffe7(0x1a8));}else{if(_0x4d023c==='off'){const _0x26962c=await setChatEnabled(_0x577fcc,![]);return _0x26962c?(clearChatMemory(_0x577fcc),sendText(_0x577fcc,'✔️\x20Anti-spa'+_0x3fffe7(0x1dd)+_0x3fffe7(0x248)+'group.')):sendText(_0x577fcc,_0x3fffe7(0x1e1)+_0x3fffe7(0x1b3)+_0x3fffe7(0x266)+_0x3fffe7(0x203)+'.');}else{const _0x17fe27=await getChatEnabled(_0x577fcc),_0x3f66dd={'SPAM_THRESHOLD':CFG[_0x3fffe7(0x211)+_0x3fffe7(0x214)],'SPAM_WINDOW_MS':CFG[_0x3fffe7(0x1c2)+'W_MS'],'SPAM_COOLDOWN_MS':CFG[_0x3fffe7(0x243)+_0x3fffe7(0x1c9)],'MAX_WARNINGS':CFG['MAX_WARNIN'+'GS'],'KICK_ON_SPAM':CFG['KICK_ON_SP'+'AM']};return sendText(_0x577fcc,_0x3fffe7(0x274)+_0x3fffe7(0x249)+_0x3fffe7(0x255)+(_0x17fe27?_0x3fffe7(0x22a):'DISABLED')+'\x0aConfig:\x20'+JSON['stringify'](_0x3f66dd));}}}if(_0x1b38e3===_0x3fffe7(0x281)){const _0x435afe=_0x21beb9[_0x3fffe7(0x229)]?.[_0x3fffe7(0x264)+_0x3fffe7(0x1d9)]?.[_0x3fffe7(0x217)+'o']?.[_0x3fffe7(0x242)+'id']||[];if(!_0x435afe||_0x435afe[_0x3fffe7(0x1e8)]===0x8f3*-0x1+0xc8b+-0x2*0x1cc)return sendText(_0x577fcc,'✔️\x20Please\x20@'+'mention\x20on'+_0x3fffe7(0x20e)+_0x3fffe7(0x1c3)+_0x3fffe7(0x1da)+_0x3fffe7(0x201)+_0x3fffe7(0x221));const _0x2d3ac4=chatUserMap['get'](_0x577fcc);for(const _0x2fb2c3 of _0x435afe){if(_0x2d3ac4&&_0x2d3ac4[_0x3fffe7(0x278)](_0x2fb2c3))_0x2d3ac4[_0x3fffe7(0x1fe)](_0x2fb2c3);}return sendText(_0x577fcc,_0x3fffe7(0x274)+_0x3fffe7(0x24d)+_0x3fffe7(0x238)+_0x3fffe7(0x22b)+_0x3fffe7(0x273));}}catch(_0x5301f8){error(_0x5301f8,'['+name+(_0x3fffe7(0x275)+_0x3fffe7(0x210))+(_0x5301f8?.['message']||_0x5301f8));}}export async function initialize(_0x821c8e){const _0x68ddfd=_0x4038f1;try{if(!_0x821c8e)throw new Error('antispam.i'+'nitialize\x20'+_0x68ddfd(0x1fa)+_0x68ddfd(0x20c)+'e');botRef=_0x821c8e,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),startManagedListener({'botRef':botRef,'eventName':_0x68ddfd(0x24b)+_0x68ddfd(0x259),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(_0x68ddfd(0x208)+_0x68ddfd(0x23f)+_0x68ddfd(0x1e5)+_0x68ddfd(0x268)+_0x68ddfd(0x252)+'y\x20')+TABLE_SETTINGS+(_0x68ddfd(0x223)+'d=')+CFG['SPAM_THRES'+'HOLD']+_0x68ddfd(0x200)+CFG[_0x68ddfd(0x1c2)+_0x68ddfd(0x1c1)]+('ms,\x20maxWar'+_0x68ddfd(0x20a))+CFG[_0x68ddfd(0x1aa)+'GS']);}catch(_0x6f8bed){error(_0x6f8bed,'['+name+(_0x68ddfd(0x208)+_0x68ddfd(0x1b5))+(_0x6f8bed?.['message']||_0x6f8bed));throw _0x6f8bed;}}function _0xf697(){const _0xeb3843=['keys','xtMessage','eset\x20their','\x20WHERE\x20cha','KICK_ON_SP','m\x20DISABLED','⚠️\x20{user},\x20',']\x20sendText','values','⚠️\x20Failed\x20t','bled\x20FROM\x20','886036rqnfkD','15428064BUYbVK','mory\x20enfor',']\x20refreshC','\x20exists\x20wi','length','LE\x20IF\x20NOT\x20','\x20VALUES\x20(?','{warnings}','ATE\x20SET\x20en','show',']\x20failed\x20t','groupParti','1133283zcbfMz','th\x20expecte','{user}','SELECT\x20ena','off','3109932kTgCGu','name','2.0.0-inme',']\x20handleMe','warnCount','requires\x20b','AND\x20name=?',']\x20tableExi',']\x20stopMana','delete','endsWith','\x20within\x20','\x20anti-spam','remoteJid','(DB\x20error)','\x20(chat_jid','r\x20failed:\x20','er\x20error:\x20','isCommand',']\x20initiali','\x20INTEGER);','ns=','cid','ot\x20instanc','\x20columns\x20f','e\x20or\x20more\x20','exec','e\x20error:\x20','SPAM_THRES','SPAM','key','HOLD','EXISTS\x20','now','contextInf','push','o\x20enable\x20a','chat_id','967254MsBGop','mentions','from',']\x20Ensuring','text',')\x20error:\x20','\x20warnings.','5566610dXHKAp','.\x20Threshol','ings}','ailed:\x20','mory','function','sIfNeeded\x20','message','ENABLED','\x20mentioned','REPLACE\x20IN','WARNING_ME','replace','BEGIN\x20TRAN','am\x20error:\x20','Y,\x20enabled','catch','\x20failed:\x20','up.','id)\x20DO\x20UPD','for\x20this\x20g','get','\x20reset\x20for',']\x20Failed\x20t',']\x20Migrated','o\x20kick\x20','ate','split','458168eEjQaq','zed.\x20In-me','slice','led)\x20SELEC','mentionedJ','SPAM_COOLD','d\x20columns.','PRAGMA\x20tab','sock','forEach','\x20for\x20this\x20','m\x20for\x20this','ARY\x20KEY,\x20e','messages.u','\x20from\x20','m\x20warnings','nabled\x20INT','nti-spam\x20(','E\x20TO\x20','spam_setti','\x20holds\x20onl','ICT(chat_j',']\x20kicked\x20','\x20group:\x20','ROM\x20','run','lastWarnAt','psert',']\x20setChatE','SELECT\x20nam','o\x20create\x20','ngs','column_nam','d\x20spam.','set','WARN_EXPIR','warnExpire','->\x20chat_ji','extendedTe','\x20\x20ON\x20CONFL','anti-spam\x20',']\x20cleaned\x20','cement.\x20DB','andler\x20inn','remove','CREATE\x20TAB','le_info(','error:\x20','ngs:\x20{warn','\x20WHERE\x20typ','rows','find','sAt','\x20user(s).','✔️\x20Anti-spa',']\x20onMessag','EGER);','antispam','has','SACTION;','L_MS','filter','_jid\x20TEXT\x20','_new\x20(chat','WARNING_TT','INSERT\x20INT','max','resetspam','error\x20for\x20','t_jid\x20=\x20?','\x20enabled\x20F','cipantsUpd','_new\x20RENAM','DB\x20error).','string','MAX_WARNIN','\x20failed\x20to',']\x20Migratio','pamSetting','\x20TEXT\x20PRIM','\x200\x20FROM\x20','timestamps','\x20LIMIT\x201','sendMessag','o\x20disable\x20','isArray','ze\x20fatal:\x20','ble','table\x20','_jid,\x20enab','fromMe',':\x20sendApi\x20','\x20(chat_id\x20','ite_master',']\x20rawMessa','map','ning\x20warni','enabled','W_MS','SPAM_WINDO','users\x20to\x20r','includes','toLowerCas','e\x20FROM\x20sql','T\x20chat_id,','ing.\x20Remai','OWN_MS','r:\x20','@g.us','Y_MS','trim','ROLLBACK;','stop\x20spamm','roup.',']\x20migrateS','6cpeHCi','PRIMARY\x20KE','participan','clear',']\x20kickUser','nabled\x20DB\x20'];_0xf697=function(){return _0xeb3843;};return _0xf697();}export async function cleanup(){const _0x455a95=_0x4038f1;try{stopManagedListener(name,_0x455a95(0x24b)+_0x455a95(0x259));}catch(_0x4a3525){warn('['+name+(_0x455a95(0x1fd)+'gedListene'+_0x455a95(0x205))+(_0x4a3525?.[_0x455a95(0x229)]||_0x4a3525));}for(const _0x6b8c86 of processedMessageKeys[_0x455a95(0x1e0)]())try{clearTimeout(_0x6b8c86);}catch(_0x4c6b5c){}processedMessageKeys[_0x455a95(0x1d5)](),chatUserMap[_0x455a95(0x1d5)](),botRef=null,sendApi=null,info('['+name+(_0x455a95(0x267)+_0x455a95(0x234)));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};