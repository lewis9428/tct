const _0xd6c8a=_0x44cd;(function(_0xa615d7,_0x1df402){const _0x4f4270=_0x44cd,_0x10d7a8=_0xa615d7();while(!![]){try{const _0x6ec926=-parseInt(_0x4f4270(0x25d))/(-0x9c*0x26+0x1*0xfb+0x2*0xb17)+-parseInt(_0x4f4270(0x2a7))/(-0x16*0xa7+0x425+-0x20b*-0x5)*(-parseInt(_0x4f4270(0x20a))/(-0x1d96+-0x15e0+0x3379))+parseInt(_0x4f4270(0x252))/(0x67c+-0x162e+0xfb6)*(-parseInt(_0x4f4270(0x260))/(0x13f*-0x9+0x3*0x5aa+-0x2e1*0x2))+parseInt(_0x4f4270(0x229))/(0xc87*0x1+-0x1*0xce0+0x5f)*(parseInt(_0x4f4270(0x22f))/(-0x1ecf+-0x26a+0x40*0x85))+parseInt(_0x4f4270(0x263))/(0x1*0x10fb+-0x1583*0x1+-0x2*-0x248)+parseInt(_0x4f4270(0x27b))/(0x3*-0x1db+0xd77+0xb*-0xb7)+-parseInt(_0x4f4270(0x27e))/(0x1*0x24e5+0x245c+-0x4937*0x1);if(_0x6ec926===_0x1df402)break;else _0x10d7a8['push'](_0x10d7a8['shift']());}catch(_0x54e678){_0x10d7a8['push'](_0x10d7a8['shift']());}}}(_0x3c94,-0x2305b+0x538a3*-0x1+0xc1773));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{getBotJid}from'../utils/bot-state.js';import{userjid}from'../utils/sudo.js';import{getSenderForMsg}from'./sudonumber.js';export const name='edit-logge'+'r';export const version=_0xd6c8a(0x290);export const priority=-0x5*-0x6a+0xd01+-0xee1;let botInstance=null,cleanupInterval=null;const FALLBACKS={'EDIT_WINDOW_MINUTES':0xf,'CLEANUP_INTERVAL_MS':(0x996*0x1+0x1845+-0x219f)*(0xf58+0x17ed+-0x235d),'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4};let EDIT_WINDOW_MINUTES=FALLBACKS[_0xd6c8a(0x21a)+'W_MINUTES'],CLEANUP_INTERVAL_MS=FALLBACKS['CLEANUP_IN'+_0xd6c8a(0x241)],MAX_SEND_RETRIES=FALLBACKS['MAX_SEND_R'+_0xd6c8a(0x212)],INITIAL_BACKOFF_MS=FALLBACKS['INITIAL_BA'+_0xd6c8a(0x272)];async function ensureTable(){const _0x4014e1=_0xd6c8a;await db['exec'](_0x4014e1(0x214)+_0x4014e1(0x2a3)+_0x4014e1(0x21b)+'ts\x20(\x0a\x20\x20\x20\x20i'+_0x4014e1(0x210)+_0x4014e1(0x287)+_0x4014e1(0x23c)+_0x4014e1(0x253)+_0x4014e1(0x21e)+_0x4014e1(0x1f4)+'at_jid\x20TEX'+_0x4014e1(0x275)+_0x4014e1(0x224)+_0x4014e1(0x2a9)+_0x4014e1(0x283)+_0x4014e1(0x279)+_0x4014e1(0x247)+_0x4014e1(0x222)+'AULT\x200,\x0a\x20\x20'+'\x20\x20saved_at'+_0x4014e1(0x208)+_0x4014e1(0x251));}function nowSeconds(){const _0x5f3870=_0xd6c8a;return Math[_0x5f3870(0x20f)](Date[_0x5f3870(0x23d)]()/(-0x1c1a+0xb2c+0x14d6));}async function insertEditVersion(_0x258646,_0x17dd7e,_0xea01ba,_0x161f41,_0x208870=0x23*0x8b+0xe8+0xc4*-0x1a){const _0x3a7ee1=_0xd6c8a,_0x49dbf8=nowSeconds();await db[_0x3a7ee1(0x27f)](_0x3a7ee1(0x295)+_0x3a7ee1(0x26e)+'sg_id,\x20cha'+_0x3a7ee1(0x226)+'t,\x20raw_jso'+_0x3a7ee1(0x233)+_0x3a7ee1(0x1fd)+_0x3a7ee1(0x299)+_0x3a7ee1(0x264)+'UES\x20(?,\x20?,'+_0x3a7ee1(0x2ac)+'?)',[_0x258646||null,_0x17dd7e||null,_0xea01ba||'',_0x161f41||null,_0x208870?0x1b7+-0x9fc+0x846:0x26*-0x49+-0x3fd*-0x1+0x6d9,_0x49dbf8]);}async function fetchLatestEditForMsg(_0x3493e5){const _0x530bc2=_0xd6c8a;if(!_0x3493e5)return null;const _0x587942=await db['get'](_0x530bc2(0x293)+_0x530bc2(0x254)+_0x530bc2(0x228)+_0x530bc2(0x213)+_0x530bc2(0x240)+_0x530bc2(0x22b)+_0x530bc2(0x234)+_0x530bc2(0x21f)+_0x530bc2(0x257)+_0x530bc2(0x29a)+_0x530bc2(0x27d)+_0x530bc2(0x215)+'ESC\x20LIMIT\x20'+'1',[_0x3493e5]);return _0x587942||null;}async function countEditsForMsg(_0x837e9){const _0x291834=_0xd6c8a;if(!_0x837e9)return 0x1f76+-0x1cce*0x1+-0x2a8;const _0x45df0a=await db[_0x291834(0x26d)](_0x291834(0x204)+_0x291834(0x2aa)+_0x291834(0x244)+_0x291834(0x270)+_0x291834(0x2a8)+_0x291834(0x22e)+_0x291834(0x1fd)+_0x291834(0x1ee),[_0x837e9]);return _0x45df0a&&typeof _0x45df0a['c']===_0x291834(0x2a1)?_0x45df0a['c']:0xa37*0x2+-0x1*0x19b7+0x1c3*0x3;}async function cleanupOldEdits(){const _0x28c71d=_0xd6c8a,_0x2491b9=nowSeconds()-Number(EDIT_WINDOW_MINUTES||FALLBACKS[_0x28c71d(0x21a)+'W_MINUTES'])*(0x1*-0x20b0+-0x3e5+0x24d1),_0x443c4d=await db[_0x28c71d(0x1ea)](_0x28c71d(0x250)+_0x28c71d(0x236)+'\x20WHERE\x20sav'+_0x28c71d(0x26b)+_0x28c71d(0x21d)+_0x28c71d(0x21c)+_0x28c71d(0x1f3),[_0x2491b9]);if(!_0x443c4d||_0x443c4d[_0x28c71d(0x1ed)]===0x7*-0x354+-0x1*-0xe20+0x4*0x24b)return;const _0x145d01=_0x443c4d[_0x28c71d(0x271)](_0xa7dfdf=>_0xa7dfdf['id']),_0x5ef389=0x1de6+0x1034+-0x2d52;for(let _0x563c89=0x3ad+0x1dd5+-0x2182;_0x563c89<_0x145d01[_0x28c71d(0x1ed)];_0x563c89+=_0x5ef389){const _0x55cfd9=_0x145d01[_0x28c71d(0x256)](_0x563c89,_0x563c89+_0x5ef389),_0x5246cb=_0x55cfd9[_0x28c71d(0x271)](()=>'?')[_0x28c71d(0x1e9)](',');await db[_0x28c71d(0x27f)]('DELETE\x20FRO'+_0x28c71d(0x28b)+'ERE\x20id\x20IN\x20'+'('+_0x5246cb+')',_0x55cfd9);}info(_0x28c71d(0x292)+_0x28c71d(0x201)+'\x20'+_0x443c4d[_0x28c71d(0x1ed)]+(_0x28c71d(0x235)+'rows'));}async function cleanupOldEditsSafe(){const _0x2d543d=_0xd6c8a;try{await cleanupOldEdits();}catch(_0x4e54a4){warn(_0x2d543d(0x292)+_0x2d543d(0x20b)+_0x2d543d(0x29c)+'fe\x20error:\x20'+(_0x4e54a4?.['message']||_0x4e54a4));}}function _0x44cd(_0x2d6640,_0x15771a){const _0x3143bd=_0x3c94();return _0x44cd=function(_0x32374a,_0x3f8fd3){_0x32374a=_0x32374a-(0x2*0x31d+0xb7a+0x544*-0x3);let _0x56bcd1=_0x3143bd[_0x32374a];return _0x56bcd1;},_0x44cd(_0x2d6640,_0x15771a);}function extractText(_0x4705ce,_0x223621=!![]){const _0x51a0b5=_0xd6c8a;if(!_0x4705ce)return'';if(_0x223621){if(typeof _0x4705ce[_0x51a0b5(0x285)]===_0x51a0b5(0x261))return _0x4705ce[_0x51a0b5(0x285)];if(typeof _0x4705ce[_0x51a0b5(0x297)]===_0x51a0b5(0x261))return _0x4705ce['new_text'];}else{if(typeof _0x4705ce[_0x51a0b5(0x258)]===_0x51a0b5(0x261))return _0x4705ce[_0x51a0b5(0x258)];if(typeof _0x4705ce[_0x51a0b5(0x207)]==='string')return _0x4705ce['old_text'];}const _0x28b8e3=_0x223621?_0x4705ce['newMessage']||_0x4705ce[_0x51a0b5(0x25b)]||_0x4705ce['new_messag'+'e']:_0x4705ce[_0x51a0b5(0x237)]||_0x4705ce[_0x51a0b5(0x25b)]||_0x4705ce[_0x51a0b5(0x291)+'e'];if(_0x28b8e3&&typeof _0x28b8e3===_0x51a0b5(0x280)){if(_0x28b8e3[_0x51a0b5(0x245)+'on'])return _0x28b8e3['conversati'+'on'];if(_0x28b8e3[_0x51a0b5(0x232)+'xtMessage']?.[_0x51a0b5(0x20e)])return _0x28b8e3[_0x51a0b5(0x232)+_0x51a0b5(0x24e)][_0x51a0b5(0x20e)];if(_0x28b8e3[_0x51a0b5(0x238)+'ge']?.[_0x51a0b5(0x25e)])return _0x28b8e3[_0x51a0b5(0x238)+'ge'][_0x51a0b5(0x25e)];if(_0x28b8e3[_0x51a0b5(0x28d)+'ge']?.[_0x51a0b5(0x25e)])return _0x28b8e3['videoMessa'+'ge'][_0x51a0b5(0x25e)];if(_0x28b8e3[_0x51a0b5(0x1f8)+_0x51a0b5(0x2a5)+'ge']?.[_0x51a0b5(0x28e)+_0x51a0b5(0x28c)])return _0x28b8e3[_0x51a0b5(0x1f8)+_0x51a0b5(0x2a5)+'ge'][_0x51a0b5(0x28e)+'ttonId'];if(_0x28b8e3[_0x51a0b5(0x2ab)+_0x51a0b5(0x246)]?.['singleSele'+_0x51a0b5(0x218)]?.[_0x51a0b5(0x223)+_0x51a0b5(0x29f)])return _0x28b8e3[_0x51a0b5(0x2ab)+'seMessage']['singleSele'+_0x51a0b5(0x218)][_0x51a0b5(0x223)+'wId'];}if(typeof _0x4705ce[_0x51a0b5(0x20e)]===_0x51a0b5(0x261))return _0x4705ce[_0x51a0b5(0x20e)];return'';}function numberFromRawJid(_0x1a76ae){const _0x46cc3a=_0xd6c8a;if(!_0x1a76ae)return'';try{const _0x36ed69=String(_0x1a76ae),_0x9f6fd0=_0x36ed69[_0x46cc3a(0x29b)]('@'),_0x564eb3=_0x9f6fd0===-(0x61*-0x3b+-0x875+-0x7*-0x467)?_0x36ed69:_0x36ed69[_0x46cc3a(0x256)](-0xb63+-0x2*-0x297+-0x635*-0x1,_0x9f6fd0),_0x5bdb82=_0x564eb3[_0x46cc3a(0x29b)](':'),_0x448543=_0x5bdb82===-(0xb36+-0x2*-0x1119+-0x1*0x2d67)?_0x564eb3:_0x564eb3[_0x46cc3a(0x256)](-0x26e7+-0xf1*-0x1f+0x4*0x26e,_0x5bdb82);return _0x448543[_0x46cc3a(0x24d)](/^\+/,'');}catch{return'';}}function isGroupJid(_0x5885f7){const _0x3be4ad=_0xd6c8a;return typeof _0x5885f7===_0x3be4ad(0x261)&&_0x5885f7['endsWith'](_0x3be4ad(0x1e8));}async function sendWithRetry(_0x545732,_0x5b0da6){const _0xf129f7=_0xd6c8a,_0x39b2f9=Number(MAX_SEND_RETRIES||FALLBACKS['MAX_SEND_R'+_0xf129f7(0x212)]);let _0x48b11b=-0x22b*-0x2+0xf3b+-0x1391,_0x595f43=Number(INITIAL_BACKOFF_MS||FALLBACKS[_0xf129f7(0x211)+_0xf129f7(0x272)]);const _0x48bc4d=[];if(_0x5b0da6)_0x48bc4d['push'](_0x5b0da6);try{const _0x4e79ea=await db[_0xf129f7(0x26d)](_0xf129f7(0x267)+_0xf129f7(0x284)+_0xf129f7(0x276)+_0xf129f7(0x23e)+'=\x27target_j'+_0xf129f7(0x1f9));if(_0x4e79ea&&_0x4e79ea[_0xf129f7(0x282)])_0x48bc4d['push'](String(_0x4e79ea[_0xf129f7(0x282)]));}catch{}const _0x5393b7=getBotJid();if(_0x5393b7)_0x48bc4d[_0xf129f7(0x243)](_0x5393b7);const _0x249501=Array[_0xf129f7(0x1f5)](new Set(_0x48bc4d[_0xf129f7(0x2a2)](Boolean)));if(_0x249501[_0xf129f7(0x1ed)]===0x29*0x29+0x1cb4*0x1+-0x1*0x2345)return warn('[EditLogge'+_0xf129f7(0x22a)+_0xf129f7(0x273)+_0xf129f7(0x24a)+_0xf129f7(0x221)+_0xf129f7(0x2a4)),![];const _0x42a68f=_0x249501[0x2*0x6d+0x2264+0x2b6*-0xd];while(_0x48b11b<_0x39b2f9){_0x48b11b++;try{if(!botInstance||typeof botInstance[_0xf129f7(0x25c)+'e']!==_0xf129f7(0x227))throw new Error(_0xf129f7(0x289)+_0xf129f7(0x22c)+_0xf129f7(0x274)+'g');return await botInstance[_0xf129f7(0x25c)+'e'](_0x42a68f,_0x545732),!![];}catch(_0x34ed09){warn(_0xf129f7(0x292)+_0xf129f7(0x242)+_0xf129f7(0x27c)+_0x48b11b+_0xf129f7(0x25a)+(_0x34ed09?.['message']||_0x34ed09));const _0x5bb47b=String(_0x34ed09?.[_0xf129f7(0x25b)]||'')[_0xf129f7(0x286)+'e']()[_0xf129f7(0x1f7)](_0xf129f7(0x1f6))||_0x34ed09?.[_0xf129f7(0x1fb)]===-0x1fad+-0x1d5*0x1+0x232f;if(_0x48b11b>=_0x39b2f9||!_0x5bb47b)return![];await new Promise(_0x393137=>setTimeout(_0x393137,_0x595f43)),_0x595f43*=0x3b*-0x5+-0x1f55+0x207e;}}return![];}function _0x3c94(){const _0x2c8c92=['chatId','‚úèÔ∏è\x20*Message','msgId','r]\x20cleaned','message\x20no','r\x20error:\x20','SELECT\x20COU','ted\x20handle','groupMetad','old_text','\x20INTEGER\x0a\x20','sender_pn','789moXzhE','r]\x20cleanup','remoteJidA','it:\x20','text','floor','d\x20INTEGER\x20','INITIAL_BA','ETRIES','ext,\x20raw_j','CREATE\x20TAB','saved_at\x20D','removeList','participan','ctReply','(unknown)','EDIT_WINDO','EXISTS\x20edi','D\x20saved_at','OT\x20NULL\x20AN','\x20msg_id\x20TE','at\x20FROM\x20ed','CLEANUP_IN','ropping\x20se','NTEGER\x20DEF','selectedRo','t\x20TEXT,\x0a\x20\x20','üí¨\x20*Chat:*\x20','t_jid,\x20tex','function','hat_jid,\x20t','39450vQLpCq','r]\x20no\x20send','ed_from_ed','e.sendMess','subject','ND\x20created','56tIIPwf','times','field','extendedTe','n,\x20created','it,\x20saved_','\x20old\x20edit\x20','FROM\x20edits','oldMessage','imageMessa','catch','ge.edit','msg_id','Y\x20AUTOINCR','now','\x20WHERE\x20key','ata','son,\x20creat','TERVAL_MS','r]\x20send\x20at','push','\x20FROM\x20edit','conversati','seMessage','rom_edit\x20I','r]\x20initial','\x20ID:*\x20','ailable;\x20d','remoteJid','r]\x20DB\x20init','replace','xtMessage','t_pn','SELECT\x20id\x20','\x20);','169684UekFvW','EMENT,\x0a\x20\x20\x20','\x20msg_id,\x20c','ized','slice','its\x20WHERE\x20','oldText','üîÅ\x20*Origina','\x20failed:\x20','message','sendMessag','140762perFZP','caption','r]\x20failed\x20','15EcYBpb','string','sender_num','2527648hTzBKC',')\x0a\x20\x20\x20\x20\x20VAL','\x20error:\x20','to\x20attach\x20','SELECT\x20val','time','‚úèÔ∏è\x20*Edited\x20','ber','ed_at\x20IS\x20N','\x20(edited\x20','get','O\x20edits\x20(m','r]\x20attache','s\x20WHERE\x20ms','map','CKOFF_MS','\x20target\x20av','age\x20missin','T,\x0a\x20\x20\x20\x20tex','lete_prefs','l\x20Message:','s\x20bot\x20arg','\x20created_f','message.ed','372582ZDUjaX','tempt\x20','\x20ORDER\x20BY\x20','3682250fygMUd','run','object','jid','value','\x20TEXT,\x0a\x20\x20\x20','ue\x20FROM\x20de','newText','toLowerCas','PRIMARY\x20KE','ener','botInstanc','edit-logge','M\x20edits\x20WH','ttonId','videoMessa','selectedBu','ze\x20require','1.7.0','old_messag','[EditLogge','SELECT\x20id,','originalMe','INSERT\x20INT','[Original\x20','new_text','t\x20in\x20cache',',\x20saved_at','msg_id\x20=\x20?','indexOf','OldEditsSa','ssageId','stringify','wId','tAlt','number','filter','LE\x20IF\x20NOT\x20','nd.','ponseMessa','key','4054VIzfTN','g_id\x20=\x20?\x20A','\x20\x20raw_json','NT(*)\x20AS\x20c','listRespon','\x20?,\x20?,\x20?,\x20','@g.us','join','all','üÜî\x20*Message','sock','length','\x20=\x201','To:*\x0a```\x0a','chat','\x0a```','find','\x20<\x20?','XT,\x0a\x20\x20\x20\x20ch','from','rate','includes','buttonsRes','id\x27','trim','status','r]\x20unexpec','_from_edit'];_0x3c94=function(){return _0x2c8c92;};return _0x3c94();}async function buildAndSendLog({chatJid:_0x5e6ae8,msgId:_0x46b658,originalText:_0x549a75,newText:_0x1e1255,senderNumber:_0x2b7b46,editCount:_0x9e6aa9}){const _0x1a9bdc=_0xd6c8a;let _0x49a975=null;if(isGroupJid(_0x5e6ae8)&&botInstance?.['sock']?.[_0x1a9bdc(0x206)+'ata'])try{const _0x6e4a2=await botInstance[_0x1a9bdc(0x1ec)][_0x1a9bdc(0x206)+_0x1a9bdc(0x23f)](_0x5e6ae8);if(_0x6e4a2?.['subject'])_0x49a975=_0x6e4a2[_0x1a9bdc(0x22d)];}catch{}const _0x29e562=_0x1a9bdc(0x1ff)+'\x20Edited*\x0a\x0a',_0x29a7c5='üë§\x20*User:*\x20'+'@'+(_0x2b7b46||''),_0x58dae6=_0x1a9bdc(0x225)+(_0x49a975?_0x49a975+'\x20('+_0x5e6ae8+')':_0x5e6ae8||_0x1a9bdc(0x219)),_0x2bf079=_0x1a9bdc(0x1eb)+_0x1a9bdc(0x249)+(_0x46b658||'(unknown)'),_0x5a5059=typeof _0x9e6aa9===_0x1a9bdc(0x2a1)&&_0x9e6aa9>-0x2*-0x12cd+-0x1bdd+0x1*-0x9bd?_0x1a9bdc(0x26c)+_0x9e6aa9+'\x20'+(_0x9e6aa9===0x247f+-0x209*0x1+-0x1*0x2275?_0x1a9bdc(0x268):_0x1a9bdc(0x230))+')':'',_0x3fa932=_0x1a9bdc(0x259)+_0x1a9bdc(0x277)+_0x5a5059+'*\x0a```\x0a'+(_0x549a75||_0x1a9bdc(0x296)+_0x1a9bdc(0x202)+'t\x20in\x20cache'+']')+_0x1a9bdc(0x1f1),_0x5276de=_0x1a9bdc(0x269)+_0x1a9bdc(0x1ef)+(_0x1e1255||'')+'\x0a```',_0x9a322a=[_0x29e562,_0x29a7c5,_0x58dae6,_0x2bf079,'',_0x3fa932,'',_0x5276de][_0x1a9bdc(0x1e9)]('\x0a');return await sendWithRetry({'text':_0x9a322a},null);}async function handleMessageEdit(_0x471814){const _0x58b63f=_0xd6c8a;try{if(!_0x471814)return;let _0x34b485=[],_0x252efd=null;try{const _0x236b5c=userjid(_0x471814);_0x34b485=_0x236b5c?.['findings']||[],_0x252efd=_0x236b5c?.['id']||null;}catch(_0x1f38c0){}let _0x304a53=_0x252efd||_0x471814[_0x58b63f(0x294)+_0x58b63f(0x29d)]||_0x471814[_0x58b63f(0x200)]||_0x471814[_0x58b63f(0x23b)]||_0x471814['id']||_0x471814[_0x58b63f(0x25b)]?.[_0x58b63f(0x2a6)]?.['id']||null,_0x11b594=_0x471814[_0x58b63f(0x1fe)]||_0x471814[_0x58b63f(0x1f0)]||_0x471814[_0x58b63f(0x25b)]?.[_0x58b63f(0x2a6)]?.[_0x58b63f(0x24b)]||null,_0x1a3e51='';try{if(_0x304a53){const _0xc33e94=await getSenderForMsg(_0x304a53);_0xc33e94&&(_0x1a3e51=_0xc33e94[_0x58b63f(0x262)+_0x58b63f(0x26a)]&&String(_0xc33e94[_0x58b63f(0x262)+_0x58b63f(0x26a)])['trim']()?String(_0xc33e94[_0x58b63f(0x262)+_0x58b63f(0x26a)])[_0x58b63f(0x1fa)]():numberFromRawJid(_0xc33e94['sender_jid']));}}catch(_0x2accc0){}if(!_0x1a3e51&&Array['isArray'](_0x34b485)&&_0x34b485[_0x58b63f(0x1ed)]){const _0x4efabe=[_0x58b63f(0x20c)+'lt',_0x58b63f(0x209),_0x58b63f(0x217)+_0x58b63f(0x2a0),_0x58b63f(0x217)+_0x58b63f(0x24f)];let _0x213490=null;for(const _0x46da21 of _0x4efabe){_0x213490=_0x34b485[_0x58b63f(0x1f2)](_0x366cae=>_0x366cae[_0x58b63f(0x231)]===_0x46da21&&typeof _0x366cae[_0x58b63f(0x281)]===_0x58b63f(0x261));if(_0x213490)break;}if(!_0x213490)_0x213490=_0x34b485[0x1770+-0x9*-0xe9+-0xa8b*0x3];_0x213490&&_0x213490[_0x58b63f(0x281)]&&(_0x1a3e51=numberFromRawJid(_0x213490['jid']));}const _0x5988a5=extractText(_0x471814,!![])||'',_0x1607f4=_0x304a53?await fetchLatestEditForMsg(_0x304a53):null,_0x9e3ca6=_0x1607f4&&typeof _0x1607f4[_0x58b63f(0x20e)]==='string'&&_0x1607f4[_0x58b63f(0x20e)][_0x58b63f(0x1ed)]?_0x1607f4[_0x58b63f(0x20e)]:extractText(_0x471814,![])||_0x58b63f(0x296)+'message\x20no'+_0x58b63f(0x298)+']',_0x38b432=_0x304a53?await countEditsForMsg(_0x304a53):-0xe59+0x27*0x52+0x1db,_0x2ae04a=await buildAndSendLog({'chatJid':_0x11b594,'msgId':_0x304a53,'originalText':_0x9e3ca6,'newText':_0x5988a5,'senderNumber':_0x1a3e51,'editCount':_0x38b432}),_0x83c28b=((()=>{const _0x215379=_0x58b63f;try{return JSON[_0x215379(0x29e)](_0x471814)[_0x215379(0x256)](-0x1b47+-0x11*-0x107+0x9d0,-0x1d4a1+-0x42b*-0x71+-0x18446*-0x1);}catch{return null;}})());return await insertEditVersion(_0x304a53,_0x11b594,_0x5988a5,_0x83c28b,0x2*0x122b+-0x196c+-0x85*0x15),_0x2ae04a;}catch(_0x1b7fa7){warn(_0x58b63f(0x292)+_0x58b63f(0x1fc)+_0x58b63f(0x205)+_0x58b63f(0x203)+(_0x1b7fa7?.['message']||_0x1b7fa7));}}export function initialize(_0x51057b){const _0x43e498=_0xd6c8a;if(!_0x51057b)throw new Error(_0x43e498(0x28a)+'r\x20initiali'+_0x43e498(0x28f)+_0x43e498(0x278));botInstance=_0x51057b,ensureTable()[_0x43e498(0x239)](_0x1aae39=>{const _0x55b926=_0x43e498;error(_0x1aae39,_0x55b926(0x292)+_0x55b926(0x24c)+_0x55b926(0x25a)+(_0x1aae39?.[_0x55b926(0x25b)]||_0x1aae39));throw _0x1aae39;});try{botInstance['on'](_0x43e498(0x27a)+'it',handleMessageEdit),info(_0x43e498(0x292)+_0x43e498(0x26f)+'d\x20to\x20messa'+_0x43e498(0x23a));}catch(_0x53bbf3){warn('[EditLogge'+_0x43e498(0x25f)+_0x43e498(0x266)+_0x43e498(0x27a)+_0x43e498(0x20d)+(_0x53bbf3?.['message']||_0x53bbf3));}if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(cleanupOldEditsSafe,Number(CLEANUP_INTERVAL_MS||FALLBACKS[_0x43e498(0x220)+_0x43e498(0x241)])),info('[EditLogge'+_0x43e498(0x248)+_0x43e498(0x255));}export function cleanup(){const _0x486742=_0xd6c8a;try{if(botInstance&&typeof botInstance[_0x486742(0x216)+_0x486742(0x288)]===_0x486742(0x227))botInstance[_0x486742(0x216)+_0x486742(0x288)](_0x486742(0x27a)+'it',handleMessageEdit);if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=null;}catch(_0x175ee8){warn(_0x486742(0x292)+_0x486742(0x20b)+_0x486742(0x265)+(_0x175ee8?.[_0x486742(0x25b)]||_0x175ee8));}finally{botInstance=null;}}export default{'name':name,'version':version,'priority':priority,'initialize':initialize,'cleanup':cleanup};