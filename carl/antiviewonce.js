const _0x28272b=_0x3e41;(function(_0x306c12,_0x2586d9){const _0x10d859=_0x3e41,_0x10ef76=_0x306c12();while(!![]){try{const _0x20f916=parseInt(_0x10d859(0x148))/(-0x2178+0xa9d+0x16dc)+-parseInt(_0x10d859(0x21e))/(-0x329*-0x6+0x147*0xd+-0x238f)*(parseInt(_0x10d859(0x21a))/(-0x129c+-0x13b2+0x11*0x241))+-parseInt(_0x10d859(0x198))/(0x1f76+0x1fe+-0x2170)*(parseInt(_0x10d859(0x247))/(-0xb07+-0xf4f+0x8c9*0x3))+-parseInt(_0x10d859(0x1df))/(0xc*-0x264+-0x1e33+0x21*0x1c9)*(parseInt(_0x10d859(0x1f4))/(-0x332*-0x2+-0x1086+-0x33*-0x33))+parseInt(_0x10d859(0x1da))/(-0x1*0xdb9+-0x3*0xc1+-0xcd*-0x14)+parseInt(_0x10d859(0x1d1))/(-0xd5a+0x4db*0x7+-0x3*0x6de)*(parseInt(_0x10d859(0x1c6))/(0x2*-0x1336+0x35*-0x9+0x2853))+parseInt(_0x10d859(0x17b))/(0x203b*0x1+-0x151+-0x1edf);if(_0x20f916===_0x2586d9)break;else _0x10ef76['push'](_0x10ef76['shift']());}catch(_0x1083dc){_0x10ef76['push'](_0x10ef76['shift']());}}}(_0x3eb7,-0x11e911+0x36c6e+0x2*0xc06d2));import{info,warn,error}from'../utils/logger.js';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';function _0x3e41(_0x282825,_0x3cc277){const _0x3a2a7d=_0x3eb7();return _0x3e41=function(_0x5b3f18,_0x3568d9){_0x5b3f18=_0x5b3f18-(0x9*-0xae+0x29+0x735);let _0x36bfe3=_0x3a2a7d[_0x5b3f18];return _0x36bfe3;},_0x3e41(_0x282825,_0x3cc277);}import{isSudo}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x28272b(0x17d);export const version=_0x28272b(0x190)+'hed';export const priority=-0x2456+-0x5c9*-0x1+0x1eec;export const commands=[_0x28272b(0x17d)];export const configKeys=[_0x28272b(0x1f9)+_0x28272b(0x19a)+'GET_EQUALS'+_0x28272b(0x222),'VIEWONCE_A'+_0x28272b(0x20c)+_0x28272b(0x1eb)+'DEFAULT'];let botRef=null,SKIP_IF_TARGET_EQUALS_SOURCE=!![],ALLOW_GROUP_COMMANDS_DEFAULT=![],MODE='p',TARGET_JID=null,ALLOW_GROUP_COMMANDS=ALLOW_GROUP_COMMANDS_DEFAULT,NOTIFY_VIEWONCE=![];function refreshConfig(){const _0x3693dc=_0x28272b;try{const _0x543064=getConfig()||{};SKIP_IF_TARGET_EQUALS_SOURCE=_0x543064[_0x3693dc(0x1f9)+_0x3693dc(0x19a)+_0x3693dc(0x164)+'_SOURCE']!==undefined?Boolean(_0x543064[_0x3693dc(0x1f9)+_0x3693dc(0x19a)+_0x3693dc(0x164)+_0x3693dc(0x222)]):SKIP_IF_TARGET_EQUALS_SOURCE,ALLOW_GROUP_COMMANDS_DEFAULT=Boolean(_0x543064['VIEWONCE_A'+_0x3693dc(0x20c)+_0x3693dc(0x1eb)+'DEFAULT']??ALLOW_GROUP_COMMANDS_DEFAULT),info('['+name+(_0x3693dc(0x245)+_0x3693dc(0x1b7)));}catch(_0xf99da3){warn('['+name+(_0x3693dc(0x246)+_0x3693dc(0x1b2)+'r:\x20')+(_0xf99da3?.[_0x3693dc(0x19d)]||_0xf99da3));}}try{hotReloadConfig&&hotReloadConfig((_0x3e7396=[])=>{const _0x4426a7=_0x28272b,_0x3d93ae=[_0x4426a7(0x1f9)+_0x4426a7(0x19a)+_0x4426a7(0x164)+_0x4426a7(0x222),'VIEWONCE_A'+'LLOW_GROUP'+_0x4426a7(0x1eb)+_0x4426a7(0x224)];if((_0x3e7396||[])[_0x4426a7(0x1a1)](_0xbe6678=>_0x3d93ae[_0x4426a7(0x205)](_0xbe6678)))refreshConfig();});}catch(_0x118731){warn('['+name+(_0x28272b(0x14f)+'dConfig\x20re'+_0x28272b(0x196)+_0x28272b(0x169))+(_0x118731?.[_0x28272b(0x19d)]||_0x118731));}refreshConfig();async function ensureSchema(){const _0x27e654=_0x28272b;try{await db[_0x27e654(0x219)](_0x27e654(0x225)+_0x27e654(0x1aa)+_0x27e654(0x18a)+_0x27e654(0x1d5)+_0x27e654(0x24a)+_0x27e654(0x227)+'ey\x20TEXT\x20PR'+_0x27e654(0x17f)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20v'+_0x27e654(0x220)+_0x27e654(0x1e8)+'\x20\x20\x20\x20\x20\x20\x20\x20up'+_0x27e654(0x1a5)+_0x27e654(0x22f)+'AULT\x200\x0a\x20\x20\x20'+_0x27e654(0x1ac));try{const _0xe808a8=await db[_0x27e654(0x19f)](_0x27e654(0x1bd)+_0x27e654(0x143)+'ewonce_pre'+_0x27e654(0x1e3)+_0x27e654(0x1f1));MODE=_0xe808a8?.[_0x27e654(0x1f5)]==='g'?'g':'p';}catch(_0x41aab3){}try{const _0x7cebf0=await db[_0x27e654(0x19f)](_0x27e654(0x1bd)+'ue\x20FROM\x20vi'+'ewonce_pre'+_0x27e654(0x1e3)+_0x27e654(0x18c)+_0x27e654(0x145));TARGET_JID=_0x7cebf0?.[_0x27e654(0x1f5)]||null;}catch(_0x2d486f){TARGET_JID=null;}try{const _0x4d66b4=await db[_0x27e654(0x19f)]('SELECT\x20val'+_0x27e654(0x143)+'ewonce_pre'+'fs\x20WHERE\x20k'+_0x27e654(0x1f8)+_0x27e654(0x15e)+_0x27e654(0x14a));ALLOW_GROUP_COMMANDS=_0x4d66b4?.['value']==='1';}catch(_0x48cc6e){ALLOW_GROUP_COMMANDS=ALLOW_GROUP_COMMANDS_DEFAULT;}try{const _0x17795a=await db[_0x27e654(0x19f)](_0x27e654(0x1bd)+_0x27e654(0x143)+'ewonce_pre'+_0x27e654(0x1e3)+_0x27e654(0x1f0)+'_viewonce\x27');NOTIFY_VIEWONCE=_0x17795a?.[_0x27e654(0x1f5)]==='1';}catch(_0x108715){NOTIFY_VIEWONCE=![];}info('['+name+(']\x20DB\x20ready'+_0x27e654(0x22d))+MODE+_0x27e654(0x18e)+(TARGET_JID||'unset')+_0x27e654(0x177)+NOTIFY_VIEWONCE+(_0x27e654(0x18f)+_0x27e654(0x185)+_0x27e654(0x232))+ALLOW_GROUP_COMMANDS+')');}catch(_0x39ba91){error(_0x39ba91,'['+name+(']\x20ensureSc'+_0x27e654(0x208)+'d'));throw _0x39ba91;}}async function savePref(_0x5d51fc,_0x2bfda5){const _0x473b37=_0x28272b;try{const _0x59c4c4=Math[_0x473b37(0x238)](Date['now']()/(-0x1ac5+0x1908+0x5a5));await db['run']('INSERT\x20INT'+_0x473b37(0x140)+_0x473b37(0x1b1)+'y,value,up'+_0x473b37(0x166)+_0x473b37(0x1e9)+_0x473b37(0x192)+_0x473b37(0x226)+_0x473b37(0x144)+_0x473b37(0x1e7)+_0x473b37(0x14b)+_0x473b37(0x210)+_0x473b37(0x159)+_0x473b37(0x147)+_0x473b37(0x159),[_0x5d51fc,_0x2bfda5,_0x59c4c4]);}catch(_0x4064de){return warn('['+name+(_0x473b37(0x163)+_0x473b37(0x15b)+_0x473b37(0x151)+'r\x20')+_0x5d51fc+'='+_0x2bfda5+_0x473b37(0x233)+(_0x4064de?.[_0x473b37(0x19d)]||_0x4064de)),![];}try{const _0x256b39=await db[_0x473b37(0x19f)](_0x473b37(0x1bd)+_0x473b37(0x143)+_0x473b37(0x22b)+_0x473b37(0x1e3)+_0x473b37(0x171),[_0x5d51fc]),_0x1e72ee=_0x256b39?.[_0x473b37(0x1f5)]??_0x2bfda5;if(_0x5d51fc==='mode')MODE=_0x1e72ee==='g'?'g':'p';if(_0x5d51fc===_0x473b37(0x174))TARGET_JID=_0x1e72ee||null;if(_0x5d51fc==='allow_grou'+_0x473b37(0x15a))ALLOW_GROUP_COMMANDS=_0x1e72ee==='1';if(_0x5d51fc===_0x473b37(0x241)+'wonce')NOTIFY_VIEWONCE=_0x1e72ee==='1';return info('['+name+(_0x473b37(0x1c1)+_0x473b37(0x1c2)+_0x473b37(0x18d))+_0x5d51fc+'='+_0x1e72ee),!![];}catch(_0x4d1fc6){warn('['+name+(_0x473b37(0x163)+_0x473b37(0x141)+_0x473b37(0x155)+_0x473b37(0x151)+'r\x20')+_0x5d51fc+'='+_0x2bfda5+_0x473b37(0x233)+(_0x4d1fc6?.['message']||_0x4d1fc6));if(_0x5d51fc===_0x473b37(0x237))MODE=_0x2bfda5==='g'?'g':'p';if(_0x5d51fc===_0x473b37(0x174))TARGET_JID=_0x2bfda5||null;if(_0x5d51fc===_0x473b37(0x1dc)+_0x473b37(0x15a))ALLOW_GROUP_COMMANDS=_0x2bfda5==='1';if(_0x5d51fc===_0x473b37(0x241)+_0x473b37(0x17a))NOTIFY_VIEWONCE=_0x2bfda5==='1';return!![];}}function normalizeToUserJid(_0x232d95){const _0x31dde4=_0x28272b;try{if(!_0x232d95||typeof _0x232d95!==_0x31dde4(0x212))return _0x232d95;const _0x549d9c=_0x232d95[_0x31dde4(0x1b3)]('@');if(_0x549d9c===-(-0xe*0x91+-0x1f46*-0x1+0x4ab*-0x5))return _0x232d95;const _0x2ad43b=_0x232d95[_0x31dde4(0x165)](0x9*0x119+0x3*-0xb5d+0x1836,_0x549d9c),_0x331dff=_0x232d95[_0x31dde4(0x165)](_0x549d9c),_0x596c34=_0x2ad43b[_0x31dde4(0x1b3)](':');if(_0x596c34===-(-0x257e+0x23f*-0x9+-0x1*-0x39b6))return _0x232d95;return _0x2ad43b[_0x31dde4(0x165)](-0x24f2+0x1*-0x2483+0x4975*0x1,_0x596c34)+_0x331dff;}catch(_0x53172e){return _0x232d95;}}async function trySend(_0x8f0d21,_0x36fdc2){const _0x3df0ba=_0x28272b;try{const _0x5a5b1b=normalizeToUserJid(String(_0x8f0d21));if(!_0x5a5b1b)throw new Error(_0x3df0ba(0x1ab)+'rget');if(typeof botRef?.[_0x3df0ba(0x1b4)+'e']===_0x3df0ba(0x24e)){await botRef[_0x3df0ba(0x1b4)+'e'](_0x5a5b1b,_0x36fdc2);return;}if(botRef?.[_0x3df0ba(0x175)]&&typeof botRef[_0x3df0ba(0x175)][_0x3df0ba(0x1b4)+'e']==='function'){await botRef['sock']['sendMessag'+'e'](_0x5a5b1b,_0x36fdc2);return;}throw new Error(_0x3df0ba(0x1ca)+_0x3df0ba(0x1fd)+'able');}catch(_0x4712b8){throw _0x4712b8;}}const DEDUPE_TTL_MS=(-0xe91+0x25dc+-0x1741*0x1)*(-0x143*0x2+0x195e+-0x978*0x2),processedKeys=new Map();function _0x3eb7(){const _0x22a059=['VIEWONCE_S','ng\x20back\x20to','\x20in\x20',']\x20handleUp','sage\x20avail','urrently\x20*','ia\x20buffer',']\x20no\x20desti','delete','requires\x20b','eo\x20to\x20',']\x20cleanup\x20','includes','text','@g.us','hema\x20faile','ssage','rget\x20-\x20abo','olved','LLOW_GROUP','to\x20PM.','messages.u','in\x20a\x20view-','ed.value,\x20','contextInf','string','d\x20media\x20ty','extendedTe','\x20clear\x20tar','with\x20\x27_\x27\x20(','split','\x20`viewonce','exec','6057sEudRV','\x20-\x20attempt','OFF','viewonce.i','628Qxoxtw','ned\x20false','alue\x20TEXT\x20','Recovered\x0a','_SOURCE','\x20error:\x20','DEFAULT','\x0a\x20\x20\x20\x20\x20\x20CRE','CONFLICT(k','\x0a\x20\x20\x20\x20\x20\x20\x20\x20k','psert','push','t\x20supporte','ewonce_pre','\x20set\x20mode.','\x20(mode=',']\x20command\x20','NTEGER\x20DEF','to\x20GROUP.\x20','viewOnceMe','ds=','\x20â€”\x20','Content\x20er',']\x20getBotJi','\x20Target\x20JI','mode','floor','tempt\x20reco','remove',']\x20upsertHa','charAt','clear','quotedMess','nner\x20is\x20no','\x20cleaned\x20u','notify_vie','selectedBu','adcast','unknown\x20ch',']\x20config\x20r',']\x20refreshC','12015oCPeaV','applicatio','participan','ce_prefs\x20(','\x20of\x20view-o','\x20from\x20','\x20view-once','function','key','unknown\x20us','concat','O\x20viewonce',':\x20reload\x20a','values','ue\x20FROM\x20vi','ey)\x20DO\x20UPD','_jid\x27',']\x20no\x20confi','=excluded.','573780zYtMdx','\x20not\x20conta','ands\x27','lue=exclud','Not\x20set','unset','once\x20Setti',']\x20hotReloa',']\x20Reply\x20st','\x20failed\x20fo','ing\x20recove','recovered.','group','fter\x20write','d:\x20','ssageV2','\x20Failed\x20to','updated_at','p_commands',':\x20DB\x20write','set',']\x20notify\x20s','group_comm','add','[viewonce]',']\x20Sent\x20rec','singleSele',']\x20savePref','GET_EQUALS','slice','dated_at)\x20','r:\x20','View-Once\x20','\x20failed:\x20','emoteJid','endsWith','\x20notify\x20on','get\x20JID.','error:\x20','overed\x20ima','ctReply','ey=?','*Notificat','catch','target_jid','sock','.\x0aReply\x20to',',\x20notify=','\x27\x20(undersc','image','wonce','15136924MgkagN','\x20Mode\x20set\x20','viewonce','fromMe','IMARY\x20KEY,','ecoveredTo','\x0a\x0afrom:\x20','selectedRo','`\x20`viewonc','\x20the\x20view-','oup_comman','D\x20cleared.','notify','buttonsRes','toLowerCas','IF\x20NOT\x20EXI','ions\x20set\x20t','ey=\x27target','ded:\x20',',\x20target=',',\x20allow_gr','2.0.0-patc','\x20in\x20chat\x20','\x20?,\x20?)\x20ON\x20','fications\x20','\x20message\x20t','|off`\x0a','gistration','video','1892YldZDJ','Configured','KIP_IF_TAR','age','\x20that\x20mess','message','isCommand','get','\x20inner\x20med','some','d\x20unavaila',']\x20download','status@bro','dated_at\x20I','age\x20with\x20a','\x20save\x20noti','\x20ctx.key.r','\x20message','ATE\x20TABLE\x20','no\x20send\x20ta','\x20\x20\x20);\x0a\x20\x20\x20\x20','trim','tener)','ngs\x20(PM-On','\x20group:\x20','_prefs\x20(ke','onfig\x20erro','indexOf','sendMessag','caption','\x20Notificat','efreshed','has','GROUP\x20(','xtMessage','remoteJid',']\x20quoted\x20v','SELECT\x20val','ot\x20instanc','listRespon',']\x20forwardR',']\x20pref\x20sav','ed\x20&\x20reloa','rmation\x20ta','imageMessa','seMessage','467450vtrbYt','true',':\x20reply\x20to','zed\x20(centr','no\x20sendMes','ly)*\x0a\x0a','ttonId','unknown','o\x20*','ions*:\x20','conversati','153BSspoO','message\x20th','and',']\x20quoted\x20m','STS\x20viewon','s\x20with*\x20\x27_','et\x20JID:\x20','length','\x20p|g`\x0a','1442672awgamG','ore)\x20to\x20at','allow_grou','videoMessa','*Target\x20JI','3163998pYdRvS','underscore','at\x20starts\x20','overed\x20doc','fs\x20WHERE\x20k','JID\x20set.','D*:\x20`','e\x20<jid>`\x0a','ATE\x20SET\x20va','NOT\x20NULL,\x0a','VALUES\x20(?,','o\x20download','_COMMANDS_','ble;\x20falli','No\x20target\x20','*Send\x20Targ','essage\x20did','ey=\x27notify','ey=\x27mode\x27','ror:\x20','wId','7xaSXjc','value','isViewOnce','ument\x20to\x20','ey=\x27allow_'];_0x3eb7=function(){return _0x22a059;};return _0x3eb7();}function markProcessed(_0x5b5690){const _0x471438=_0x28272b;if(!_0x5b5690)return;if(processedKeys['has'](_0x5b5690))try{clearTimeout(processedKeys['get'](_0x5b5690));}catch(_0x5f1d2e){}const _0x160727=setTimeout(()=>processedKeys[_0x471438(0x201)](_0x5b5690),DEDUPE_TTL_MS);processedKeys[_0x471438(0x15c)](_0x5b5690,_0x160727);}function isProcessed(_0x45d62a){const _0x5d7b00=_0x28272b;return _0x45d62a&&processedKeys[_0x5d7b00(0x1b8)](_0x45d62a);}function extractContextInfo(_0xd9eacc){const _0x2fbb3c=_0x28272b;if(!_0xd9eacc||!_0xd9eacc['message'])return null;const _0x5af7aa=_0xd9eacc[_0x2fbb3c(0x19d)];return _0x5af7aa[_0x2fbb3c(0x214)+_0x2fbb3c(0x1ba)]?.[_0x2fbb3c(0x211)+'o']||_0x5af7aa['contextInf'+'o']||null;}function extractViewOnceInnerFromQuoted(_0x452763){const _0x383803=_0x28272b;if(!_0x452763)return null;return _0x452763?.[_0x383803(0x231)+_0x383803(0x209)]?.[_0x383803(0x19d)]||_0x452763?.[_0x383803(0x231)+_0x383803(0x157)]?.[_0x383803(0x19d)]||(_0x452763[_0x383803(0x1c4)+'ge']?_0x452763:null)||(_0x452763[_0x383803(0x1dd)+'ge']?_0x452763:null)||null;}function getSelfJid(){return getBotJid()||null;}function resolveDestination(_0x197332){const _0x227833=getSelfJid();if(MODE==='g'&&TARGET_JID){if(SKIP_IF_TARGET_EQUALS_SOURCE&&TARGET_JID===_0x197332)return _0x227833;return TARGET_JID;}return _0x227833;}function stripDomain(_0x4f47a9){const _0x4a3ffb=_0x28272b;if(!_0x4f47a9||typeof _0x4f47a9!==_0x4a3ffb(0x212))return _0x4f47a9;const _0x28440c=_0x4f47a9['indexOf']('@');if(_0x28440c===-(0x6a0+0x5*-0x3b7+0x5a*0x22))return _0x4f47a9;return _0x4f47a9[_0x4a3ffb(0x165)](0x126a+0x26*0x18+-0x15fa,_0x28440c);}async function handleUpsertSingle(_0x5d25a7){const _0x4fc4fe=_0x28272b;try{if(!_0x5d25a7||!_0x5d25a7[_0x4fc4fe(0x24f)])return;if(_0x5d25a7['key']?.[_0x4fc4fe(0x1bb)]===_0x4fc4fe(0x1a4)+_0x4fc4fe(0x243))return;if(Boolean(_0x5d25a7[_0x4fc4fe(0x24f)]?.[_0x4fc4fe(0x17e)]))return;const _0x51b0d1=String(_0x5d25a7['key'][_0x4fc4fe(0x1bb)]||'')+'::'+String(_0x5d25a7[_0x4fc4fe(0x24f)]['id']||'');if(isProcessed(_0x51b0d1))return;markProcessed(_0x51b0d1);const _0x3f9048=Boolean(_0x5d25a7[_0x4fc4fe(0x24f)]?.[_0x4fc4fe(0x1f6)]),_0x2a17ff=Boolean(_0x5d25a7[_0x4fc4fe(0x19d)]?.[_0x4fc4fe(0x231)+_0x4fc4fe(0x209)]||_0x5d25a7[_0x4fc4fe(0x19d)]?.[_0x4fc4fe(0x231)+_0x4fc4fe(0x157)]);if(!_0x3f9048&&!_0x2a17ff)return;if(!NOTIFY_VIEWONCE)return;const _0x194de3=_0x5d25a7['pushName']||_0x5d25a7['key']?.[_0x4fc4fe(0x249)+'t']||_0x5d25a7['key']?.[_0x4fc4fe(0x1bb)]||null,_0x440c0b=_0x194de3?stripDomain(String(_0x194de3)):_0x4fc4fe(0x1cd),_0x859d5b=_0x5d25a7[_0x4fc4fe(0x24f)]?.[_0x4fc4fe(0x1bb)]?stripDomain(_0x5d25a7[_0x4fc4fe(0x24f)]['remoteJid']):_0x4fc4fe(0x244)+'at',_0x3df345=resolveDestination(_0x5d25a7[_0x4fc4fe(0x24f)]?.[_0x4fc4fe(0x1bb)]);if(!_0x3df345)return;const _0xc6e531='ðŸ‘ï¸\x20Detected'+_0x4fc4fe(0x24d)+_0x4fc4fe(0x24c)+_0x440c0b+_0x4fc4fe(0x191)+_0x859d5b+(_0x4fc4fe(0x176)+_0x4fc4fe(0x19c)+_0x4fc4fe(0x1a6)+_0x4fc4fe(0x194)+'hat\x20*start'+_0x4fc4fe(0x1d6)+_0x4fc4fe(0x178)+_0x4fc4fe(0x1db)+_0x4fc4fe(0x239)+'very.');try{await trySend(_0x3df345,{'text':_0xc6e531}),info('['+name+(']\x20Notified'+'\x20')+_0x3df345+(_0x4fc4fe(0x24b)+'nce\x20from\x20')+_0x440c0b+_0x4fc4fe(0x1fb)+_0x859d5b);}catch(_0x2a42db){warn('['+name+(_0x4fc4fe(0x15d)+'end\x20failed'+':\x20')+(_0x2a42db?.['message']||_0x2a42db));}}catch(_0x65b0ab){warn('['+name+(_0x4fc4fe(0x1fc)+'sertSingle'+_0x4fc4fe(0x223))+(_0x65b0ab?.[_0x4fc4fe(0x19d)]||_0x65b0ab));}}async function upsertHandler({messages:_0x20053c}){const _0x30fa8d=_0x28272b;try{if(!Array['isArray'](_0x20053c))return;for(const _0x4dfbb6 of _0x20053c)await handleUpsertSingle(_0x4dfbb6);}catch(_0x2a16f9){warn('['+name+(_0x30fa8d(0x23b)+'ndler\x20erro'+'r:\x20')+(_0x2a16f9?.[_0x30fa8d(0x19d)]||_0x2a16f9));}}async function downloadBufferFromContent(_0x55f40f,_0x4c5f02){const _0x116ab8=_0x28272b;try{if(!_0x55f40f||!_0x4c5f02)return null;const _0x14b52c=await downloadContentFromMessage(_0x55f40f,_0x4c5f02);if(!_0x14b52c)return null;const _0x456642=[];for await(const _0x11ec35 of _0x14b52c){_0x456642[_0x116ab8(0x229)](_0x11ec35);}if(!_0x456642[_0x116ab8(0x1d8)])return null;return Buffer[_0x116ab8(0x251)](_0x456642);}catch(_0x4e864f){return warn('['+name+(_0x116ab8(0x1a3)+'BufferFrom'+_0x116ab8(0x234)+_0x116ab8(0x1f2))+(_0x4e864f?.[_0x116ab8(0x19d)]||_0x4e864f)),null;}}async function forwardRecoveredToDest(_0x6ecc6a,_0x513ccd,_0x41c83a,_0x6e8cc2){const _0xfdbbb1=_0x28272b,_0x1a0d61=resolveDestination(_0x41c83a);if(!_0x1a0d61)return warn('['+name+(_0xfdbbb1(0x200)+'nation\x20res'+_0xfdbbb1(0x20b))),![];try{const _0x23b49e=_0x6ecc6a?.['imageMessa'+'ge']?.['caption']||_0x6ecc6a?.[_0xfdbbb1(0x1dd)+'ge']?.[_0xfdbbb1(0x1b5)]||'',_0x5a87aa=_0x6e8cc2?stripDomain(_0x6e8cc2):_0xfdbbb1(0x250)+'er',_0x1d141a=_0x41c83a?stripDomain(_0x41c83a):_0xfdbbb1(0x244)+'at',_0x46f91e=_0xfdbbb1(0x181)+_0x5a87aa+_0xfdbbb1(0x1fb)+_0x1d141a,_0x4faf39=_0xfdbbb1(0x168)+_0xfdbbb1(0x221)+_0x23b49e+_0x46f91e;if(_0x6ecc6a[_0xfdbbb1(0x1c4)+'ge'])return await trySend(_0x1a0d61,{'image':_0x513ccd,'caption':_0x4faf39}),info('['+name+(_0xfdbbb1(0x161)+_0xfdbbb1(0x16f)+'ge\x20to\x20')+_0x1a0d61),!![];if(_0x6ecc6a[_0xfdbbb1(0x1dd)+'ge']){const _0x20c47b=Boolean(_0x6ecc6a[_0xfdbbb1(0x1dd)+'ge']?.['gifPlaybac'+'k']);return await trySend(_0x1a0d61,{'video':_0x513ccd,'caption':_0x4faf39,'gifPlayback':_0x20c47b}),info('['+name+(']\x20Sent\x20rec'+'overed\x20vid'+_0xfdbbb1(0x203))+_0x1a0d61),!![];}return await trySend(_0x1a0d61,{'document':_0x513ccd,'fileName':_0xfdbbb1(0x153)+'bin','mimetype':_0xfdbbb1(0x248)+'n/octet-st'+'ream','caption':_0x4faf39}),info('['+name+(']\x20Sent\x20rec'+_0xfdbbb1(0x1e2)+_0xfdbbb1(0x1f7))+_0x1a0d61),!![];}catch(_0x5f5a56){return warn('['+name+(_0xfdbbb1(0x1c0)+_0xfdbbb1(0x180)+'Dest\x20faile'+_0xfdbbb1(0x156))+(_0x5f5a56?.['message']||_0x5f5a56)),![];}}function extractTextFromCtx(_0x17044e){const _0x4a44c6=_0x28272b;if(!_0x17044e||!_0x17044e[_0x4a44c6(0x19d)])return'';const _0x57d223=_0x17044e[_0x4a44c6(0x19d)];return _0x57d223[_0x4a44c6(0x1d0)+'on']||_0x57d223['extendedTe'+_0x4a44c6(0x1ba)]?.['text']||_0x57d223[_0x4a44c6(0x1c4)+'ge']?.['caption']||_0x57d223['videoMessa'+'ge']?.[_0x4a44c6(0x1b5)]||'';}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0x67e*-0x1+-0x2379+0x1d19)*(-0x127b+0x26a+0x13f9);function markCmdProcessed(_0x1d01c9){const _0x2ef613=_0x28272b;if(!_0x1d01c9)return;if(processedCmdKeys[_0x2ef613(0x1b8)](_0x1d01c9))try{clearTimeout(processedCmdKeys['get'](_0x1d01c9));}catch(_0xaf9277){};const _0xdeb15d=setTimeout(()=>processedCmdKeys[_0x2ef613(0x201)](_0x1d01c9),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x2ef613(0x15c)](_0x1d01c9,_0xdeb15d);}function isCmdProcessed(_0x4fc541){return _0x4fc541&&processedCmdKeys['has'](_0x4fc541);}const recentResponded=new Set();export async function onMessage(_0x13a3ed){const _0x16abe9=_0x28272b;try{if(!_0x13a3ed||!_0x13a3ed[_0x16abe9(0x24f)]||!_0x13a3ed[_0x16abe9(0x19d)])return;const _0x4dce79=_0x13a3ed[_0x16abe9(0x24f)]?.['id']||null;if(_0x4dce79){if(recentResponded[_0x16abe9(0x1b8)](_0x4dce79))return;recentResponded[_0x16abe9(0x15f)](_0x4dce79),setTimeout(()=>recentResponded[_0x16abe9(0x201)](_0x4dce79),(0xa7*-0x1f+0x877+0xbfe)*(-0x189*0x17+-0x1df*-0x3+0x219a));}if(_0x13a3ed[_0x16abe9(0x19e)]){const _0x13c495=_0x13a3ed[_0x16abe9(0x24f)][_0x16abe9(0x1bb)],_0x1e9723=typeof _0x13c495===_0x16abe9(0x212)&&_0x13c495[_0x16abe9(0x16b)](_0x16abe9(0x207));if(_0x1e9723&&!ALLOW_GROUP_COMMANDS){}else{const _0x3eb02b=Boolean(_0x13a3ed[_0x16abe9(0x24f)][_0x16abe9(0x17e)]);if(!_0x1e9723&&!_0x3eb02b){const _0x3d09dd=await isSudo(botRef,_0x13a3ed)[_0x16abe9(0x173)](()=>![]);if(!_0x3d09dd){}else await handleCommand(_0x13a3ed)['catch'](_0x5bdd98=>warn('['+name+(']\x20command\x20'+_0x16abe9(0x16e))+(_0x5bdd98?.[_0x16abe9(0x19d)]||_0x5bdd98)));}else{const _0x53635a=await isSudo(botRef,_0x13a3ed)['catch'](()=>![]),_0x513a6f=Boolean(_0x13a3ed[_0x16abe9(0x24f)][_0x16abe9(0x17e)]);(_0x513a6f||_0x53635a)&&await handleCommand(_0x13a3ed)[_0x16abe9(0x173)](_0x258d22=>warn('['+name+(_0x16abe9(0x22e)+'error:\x20')+(_0x258d22?.[_0x16abe9(0x19d)]||_0x258d22)));}}}const _0x5c2e1=extractContextInfo(_0x13a3ed);if(!_0x5c2e1||!_0x5c2e1[_0x16abe9(0x23e)+_0x16abe9(0x19b)])return;const _0x526238=extractTextFromCtx(_0x13a3ed)||'';if(!_0x526238)return;const _0x263f7a=_0x526238[_0x16abe9(0x1ad)]()[_0x16abe9(0x23c)](-0xf27+-0x1bb4+0x2adb);if(_0x263f7a!=='_')return;info('['+name+(_0x16abe9(0x150)+'arts\x20with\x20'+_0x16abe9(0x1e0)+_0x16abe9(0x21b)+_0x16abe9(0x152)+'ry'));const _0x5e1401=extractViewOnceInnerFromQuoted(_0x5c2e1[_0x16abe9(0x23e)+'age']);if(!_0x5e1401){warn('['+name+(_0x16abe9(0x1d4)+_0x16abe9(0x1ef)+_0x16abe9(0x149)+_0x16abe9(0x20f)+'once\x20inner'+_0x16abe9(0x1a9)));return;}let _0x83675d=null,_0x5249e2=null;if(_0x5e1401[_0x16abe9(0x1c4)+'ge'])_0x83675d=_0x5e1401[_0x16abe9(0x1c4)+'ge'],_0x5249e2=_0x16abe9(0x179);else _0x5e1401[_0x16abe9(0x1dd)+'ge']&&(_0x83675d=_0x5e1401['videoMessa'+'ge'],_0x5249e2=_0x16abe9(0x197));if(!_0x83675d||!_0x5249e2){warn('['+name+(_0x16abe9(0x1bc)+'iew-once\x20i'+_0x16abe9(0x23f)+_0x16abe9(0x22a)+_0x16abe9(0x213)+'pe'));return;}const _0x12d64e=await downloadBufferFromContent(_0x83675d,_0x5249e2);if(!_0x12d64e){warn('['+name+(']\x20failed\x20t'+_0x16abe9(0x1ea)+_0x16abe9(0x1a0)+_0x16abe9(0x1ff)));return;}const _0x1b2ceb=_0x13a3ed[_0x16abe9(0x24f)][_0x16abe9(0x1bb)]||null,_0x5399c2=_0x5c2e1[_0x16abe9(0x249)+'t']||null,_0x216d4b=await forwardRecoveredToDest(_0x5e1401,_0x12d64e,_0x1b2ceb,_0x5399c2);if(!_0x216d4b)warn('['+name+(_0x16abe9(0x1c0)+_0x16abe9(0x180)+'Dest\x20retur'+_0x16abe9(0x21f)));}catch(_0x2b97cd){error(_0x2b97cd,'['+name+(']\x20onMessag'+'e\x20handler\x20'+'error:\x20')+(_0x2b97cd?.['message']||_0x2b97cd));}}async function handleCommand(_0x42def7){const _0x57d371=_0x28272b;try{if(!_0x42def7||!_0x42def7[_0x57d371(0x24f)]||!_0x42def7[_0x57d371(0x19d)])return;const _0x278b8f=_0x42def7[_0x57d371(0x24f)]['remoteJid'],_0x4191d1=typeof _0x278b8f===_0x57d371(0x212)&&_0x278b8f[_0x57d371(0x16b)](_0x57d371(0x207));if(_0x4191d1&&!ALLOW_GROUP_COMMANDS)return;const _0x3809b7=Boolean(_0x42def7[_0x57d371(0x24f)][_0x57d371(0x17e)]);if(!_0x4191d1&&!_0x3809b7){const _0x5e77d1=await isSudo(botRef,_0x42def7)[_0x57d371(0x173)](()=>![]);if(!_0x5e77d1)return;}const _0x131f2d=Boolean(_0x42def7['key'][_0x57d371(0x17e)]),_0x566653=await isSudo(botRef,_0x42def7)['catch'](()=>![]);let _0x41c6f;if(_0x131f2d)_0x41c6f=getBotJid()||_0x42def7['key'][_0x57d371(0x1bb)]||_0x42def7[_0x57d371(0x24f)][_0x57d371(0x249)+'t']||null,!_0x41c6f&&(warn('['+name+(_0x57d371(0x235)+_0x57d371(0x1a2)+_0x57d371(0x1ec)+_0x57d371(0x1fa)+_0x57d371(0x1a8)+_0x57d371(0x16a))),_0x41c6f=_0x42def7[_0x57d371(0x24f)][_0x57d371(0x1bb)]||null);else{if(_0x566653)_0x41c6f=_0x42def7['key'][_0x57d371(0x1bb)];else return;}if(!_0x41c6f){warn('['+name+(_0x57d371(0x146)+_0x57d371(0x1c3)+_0x57d371(0x20a)+'rting\x20comm'+_0x57d371(0x1d3)));return;}const _0x20f2f1=String(_0x42def7[_0x57d371(0x24f)][_0x57d371(0x1bb)]||'')+'::'+String(_0x42def7[_0x57d371(0x24f)]['id']||_0x42def7['key'][_0x57d371(0x249)+'t']||'');if(isCmdProcessed(_0x20f2f1))return;markCmdProcessed(_0x20f2f1);const _0x5d04bd=typeof _0x42def7[_0x57d371(0x206)]==='string'&&_0x42def7[_0x57d371(0x206)]['trim']()['length']?_0x42def7['text'][_0x57d371(0x1ad)]():function _0x97f614(_0x962be5){const _0x198c43=_0x57d371;if(!_0x962be5||!_0x962be5[_0x198c43(0x19d)])return'';const _0x481b28=_0x962be5['message'];if(_0x481b28[_0x198c43(0x1d0)+'on'])return _0x481b28[_0x198c43(0x1d0)+'on'];if(_0x481b28[_0x198c43(0x214)+_0x198c43(0x1ba)]?.[_0x198c43(0x206)])return _0x481b28['extendedTe'+_0x198c43(0x1ba)][_0x198c43(0x206)];if(_0x481b28['imageMessa'+'ge']?.['caption'])return _0x481b28['imageMessa'+'ge'][_0x198c43(0x1b5)];if(_0x481b28[_0x198c43(0x1dd)+'ge']?.[_0x198c43(0x1b5)])return _0x481b28[_0x198c43(0x1dd)+'ge']['caption'];if(_0x481b28[_0x198c43(0x188)+'ponseMessa'+'ge']?.[_0x198c43(0x242)+'ttonId'])return _0x481b28[_0x198c43(0x188)+'ponseMessa'+'ge'][_0x198c43(0x242)+_0x198c43(0x1cc)];if(_0x481b28[_0x198c43(0x1bf)+_0x198c43(0x1c5)]?.[_0x198c43(0x162)+_0x198c43(0x170)]?.['selectedRo'+'wId'])return _0x481b28[_0x198c43(0x1bf)+'seMessage']['singleSele'+_0x198c43(0x170)][_0x198c43(0x182)+_0x198c43(0x1f3)];return'';}(_0x42def7)||'';if(!_0x5d04bd)return;const _0x2011b4=(_0x5d04bd[_0x57d371(0x217)](/\r?\n/)[0x1f08+0x14a0+-0xe8*0x39]||'')[_0x57d371(0x1ad)](),_0x35cdb4=_0x2011b4['split'](/\s+/),_0x5192f8=(_0x35cdb4[-0x23a3*0x1+-0x12d8+0x367b]||'')['toLowerCas'+'e']();if(!commands[_0x57d371(0x205)](_0x5192f8))return;const _0xe395d5=(_0x35cdb4[0x1e08+-0x1a57+0x1*-0x3b0]||'')[_0x57d371(0x189)+'e']();if(_0xe395d5===_0x57d371(0x187)){const _0x487444=(_0x35cdb4[-0x2*0x1e5+-0x4cb+0x897]||'')[_0x57d371(0x189)+'e']();if(!_0x487444){await trySend(_0x41c6f,{'text':'[viewonce]'+_0x57d371(0x1b6)+'ions\x20are\x20c'+_0x57d371(0x1fe)+(NOTIFY_VIEWONCE?'ON':_0x57d371(0x21c))+'*'});return;}const _0x3a0b7d=_0x487444==='on'||_0x487444==='1'||_0x487444===_0x57d371(0x1c7),_0x453f8e=await savePref('notify_vie'+_0x57d371(0x17a),_0x3a0b7d?'1':'0');if(!_0x453f8e){await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x158)+_0x57d371(0x1a7)+_0x57d371(0x193)+'setting.'});return;}await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x1b6)+_0x57d371(0x18b)+_0x57d371(0x1ce)+(_0x3a0b7d?'ON':_0x57d371(0x21c))+'*'});return;}if(_0xe395d5==='p'||_0xe395d5==='pm'){const _0x469532=await savePref(_0x57d371(0x237),'p');if(!_0x469532){await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x158)+'\x20set\x20mode.'});return;}await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x17c)+_0x57d371(0x20d)});return;}if(_0xe395d5==='g'||_0xe395d5===_0x57d371(0x154)||_0xe395d5==='gp'){const _0x2882f4=await savePref(_0x57d371(0x237),'g');if(!_0x2882f4){await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x158)+_0x57d371(0x22c)});return;}const _0x289f1b=TARGET_JID?_0x57d371(0x199)+_0x57d371(0x1b0)+TARGET_JID:_0x57d371(0x1ed)+_0x57d371(0x1e4);await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x17c)+_0x57d371(0x230)+_0x289f1b});return;}if(_0xe395d5&&_0xe395d5['includes']('@')){const _0x176059=normalizeToUserJid(_0xe395d5),_0x3c9005=await savePref(_0x57d371(0x174),_0x176059);if(_0x3c9005)await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x236)+'D\x20saved:\x20'+_0x176059});else await trySend(_0x41c6f,{'text':_0x57d371(0x160)+'\x20Failed\x20to'+'\x20save\x20targ'+_0x57d371(0x1d7)+_0x176059});return;}if(_0xe395d5===_0x57d371(0x23d)||_0xe395d5===_0x57d371(0x14d)||_0xe395d5===_0x57d371(0x23a)){const _0x21198d=await savePref(_0x57d371(0x174),'');if(_0x21198d)await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x236)+_0x57d371(0x186)});else await trySend(_0x41c6f,{'text':_0x57d371(0x160)+_0x57d371(0x158)+_0x57d371(0x215)+_0x57d371(0x16d)});return;}const _0x1c33ed=MODE==='g'?_0x57d371(0x1b9)+(TARGET_JID||'not\x20set')+')':'PM';await trySend(_0x41c6f,{'text':'*Anti-View'+_0x57d371(0x14e)+_0x57d371(0x1af)+_0x57d371(0x1cb)+(_0x57d371(0x172)+_0x57d371(0x1cf)+(NOTIFY_VIEWONCE?'ON':_0x57d371(0x21c))+(_0x57d371(0x218)+_0x57d371(0x16c)+_0x57d371(0x195)))+(_0x57d371(0x1ee)+'et*:\x20'+_0x1c33ed+('\x20`viewonce'+_0x57d371(0x1d9)))+(_0x57d371(0x1de)+_0x57d371(0x1e5)+(TARGET_JID||_0x57d371(0x14c))+(_0x57d371(0x183)+_0x57d371(0x1e6)))+('To\x20recover'+_0x57d371(0x1c8)+_0x57d371(0x184)+'once\x20messa'+'ge\x20with\x20a\x20'+_0x57d371(0x1d2)+_0x57d371(0x1e1)+_0x57d371(0x216)+_0x57d371(0x1e0)+').')});}catch(_0x16d1b6){warn('['+name+(']\x20handleCo'+'mmand\x20erro'+_0x57d371(0x167))+(_0x16d1b6?.[_0x57d371(0x19d)]||_0x16d1b6));}}export async function initialize(_0x5b85f8){const _0x49bd74=_0x28272b;if(!_0x5b85f8)throw new Error(_0x49bd74(0x21d)+'nitialize\x20'+_0x49bd74(0x202)+_0x49bd74(0x1be)+'e');botRef=_0x5b85f8,await ensureSchema(),refreshConfig(),startManagedListener({'botRef':botRef,'eventName':_0x49bd74(0x20e)+_0x49bd74(0x228),'handler':upsertHandler,'moduleName':name}),info('['+name+(']\x20initiali'+_0x49bd74(0x1c9)+'alized\x20lis'+_0x49bd74(0x1ae)));}export async function cleanup(){const _0x2cc509=_0x28272b;try{stopManagedListener(name,_0x2cc509(0x20e)+'psert');for(const _0x181c90 of processedKeys[_0x2cc509(0x142)]())try{clearTimeout(_0x181c90);}catch(_0x115444){}processedKeys[_0x2cc509(0x23d)]();}catch(_0x241993){warn(name+(_0x2cc509(0x204)+_0x2cc509(0x16e))+(_0x241993?.[_0x2cc509(0x19d)]||_0x241993));}finally{botRef=null,info(name+(_0x2cc509(0x240)+'p'));}}export default{'name':name,'version':version,'priority':priority,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};