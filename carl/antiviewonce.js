const _0x2914ad=_0x426d;(function(_0x238201,_0x77ea81){const _0x516a7b=_0x426d,_0x747602=_0x238201();while(!![]){try{const _0x55266c=parseInt(_0x516a7b(0x212))/(0xda+-0x2643+0x256a)+parseInt(_0x516a7b(0x238))/(-0x227*-0x7+0x429*0x3+-0x582*0x5)*(-parseInt(_0x516a7b(0x160))/(0xc9*0x4+0x2a+-0x3*0x119))+parseInt(_0x516a7b(0x248))/(0x361*0x4+0x4ce+-0x124e)+parseInt(_0x516a7b(0x215))/(0x47e+0x1*0x1a89+0x36*-0x93)*(-parseInt(_0x516a7b(0x252))/(-0x2c5*-0x7+0xb8*0x32+-0x374d))+parseInt(_0x516a7b(0x152))/(-0xb17+-0x234*-0xe+-0x13ba)*(parseInt(_0x516a7b(0x1bd))/(-0x5c0+0x1b58+0x14*-0x114))+-parseInt(_0x516a7b(0x14d))/(-0x1e54+-0x2107*-0x1+-0x2aa)*(parseInt(_0x516a7b(0x154))/(-0x24c1+-0x511*-0x7+0xa*0x22))+parseInt(_0x516a7b(0x172))/(-0x1e69+-0x2034+0x3ea8);if(_0x55266c===_0x77ea81)break;else _0x747602['push'](_0x747602['shift']());}catch(_0x8dbe2b){_0x747602['push'](_0x747602['shift']());}}}(_0x4baa,-0x529*0x1f0+0x373*0x40f+0x37e4b));import{info,warn,error}from'../utils/logger.js';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{getConfig,hotReloadConfig}from'../utils/config.js';function _0x4baa(){const _0x28abbf=['and','slice','VALUES\x20(?,','rmation\x20ta','_viewonce\x27','quotedMess','fs\x20WHERE\x20k','age\x20with\x20a','xtMessage','once\x20messa','VIEWONCE_A','now','r:\x20','messages.u','\x20ctx.key.r',':\x20reply\x20to','true','\x20that\x20mess','\x20not\x20conta',',\x20notify=','no\x20sendMes','underscore','tener)','\x20\x20\x20);\x0a\x20\x20\x20\x20','psert','AULT\x200\x0a\x20\x20\x20','t\x20supporte','end\x20failed','\x20clear\x20tar','\x20in\x20',']\x20cleanup\x20','unknown\x20ch','value','\x20p|g`\x0a','has','get',']\x20Sent\x20rec','floor','allow_grou',']\x20no\x20desti','concat','D*:\x20`','et*:\x20','at\x20starts\x20','ponseMessa','alized\x20lis','ngs\x20(PM-On','d\x20media\x20ty','140002AfkMsS','wId','set','1753455veKIiI','age','*Notificat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20v','o\x20download','overed\x20doc','ttonId',']\x20download','\x20inner\x20med','ATE\x20SET\x20va','ned\x20false','once\x20inner','ssageV2','OFF','sock','rget\x20-\x20abo','catch','ey=?','üëÅÔ∏è\x20Detected','`\x20`viewonc','\x20in\x20chat\x20','conversati','GET_EQUALS','listRespon',']\x20quoted\x20m','isArray','\x20error:\x20','very.',']\x20ensureSc','mmand\x20erro','*Target\x20JI','ewonce_pre','\x20save\x20noti','INSERT\x20INT',']\x20forwardR','124OhYPep','Recovered\x0a','ue\x20FROM\x20vi','tempt\x20reco','o\x20*','caption','unset','ions*:\x20',']\x20quoted\x20v','e\x20<jid>`\x0a','\x20(mode=','\x0a\x0afrom:\x20','\x20view-once','message\x20th',']\x20handleCo',']\x20Reply\x20st','3654420EjppOc','image','Dest\x20retur','notify_vie','overed\x20vid','exec','urrently\x20*','NTEGER\x20DEF','_jid\x27','D\x20cleared.','6ySMLgP',',\x20allow_gr','BufferFrom','\x20Notificat','wonce','\x20cleaned\x20u','not\x20set','\x20failed\x20fo','viewonce','ore)\x20to\x20at','O\x20viewonce','ed\x20&\x20reloa','dated_at)\x20','error:\x20','18IXDMCw','ey)\x20DO\x20UPD','charAt','unknown\x20us',']\x20failed\x20t','336427BjkwXu','ce_prefs\x20(','1802730Pxyzrt','[viewonce]','includes',']\x20Notified','ge\x20with\x20a\x20',']\x20config\x20r','extendedTe','p_commands','To\x20recover','seMessage','rting\x20comm','essage\x20did','17493kyGvLf','onfig\x20erro','\x20`viewonce','message','group','Content\x20er','toLowerCas','DEFAULT','\x0a\x20\x20\x20\x20\x20\x20CRE','@g.us','Not\x20set',']\x20savePref','video','viewonce.i','contextInf','\x20Mode\x20set\x20','text','sendMessag','4556090QvZQFn','updated_at','\x20save\x20targ','y,value,up',']\x20handleUp','ge\x20to\x20','d\x20unavaila','key','ssage','ed.value,\x20','applicatio','status@bro','2.0.0-patc','ey=\x27target','unknown','*Anti-View','KIP_IF_TAR','alue\x20TEXT\x20','ey=\x27mode\x27',']\x20hotReloa','sertSingle','buttonsRes','some','No\x20target\x20','mode','Configured','participan','ctReply','remoteJid','VIEWONCE_S','olved',']\x20onMessag','IMARY\x20KEY,','endsWith','fromMe','\x20group:\x20','_prefs\x20(ke','\x20‚Äî\x20','\x20the\x20view-','LLOW_GROUP','string','s\x20with*\x20\x27_',':\x20reload\x20a',']\x20getBotJi','run','efreshed','STS\x20viewon','to\x20PM.','selectedRo','gistration','emoteJid','\x20Target\x20JI','_COMMANDS_',']\x20DB\x20ready','\x20set\x20mode.','once\x20Setti','ing\x20recove','able','ot\x20instanc','\x20-\x20attempt','SELECT\x20val',']\x20upsertHa','target_jid','to\x20GROUP.\x20','function','et\x20JID:\x20','\x20from\x20','IF\x20NOT\x20EXI','viewOnceMe','_SOURCE','\x20message','selectedBu','length','ly)*\x0a\x0a','\x20Failed\x20to','16rzXeRD','get\x20JID.','trim','ecoveredTo','hed','indexOf','remove','isViewOnce','rget','\x20notify\x20on','in\x20a\x20view-','arts\x20with\x20',',\x20target=','dated_at\x20I','notify','dConfig\x20re','ng\x20back\x20to','add','ble;\x20falli','lue=exclud','nner\x20is\x20no','d:\x20',']\x20refreshC','videoMessa','delete','ded:\x20','CONFLICT(k','split','\x20\x20\x20\x20\x20\x20\x20\x20up','*Send\x20Targ','singleSele','JID\x20set.','ey\x20TEXT\x20PR','\x0a\x20\x20\x20\x20\x20\x20\x20\x20k','iew-once\x20i','\x20of\x20view-o','imageMessa'];_0x4baa=function(){return _0x28abbf;};return _0x4baa();}import{db}from'../utils/database.js';import{isSudo}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x2914ad(0x25a);export const version=_0x2914ad(0x17e)+_0x2914ad(0x1c1);export const priority=-0x10b6+0x1c*-0x1d+0x1*0x1441;export const commands=[_0x2914ad(0x25a)];export const configKeys=[_0x2914ad(0x18f)+_0x2914ad(0x182)+'GET_EQUALS'+_0x2914ad(0x1b7),'VIEWONCE_A'+_0x2914ad(0x199)+_0x2914ad(0x1a6)+_0x2914ad(0x167)];function _0x426d(_0x1cfc8a,_0x2cbdca){const _0xc27592=_0x4baa();return _0x426d=function(_0x4ec1e9,_0x1b4b5e){_0x4ec1e9=_0x4ec1e9-(0xb68+0x2248*0x1+-0x2c67);let _0x2bd0f0=_0xc27592[_0x4ec1e9];return _0x2bd0f0;},_0x426d(_0x1cfc8a,_0x2cbdca);}let botRef=null,SKIP_IF_TARGET_EQUALS_SOURCE=!![],ALLOW_GROUP_COMMANDS_DEFAULT=![],MODE='p',TARGET_JID=null,ALLOW_GROUP_COMMANDS=ALLOW_GROUP_COMMANDS_DEFAULT,NOTIFY_VIEWONCE=![];function refreshConfig(){const _0x44325e=_0x2914ad;try{const _0x5b838a=getConfig()||{};SKIP_IF_TARGET_EQUALS_SOURCE=_0x5b838a[_0x44325e(0x18f)+_0x44325e(0x182)+_0x44325e(0x22b)+'_SOURCE']!==undefined?Boolean(_0x5b838a['VIEWONCE_S'+_0x44325e(0x182)+_0x44325e(0x22b)+_0x44325e(0x1b7)]):SKIP_IF_TARGET_EQUALS_SOURCE,ALLOW_GROUP_COMMANDS_DEFAULT=Boolean(_0x5b838a[_0x44325e(0x1ec)+_0x44325e(0x199)+_0x44325e(0x1a6)+'DEFAULT']??ALLOW_GROUP_COMMANDS_DEFAULT),info('['+name+(_0x44325e(0x159)+_0x44325e(0x19f)));}catch(_0x5652e7){warn('['+name+(_0x44325e(0x1d3)+_0x44325e(0x161)+_0x44325e(0x1ee))+(_0x5652e7?.[_0x44325e(0x163)]||_0x5652e7));}}try{hotReloadConfig&&hotReloadConfig((_0x1a7b28=[])=>{const _0x5ad570=_0x2914ad,_0x2e3c12=[_0x5ad570(0x18f)+'KIP_IF_TAR'+'GET_EQUALS'+_0x5ad570(0x1b7),_0x5ad570(0x1ec)+_0x5ad570(0x199)+'_COMMANDS_'+_0x5ad570(0x167)];if((_0x1a7b28||[])[_0x5ad570(0x188)](_0x22333b=>_0x2e3c12[_0x5ad570(0x156)](_0x22333b)))refreshConfig();});}catch(_0x5b3ac8){warn('['+name+(_0x2914ad(0x185)+_0x2914ad(0x1cc)+_0x2914ad(0x1a3)+'\x20failed:\x20')+(_0x5b3ac8?.['message']||_0x5b3ac8));}refreshConfig();async function ensureSchema(){const _0x1350ee=_0x2914ad;try{await db[_0x1350ee(0x24d)](_0x1350ee(0x168)+'ATE\x20TABLE\x20'+_0x1350ee(0x1b5)+_0x1350ee(0x1a0)+_0x1350ee(0x153)+_0x1350ee(0x1de)+_0x1350ee(0x1dd)+_0x1350ee(0x192)+_0x1350ee(0x218)+_0x1350ee(0x183)+'NOT\x20NULL,\x0a'+_0x1350ee(0x1d9)+_0x1350ee(0x1ca)+_0x1350ee(0x24f)+_0x1350ee(0x1fb)+_0x1350ee(0x1f9));try{const _0x1501dc=await db[_0x1350ee(0x205)]('SELECT\x20val'+_0x1350ee(0x23a)+_0x1350ee(0x234)+_0x1350ee(0x1e8)+_0x1350ee(0x184));MODE=_0x1501dc?.['value']==='g'?'g':'p';}catch(_0x4c0d69){}try{const _0x5a84ac=await db[_0x1350ee(0x205)](_0x1350ee(0x1ae)+_0x1350ee(0x23a)+'ewonce_pre'+'fs\x20WHERE\x20k'+_0x1350ee(0x17f)+_0x1350ee(0x250));TARGET_JID=_0x5a84ac?.[_0x1350ee(0x202)]||null;}catch(_0x4b9580){TARGET_JID=null;}try{const _0x243db7=await db['get'](_0x1350ee(0x1ae)+_0x1350ee(0x23a)+_0x1350ee(0x234)+_0x1350ee(0x1e8)+'ey=\x27allow_'+'group_comm'+'ands\x27');ALLOW_GROUP_COMMANDS=_0x243db7?.[_0x1350ee(0x202)]==='1';}catch(_0x366561){ALLOW_GROUP_COMMANDS=ALLOW_GROUP_COMMANDS_DEFAULT;}try{const _0x19f36c=await db['get'](_0x1350ee(0x1ae)+_0x1350ee(0x23a)+_0x1350ee(0x234)+_0x1350ee(0x1e8)+'ey=\x27notify'+_0x1350ee(0x1e6));NOTIFY_VIEWONCE=_0x19f36c?.[_0x1350ee(0x202)]==='1';}catch(_0x44a1ae){NOTIFY_VIEWONCE=![];}info('['+name+(_0x1350ee(0x1a7)+_0x1350ee(0x242))+MODE+_0x1350ee(0x1c9)+(TARGET_JID||_0x1350ee(0x23e))+_0x1350ee(0x1f5)+NOTIFY_VIEWONCE+(_0x1350ee(0x253)+'oup_comman'+'ds=')+ALLOW_GROUP_COMMANDS+')');}catch(_0x213c1e){error(_0x213c1e,'['+name+(_0x1350ee(0x231)+'hema\x20faile'+'d'));throw _0x213c1e;}}async function savePref(_0x2d1cb2,_0x3daedb){const _0x44ce1e=_0x2914ad;try{const _0x33362a=Math[_0x44ce1e(0x207)](Date[_0x44ce1e(0x1ed)]()/(-0x1*-0xbc6+-0x13c6+-0x18*-0x7f));await db[_0x44ce1e(0x19e)](_0x44ce1e(0x236)+_0x44ce1e(0x149)+_0x44ce1e(0x196)+_0x44ce1e(0x175)+_0x44ce1e(0x14b)+_0x44ce1e(0x1e4)+'\x20?,\x20?)\x20ON\x20'+_0x44ce1e(0x1d7)+_0x44ce1e(0x14e)+_0x44ce1e(0x21e)+_0x44ce1e(0x1d0)+_0x44ce1e(0x17b)+'updated_at'+'=excluded.'+_0x44ce1e(0x173),[_0x2d1cb2,_0x3daedb,_0x33362a]);}catch(_0x22bfee){return warn('['+name+(_0x44ce1e(0x16b)+':\x20DB\x20write'+_0x44ce1e(0x259)+'r\x20')+_0x2d1cb2+'='+_0x3daedb+_0x44ce1e(0x197)+(_0x22bfee?.['message']||_0x22bfee)),![];}try{const _0x233776=await db[_0x44ce1e(0x205)](_0x44ce1e(0x1ae)+'ue\x20FROM\x20vi'+'ewonce_pre'+_0x44ce1e(0x1e8)+_0x44ce1e(0x226),[_0x2d1cb2]),_0x36cf43=_0x233776?.[_0x44ce1e(0x202)]??_0x3daedb;if(_0x2d1cb2===_0x44ce1e(0x18a))MODE=_0x36cf43==='g'?'g':'p';if(_0x2d1cb2===_0x44ce1e(0x1b0))TARGET_JID=_0x36cf43||null;if(_0x2d1cb2==='allow_grou'+_0x44ce1e(0x15b))ALLOW_GROUP_COMMANDS=_0x36cf43==='1';if(_0x2d1cb2==='notify_vie'+'wonce')NOTIFY_VIEWONCE=_0x36cf43==='1';return info('['+name+(']\x20pref\x20sav'+_0x44ce1e(0x14a)+_0x44ce1e(0x1d6))+_0x2d1cb2+'='+_0x36cf43),!![];}catch(_0x47e1a0){warn('['+name+(_0x44ce1e(0x16b)+_0x44ce1e(0x19c)+'fter\x20write'+_0x44ce1e(0x259)+'r\x20')+_0x2d1cb2+'='+_0x3daedb+_0x44ce1e(0x197)+(_0x47e1a0?.[_0x44ce1e(0x163)]||_0x47e1a0));if(_0x2d1cb2===_0x44ce1e(0x18a))MODE=_0x3daedb==='g'?'g':'p';if(_0x2d1cb2==='target_jid')TARGET_JID=_0x3daedb||null;if(_0x2d1cb2===_0x44ce1e(0x208)+_0x44ce1e(0x15b))ALLOW_GROUP_COMMANDS=_0x3daedb==='1';if(_0x2d1cb2===_0x44ce1e(0x24b)+_0x44ce1e(0x256))NOTIFY_VIEWONCE=_0x3daedb==='1';return!![];}}function normalizeToUserJid(_0xe652e4){const _0x50c394=_0x2914ad;try{if(!_0xe652e4||typeof _0xe652e4!==_0x50c394(0x19a))return _0xe652e4;const _0x415385=_0xe652e4[_0x50c394(0x1c2)]('@');if(_0x415385===-(0xf23*-0x1+-0x25*-0x9+0x1*0xdd7))return _0xe652e4;const _0x4d0895=_0xe652e4['slice'](-0x3*-0x7b9+0x19e6+-0x35*0xed,_0x415385),_0x1a321c=_0xe652e4[_0x50c394(0x1e3)](_0x415385),_0x3214ee=_0x4d0895['indexOf'](':');if(_0x3214ee===-(-0xe*-0x103+0x14b1+-0x22da))return _0xe652e4;return _0x4d0895[_0x50c394(0x1e3)](0x191f+0x2*-0x119b+0xa17,_0x3214ee)+_0x1a321c;}catch(_0x285364){return _0xe652e4;}}async function trySend(_0x4197c3,_0x304e75){const _0x3a3086=_0x2914ad;try{const _0x21e56d=normalizeToUserJid(String(_0x4197c3));if(!_0x21e56d)throw new Error('no\x20send\x20ta'+_0x3a3086(0x1c5));if(typeof botRef?.['sendMessag'+'e']===_0x3a3086(0x1b2)){await botRef['sendMessag'+'e'](_0x21e56d,_0x304e75);return;}if(botRef?.['sock']&&typeof botRef['sock'][_0x3a3086(0x171)+'e']===_0x3a3086(0x1b2)){await botRef[_0x3a3086(0x223)][_0x3a3086(0x171)+'e'](_0x21e56d,_0x304e75);return;}throw new Error(_0x3a3086(0x1f6)+'sage\x20avail'+_0x3a3086(0x1ab));}catch(_0x506c5e){throw _0x506c5e;}}const DEDUPE_TTL_MS=(-0x328*0xa+0xe*0x216+-0x266*-0x1)*(-0x354*-0x2+-0x1*-0x12af+0x156f*-0x1),processedKeys=new Map();function markProcessed(_0x544098){const _0x316061=_0x2914ad;if(!_0x544098)return;if(processedKeys[_0x316061(0x204)](_0x544098))try{clearTimeout(processedKeys['get'](_0x544098));}catch(_0x281a3a){}const _0x187cce=setTimeout(()=>processedKeys[_0x316061(0x1d5)](_0x544098),DEDUPE_TTL_MS);processedKeys[_0x316061(0x214)](_0x544098,_0x187cce);}function isProcessed(_0x40c55f){const _0x4aaec8=_0x2914ad;return _0x40c55f&&processedKeys[_0x4aaec8(0x204)](_0x40c55f);}function extractContextInfo(_0x22667f){const _0x23a9a4=_0x2914ad;if(!_0x22667f||!_0x22667f[_0x23a9a4(0x163)])return null;const _0x25b423=_0x22667f[_0x23a9a4(0x163)];return _0x25b423[_0x23a9a4(0x15a)+'xtMessage']?.[_0x23a9a4(0x16e)+'o']||_0x25b423[_0x23a9a4(0x16e)+'o']||null;}function extractViewOnceInnerFromQuoted(_0x29de6f){const _0x5aaab3=_0x2914ad;if(!_0x29de6f)return null;return _0x29de6f?.['viewOnceMe'+'ssage']?.[_0x5aaab3(0x163)]||_0x29de6f?.[_0x5aaab3(0x1b6)+_0x5aaab3(0x221)]?.[_0x5aaab3(0x163)]||(_0x29de6f[_0x5aaab3(0x1e1)+'ge']?_0x29de6f:null)||(_0x29de6f[_0x5aaab3(0x1d4)+'ge']?_0x29de6f:null)||null;}function getSelfJid(){return getBotJid()||null;}function resolveDestination(_0xc9bd36){const _0x555d8e=getSelfJid();if(MODE==='g'&&TARGET_JID){if(SKIP_IF_TARGET_EQUALS_SOURCE&&TARGET_JID===_0xc9bd36)return _0x555d8e;return TARGET_JID;}return _0x555d8e;}function stripDomain(_0x14d976){const _0x3f9bdf=_0x2914ad;if(!_0x14d976||typeof _0x14d976!==_0x3f9bdf(0x19a))return _0x14d976;const _0x1d58aa=_0x14d976[_0x3f9bdf(0x1c2)]('@');if(_0x1d58aa===-(-0x1743+-0x1*-0x2621+0xedd*-0x1))return _0x14d976;return _0x14d976[_0x3f9bdf(0x1e3)](-0x641*-0x3+0xd5c+-0xab5*0x3,_0x1d58aa);}async function handleUpsertSingle(_0x13ed02){const _0x3ac244=_0x2914ad;try{if(!_0x13ed02||!_0x13ed02[_0x3ac244(0x179)])return;if(_0x13ed02[_0x3ac244(0x179)]?.['remoteJid']===_0x3ac244(0x17d)+'adcast')return;if(Boolean(_0x13ed02[_0x3ac244(0x179)]?.[_0x3ac244(0x194)]))return;const _0x575a4d=String(_0x13ed02['key'][_0x3ac244(0x18e)]||'')+'::'+String(_0x13ed02[_0x3ac244(0x179)]['id']||'');if(isProcessed(_0x575a4d))return;markProcessed(_0x575a4d);const _0x4df2c0=Boolean(_0x13ed02['key']?.[_0x3ac244(0x1c4)]),_0x53953b=Boolean(_0x13ed02['message']?.[_0x3ac244(0x1b6)+_0x3ac244(0x17a)]||_0x13ed02[_0x3ac244(0x163)]?.[_0x3ac244(0x1b6)+_0x3ac244(0x221)]);if(!_0x4df2c0&&!_0x53953b)return;if(!NOTIFY_VIEWONCE)return;const _0x2eef10=_0x13ed02['pushName']||_0x13ed02[_0x3ac244(0x179)]?.[_0x3ac244(0x18c)+'t']||_0x13ed02[_0x3ac244(0x179)]?.[_0x3ac244(0x18e)]||null,_0x3dfe6b=_0x2eef10?stripDomain(String(_0x2eef10)):_0x3ac244(0x180),_0x22a40f=_0x13ed02[_0x3ac244(0x179)]?.['remoteJid']?stripDomain(_0x13ed02['key'][_0x3ac244(0x18e)]):_0x3ac244(0x201)+'at',_0x19732a=resolveDestination(_0x13ed02[_0x3ac244(0x179)]?.[_0x3ac244(0x18e)]);if(!_0x19732a)return;const _0x4a76ae=_0x3ac244(0x227)+_0x3ac244(0x244)+_0x3ac244(0x1b4)+_0x3dfe6b+_0x3ac244(0x229)+_0x22a40f+('.\x0aReply\x20to'+_0x3ac244(0x1f3)+_0x3ac244(0x1e9)+'\x20message\x20t'+'hat\x20*start'+_0x3ac244(0x19b)+'\x27\x20(undersc'+_0x3ac244(0x25b)+_0x3ac244(0x23b)+_0x3ac244(0x230));try{await trySend(_0x19732a,{'text':_0x4a76ae}),info('['+name+(_0x3ac244(0x157)+'\x20')+_0x19732a+(_0x3ac244(0x1e0)+'nce\x20from\x20')+_0x3dfe6b+_0x3ac244(0x1ff)+_0x22a40f);}catch(_0x38210e){warn('['+name+(']\x20notify\x20s'+_0x3ac244(0x1fd)+':\x20')+(_0x38210e?.[_0x3ac244(0x163)]||_0x38210e));}}catch(_0x29f93c){warn('['+name+(_0x3ac244(0x176)+_0x3ac244(0x186)+_0x3ac244(0x22f))+(_0x29f93c?.[_0x3ac244(0x163)]||_0x29f93c));}}async function upsertHandler({messages:_0x5d9087}){const _0x20ca1c=_0x2914ad;try{if(!Array[_0x20ca1c(0x22e)](_0x5d9087))return;for(const _0x75fb7e of _0x5d9087)await handleUpsertSingle(_0x75fb7e);}catch(_0x48586c){warn('['+name+(_0x20ca1c(0x1af)+'ndler\x20erro'+_0x20ca1c(0x1ee))+(_0x48586c?.['message']||_0x48586c));}}async function downloadBufferFromContent(_0x43b565,_0x274413){const _0x450fc8=_0x2914ad;try{if(!_0x43b565||!_0x274413)return null;const _0x54bc1b=await downloadContentFromMessage(_0x43b565,_0x274413);if(!_0x54bc1b)return null;const _0x12688f=[];for await(const _0x5cd72a of _0x54bc1b){_0x12688f['push'](_0x5cd72a);}if(!_0x12688f[_0x450fc8(0x1ba)])return null;return Buffer[_0x450fc8(0x20a)](_0x12688f);}catch(_0x98d58a){return warn('['+name+(_0x450fc8(0x21c)+_0x450fc8(0x254)+_0x450fc8(0x165)+'ror:\x20')+(_0x98d58a?.[_0x450fc8(0x163)]||_0x98d58a)),null;}}async function forwardRecoveredToDest(_0x5878c4,_0x2d3b97,_0x2aa581,_0x22ab05){const _0x12e1d8=_0x2914ad,_0x3f5f96=resolveDestination(_0x2aa581);if(!_0x3f5f96)return warn('['+name+(_0x12e1d8(0x209)+'nation\x20res'+_0x12e1d8(0x190))),![];try{const _0x444b35=_0x5878c4?.[_0x12e1d8(0x1e1)+'ge']?.[_0x12e1d8(0x23d)]||_0x5878c4?.[_0x12e1d8(0x1d4)+'ge']?.[_0x12e1d8(0x23d)]||'',_0x1cbec4=_0x22ab05?stripDomain(_0x22ab05):_0x12e1d8(0x150)+'er',_0x511edd=_0x2aa581?stripDomain(_0x2aa581):_0x12e1d8(0x201)+'at',_0x4e8275=_0x12e1d8(0x243)+_0x1cbec4+_0x12e1d8(0x1ff)+_0x511edd,_0x39c7b3='View-Once\x20'+_0x12e1d8(0x239)+_0x444b35+_0x4e8275;if(_0x5878c4[_0x12e1d8(0x1e1)+'ge'])return await trySend(_0x3f5f96,{'image':_0x2d3b97,'caption':_0x39c7b3}),info('['+name+(_0x12e1d8(0x206)+'overed\x20ima'+_0x12e1d8(0x177))+_0x3f5f96),!![];if(_0x5878c4[_0x12e1d8(0x1d4)+'ge']){const _0x3fe575=Boolean(_0x5878c4[_0x12e1d8(0x1d4)+'ge']?.['gifPlaybac'+'k']);return await trySend(_0x3f5f96,{'video':_0x2d3b97,'caption':_0x39c7b3,'gifPlayback':_0x3fe575}),info('['+name+(']\x20Sent\x20rec'+_0x12e1d8(0x24c)+'eo\x20to\x20')+_0x3f5f96),!![];}return await trySend(_0x3f5f96,{'document':_0x2d3b97,'fileName':'recovered.'+'bin','mimetype':_0x12e1d8(0x17c)+'n/octet-st'+'ream','caption':_0x39c7b3}),info('['+name+(_0x12e1d8(0x206)+_0x12e1d8(0x21a)+'ument\x20to\x20')+_0x3f5f96),!![];}catch(_0x515cb4){return warn('['+name+(_0x12e1d8(0x237)+_0x12e1d8(0x1c0)+'Dest\x20faile'+_0x12e1d8(0x1d2))+(_0x515cb4?.[_0x12e1d8(0x163)]||_0x515cb4)),![];}}function extractTextFromCtx(_0x29daeb){const _0x19a812=_0x2914ad;if(!_0x29daeb||!_0x29daeb['message'])return'';const _0x59e0cb=_0x29daeb[_0x19a812(0x163)];return _0x59e0cb[_0x19a812(0x22a)+'on']||_0x59e0cb['extendedTe'+_0x19a812(0x1ea)]?.[_0x19a812(0x170)]||_0x59e0cb[_0x19a812(0x1e1)+'ge']?.['caption']||_0x59e0cb[_0x19a812(0x1d4)+'ge']?.[_0x19a812(0x23d)]||'';}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0x85*-0x43+-0xa78+-0x1839*0x1)*(0x2425+-0x10b*-0x2+0xb71*-0x3);function markCmdProcessed(_0x3a83b7){const _0xa343ee=_0x2914ad;if(!_0x3a83b7)return;if(processedCmdKeys[_0xa343ee(0x204)](_0x3a83b7))try{clearTimeout(processedCmdKeys[_0xa343ee(0x205)](_0x3a83b7));}catch(_0x4c45bc){};const _0x32c0a6=setTimeout(()=>processedCmdKeys['delete'](_0x3a83b7),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0xa343ee(0x214)](_0x3a83b7,_0x32c0a6);}function isCmdProcessed(_0xefa64d){const _0x480d03=_0x2914ad;return _0xefa64d&&processedCmdKeys[_0x480d03(0x204)](_0xefa64d);}const recentResponded=new Set();export async function onMessage(_0x1da856){const _0x2a656c=_0x2914ad;try{if(!_0x1da856||!_0x1da856[_0x2a656c(0x179)]||!_0x1da856[_0x2a656c(0x163)])return;const _0x596e96=_0x1da856[_0x2a656c(0x179)]?.['id']||null;if(_0x596e96){if(recentResponded['has'](_0x596e96))return;recentResponded[_0x2a656c(0x1ce)](_0x596e96),setTimeout(()=>recentResponded[_0x2a656c(0x1d5)](_0x596e96),(-0x4ff+0x22c2+-0x1d87*0x1)*(-0x13*0x2c+-0x178*-0x1+0x5b4));}if(_0x1da856['isCommand']){const _0x113fb4=_0x1da856[_0x2a656c(0x179)][_0x2a656c(0x18e)],_0x5e1279=typeof _0x113fb4===_0x2a656c(0x19a)&&_0x113fb4['endsWith']('@g.us');if(_0x5e1279&&!ALLOW_GROUP_COMMANDS){}else{const _0x277bbb=Boolean(_0x1da856['key']['fromMe']);if(!_0x5e1279&&!_0x277bbb){const _0x31ed90=await isSudo(botRef,_0x1da856)[_0x2a656c(0x225)](()=>![]);if(!_0x31ed90){}else await handleCommand(_0x1da856)[_0x2a656c(0x225)](_0x426151=>warn('['+name+(']\x20command\x20'+_0x2a656c(0x14c))+(_0x426151?.[_0x2a656c(0x163)]||_0x426151)));}else{const _0x945dba=await isSudo(botRef,_0x1da856)['catch'](()=>![]),_0x5406ab=Boolean(_0x1da856[_0x2a656c(0x179)][_0x2a656c(0x194)]);(_0x5406ab||_0x945dba)&&await handleCommand(_0x1da856)[_0x2a656c(0x225)](_0x189f1c=>warn('['+name+(']\x20command\x20'+_0x2a656c(0x14c))+(_0x189f1c?.['message']||_0x189f1c)));}}}const _0x4eda87=extractContextInfo(_0x1da856);if(!_0x4eda87||!_0x4eda87[_0x2a656c(0x1e7)+_0x2a656c(0x216)])return;const _0x409760=extractTextFromCtx(_0x1da856)||'';if(!_0x409760)return;const _0x38c5fd=_0x409760[_0x2a656c(0x1bf)]()[_0x2a656c(0x14f)](0x2426+-0x1c84+-0x7a2);if(_0x38c5fd!=='_')return;info('['+name+(_0x2a656c(0x247)+_0x2a656c(0x1c8)+_0x2a656c(0x1f7)+_0x2a656c(0x1ad)+_0x2a656c(0x1aa)+'ry'));const _0xc3d025=extractViewOnceInnerFromQuoted(_0x4eda87[_0x2a656c(0x1e7)+'age']);if(!_0xc3d025){warn('['+name+(_0x2a656c(0x22d)+_0x2a656c(0x15f)+_0x2a656c(0x1f4)+_0x2a656c(0x1c7)+_0x2a656c(0x220)+_0x2a656c(0x1b8)));return;}let _0x45b21c=null,_0x2374ca=null;if(_0xc3d025[_0x2a656c(0x1e1)+'ge'])_0x45b21c=_0xc3d025[_0x2a656c(0x1e1)+'ge'],_0x2374ca=_0x2a656c(0x249);else _0xc3d025[_0x2a656c(0x1d4)+'ge']&&(_0x45b21c=_0xc3d025[_0x2a656c(0x1d4)+'ge'],_0x2374ca=_0x2a656c(0x16c));if(!_0x45b21c||!_0x2374ca){warn('['+name+(_0x2a656c(0x240)+_0x2a656c(0x1df)+_0x2a656c(0x1d1)+_0x2a656c(0x1fc)+_0x2a656c(0x211)+'pe'));return;}const _0x50ea39=await downloadBufferFromContent(_0x45b21c,_0x2374ca);if(!_0x50ea39){warn('['+name+(_0x2a656c(0x151)+_0x2a656c(0x219)+_0x2a656c(0x21d)+'ia\x20buffer'));return;}const _0x48f150=_0x1da856[_0x2a656c(0x179)][_0x2a656c(0x18e)]||null,_0x5b6c27=_0x4eda87[_0x2a656c(0x18c)+'t']||null,_0x418670=await forwardRecoveredToDest(_0xc3d025,_0x50ea39,_0x48f150,_0x5b6c27);if(!_0x418670)warn('['+name+(']\x20forwardR'+'ecoveredTo'+_0x2a656c(0x24a)+_0x2a656c(0x21f)));}catch(_0xa72be){error(_0xa72be,'['+name+(_0x2a656c(0x191)+'e\x20handler\x20'+_0x2a656c(0x14c))+(_0xa72be?.[_0x2a656c(0x163)]||_0xa72be));}}async function handleCommand(_0x217ae4){const _0xa68ee4=_0x2914ad;try{if(!_0x217ae4||!_0x217ae4[_0xa68ee4(0x179)]||!_0x217ae4['message'])return;const _0xe5094=_0x217ae4[_0xa68ee4(0x179)][_0xa68ee4(0x18e)],_0x2b8606=typeof _0xe5094===_0xa68ee4(0x19a)&&_0xe5094[_0xa68ee4(0x193)](_0xa68ee4(0x169));if(_0x2b8606&&!ALLOW_GROUP_COMMANDS)return;const _0x3746de=Boolean(_0x217ae4['key'][_0xa68ee4(0x194)]);if(!_0x2b8606&&!_0x3746de){const _0x328b32=await isSudo(botRef,_0x217ae4)[_0xa68ee4(0x225)](()=>![]);if(!_0x328b32)return;}const _0x248a21=Boolean(_0x217ae4['key']['fromMe']),_0x50d156=await isSudo(botRef,_0x217ae4)[_0xa68ee4(0x225)](()=>![]);let _0x294d35;if(_0x248a21)_0x294d35=getBotJid()||_0x217ae4[_0xa68ee4(0x179)]['remoteJid']||_0x217ae4[_0xa68ee4(0x179)][_0xa68ee4(0x18c)+'t']||null,!_0x294d35&&(warn('['+name+(_0xa68ee4(0x19d)+_0xa68ee4(0x178)+_0xa68ee4(0x1cf)+_0xa68ee4(0x1cd)+_0xa68ee4(0x1f0)+_0xa68ee4(0x1a4))),_0x294d35=_0x217ae4['key'][_0xa68ee4(0x18e)]||null);else{if(_0x50d156)_0x294d35=_0x217ae4[_0xa68ee4(0x179)]['remoteJid'];else return;}if(!_0x294d35){warn('['+name+(']\x20no\x20confi'+_0xa68ee4(0x1e5)+_0xa68ee4(0x224)+_0xa68ee4(0x15e)+_0xa68ee4(0x1e2)));return;}const _0x3caf26=String(_0x217ae4[_0xa68ee4(0x179)][_0xa68ee4(0x18e)]||'')+'::'+String(_0x217ae4[_0xa68ee4(0x179)]['id']||_0x217ae4['key'][_0xa68ee4(0x18c)+'t']||'');if(isCmdProcessed(_0x3caf26))return;markCmdProcessed(_0x3caf26);const _0x5d1008=typeof _0x217ae4['text']===_0xa68ee4(0x19a)&&_0x217ae4[_0xa68ee4(0x170)][_0xa68ee4(0x1bf)]()['length']?_0x217ae4['text'][_0xa68ee4(0x1bf)]():function _0xec654f(_0x4b981f){const _0x5eccdc=_0xa68ee4;if(!_0x4b981f||!_0x4b981f['message'])return'';const _0x5bd466=_0x4b981f['message'];if(_0x5bd466[_0x5eccdc(0x22a)+'on'])return _0x5bd466[_0x5eccdc(0x22a)+'on'];if(_0x5bd466['extendedTe'+_0x5eccdc(0x1ea)]?.[_0x5eccdc(0x170)])return _0x5bd466['extendedTe'+_0x5eccdc(0x1ea)][_0x5eccdc(0x170)];if(_0x5bd466[_0x5eccdc(0x1e1)+'ge']?.['caption'])return _0x5bd466[_0x5eccdc(0x1e1)+'ge'][_0x5eccdc(0x23d)];if(_0x5bd466[_0x5eccdc(0x1d4)+'ge']?.[_0x5eccdc(0x23d)])return _0x5bd466[_0x5eccdc(0x1d4)+'ge'][_0x5eccdc(0x23d)];if(_0x5bd466[_0x5eccdc(0x187)+_0x5eccdc(0x20e)+'ge']?.[_0x5eccdc(0x1b9)+_0x5eccdc(0x21b)])return _0x5bd466[_0x5eccdc(0x187)+'ponseMessa'+'ge'][_0x5eccdc(0x1b9)+_0x5eccdc(0x21b)];if(_0x5bd466[_0x5eccdc(0x22c)+'seMessage']?.[_0x5eccdc(0x1db)+'ctReply']?.[_0x5eccdc(0x1a2)+_0x5eccdc(0x213)])return _0x5bd466[_0x5eccdc(0x22c)+_0x5eccdc(0x15d)][_0x5eccdc(0x1db)+_0x5eccdc(0x18d)]['selectedRo'+_0x5eccdc(0x213)];return'';}(_0x217ae4)||'';if(!_0x5d1008)return;const _0x1fe604=(_0x5d1008[_0xa68ee4(0x1d8)](/\r?\n/)[-0x4a7*0x1+0x11d8+0xd31*-0x1]||'')[_0xa68ee4(0x1bf)](),_0x39284d=_0x1fe604[_0xa68ee4(0x1d8)](/\s+/),_0x3b07bf=(_0x39284d[-0x1346*0x2+-0x1b61+0x41ed]||'')[_0xa68ee4(0x166)+'e']();if(!commands[_0xa68ee4(0x156)](_0x3b07bf))return;const _0x3c22fb=(_0x39284d[0x74b*0x5+-0x259d+0x127*0x1]||'')['toLowerCas'+'e']();if(_0x3c22fb===_0xa68ee4(0x1cb)){const _0xdfccf=(_0x39284d[-0x223*-0xa+0x21d*-0x4+0xe*-0xec]||'')['toLowerCas'+'e']();if(!_0xdfccf){await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+_0xa68ee4(0x255)+'ions\x20are\x20c'+_0xa68ee4(0x24e)+(NOTIFY_VIEWONCE?'ON':_0xa68ee4(0x222))+'*'});return;}const _0x4977e3=_0xdfccf==='on'||_0xdfccf==='1'||_0xdfccf===_0xa68ee4(0x1f2),_0x1780e8=await savePref('notify_vie'+_0xa68ee4(0x256),_0x4977e3?'1':'0');if(!_0x1780e8){await trySend(_0x294d35,{'text':'[viewonce]'+_0xa68ee4(0x1bc)+_0xa68ee4(0x235)+'fications\x20'+'setting.'});return;}await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+'\x20Notificat'+'ions\x20set\x20t'+_0xa68ee4(0x23c)+(_0x4977e3?'ON':'OFF')+'*'});return;}if(_0x3c22fb==='p'||_0x3c22fb==='pm'){const _0x1124d8=await savePref(_0xa68ee4(0x18a),'p');if(!_0x1124d8){await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+_0xa68ee4(0x1bc)+_0xa68ee4(0x1a8)});return;}await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+_0xa68ee4(0x16f)+_0xa68ee4(0x1a1)});return;}if(_0x3c22fb==='g'||_0x3c22fb===_0xa68ee4(0x164)||_0x3c22fb==='gp'){const _0xf410e1=await savePref(_0xa68ee4(0x18a),'g');if(!_0xf410e1){await trySend(_0x294d35,{'text':'[viewonce]'+'\x20Failed\x20to'+_0xa68ee4(0x1a8)});return;}const _0x4887bf=TARGET_JID?_0xa68ee4(0x18b)+_0xa68ee4(0x195)+TARGET_JID:_0xa68ee4(0x189)+_0xa68ee4(0x1dc);await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+'\x20Mode\x20set\x20'+_0xa68ee4(0x1b1)+_0x4887bf});return;}if(_0x3c22fb&&_0x3c22fb[_0xa68ee4(0x156)]('@')){const _0x2f681d=normalizeToUserJid(_0x3c22fb),_0x425b93=await savePref(_0xa68ee4(0x1b0),_0x2f681d);if(_0x425b93)await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+_0xa68ee4(0x1a5)+'D\x20saved:\x20'+_0x2f681d});else await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+_0xa68ee4(0x1bc)+_0xa68ee4(0x174)+_0xa68ee4(0x1b3)+_0x2f681d});return;}if(_0x3c22fb==='clear'||_0x3c22fb===_0xa68ee4(0x23e)||_0x3c22fb===_0xa68ee4(0x1c3)){const _0x571a60=await savePref('target_jid','');if(_0x571a60)await trySend(_0x294d35,{'text':'[viewonce]'+_0xa68ee4(0x1a5)+_0xa68ee4(0x251)});else await trySend(_0x294d35,{'text':_0xa68ee4(0x155)+_0xa68ee4(0x1bc)+_0xa68ee4(0x1fe)+_0xa68ee4(0x1be)});return;}const _0x11fd20=MODE==='g'?'GROUP\x20('+(TARGET_JID||_0xa68ee4(0x258))+')':'PM';await trySend(_0x294d35,{'text':_0xa68ee4(0x181)+_0xa68ee4(0x1a9)+_0xa68ee4(0x210)+_0xa68ee4(0x1bb)+(_0xa68ee4(0x217)+_0xa68ee4(0x23f)+(NOTIFY_VIEWONCE?'ON':_0xa68ee4(0x222))+(_0xa68ee4(0x162)+_0xa68ee4(0x1c6)+'|off`\x0a'))+(_0xa68ee4(0x1da)+_0xa68ee4(0x20c)+_0x11fd20+(_0xa68ee4(0x162)+_0xa68ee4(0x203)))+(_0xa68ee4(0x233)+_0xa68ee4(0x20b)+(TARGET_JID||_0xa68ee4(0x16a))+(_0xa68ee4(0x228)+_0xa68ee4(0x241)))+(_0xa68ee4(0x15c)+_0xa68ee4(0x1f1)+_0xa68ee4(0x198)+_0xa68ee4(0x1eb)+_0xa68ee4(0x158)+_0xa68ee4(0x245)+_0xa68ee4(0x20d)+'with\x20\x27_\x27\x20('+'underscore'+').')});}catch(_0x5a416a){warn('['+name+(_0xa68ee4(0x246)+_0xa68ee4(0x232)+_0xa68ee4(0x1ee))+(_0x5a416a?.['message']||_0x5a416a));}}export async function initialize(_0x1a4762){const _0x147e30=_0x2914ad;if(!_0x1a4762)throw new Error(_0x147e30(0x16d)+'nitialize\x20'+'requires\x20b'+_0x147e30(0x1ac)+'e');botRef=_0x1a4762,await ensureSchema(),refreshConfig(),startManagedListener({'botRef':botRef,'eventName':_0x147e30(0x1ef)+'psert','handler':upsertHandler,'moduleName':name}),info('['+name+(']\x20initiali'+'zed\x20(centr'+_0x147e30(0x20f)+_0x147e30(0x1f8)));}export async function cleanup(){const _0x50883d=_0x2914ad;try{stopManagedListener(name,'messages.u'+_0x50883d(0x1fa));for(const _0x23d4f9 of processedKeys['values']())try{clearTimeout(_0x23d4f9);}catch(_0x404edb){}processedKeys['clear']();}catch(_0x3cb5f8){warn(name+(_0x50883d(0x200)+_0x50883d(0x14c))+(_0x3cb5f8?.[_0x50883d(0x163)]||_0x3cb5f8));}finally{botRef=null,info(name+(_0x50883d(0x257)+'p'));}}export default{'name':name,'version':version,'priority':priority,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};