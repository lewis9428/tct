const _0x251909=_0x5a89;(function(_0x100145,_0x4cb76a){const _0x2d7d93=_0x5a89,_0x398d5f=_0x100145();while(!![]){try{const _0x28c605=-parseInt(_0x2d7d93(0x222))/(0x7*0x593+0x3de+-0x2ae2)*(-parseInt(_0x2d7d93(0x30e))/(-0x14f5+0x6e2+0xe15))+parseInt(_0x2d7d93(0x359))/(0x26d9+-0x2419+-0x2bd)+-parseInt(_0x2d7d93(0x206))/(-0x14c5+0x2193+-0xcca)+-parseInt(_0x2d7d93(0x234))/(-0x21e*0x5+-0xf2d+0x19c8)+-parseInt(_0x2d7d93(0x1bc))/(0x1*-0xe2f+-0xa18+0x184d*0x1)+-parseInt(_0x2d7d93(0x1b1))/(0xa*-0xc3+0x191b+-0x1176)+-parseInt(_0x2d7d93(0x362))/(0x1b99+0x90d*0x1+0x6d*-0x56)*(-parseInt(_0x2d7d93(0x1c3))/(-0x21b0+0xd55*-0x1+0x2f0e));if(_0x28c605===_0x4cb76a)break;else _0x398d5f['push'](_0x398d5f['shift']());}catch(_0x5e1f35){_0x398d5f['push'](_0x398d5f['shift']());}}}(_0x13a0,0x6d68f*0x1+0x796cc+-0x4ed0f));import _0x1b8032 from'path';import _0x314ba2 from'fs';import{mkdirSync}from'fs';import{rm as _0x516618}from'fs/promises';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import _0x4fe2d5 from'node-cache';function _0x13a0(){const _0xf996b7=['sender','COVERED*\x20🗑','ET\x20value=e','singleSele','\x20DELETED\x20M','[delete]\x20M','d\x20config.','ded.value,','etchOrigin','ANUP_DAYS','ble.','pollCreati','refs\x20(key,','function','write','\x20NULL,\x0a\x20\x20\x20','vered\x20send','MODULE_CON','ule\x20requir','*Delete\x20Re','messages.','seMessage','uded.updat','type','emove\x20file','msg_id','OUNCE_MS','t=excluded','estamp','arget_jid\x27','notify','mentions','Days:\x20','efreshConf','\x20remote_al','t\x20JID.','am)\x20sent\x20f','adcast','es\x20bot\x20arg','EXISTS\x20mes','dMessages\x20','d\x20retry','s\x20WHERE\x20ms','\x20—\x20ensurin','ue\x20FROM\x20de','RY\x20KEY','aveDeleteT','PRAGMA\x20tab','protocolMe','[no-id]','item\x20error','ctReply','ed:\x20','ptt','[delete]\x20F','CLEANUP_IN','ESSAGES\x20RE','push','pm\x20\x20\x20\x20\x20\x20\x20-','RAGMA\x20tabl','delete','SELECT\x20med','\x20group:\x20','ed\x20due\x20mis','y\x20to\x20owner','ble','ailed\x20to\x20c','no\x20send\x20ta','covery\x20Set','seconds','map','Message','exec','statSync','nitial\x20cle','\x20failed','DEFAULT_CO','error:\x20','or\x20for\x20','name','D_DELETE\x20f','audio','mimetype','FF_MS','JID\x20set;\x20w','[Audio]','ecovered\x20m','pop','mapping\x20fa','GROUP\x20(','ges\x20(older','message_js','r:\x20','ia_path,\x20s','\x20Recovery\x20','redBatch\x20e',',\x20?,\x20?,\x20?,','on\x20LIKE\x20?\x20','includes','isArray','FROM\x20messa','psert','O\x20delete_p','\x20days*','8SKcSvV','CURRENCY_L','d).\x20Leavin','ges\x20WHERE\x20','\x20old\x20messa','M\x20messages','[Delete]\x20s','geToDB\x20fai','has','slice','[Delete]\x20d','lush\x20loop\x20','\x20delete\x20<j','PROJECT_RO','IA_SEND_DE','split','eliver\x20med','stickerMes','[Delete]\x20f','IA_DIRNAME','mediaPath','[Sticker]','aybeSaveMe','VALUES\x20(\x27t','nMessage\x20e','bin','floor','4.2.0','leanup\x20err','_id,\x20media','er\x20item\x20er','\x20WHERE\x20msg','Stream','_path,\x20sav','[Delete]\x20r','CREATE\x20TAB','xtMessage','ot\x20JID\x20is\x20','aveDeleteM','value','join','bParameter','ToFile\x20fai','eletionWor','zation\x20fai','ode\x20failed','audioMessa','->\x20set\x20tar','overed\x20to\x20','rocessMess',':\x20*','cleared','ailed\x20to\x20r','failed:\x20','\x20delete\x20g|','tration\x20fa','R\x20DEFAULT\x20','ig\x20error:\x20','ptv','messages.u','alse\x20—\x20ski','ck\x20to\x20bot\x20','try/cleanu','_id=?','.\x20Mode:\x20','stream\x20fal','ailed\x20to\x20a','TERVAL_MS','[Delete]\x20D','[Delete]\x20c','messageStu','ed\x20media\x20f','cipant_alt','pdf','riginal\x20fo','1526712lRCwXC','lushRecove','GROUP','msg_id=?','d\x20unexpect',')\x20ON\x20CONFL','awMessages','[Voice\x20not','nsureTable','88ssumif','catch','size','et_jid\x27','CURRENCY','ttonId','eleted\x20mes','edia\x20(stre','mp4','nfig\x20regis','all','ode\x27,\x20?,\x20?','load\x20faile','MEDIA_DIRN','ES\x20(?,\x20?,\x20','[Unknown\x20G','*Current\x20S','0\x0a\x20\x20\x20\x20);','Configured','[Delete]\x20p',')\x20load\x20fai','ed\x20message','image','EFAULT_SEN','leaning\x20','_at\x20INTEGE','saved:\x20','repeat','plete.','ponseMessa','document','📝\x20Content:','alMessage\x20','clear','lear\x20targe','find','er\x20legacy-','fromMe','\x20chat_jid,','imageMessa','ile','forward\x20fa','.updated_a','[Delete]\x20m','roup]','ALTER\x20TABL','essageWork','LE\x20IF\x20NOT\x20','createWrit','drain','\x20(all\x20atte','ler\x20error:','messageTim','ageItem\x20er','arget\x20fail','e_info\x20fai','originalMe','SELECT\x20val','TIAL_BACKO','once','7281204vZCrmD','status','INSERT\x20OR\x20','[Delete]\x20P','now','REPLACE\x20IN','indexOf','\x20to\x20','media','get\x20availa','forwarded\x20','4518882qcudrz','edia_path,','isCommand','geToDB:\x20mi','createRead','existsSync','[Delete]\x20h','1927818VSXIKM','_DELAY_MS','set','bot\x20PM\x0a','er\x20stream-','rwarded\x20fo','anup\x20error','extendedTe','No\x20persist','ode\x20set\x20to','ting\x20file\x20','saved_at','\x20PM.\x20Recov','overy','refs\x20(mode','cleared.\x20W','eStream','afe\x20error:','nable\x20to\x20d','VALUES\x20(\x27m','arget\x20JID\x20','SELECT\x20msg','dMessagesS','g_id=?','\x20ADD\x20COLUM','not\x20availa','annot\x20repl','url\x20form)\x20','jid,\x20parti','xcluded.va','videoMessa','ICT(key)\x20D','\x20\x20\x20\x20\x20\x20VALU','led\x20for\x20','ETRIES','->\x20send\x20re','ror:\x20','conversati','@lid','onWhatsApp','content','toLowerCas','IMIT','led:\x20','_id\x20IN\x20(','sages\x20(\x0a\x20\x20','ummary\x20sen','MEDIA_SEND','pping\x20reco','ave\x20target','participan','lete_prefs','[Delete]\x20C','emoved\x20sav','jid','ed_at=excl','DELETE_INI','ile-send\x20(','group\x20\x20\x20\x20\x20','add','ge_json,\x20m','LIMIT\x201','nsert\x20fail','Active:\x20*','JID\x0a','\x20?)','message','887344MZtHGk','send\x20faile','number','stringify','ailed\x20dele','g\x20in\x20DB\x20fo','finish','T\x20NULL\x20AND','stamp,\x20med','\x20WHERE\x20key','to\x20bot\x20PM.','👤\x20From:\x20@','ear\x20\x20\x20\x20\x20\x20\x20','ssage','alue=exclu','fileName','o\x20bot\x20PM\x20u','ecovered\x20o','[Delete]\x20l','end','MAX_SEND_R','dated_at)\x20','DEFAULT_SE','d:\x20','e\x20TEXT\x20NOT','rocessDele','DELETE\x20FRO','run','163663qAAKTk','aved_at,\x20r','covered\x20to','DELETE_CLE','[delete]\x20T','\x20is\x20empty','keys','sock','sing\x20colum','filter','selectedBu','ode\x20saved:','id>\x20\x20\x20\x20\x20\x20\x20','\x20saved_at\x20','DELETE_DEB','_SEND_RETR','\x20->\x20','unset','4409775pgISBz','=\x27target_j','AME','DATE\x20SET\x20v','ptvMessage','ng\x20column\x20','selectedRo','DELETE_CON','🗑\x20*','splice','DELETE_MED','DEBOUNCE_M','media_path','ot-reloade','text','ete_prefs\x20','EXISTS\x20del','nWhatsApp\x20','\x20delete\x20p|','able','ill\x20send\x20t','buttonsRes','\x20messages\x20','parse','led\x20fatall','jpg','sendMessag','fter:\x20*','key','IA_DIR','error\x20for\x20','\x20updated_a','umn','d_at\x20IS\x20NO','sage','\x20GROUP.\x20','rror:\x20','esent_at)\x0a','INSERT\x20INT','t\x20failed:\x20','rget\x20avail','[Delete]\x20o','groupMetad','y:\x20','nsertMessa','wId','[Delete]\x20i','[Delete]\x20t','M\x20delete_p','documentMe','onMessageV','arget_jid\x20','length','shift','B\x20initiali','end\x20attemp','INTEGER','mpts\x20faile','get','\x20value,\x20up','failed\x20for','low','utoCleanOl','entries','ode\x27,\x27p\x27,\x20','leanup\x20aft','caption','remoteJid','n:\x20','ND_DELETE','TEXT','\x20GROUP\x20mod','MARY\x20KEY,\x0a','ntil\x20confi','endsWith','lue,\x20updat','tatus:*\x0a','Usage:\x0a','[Delete]\x20u','er\x20send\x20fa','INITIAL_BA','\x20failed:\x20','[Poll:\x20','iled:\x20','trim','ed\x20error:\x20','s\x20(msg_id,','basename','[Delete]\x20I','tings\x20(PM-','string','treamMedia','gifPlaybac','Only)*\x0a\x0a','lback)\x20err','CKOFF_MS','[Delete]\x20e','\x20\x20\x20updated','NCURRENCY','sticker','aved\x20file\x20','boolean','\x20key=\x27targ','CLEANUP_DA','\x20\x20\x20\x20\x20\x20valu','delete-rec','ed_at\x20FROM','\x20days)','[Delete]\x20a','->\x20clear\x20t','🗨\x20Group:\x20','group','\x20because\x20b',',\x20?,\x20?)\x20ON'];_0x13a0=function(){return _0xf996b7;};return _0x13a0();}import{isSudo}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x251909(0x29d)+_0x251909(0x1d0);export const version=_0x251909(0x329);export const priority=-0x7*-0x35b+0x1*0xcd7+-0x2422;export const commands=['delete'];export const configKeys=[_0x251909(0x23e)+_0x251909(0x321),_0x251909(0x230)+_0x251909(0x2c0),_0x251909(0x23b)+_0x251909(0x366),_0x251909(0x21c)+_0x251909(0x279),_0x251909(0x225)+_0x251909(0x2af),_0x251909(0x225)+'ANUP_INTER'+'VAL_MS'];const FALLBACKS={'DEBOUNCE_MS':0xbb8,'MEDIA_DIRNAME':_0x251909(0x1b9),'DEFAULT_CONCURRENCY':0x3,'CLEANUP_INTERVAL_MS':(0xb62*-0x3+-0x370+0x259c)*(0x578+0x288+-0x7c4)*(0xf1*0x26+0x23cd+0x7*-0xa31)*(-0x1ccf*0x1+0x7f*-0x7+0x2430),'MEDIA_SEND_DELAY_MS':0x12c,'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4,'CLEANUP_DAYS':0x3};let botRef=null,cleanupInterval=null;const messageQueue=[],deletionQueue=[];let activeMessageTasks=0x361+0x2384+0x3*-0xcf7,activeDeletionTasks=0x1d93*0x1+0x1*0x2e+-0x1dc1,MEDIA_DIR=null,DEBOUNCE_DELAY_MS=FALLBACKS['DEBOUNCE_M'+'S'],CONCURRENCY=FALLBACKS[_0x251909(0x2f2)+'NCURRENCY'],MEDIA_SEND_DELAY_MS=FALLBACKS[_0x251909(0x1f2)+_0x251909(0x1c4)],CLEANUP_INTERVAL=FALLBACKS[_0x251909(0x2dd)+_0x251909(0x351)],MAX_SEND_RETRIES=FALLBACKS[_0x251909(0x21a)+_0x251909(0x1e5)],INITIAL_BACKOFF=FALLBACKS['INITIAL_BA'+_0x251909(0x293)],DELETE_CLEANUP_DAYS=FALLBACKS[_0x251909(0x29b)+'YS'],DEFAULT_SEND_DELETE=![],DELETE_MODE='p',TARGET_JID=null;const nameCache=new _0x4fe2d5({'stdTTL':0xe10});let flushTimer=null;const pendingRecovered=[];function ensureDirSync(_0x12be77){const _0xba3665=_0x251909;if(!_0x314ba2[_0xba3665(0x1c1)](_0x12be77))mkdirSync(_0x12be77,{'recursive':!![]});}function sleep(_0x247334){return new Promise(_0x5086ac=>setTimeout(_0x5086ac,_0x247334));}function normalizeToUserJid(_0x870c90){const _0x23cb6f=_0x251909;try{if(!_0x870c90||typeof _0x870c90!==_0x23cb6f(0x28e))return _0x870c90;const _0x119ca3=_0x870c90['indexOf']('@');if(_0x119ca3===-(0x169*0x2+0x1*0x17d7+0x1aa8*-0x1))return _0x870c90;const _0x5cd20b=_0x870c90[_0x23cb6f(0x317)](0x2352+-0x214+-0x109f*0x2,_0x119ca3),_0x4eaae0=_0x870c90[_0x23cb6f(0x317)](_0x119ca3),_0x1d3c98=_0x5cd20b[_0x23cb6f(0x1b7)](':');if(_0x1d3c98===-(0x13f+-0x1*0xd49+0xc0b))return _0x870c90;return _0x5cd20b[_0x23cb6f(0x317)](0x2b*-0xdb+-0x28c+0x2755,_0x1d3c98)+_0x4eaae0;}catch(_0x2eba71){return _0x870c90;}}function refreshConfig(){const _0x2e8bd6=_0x251909;try{const _0x3a1dde=getConfig()||{};DEFAULT_SEND_DELETE=typeof _0x3a1dde[_0x2e8bd6(0x21c)+_0x2e8bd6(0x279)]===_0x2e8bd6(0x299)?_0x3a1dde[_0x2e8bd6(0x21c)+_0x2e8bd6(0x279)]:DEFAULT_SEND_DELETE,DEBOUNCE_DELAY_MS=Number(_0x3a1dde['DELETE_DEB'+_0x2e8bd6(0x2c0)]??FALLBACKS[_0x2e8bd6(0x23f)+'S']),CONCURRENCY=Number(_0x3a1dde[_0x2e8bd6(0x23b)+_0x2e8bd6(0x366)]??_0x3a1dde[_0x2e8bd6(0x2b7)+_0x2e8bd6(0x30f)+_0x2e8bd6(0x1ed)]??FALLBACKS[_0x2e8bd6(0x2f2)+_0x2e8bd6(0x296)]),MEDIA_SEND_DELAY_MS=Number(_0x3a1dde[_0x2e8bd6(0x23e)+_0x2e8bd6(0x31c)+'LAY_MS']??FALLBACKS[_0x2e8bd6(0x1f2)+_0x2e8bd6(0x1c4)]),CLEANUP_INTERVAL=Number(_0x3a1dde[_0x2e8bd6(0x225)+'ANUP_INTER'+'VAL_MS']??FALLBACKS[_0x2e8bd6(0x2dd)+'TERVAL_MS']),MAX_SEND_RETRIES=Number(_0x3a1dde['DELETE_MAX'+_0x2e8bd6(0x231)+'IES']??FALLBACKS['MAX_SEND_R'+_0x2e8bd6(0x1e5)]),INITIAL_BACKOFF=Number(_0x3a1dde[_0x2e8bd6(0x1fb)+_0x2e8bd6(0x1af)+_0x2e8bd6(0x2f9)]??FALLBACKS[_0x2e8bd6(0x284)+_0x2e8bd6(0x293)]),DELETE_CLEANUP_DAYS=Number(_0x3a1dde[_0x2e8bd6(0x225)+_0x2e8bd6(0x2af)]??FALLBACKS['CLEANUP_DA'+'YS']);const _0x30bffb=_0x3a1dde[_0x2e8bd6(0x31b)+'OT']&&typeof _0x3a1dde[_0x2e8bd6(0x31b)+'OT']===_0x2e8bd6(0x28e)?_0x3a1dde['PROJECT_RO'+'OT']:process['cwd'](),_0x1d6e94=_0x1b8032['resolve'](_0x30bffb,'data',_0x2e8bd6(0x2e2));ensureDirSync(_0x1d6e94),MEDIA_DIR=_0x1b8032[_0x2e8bd6(0x336)](_0x1d6e94,_0x3a1dde[_0x2e8bd6(0x23e)+_0x2e8bd6(0x321)]??_0x3a1dde[_0x2e8bd6(0x23e)+_0x2e8bd6(0x251)]??FALLBACKS[_0x2e8bd6(0x182)+_0x2e8bd6(0x236)]),ensureDirSync(MEDIA_DIR);}catch(_0x3ee583){warn(_0x2e8bd6(0x330)+_0x2e8bd6(0x2c7)+_0x2e8bd6(0x347)+(_0x3ee583?.[_0x2e8bd6(0x205)]||_0x3ee583));}}try{hotReloadConfig&&hotReloadConfig(()=>{const _0x1d64ec=_0x251909;refreshConfig(),info('[Delete]\x20H'+_0x1d64ec(0x241)+_0x1d64ec(0x2ac));});}catch(_0xf06c3b){warn(_0x251909(0x1c2)+'otReloadCo'+_0x251909(0x17e)+_0x251909(0x345)+_0x251909(0x287)+(_0xf06c3b?.['message']||_0xf06c3b));}refreshConfig();const MESSAGES_COLUMNS={'msg_id':'TEXT\x20PRIMA'+_0x251909(0x2d3),'chat_jid':_0x251909(0x27a),'remote_alt':_0x251909(0x27a),'sender_jid':_0x251909(0x27a),'participant_alt':_0x251909(0x27a),'message_json':'TEXT','timestamp':_0x251909(0x26c),'media_path':_0x251909(0x27a),'saved_at':_0x251909(0x26c),'resent_at':_0x251909(0x26c)};async function ensureTable(){const _0x472234=_0x251909;try{const _0x4103b1=Object[_0x472234(0x273)](MESSAGES_COLUMNS)[_0x472234(0x2ec)](([_0x122bad,_0x7d5e32])=>_0x122bad+'\x20'+_0x7d5e32)[_0x472234(0x336)](',\x0a\x20\x20');await db[_0x472234(0x2ee)](_0x472234(0x331)+_0x472234(0x1a4)+_0x472234(0x2cd)+_0x472234(0x1f0)+_0x4103b1+'\x0a);');let _0x1cf87e=[];try{const _0x3debbf=await db['all'](_0x472234(0x2d5)+'le_info(\x27m'+'essages\x27)');_0x1cf87e=(_0x3debbf||[])[_0x472234(0x2ec)](_0x594b60=>_0x594b60[_0x472234(0x2f5)]);}catch(_0x2c0389){warn(_0x472234(0x1b4)+_0x472234(0x2e1)+_0x472234(0x1ac)+'led:\x20'+(_0x2c0389?.[_0x472234(0x205)]||_0x2c0389));}for(const _0xdd2a44 of Object[_0x472234(0x228)](MESSAGES_COLUMNS)){if(!_0x1cf87e[_0x472234(0x308)](_0xdd2a44)){const _0x5674a8=MESSAGES_COLUMNS[_0xdd2a44];try{await db[_0x472234(0x221)](_0x472234(0x1a2)+'E\x20messages'+_0x472234(0x1db)+'N\x20'+_0xdd2a44+'\x20'+_0x5674a8),info(_0x472234(0x2a0)+'dded\x20missi'+_0x472234(0x239)+_0x472234(0x2ba)+_0xdd2a44);}catch(_0xb5853b){warn(_0x472234(0x320)+_0x472234(0x350)+'dd\x20column\x20'+_0xdd2a44+':\x20'+(_0xb5853b?.[_0x472234(0x205)]||_0xb5853b));}}}await db[_0x472234(0x2ee)]('CREATE\x20TAB'+_0x472234(0x1a4)+_0x472234(0x244)+_0x472234(0x243)+'(\x0a\x20\x20\x20\x20\x20\x20ke'+'y\x20TEXT\x20PRI'+_0x472234(0x27c)+_0x472234(0x29c)+_0x472234(0x21e)+_0x472234(0x2b5)+_0x472234(0x295)+_0x472234(0x18e)+_0x472234(0x346)+_0x472234(0x186));try{const _0x5c07c7=await db[_0x472234(0x26e)](_0x472234(0x1ae)+_0x472234(0x2d2)+'lete_prefs'+_0x472234(0x20f)+'=\x27mode\x27');if(!_0x5c07c7){const _0x1e0a04=Math['floor'](Date[_0x472234(0x1b5)]()/(-0x1*-0x8cb+0x1165+-0x1648));await db[_0x472234(0x221)](_0x472234(0x25a)+'O\x20delete_p'+'refs\x20(key,'+_0x472234(0x26f)+_0x472234(0x21b)+_0x472234(0x1d6)+_0x472234(0x274)+'?)',[_0x1e0a04]),DELETE_MODE='p';}else DELETE_MODE=_0x5c07c7[_0x472234(0x335)]==='g'?'g':'p';}catch(_0x2e9300){warn(_0x472234(0x188)+_0x472234(0x1d1)+_0x472234(0x189)+_0x472234(0x1ee)+(_0x2e9300?.[_0x472234(0x205)]||_0x2e9300));}try{const _0x39431a=await db[_0x472234(0x26e)](_0x472234(0x1ae)+_0x472234(0x2d2)+_0x472234(0x1f6)+'\x20WHERE\x20key'+_0x472234(0x235)+'id\x27');TARGET_JID=_0x39431a?.[_0x472234(0x335)]||null;}catch(_0x2ae659){warn(_0x472234(0x263)+_0x472234(0x267)+_0x472234(0x181)+_0x472234(0x21d)+(_0x2ae659?.[_0x472234(0x205)]||_0x2ae659)),TARGET_JID=null;}}catch(_0x3e258b){warn(_0x472234(0x294)+_0x472234(0x361)+'\x20top\x20error'+':\x20'+(_0x3e258b?.[_0x472234(0x205)]||_0x3e258b));throw _0x3e258b;}}async function streamMediaToFile(_0x30813a,_0x46cbaa){const _0x202989=_0x251909;try{const _0x40e087=_0x30813a[_0x202989(0x205)][_0x46cbaa+'Message'],_0xf5ea07=await downloadContentFromMessage(_0x40e087,_0x46cbaa);let _0x54b4f5=_0x202989(0x327);if(_0x46cbaa===_0x202989(0x18b))_0x54b4f5=_0x202989(0x24d);else{if(_0x46cbaa==='video'||_0x46cbaa===_0x202989(0x348))_0x54b4f5=_0x202989(0x17d);else{if(_0x46cbaa===_0x202989(0x2f7))_0x54b4f5='ogg';else{if(_0x46cbaa===_0x202989(0x193))_0x54b4f5=_0x40e087?.[_0x202989(0x215)]?_0x40e087[_0x202989(0x215)][_0x202989(0x31d)]('.')[_0x202989(0x2fd)]():_0x202989(0x357);else{if(_0x46cbaa===_0x202989(0x297))_0x54b4f5='webp';}}}}const _0x484e52=_0x30813a[_0x202989(0x250)]['id']+'.'+_0x54b4f5,_0x5186a2=_0x1b8032['join'](MEDIA_DIR,_0x484e52);await new Promise((_0x5c98f7,_0xbb00be)=>{const _0x47e48f=_0x202989,_0x166238=_0x314ba2[_0x47e48f(0x1a5)+_0x47e48f(0x1d3)](_0x5186a2);((async()=>{const _0x42bbe8=_0x47e48f;try{for await(const _0x285a8a of _0xf5ea07){if(!_0x166238[_0x42bbe8(0x2b4)](_0x285a8a))await new Promise(_0x5a7724=>_0x166238[_0x42bbe8(0x1b0)](_0x42bbe8(0x1a6),_0x5a7724));}_0x166238[_0x42bbe8(0x219)](),_0x166238[_0x42bbe8(0x1b0)](_0x42bbe8(0x20c),()=>_0x5c98f7());}catch(_0x18d321){try{_0x166238['destroy']();}catch(_0x5571fa){}_0xbb00be(_0x18d321);}})());});try{const _0x5871fb=_0x314ba2[_0x202989(0x2ef)](_0x5186a2);if(_0x5871fb[_0x202989(0x364)]===-0x1*-0x1ef7+-0x19b0+-0x547*0x1)return warn(_0x202989(0x314)+_0x202989(0x298)+_0x5186a2+_0x202989(0x227)),null;}catch(_0x307d20){}return _0x5186a2;}catch(_0x1d29f8){return warn(_0x202989(0x314)+_0x202989(0x28f)+_0x202989(0x338)+_0x202989(0x1e4)+(_0x30813a[_0x202989(0x250)]?.['id']||_0x202989(0x2d7))+':\x20'+(_0x1d29f8?.[_0x202989(0x205)]||_0x1d29f8)),null;}}async function maybeSaveMedia(_0x58e7f1){const _0x318d10=_0x251909;try{const _0x3cd0ed=['image','video',_0x318d10(0x348),'audio',_0x318d10(0x193),_0x318d10(0x297)];for(const _0x5e1e49 of _0x3cd0ed){if(_0x5e1e49===_0x318d10(0x348)){if(_0x58e7f1[_0x318d10(0x205)]?.[_0x318d10(0x238)])return await streamMediaToFile(_0x58e7f1,_0x318d10(0x348));continue;}if(_0x58e7f1['message']?.[_0x5e1e49+_0x318d10(0x2ed)])return await streamMediaToFile(_0x58e7f1,_0x5e1e49);}return null;}catch(_0x5e7879){return warn(_0x318d10(0x1a0)+_0x318d10(0x324)+'dia\x20error:'+'\x20'+(_0x5e7879?.[_0x318d10(0x205)]||_0x5e7879)),null;}}async function insertMessageToDB(_0x4f972d,_0xe0ea2f){const _0x5dcc05=_0x251909;try{if(!_0x4f972d||!_0x4f972d[_0x5dcc05(0x250)])return;const {id:_0xf327ab,remoteJid:_0x232122,participant:_0x4d139f}=_0x4f972d[_0x5dcc05(0x250)],_0x52082a=_0x4d139f||_0x232122,_0x1858e2=typeof _0x4f972d[_0x5dcc05(0x1a9)+_0x5dcc05(0x2c2)]===_0x5dcc05(0x208)?_0x4f972d[_0x5dcc05(0x1a9)+_0x5dcc05(0x2c2)]:_0x4f972d[_0x5dcc05(0x1a9)+'estamp']?.[_0x5dcc05(0x271)]||Math['floor'](Date[_0x5dcc05(0x1b5)]()/(0x931+0xdc4+0x1*-0x130d)),_0x573b86=_0x4f972d[_0x5dcc05(0x250)]?.['remoteJidA'+'lt']||null,_0x1afdb1=_0x4f972d[_0x5dcc05(0x250)]?.[_0x5dcc05(0x1f5)+'tAlt']||null,_0x3a19d3=Math[_0x5dcc05(0x328)](Date[_0x5dcc05(0x1b5)]()/(0x1*-0x19bb+0x22*-0x33+-0x27*-0xef));if(!_0xf327ab){warn('[Delete]\x20i'+_0x5dcc05(0x260)+_0x5dcc05(0x1bf)+'ssing\x20key.'+'id');return;}const _0x4f98e7=_0x5dcc05(0x1b3)+_0x5dcc05(0x1b6)+'TO\x20message'+_0x5dcc05(0x28a)+_0x5dcc05(0x19b)+_0x5dcc05(0x2c8)+'t,\x20sender_'+_0x5dcc05(0x1df)+_0x5dcc05(0x356)+',\x20message_'+'json,\x20time'+_0x5dcc05(0x20e)+_0x5dcc05(0x303)+_0x5dcc05(0x223)+_0x5dcc05(0x259)+_0x5dcc05(0x1e3)+_0x5dcc05(0x183)+'?,\x20?,\x20?,\x20?'+_0x5dcc05(0x306)+_0x5dcc05(0x204),_0x574f75=[_0xf327ab,_0x232122||null,_0x573b86,_0x52082a||null,_0x1afdb1,JSON[_0x5dcc05(0x209)](_0x4f972d),_0x1858e2,_0xe0ea2f||null,_0x3a19d3,null];try{await db[_0x5dcc05(0x221)](_0x4f98e7,_0x574f75);}catch(_0x2a1d46){const _0x3193b7=String(_0x2a1d46?.[_0x5dcc05(0x205)]||'');if(_0x3193b7[_0x5dcc05(0x308)]('has\x20no\x20col'+_0x5dcc05(0x254))){warn(_0x5dcc05(0x262)+_0x5dcc05(0x201)+_0x5dcc05(0x2e5)+_0x5dcc05(0x22a)+_0x5dcc05(0x278)+_0x3193b7+(_0x5dcc05(0x2d1)+'g\x20table\x20an'+_0x5dcc05(0x2cf)));try{await ensureTable(),await db[_0x5dcc05(0x221)](_0x4f98e7,_0x574f75);}catch(_0x4afdfc){warn('[Delete]\x20r'+'etry\x20inser'+_0x5dcc05(0x25b)+(_0x4afdfc?.['message']||_0x4afdfc));}}else throw _0x2a1d46;}}catch(_0x319755){warn(_0x5dcc05(0x262)+_0x5dcc05(0x260)+_0x5dcc05(0x315)+'led:\x20'+(_0x319755?.['message']||_0x319755));}}function _0x5a89(_0xf809c8,_0x35af72){const _0x4ff388=_0x13a0();return _0x5a89=function(_0x4fdb9c,_0x4c5b98){_0x4fdb9c=_0x4fdb9c-(-0x134b+-0x63*-0x43+-0x524);let _0x3f5bd7=_0x4ff388[_0x4fdb9c];return _0x3f5bd7;},_0x5a89(_0xf809c8,_0x35af72);}async function fetchOriginalMessage(_0x47416f){const _0xbcb9c4=_0x251909;try{if(!_0x47416f)return null;const _0xfc827a=await db['get'](_0xbcb9c4(0x1d8)+'_id,\x20messa'+_0xbcb9c4(0x1ff)+_0xbcb9c4(0x1bd)+_0xbcb9c4(0x22f)+_0xbcb9c4(0x30a)+'ges\x20WHERE\x20'+_0xbcb9c4(0x35c),[_0x47416f]);if(_0xfc827a)try{return{'msg_id':_0xfc827a['msg_id'],'message':JSON['parse'](_0xfc827a[_0xbcb9c4(0x301)+'on']),'media_path':_0xfc827a[_0xbcb9c4(0x240)],'saved_at':_0xfc827a[_0xbcb9c4(0x1ce)]};}catch(_0xe17418){return{'msg_id':_0xfc827a[_0xbcb9c4(0x2bf)],'message':null,'media_path':_0xfc827a[_0xbcb9c4(0x240)],'saved_at':_0xfc827a[_0xbcb9c4(0x1ce)]};}const _0xcf2d9d='%\x22id\x22:\x22'+_0x47416f+'\x22%',_0x1f03ba=await db['all']('SELECT\x20msg'+'_id,\x20messa'+_0xbcb9c4(0x1ff)+_0xbcb9c4(0x1bd)+_0xbcb9c4(0x22f)+_0xbcb9c4(0x30a)+_0xbcb9c4(0x311)+'message_js'+_0xbcb9c4(0x307)+_0xbcb9c4(0x200),[_0xcf2d9d]);if(_0x1f03ba&&_0x1f03ba[_0xbcb9c4(0x268)])try{return{'msg_id':_0x1f03ba[-0xac9*-0x1+-0x523*-0x4+0x1f55*-0x1][_0xbcb9c4(0x2bf)],'message':JSON[_0xbcb9c4(0x24b)](_0x1f03ba[-0xa*0x331+0x638+0x19b2]['message_js'+'on']),'media_path':_0x1f03ba[-0xd*-0x94+-0x1172+0x9ee][_0xbcb9c4(0x240)],'saved_at':_0x1f03ba[0x25a8+0x169*-0x2+0x22d6*-0x1][_0xbcb9c4(0x1ce)]};}catch(_0x1b2746){return{'msg_id':_0x1f03ba[-0x234f+0x1*-0x6ee+0x2a3d][_0xbcb9c4(0x2bf)],'message':null,'media_path':_0x1f03ba[-0x1a98+0x1d*0x31+0x1*0x150b][_0xbcb9c4(0x240)],'saved_at':_0x1f03ba[-0x14d6+0x1b2b+-0x1*0x655][_0xbcb9c4(0x1ce)]};}return null;}catch(_0x4a4a63){return warn('[Delete]\x20f'+_0xbcb9c4(0x2ae)+_0xbcb9c4(0x195)+_0xbcb9c4(0x2f3)+(_0x4a4a63?.['message']||_0x4a4a63)),null;}}async function deleteMessageRow(_0x391d93){const _0x3a14e4=_0x251909;try{if(!_0x391d93)return;const _0x50aa95=await db['get'](_0x3a14e4(0x2e3)+'ia_path\x20FR'+'OM\x20message'+_0x3a14e4(0x2d0)+_0x3a14e4(0x1da),[_0x391d93]);if(_0x50aa95?.[_0x3a14e4(0x240)])try{await _0x516618(_0x50aa95[_0x3a14e4(0x240)]),info(_0x3a14e4(0x330)+_0x3a14e4(0x1f8)+_0x3a14e4(0x355)+_0x3a14e4(0x19d));}catch(_0x4e6c0e){warn(_0x3a14e4(0x320)+_0x3a14e4(0x342)+_0x3a14e4(0x2be)+'\x20'+_0x50aa95[_0x3a14e4(0x240)]+':\x20'+(_0x4e6c0e?.['message']||_0x4e6c0e));}await db[_0x3a14e4(0x221)]('DELETE\x20FRO'+_0x3a14e4(0x313)+_0x3a14e4(0x32d)+_0x3a14e4(0x34d),[_0x391d93]),info(_0x3a14e4(0x318)+_0x3a14e4(0x17b)+'sages\x20row:'+'\x20'+_0x391d93);}catch(_0x51a728){warn(_0x3a14e4(0x318)+'eleteMessa'+'geRow\x20erro'+_0x3a14e4(0x302)+(_0x51a728?.[_0x3a14e4(0x205)]||_0x51a728));}}async function sendWithRetry(_0x48492a,_0x3916c6,_0x1b8459=[]){const _0x4892aa=_0x251909,_0x402d42=Number(MAX_SEND_RETRIES||FALLBACKS[_0x4892aa(0x21a)+_0x4892aa(0x1e5)]);let _0x42f562=-0x21d+-0x43f*-0x1+-0x222,_0x137db6=Number(INITIAL_BACKOFF||FALLBACKS['INITIAL_BA'+_0x4892aa(0x293)]);const _0xd83b55=[_0x48492a,TARGET_JID,getBotJid()][_0x4892aa(0x22b)](Boolean)[_0x4892aa(0x2ec)](normalizeToUserJid),_0x2701d9=new Set(),_0x251513=[];for(const _0x5125c8 of _0xd83b55){if(!_0x5125c8)continue;!_0x2701d9[_0x4892aa(0x316)](_0x5125c8)&&(_0x2701d9[_0x4892aa(0x1fe)](_0x5125c8),_0x251513['push'](_0x5125c8));}let _0x56e88e=_0x251513[_0x4892aa(0x268)]?_0x251513[0xd*-0x1d+0x1f49+-0x24*0xd4]:null;if(_0x56e88e&&_0x56e88e['endsWith'](_0x4892aa(0x1e9))&&typeof botRef?.[_0x4892aa(0x229)]?.[_0x4892aa(0x1ea)]===_0x4892aa(0x2b3))try{const _0x3f99d3=await botRef[_0x4892aa(0x229)]['onWhatsApp'](_0x56e88e);if(Array[_0x4892aa(0x309)](_0x3f99d3)&&_0x3f99d3[-0x1*0x1f71+-0x1af*0xd+0x3554]&&_0x3f99d3[-0x4*-0x244+-0x1*0x1b0d+0x11fd][_0x4892aa(0x1f9)])_0x56e88e=normalizeToUserJid(_0x3f99d3[0x6*-0x18+0x149c*0x1+0xa06*-0x2][_0x4892aa(0x1f9)]);}catch(_0x505093){warn(_0x4892aa(0x25d)+_0x4892aa(0x245)+_0x4892aa(0x2fe)+_0x4892aa(0x287)+(_0x505093?.[_0x4892aa(0x205)]||_0x505093));}while(_0x42f562<_0x402d42){try{if(!_0x56e88e)throw new Error(_0x4892aa(0x2e9)+_0x4892aa(0x25c)+_0x4892aa(0x247));if(Array['isArray'](_0x1b8459)&&_0x1b8459[_0x4892aa(0x268)]&&typeof _0x3916c6==='object'&&_0x3916c6!==null)_0x3916c6[_0x4892aa(0x2c5)]=_0x1b8459;return await botRef[_0x4892aa(0x24e)+'e'](_0x56e88e,_0x3916c6),!![];}catch(_0x3fefd0){_0x42f562++;const _0x5a677c=String(_0x3fefd0?.[_0x4892aa(0x205)]||'')[_0x4892aa(0x1ec)+'e']()[_0x4892aa(0x308)]('rate')||_0x3fefd0?.[_0x4892aa(0x1b2)]===-0x3*-0xcae+0x1af6+-0x4df*0xd;warn(_0x4892aa(0x314)+_0x4892aa(0x26b)+'t\x20'+_0x42f562+_0x4892aa(0x1b8)+_0x56e88e+_0x4892aa(0x285)+(_0x3fefd0?.[_0x4892aa(0x205)]||_0x3fefd0));if(_0x42f562>=_0x402d42||!_0x5a677c)return![];await sleep(_0x137db6),_0x137db6*=0x13f9+-0xe*0x1ff+0x7fb;}}return![];}function extractContent(_0x45f70b){const _0x38a0f0=_0x251909;if(!_0x45f70b)return'';if(_0x45f70b[_0x38a0f0(0x1e8)+'on'])return _0x45f70b[_0x38a0f0(0x1e8)+'on'];if(_0x45f70b['extendedTe'+_0x38a0f0(0x332)])return _0x45f70b[_0x38a0f0(0x1ca)+_0x38a0f0(0x332)][_0x38a0f0(0x242)];if(_0x45f70b[_0x38a0f0(0x19c)+'ge'])return _0x45f70b['imageMessa'+'ge'][_0x38a0f0(0x276)]||'';if(_0x45f70b[_0x38a0f0(0x1e1)+'ge'])return _0x45f70b[_0x38a0f0(0x1e1)+'ge'][_0x38a0f0(0x276)]||'';if(_0x45f70b[_0x38a0f0(0x238)])return _0x45f70b[_0x38a0f0(0x238)][_0x38a0f0(0x276)]||'';if(_0x45f70b['audioMessa'+'ge'])return _0x45f70b[_0x38a0f0(0x33c)+'ge']?.[_0x38a0f0(0x2db)]?_0x38a0f0(0x360)+'e]':_0x38a0f0(0x2fb);if(_0x45f70b[_0x38a0f0(0x265)+_0x38a0f0(0x213)])return _0x45f70b[_0x38a0f0(0x265)+_0x38a0f0(0x213)][_0x38a0f0(0x215)]||'';if(_0x45f70b['stickerMes'+_0x38a0f0(0x256)])return _0x38a0f0(0x323);if(_0x45f70b[_0x38a0f0(0x2b1)+_0x38a0f0(0x266)+'3'])return _0x38a0f0(0x286)+(_0x45f70b[_0x38a0f0(0x2b1)+_0x38a0f0(0x266)+'3'][_0x38a0f0(0x2f5)]||'poll')+']';return'[Media]';}function isMediaMessage(_0x35815a){const _0x2e5772=_0x251909;if(!_0x35815a)return![];if(_0x35815a[_0x2e5772(0x19c)+'ge'])return!![];if(_0x35815a[_0x2e5772(0x1e1)+'ge'])return!![];if(_0x35815a[_0x2e5772(0x33c)+'ge'])return!![];if(_0x35815a[_0x2e5772(0x265)+_0x2e5772(0x213)])return!![];if(_0x35815a[_0x2e5772(0x31f)+_0x2e5772(0x256)])return!![];if(_0x35815a[_0x2e5772(0x238)])return!![];if(_0x35815a[_0x2e5772(0x1e1)+'ge']&&_0x35815a['videoMessa'+'ge'][_0x2e5772(0x290)+'k'])return!![];const _0x591ca9=Object[_0x2e5772(0x228)](_0x35815a||{});for(const _0x22ead5 of _0x591ca9){if(_0x22ead5[_0x2e5772(0x27e)](_0x2e5772(0x2ed))&&['imageMessa'+'ge',_0x2e5772(0x1e1)+'ge',_0x2e5772(0x33c)+'ge',_0x2e5772(0x265)+'ssage','stickerMes'+'sage',_0x2e5772(0x238)][_0x2e5772(0x308)](_0x22ead5))return!![];}return![];}function buildPayloadForSavedFile(_0x2bfdbc,_0x1dfecb){const _0xa2dd7c=_0x251909,_0x211b8a=_0x1dfecb?.[_0xa2dd7c(0x205)]||{},_0x58dfff=extractContent(_0x211b8a)||undefined;if(_0x211b8a[_0xa2dd7c(0x31f)+_0xa2dd7c(0x256)])return{'sticker':{'url':_0x2bfdbc}};if(_0x211b8a[_0xa2dd7c(0x238)]){const _0x2a262f={'video':{'url':_0x2bfdbc},'ptv':!![]};if(_0x58dfff)_0x2a262f[_0xa2dd7c(0x276)]=_0x58dfff;if(_0x211b8a[_0xa2dd7c(0x238)]?.[_0xa2dd7c(0x2f8)])_0x2a262f[_0xa2dd7c(0x2f8)]=_0x211b8a['ptvMessage'][_0xa2dd7c(0x2f8)];return _0x2a262f;}if(_0x211b8a['videoMessa'+'ge']){const _0x2b3cb5={'video':{'url':_0x2bfdbc}};if(_0x211b8a[_0xa2dd7c(0x1e1)+'ge']?.[_0xa2dd7c(0x276)])_0x2b3cb5[_0xa2dd7c(0x276)]=_0x211b8a['videoMessa'+'ge'][_0xa2dd7c(0x276)];if(typeof _0x211b8a[_0xa2dd7c(0x1e1)+'ge']?.['gifPlaybac'+'k']===_0xa2dd7c(0x299))_0x2b3cb5[_0xa2dd7c(0x290)+'k']=_0x211b8a[_0xa2dd7c(0x1e1)+'ge']['gifPlaybac'+'k'];if(_0x211b8a[_0xa2dd7c(0x1e1)+'ge']?.[_0xa2dd7c(0x2f8)])_0x2b3cb5[_0xa2dd7c(0x2f8)]=_0x211b8a[_0xa2dd7c(0x1e1)+'ge'][_0xa2dd7c(0x2f8)];return _0x2b3cb5;}if(_0x211b8a['imageMessa'+'ge']){const _0x577994={'image':{'url':_0x2bfdbc}};if(_0x211b8a[_0xa2dd7c(0x19c)+'ge']?.[_0xa2dd7c(0x276)])_0x577994[_0xa2dd7c(0x276)]=_0x211b8a[_0xa2dd7c(0x19c)+'ge'][_0xa2dd7c(0x276)];return _0x577994;}if(_0x211b8a[_0xa2dd7c(0x33c)+'ge']){const _0x2dc14a={'audio':{'url':_0x2bfdbc}};if(typeof _0x211b8a['audioMessa'+'ge']?.['ptt']===_0xa2dd7c(0x299))_0x2dc14a[_0xa2dd7c(0x2db)]=_0x211b8a[_0xa2dd7c(0x33c)+'ge'][_0xa2dd7c(0x2db)];if(_0x211b8a[_0xa2dd7c(0x33c)+'ge']?.[_0xa2dd7c(0x2f8)])_0x2dc14a[_0xa2dd7c(0x2f8)]=_0x211b8a[_0xa2dd7c(0x33c)+'ge'][_0xa2dd7c(0x2f8)];if(typeof _0x211b8a[_0xa2dd7c(0x33c)+'ge']?.['seconds']===_0xa2dd7c(0x208))_0x2dc14a[_0xa2dd7c(0x2eb)]=_0x211b8a['audioMessa'+'ge'][_0xa2dd7c(0x2eb)];return _0x2dc14a;}if(_0x211b8a[_0xa2dd7c(0x265)+'ssage']){const _0x3975c9=_0x211b8a[_0xa2dd7c(0x265)+_0xa2dd7c(0x213)]?.[_0xa2dd7c(0x215)]||_0x1b8032[_0xa2dd7c(0x28b)](_0x2bfdbc),_0x1f6870={'document':{'url':_0x2bfdbc,'fileName':_0x3975c9}};if(_0x211b8a['documentMe'+_0xa2dd7c(0x213)]?.[_0xa2dd7c(0x2f8)])_0x1f6870[_0xa2dd7c(0x2f8)]=_0x211b8a[_0xa2dd7c(0x265)+_0xa2dd7c(0x213)][_0xa2dd7c(0x2f8)];if(_0x211b8a['documentMe'+_0xa2dd7c(0x213)]?.['caption'])_0x1f6870['caption']=_0x211b8a[_0xa2dd7c(0x265)+_0xa2dd7c(0x213)][_0xa2dd7c(0x276)];if(_0x58dfff&&!_0x1f6870[_0xa2dd7c(0x276)])_0x1f6870[_0xa2dd7c(0x276)]=_0x58dfff;return _0x1f6870;}return{'document':{'url':_0x2bfdbc,'fileName':_0x1b8032[_0xa2dd7c(0x28b)](_0x2bfdbc)},'caption':_0x58dfff};}async function processDeletionItem(_0x287c91){const _0x162b2b=_0x251909;try{const _0x35305c=_0x287c91['keys']||[];if(!_0x35305c[_0x162b2b(0x268)])return;for(const _0xbe2aae of _0x35305c){const _0x3281d7=await fetchOriginalMessage(_0xbe2aae['id']);if(!_0x3281d7||!_0x3281d7[_0x162b2b(0x205)])continue;const _0x330bc7=_0x3281d7[_0x162b2b(0x205)],_0x53a7a7=getBotJidRaw(),_0x300483=_0x330bc7[_0x162b2b(0x250)]?.['participan'+'t']||_0x330bc7[_0x162b2b(0x250)]?.[_0x162b2b(0x277)];if(_0x330bc7[_0x162b2b(0x250)]?.[_0x162b2b(0x19a)]||_0x300483===_0x53a7a7)continue;const _0x3c27d9=_0x330bc7[_0x162b2b(0x250)]['participan'+'t']||_0x330bc7[_0x162b2b(0x250)]['remoteJid'],_0x54a480=extractContent(_0x330bc7[_0x162b2b(0x205)]);let _0x387654=nameCache[_0x162b2b(0x26e)](_0x3c27d9);if(!_0x387654){try{const [_0x366b0a]=await botRef[_0x162b2b(0x229)]['onWhatsApp'](_0x3c27d9);_0x387654=_0x366b0a?.[_0x162b2b(0x2c4)]||'~'+_0x3c27d9[_0x162b2b(0x31d)]('@')[0x2391+0x1*0x16ba+0x3a4b*-0x1];}catch{_0x387654='~'+_0x3c27d9['split']('@')[0x1e16+0x1*-0x1b27+-0x2ef*0x1];}nameCache[_0x162b2b(0x1c5)](_0x3c27d9,_0x387654);}let _0x4eeaa2='';if(isJidGroup(_0x330bc7[_0x162b2b(0x250)][_0x162b2b(0x277)]))try{_0x4eeaa2=(await botRef['sock'][_0x162b2b(0x25e)+'ata'](_0x330bc7[_0x162b2b(0x250)][_0x162b2b(0x277)]))['subject'];}catch{_0x4eeaa2=_0x162b2b(0x184)+_0x162b2b(0x1a1);}deletionPush({'msg_id':_0x3281d7[_0x162b2b(0x2bf)],'sender':_0x3c27d9,'name':_0x387654,'group':_0x4eeaa2,'content':_0x54a480,'mediaPath':_0x3281d7[_0x162b2b(0x240)]||null,'originalMessage':_0x330bc7});}}catch(_0x2ad84f){warn(_0x162b2b(0x188)+_0x162b2b(0x21f)+'tionItem\x20e'+_0x162b2b(0x258)+(_0x2ad84f?.[_0x162b2b(0x205)]||_0x2ad84f));}}async function deletionWorker(){const _0x2d0649=_0x251909,_0xcee0e4=CONCURRENCY||FALLBACKS['DEFAULT_CO'+'NCURRENCY'];while(deletionQueue[_0x2d0649(0x268)]>-0x99e+0x17e5*-0x1+0x2183&&activeDeletionTasks<_0xcee0e4){const _0x15f873=deletionQueue[_0x2d0649(0x269)]();if(!_0x15f873)break;activeDeletionTasks++,((async()=>{const _0xf9c526=_0x2d0649;try{await processDeletionItem(_0x15f873);}catch(_0x302110){warn(_0xf9c526(0x318)+_0xf9c526(0x339)+'ker\x20item\x20e'+_0xf9c526(0x258)+(_0x302110?.['message']||_0x302110));}finally{activeDeletionTasks--,setImmediate(()=>{const _0x30b2a0=_0xf9c526;if(deletionQueue[_0x30b2a0(0x268)])deletionWorker()[_0x30b2a0(0x363)](()=>{});});}})());}}function deletionPush(_0x18673f){const _0x2db127=_0x251909;pendingRecovered['push'](_0x18673f),clearTimeout(flushTimer),flushTimer=setTimeout(()=>{const _0x448d80=_0x5a89,_0x1d0964=pendingRecovered[_0x448d80(0x23d)](-0x1040+0x16aa+-0x2*0x335,pendingRecovered[_0x448d80(0x268)]);((async()=>{const _0x366f8d=_0x448d80;try{await flushRecoveredBatch(_0x1d0964);}catch(_0x3162e7){warn(_0x366f8d(0x320)+_0x366f8d(0x35a)+_0x366f8d(0x305)+'rror:\x20'+(_0x3162e7?.[_0x366f8d(0x205)]||_0x3162e7));}})());},DEBOUNCE_DELAY_MS||FALLBACKS[_0x2db127(0x23f)+'S']);}function resolveDeleteTarget(_0x165902){const _0x163bda=getBotJid();if(DELETE_MODE==='g'&&TARGET_JID){if(TARGET_JID===_0x165902)return _0x163bda;return TARGET_JID;}return _0x163bda;}async function saveDeleteMode(_0xd64f8f){const _0x12ad24=_0x251909;try{const _0x590cc8=_0xd64f8f==='g'?'g':'p',_0x5196d2=Math[_0x12ad24(0x328)](Date[_0x12ad24(0x1b5)]()/(-0x13e4+-0x13e7+-0x63*-0x71));return await db['run']('INSERT\x20INT'+_0x12ad24(0x30c)+_0x12ad24(0x2b2)+'\x20value,\x20up'+_0x12ad24(0x21b)+_0x12ad24(0x1d6)+_0x12ad24(0x180)+_0x12ad24(0x35e)+_0x12ad24(0x1e2)+'O\x20UPDATE\x20S'+_0x12ad24(0x2a8)+_0x12ad24(0x1e0)+_0x12ad24(0x27f)+_0x12ad24(0x1fa)+_0x12ad24(0x2bc)+'ed_at',[_0x590cc8,_0x5196d2]),DELETE_MODE=_0x590cc8,info(_0x12ad24(0x1a0)+_0x12ad24(0x22d)+'\x20'+DELETE_MODE),!![];}catch(_0x25a093){return warn('[Delete]\x20s'+_0x12ad24(0x334)+_0x12ad24(0x33b)+':\x20'+(_0x25a093?.[_0x12ad24(0x205)]||_0x25a093)),![];}}async function saveDeleteTarget(_0x2d5aa7){const _0x16d5c2=_0x251909;try{const _0x53e094=Math[_0x16d5c2(0x328)](Date[_0x16d5c2(0x1b5)]()/(-0x1678+0x1*0x1640+0x420));if(!_0x2d5aa7)return await db[_0x16d5c2(0x221)](_0x16d5c2(0x220)+_0x16d5c2(0x264)+'refs\x20WHERE'+_0x16d5c2(0x29a)+_0x16d5c2(0x365)),TARGET_JID=null,info(_0x16d5c2(0x263)+_0x16d5c2(0x267)+_0x16d5c2(0x341)),!![];else{const _0xb62ae1=normalizeToUserJid(_0x2d5aa7);return await db[_0x16d5c2(0x221)](_0x16d5c2(0x25a)+_0x16d5c2(0x30c)+'refs\x20(key,'+_0x16d5c2(0x26f)+_0x16d5c2(0x21b)+_0x16d5c2(0x325)+_0x16d5c2(0x2c3)+_0x16d5c2(0x2a5)+'\x20CONFLICT('+'key)\x20DO\x20UP'+_0x16d5c2(0x237)+_0x16d5c2(0x214)+_0x16d5c2(0x2ad)+_0x16d5c2(0x253)+_0x16d5c2(0x2c1)+_0x16d5c2(0x19f)+'t',[_0xb62ae1,_0x53e094]),TARGET_JID=_0xb62ae1,info(_0x16d5c2(0x263)+'arget_jid\x20'+_0x16d5c2(0x18f)+TARGET_JID),!![];}}catch(_0x36e100){return warn(_0x16d5c2(0x314)+_0x16d5c2(0x2d4)+_0x16d5c2(0x1ab)+_0x16d5c2(0x2da)+(_0x36e100?.[_0x16d5c2(0x205)]||_0x36e100)),![];}}async function flushRecoveredBatch(_0x35cc4e){const _0x3d48f2=_0x251909;if(!_0x35cc4e||_0x35cc4e[_0x3d48f2(0x268)]===-0x261b+0x177+0x86*0x46)return;if(!DEFAULT_SEND_DELETE){info(_0x3d48f2(0x352)+_0x3d48f2(0x18c)+_0x3d48f2(0x2f6)+_0x3d48f2(0x34a)+_0x3d48f2(0x1f3)+_0x3d48f2(0x2b6)+'s.');return;}const _0x1680a0=_0x35cc4e[_0x3d48f2(0x198)](_0x185004=>_0x185004[_0x3d48f2(0x1ad)+'ssage'])?.['originalMe'+_0x3d48f2(0x213)]?.[_0x3d48f2(0x250)]?.[_0x3d48f2(0x277)]||null,_0x9a6584=resolveDeleteTarget(_0x1680a0)||getBotJid();if(!_0x9a6584){warn('[Delete]\x20n'+'o\x20send\x20tar'+_0x3d48f2(0x1ba)+_0x3d48f2(0x2e7));return;}const _0x2e3924=[...new Set(_0x35cc4e[_0x3d48f2(0x2ec)](_0x596e10=>_0x596e10[_0x3d48f2(0x2a6)]))],_0x433bc7=_0x35cc4e[_0x3d48f2(0x2ec)](_0x143016=>_0x3d48f2(0x211)+_0x143016[_0x3d48f2(0x2a6)][_0x3d48f2(0x31d)]('@')[0xba1+0xdfa+0x1*-0x199b]+'\x20('+_0x143016[_0x3d48f2(0x2f5)]+')\x0a'+(_0x143016[_0x3d48f2(0x2a3)]?_0x3d48f2(0x2a2)+_0x143016[_0x3d48f2(0x2a3)]+'\x0a':'')+(_0x3d48f2(0x194)+'\x20'+_0x143016[_0x3d48f2(0x1eb)]+'\x0a')+'─'[_0x3d48f2(0x190)](-0x1fe4+-0x13de+-0x5*-0xa5f))[_0x3d48f2(0x336)]('\x0a'),_0x46f3ce=_0x3d48f2(0x23c)+_0x35cc4e[_0x3d48f2(0x268)]+(_0x3d48f2(0x2aa)+_0x3d48f2(0x2de)+_0x3d48f2(0x2a7)+'\x0a\x0a');try{const _0x165c6e=await sendWithRetry(_0x9a6584,{'text':_0x46f3ce+_0x433bc7},_0x2e3924);if(!_0x165c6e)warn(_0x3d48f2(0x314)+_0x3d48f2(0x1f1)+'d\x20may\x20have'+_0x3d48f2(0x2f1));}catch(_0x3abb5b){warn('[Delete]\x20s'+_0x3d48f2(0x1f1)+_0x3d48f2(0x35d)+_0x3d48f2(0x289)+(_0x3abb5b?.[_0x3d48f2(0x205)]||_0x3abb5b));}for(const _0x49b614 of _0x35cc4e){try{const _0x578938=_0x49b614[_0x3d48f2(0x322)],_0x43559b=_0x49b614['originalMe'+_0x3d48f2(0x213)],_0x2a6766=!!_0x578938||isMediaMessage(_0x43559b?.[_0x3d48f2(0x205)]);if(!_0x2a6766){try{await deleteMessageRow(_0x49b614[_0x3d48f2(0x2bf)]);}catch(_0x23b4c0){}continue;}const _0x43892c=_0x43559b?.[_0x3d48f2(0x250)]?.['id']||'(no-id)';let _0x1a6066=![];if(_0x578938&&_0x314ba2[_0x3d48f2(0x1c1)](_0x578938)){const _0x56eea9=buildPayloadForSavedFile(_0x578938,_0x43559b);try{const _0x4d4bda=await sendWithRetry(_0x9a6584,_0x56eea9);if(_0x4d4bda){info(_0x3d48f2(0x330)+'ecovered\x20m'+'edia\x20sent\x20'+'for\x20'+_0x43892c+'\x20->\x20'+_0x9a6584),_0x1a6066=!![];try{await deleteMessageRow(_0x49b614[_0x3d48f2(0x2bf)]);}catch(_0x185634){warn('[Delete]\x20c'+_0x3d48f2(0x275)+_0x3d48f2(0x283)+_0x3d48f2(0x287)+(_0x185634?.[_0x3d48f2(0x205)]||_0x185634));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS['MEDIA_SEND'+_0x3d48f2(0x1c4)]);continue;}else warn(_0x3d48f2(0x320)+'ile-send\x20('+_0x3d48f2(0x1de)+_0x3d48f2(0x270)+'\x20'+_0x578938);}catch(_0x482226){warn(_0x3d48f2(0x320)+_0x3d48f2(0x1fc)+_0x3d48f2(0x1de)+_0x3d48f2(0x252)+_0x578938+':\x20'+(_0x482226?.[_0x3d48f2(0x205)]||_0x482226));}}if(!_0x1a6066&&_0x578938&&_0x314ba2[_0x3d48f2(0x1c1)](_0x578938))try{const _0x19c0c7=_0x43559b?.['message']||{};let _0x523288;if(_0x19c0c7[_0x3d48f2(0x31f)+_0x3d48f2(0x256)])_0x523288={'sticker':_0x314ba2[_0x3d48f2(0x1c0)+_0x3d48f2(0x32e)](_0x578938)};else{if(_0x19c0c7['ptvMessage'])_0x523288={'video':_0x314ba2['createRead'+_0x3d48f2(0x32e)](_0x578938),'ptv':!![]};else{if(_0x19c0c7[_0x3d48f2(0x1e1)+'ge'])_0x523288={'video':_0x314ba2['createRead'+_0x3d48f2(0x32e)](_0x578938),'caption':_0x19c0c7[_0x3d48f2(0x1e1)+'ge']?.[_0x3d48f2(0x276)]||undefined,'gifPlayback':!!_0x19c0c7['videoMessa'+'ge']?.[_0x3d48f2(0x290)+'k']};else{if(_0x19c0c7[_0x3d48f2(0x19c)+'ge'])_0x523288={'image':_0x314ba2[_0x3d48f2(0x1c0)+_0x3d48f2(0x32e)](_0x578938),'caption':_0x19c0c7[_0x3d48f2(0x19c)+'ge']?.['caption']||undefined};else{if(_0x19c0c7[_0x3d48f2(0x33c)+'ge'])_0x523288={'audio':_0x314ba2[_0x3d48f2(0x1c0)+_0x3d48f2(0x32e)](_0x578938),'ptt':!!_0x19c0c7[_0x3d48f2(0x33c)+'ge']?.[_0x3d48f2(0x2db)],'mimetype':_0x19c0c7['audioMessa'+'ge']?.[_0x3d48f2(0x2f8)]};else _0x523288={'document':_0x314ba2[_0x3d48f2(0x1c0)+'Stream'](_0x578938),'fileName':_0x1b8032[_0x3d48f2(0x28b)](_0x578938),'caption':extractContent(_0x19c0c7)};}}}}const _0x3600d5=await sendWithRetry(_0x9a6584,_0x523288);if(_0x3600d5){info(_0x3d48f2(0x330)+_0x3d48f2(0x2fc)+_0x3d48f2(0x17c)+_0x3d48f2(0x2ca)+'or\x20'+_0x43892c+_0x3d48f2(0x232)+_0x9a6584),_0x1a6066=!![];try{await deleteMessageRow(_0x49b614[_0x3d48f2(0x2bf)]);}catch(_0x1a592d){warn('[Delete]\x20c'+_0x3d48f2(0x275)+_0x3d48f2(0x1c7)+_0x3d48f2(0x207)+_0x3d48f2(0x21d)+(_0x1a592d?.[_0x3d48f2(0x205)]||_0x1a592d));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x3d48f2(0x1f2)+'_DELAY_MS']);continue;}else warn('[Delete]\x20f'+_0x3d48f2(0x1fc)+_0x3d48f2(0x34f)+'lback)\x20fai'+_0x3d48f2(0x1e4)+_0x578938);}catch(_0x517346){warn('[Delete]\x20f'+'ile-send\x20('+'stream\x20fal'+_0x3d48f2(0x292)+_0x3d48f2(0x2f4)+_0x578938+':\x20'+(_0x517346?.[_0x3d48f2(0x205)]||_0x517346));}try{const _0x106073=await sendWithRetry(_0x9a6584,{'forward':_0x43559b});if(_0x106073){info(_0x3d48f2(0x330)+_0x3d48f2(0x217)+_0x3d48f2(0x358)+_0x3d48f2(0x1c8)+'r\x20'+_0x43892c+_0x3d48f2(0x232)+_0x9a6584);try{await deleteMessageRow(_0x49b614[_0x3d48f2(0x2bf)]);}catch(_0x1e87a7){warn('[Delete]\x20c'+'leanup\x20aft'+_0x3d48f2(0x199)+_0x3d48f2(0x19e)+'iled:\x20'+(_0x1e87a7?.['message']||_0x1e87a7));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x3d48f2(0x1f2)+_0x3d48f2(0x1c4)]);continue;}}catch(_0x4381a0){warn(_0x3d48f2(0x218)+'egacy\x20forw'+'ard\x20error:'+'\x20'+(_0x4381a0?.[_0x3d48f2(0x205)]||_0x4381a0));}warn(_0x3d48f2(0x282)+_0x3d48f2(0x1d5)+_0x3d48f2(0x31e)+'ia\x20for\x20'+_0x43892c+(_0x3d48f2(0x1a7)+_0x3d48f2(0x26d)+_0x3d48f2(0x310)+_0x3d48f2(0x20b)+'r\x20later\x20re'+_0x3d48f2(0x34c)+'p.'));}catch(_0x36b50c){warn(_0x3d48f2(0x320)+_0x3d48f2(0x319)+_0x3d48f2(0x2d8)+':\x20'+(_0x36b50c?.[_0x3d48f2(0x205)]||_0x36b50c));}}}async function rawMessagesUpsertHandler({messages:_0x38c665}){const _0x154605=_0x251909;try{if(!_0x38c665||!Array[_0x154605(0x309)](_0x38c665))return;for(const _0x598d2d of _0x38c665){if(!_0x598d2d||!_0x598d2d['message']||_0x598d2d[_0x154605(0x250)]?.[_0x154605(0x277)]==='status@bro'+_0x154605(0x2cb))continue;if(_0x598d2d[_0x154605(0x250)]?.[_0x154605(0x19a)])continue;messageQueue['push'](_0x598d2d),setImmediate(()=>{const _0x332c30=_0x154605;messageWorker()[_0x332c30(0x363)](()=>{});});const _0x507232=_0x598d2d['message']?.[_0x154605(0x2d6)+_0x154605(0x213)];if(_0x507232?.[_0x154605(0x2bd)]===0x1*0x164+-0x2221+-0x1ed*-0x11&&_0x507232?.[_0x154605(0x250)])deletionQueue['push']({'keys':[_0x507232[_0x154605(0x250)]],'remoteJid':_0x598d2d[_0x154605(0x250)][_0x154605(0x277)]}),setImmediate(()=>{const _0x1b7399=_0x154605;deletionWorker()[_0x1b7399(0x363)](()=>{});});else{if(_0x598d2d[_0x154605(0x354)+'bType']===-0x1993+-0x1ea6+0x383d&&Array[_0x154605(0x309)](_0x598d2d[_0x154605(0x354)+_0x154605(0x337)+'s'])&&_0x598d2d[_0x154605(0x354)+_0x154605(0x337)+'s'][-0x1*-0x241+0x7*-0x124+0x5bb*0x1]==='REVOKE'){const _0x18c402=[];for(let _0x3b5b61=-0xcac+0x2*-0x12f9+0x329f*0x1;_0x3b5b61<_0x598d2d[_0x154605(0x354)+'bParameter'+'s']['length'];_0x3b5b61++)_0x18c402[_0x154605(0x2df)]({'id':_0x598d2d[_0x154605(0x354)+'bParameter'+'s'][_0x3b5b61],'remoteJid':_0x598d2d[_0x154605(0x250)][_0x154605(0x277)]});_0x18c402[_0x154605(0x268)]&&(deletionQueue['push']({'keys':_0x18c402,'remoteJid':_0x598d2d[_0x154605(0x250)]['remoteJid']}),setImmediate(()=>{deletionWorker()['catch'](()=>{});}));}}}}catch(_0x993777){warn(_0x154605(0x330)+_0x154605(0x35f)+'UpsertHand'+_0x154605(0x1a8)+'\x20'+(_0x993777?.[_0x154605(0x205)]||_0x993777));}}async function processMessageItem(_0x5d2db9){const _0x38c07d=_0x251909;try{if(!_0x5d2db9||!_0x5d2db9[_0x38c07d(0x205)]||_0x5d2db9[_0x38c07d(0x250)]?.[_0x38c07d(0x19a)])return;const _0x4c0221=await maybeSaveMedia(_0x5d2db9);await insertMessageToDB(_0x5d2db9,_0x4c0221);}catch(_0x5bfaed){warn(_0x38c07d(0x188)+_0x38c07d(0x33f)+_0x38c07d(0x1aa)+'ror:\x20'+(_0x5bfaed?.[_0x38c07d(0x205)]||_0x5bfaed));}}async function messageWorker(){const _0x420841=_0x251909,_0x231eb5=CONCURRENCY||FALLBACKS[_0x420841(0x2f2)+_0x420841(0x296)];while(messageQueue[_0x420841(0x268)]>-0x1ac*-0x8+0x56*0xa+-0x10bc&&activeMessageTasks<_0x231eb5){const _0xd18dbb=messageQueue[_0x420841(0x269)]();if(!_0xd18dbb)break;activeMessageTasks++,((async()=>{const _0x222cc1=_0x420841;try{await processMessageItem(_0xd18dbb);}catch(_0x24a424){warn(_0x222cc1(0x1a0)+_0x222cc1(0x1a3)+_0x222cc1(0x32c)+_0x222cc1(0x1e7)+(_0x24a424?.[_0x222cc1(0x205)]||_0x24a424));}finally{activeMessageTasks--,setImmediate(()=>{if(messageQueue['length'])messageWorker()['catch'](()=>{});});}})());}}async function autoCleanOldMessagesSafe(){const _0x4f6de0=_0x251909;try{await autoCleanOldMessages();}catch(_0x38fe68){warn(_0x4f6de0(0x2a0)+_0x4f6de0(0x272)+_0x4f6de0(0x1d9)+_0x4f6de0(0x1d4)+'\x20'+(_0x38fe68?.['message']||_0x38fe68));}}async function autoCleanOldMessages(){const _0x3271e1=_0x251909;try{const _0x593353=Math[_0x3271e1(0x328)](Date[_0x3271e1(0x1b5)]()/(-0x11*-0x105+0xe0f+-0x1b7c))-Number(DELETE_CLEANUP_DAYS||FALLBACKS[_0x3271e1(0x29b)+'YS'])*(-0xb24+0x125*-0xe+0x1b42*0x1)*(0x5ed*0x4+0x19a6+-0x1*0x311e)*(-0x2663+-0x19f*-0x7+0x1b46),_0x2dcf33=await db[_0x3271e1(0x17f)](_0x3271e1(0x1d8)+_0x3271e1(0x32b)+_0x3271e1(0x32f)+_0x3271e1(0x29e)+_0x3271e1(0x24a)+'WHERE\x20save'+_0x3271e1(0x255)+_0x3271e1(0x20d)+_0x3271e1(0x22f)+'<\x20?',[_0x593353]);if(!_0x2dcf33||_0x2dcf33[_0x3271e1(0x268)]===-0x8*0x2ee+0x2c1+0x423*0x5)return;info('[Delete]\x20c'+_0x3271e1(0x18d)+_0x2dcf33[_0x3271e1(0x268)]+(_0x3271e1(0x312)+_0x3271e1(0x300)+'\x20than\x20')+DELETE_CLEANUP_DAYS+_0x3271e1(0x29f));for(const _0x5f3fe7 of _0x2dcf33){if(_0x5f3fe7[_0x3271e1(0x240)])try{await _0x516618(_0x5f3fe7[_0x3271e1(0x240)]);}catch(_0x276c1b){warn('[Delete]\x20f'+_0x3271e1(0x20a)+_0x3271e1(0x1cd)+_0x5f3fe7['media_path']+':\x20'+(_0x276c1b?.[_0x3271e1(0x205)]||_0x276c1b));}}const _0xcece6f=_0x2dcf33[_0x3271e1(0x2ec)](_0x3d04af=>_0x3d04af[_0x3271e1(0x2bf)]),_0x4166f0=-0x2191*-0x1+0x2544+-0xe3*0x4f;for(let _0x42342c=0x77+0x2*0x1e9+-0x1*0x449;_0x42342c<_0xcece6f['length'];_0x42342c+=_0x4166f0){const _0x5d062d=_0xcece6f[_0x3271e1(0x317)](_0x42342c,_0x42342c+_0x4166f0),_0x40d85d=_0x5d062d[_0x3271e1(0x2ec)](()=>'?')[_0x3271e1(0x336)](',');await db[_0x3271e1(0x221)](_0x3271e1(0x220)+_0x3271e1(0x313)+'\x20WHERE\x20msg'+_0x3271e1(0x1ef)+_0x40d85d+')',_0x5d062d);}info(_0x3271e1(0x353)+'leanup\x20com'+_0x3271e1(0x191));}catch(_0x191577){warn(_0x3271e1(0x2a0)+_0x3271e1(0x272)+_0x3271e1(0x2ce)+_0x3271e1(0x343)+(_0x191577?.[_0x3271e1(0x205)]||_0x191577));}}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0x213e+0x3*0x29+0x20e1)*(0xf*0x41+0xf8*-0x13+0x1281*0x1);function markCmdProcessed(_0x4e1fbd){const _0x12185d=_0x251909;if(!_0x4e1fbd)return;if(processedCmdKeys[_0x12185d(0x316)](_0x4e1fbd))try{clearTimeout(processedCmdKeys['get'](_0x4e1fbd));}catch(_0x2bc1da){};const _0x9c2e72=setTimeout(()=>processedCmdKeys[_0x12185d(0x2e2)](_0x4e1fbd),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x12185d(0x1c5)](_0x4e1fbd,_0x9c2e72);}function isCmdProcessed(_0x447428){const _0x5dc423=_0x251909;return _0x447428&&processedCmdKeys[_0x5dc423(0x316)](_0x447428);}export async function onMessage(_0x8631a8){const _0x41f6f3=_0x251909;try{if(!_0x8631a8||!_0x8631a8['key']||!_0x8631a8[_0x41f6f3(0x205)]||!_0x8631a8[_0x41f6f3(0x1be)])return;if(isJidGroup(_0x8631a8[_0x41f6f3(0x250)][_0x41f6f3(0x277)]))return;const _0x2e74e3=_0x8631a8[_0x41f6f3(0x250)][_0x41f6f3(0x19a)],_0x115166=await isSudo(botRef,_0x8631a8)[_0x41f6f3(0x363)](()=>![]);if(!_0x2e74e3&&!_0x115166)return;let _0x6d9b6;if(_0x2e74e3){_0x6d9b6=getBotJid();if(!_0x6d9b6){warn(_0x41f6f3(0x1f7)+_0x41f6f3(0x1dd)+_0x41f6f3(0x2e6)+_0x41f6f3(0x2a4)+_0x41f6f3(0x333)+_0x41f6f3(0x1dc)+_0x41f6f3(0x2b0));return;}}else _0x6d9b6=_0x8631a8['key'][_0x41f6f3(0x277)];const _0x43b72d=String(_0x8631a8[_0x41f6f3(0x250)][_0x41f6f3(0x277)]||'')+'::'+String(_0x8631a8[_0x41f6f3(0x250)]['id']||_0x8631a8[_0x41f6f3(0x250)]['participan'+'t']||'');if(isCmdProcessed(_0x43b72d))return;markCmdProcessed(_0x43b72d);const _0x4e96f7=typeof _0x8631a8['text']===_0x41f6f3(0x28e)&&_0x8631a8[_0x41f6f3(0x242)][_0x41f6f3(0x288)]()[_0x41f6f3(0x268)]?_0x8631a8['text']['trim']():function _0x305ce8(_0x1f6d82){const _0x9bfca5=_0x41f6f3;if(!_0x1f6d82||!_0x1f6d82[_0x9bfca5(0x205)])return'';const _0x415dbc=_0x1f6d82[_0x9bfca5(0x205)];if(_0x415dbc[_0x9bfca5(0x1e8)+'on'])return _0x415dbc[_0x9bfca5(0x1e8)+'on'];if(_0x415dbc[_0x9bfca5(0x1ca)+'xtMessage']?.['text'])return _0x415dbc[_0x9bfca5(0x1ca)+_0x9bfca5(0x332)][_0x9bfca5(0x242)];if(_0x415dbc[_0x9bfca5(0x19c)+'ge']?.['caption'])return _0x415dbc[_0x9bfca5(0x19c)+'ge'][_0x9bfca5(0x276)];if(_0x415dbc[_0x9bfca5(0x1e1)+'ge']?.[_0x9bfca5(0x276)])return _0x415dbc[_0x9bfca5(0x1e1)+'ge']['caption'];if(_0x415dbc[_0x9bfca5(0x249)+_0x9bfca5(0x192)+'ge']?.[_0x9bfca5(0x22c)+'ttonId'])return _0x415dbc['buttonsRes'+'ponseMessa'+'ge'][_0x9bfca5(0x22c)+_0x9bfca5(0x17a)];if(_0x415dbc['listRespon'+_0x9bfca5(0x2bb)]?.[_0x9bfca5(0x2a9)+_0x9bfca5(0x2d9)]?.[_0x9bfca5(0x23a)+_0x9bfca5(0x261)])return _0x415dbc['listRespon'+'seMessage'][_0x9bfca5(0x2a9)+_0x9bfca5(0x2d9)]['selectedRo'+_0x9bfca5(0x261)];return'';}(_0x8631a8)||'';if(!_0x4e96f7)return;const _0x7c6fa5=(_0x4e96f7[_0x41f6f3(0x31d)](/\r?\n/)[-0x1f64+0x325*0xa+-0xe]||'')[_0x41f6f3(0x288)](),_0xa68e9b=_0x7c6fa5['split'](/\s+/),_0x29715b=(_0xa68e9b[0x137*-0x1+-0x256d+0x26a4]||'')[_0x41f6f3(0x1ec)+'e']();if(!commands[_0x41f6f3(0x308)](_0x29715b))return;const _0x332456=(_0xa68e9b[-0xb97+0x1045*-0x1+-0x7*-0x3fb]||'')[_0x41f6f3(0x1ec)+'e']();if(_0x332456&&_0x332456[_0x41f6f3(0x308)]('@')){const _0x3c1f03=normalizeToUserJid(_0x332456),_0x196c03=await saveDeleteTarget(_0x3c1f03);if(_0x196c03)await sendWithRetry(_0x6d9b6,{'text':_0x41f6f3(0x226)+_0x41f6f3(0x1d7)+_0x41f6f3(0x18f)+_0x3c1f03+_0x41f6f3(0x34e)+(DELETE_MODE==='g'?_0x41f6f3(0x35b):'PM')});else await sendWithRetry(_0x6d9b6,{'text':_0x41f6f3(0x2dc)+'ailed\x20to\x20s'+_0x41f6f3(0x1f4)+'\x20JID:\x20'+_0x3c1f03});return;}if(_0x332456===_0x41f6f3(0x196)||_0x332456===_0x41f6f3(0x233)||_0x332456==='remove'){const _0x57841b=await saveDeleteTarget(null);if(_0x57841b)await sendWithRetry(_0x6d9b6,{'text':_0x41f6f3(0x226)+'arget\x20JID\x20'+_0x41f6f3(0x1d2)+'ill\x20fallba'+_0x41f6f3(0x34b)+'PM\x20when\x20in'+_0x41f6f3(0x27b)+'e.'});else await sendWithRetry(_0x6d9b6,{'text':_0x41f6f3(0x2dc)+_0x41f6f3(0x2e8)+_0x41f6f3(0x197)+_0x41f6f3(0x2c9)});return;}if(_0x332456==='p'||_0x332456==='pm'){await saveDeleteMode('p'),await sendWithRetry(_0x6d9b6,{'text':_0x41f6f3(0x2ab)+_0x41f6f3(0x1cc)+_0x41f6f3(0x1cf)+'ered\x20delet'+_0x41f6f3(0x18a)+'s\x20will\x20be\x20'+_0x41f6f3(0x1bb)+_0x41f6f3(0x210)});return;}if(_0x332456==='g'||_0x332456===_0x41f6f3(0x2a3)||_0x332456==='gp'){await saveDeleteMode('g');const _0x154249=TARGET_JID?_0x41f6f3(0x187)+_0x41f6f3(0x2e4)+TARGET_JID:_0x41f6f3(0x1cb)+'ed\x20target\x20'+_0x41f6f3(0x2fa)+_0x41f6f3(0x248)+_0x41f6f3(0x216)+_0x41f6f3(0x27d)+'gured.';await sendWithRetry(_0x6d9b6,{'text':_0x41f6f3(0x2ab)+_0x41f6f3(0x1cc)+_0x41f6f3(0x257)+_0x154249});return;}const _0x3d3c73=DELETE_MODE==='g'?_0x41f6f3(0x2ff)+(TARGET_JID||'not\x20set')+')':'PM';await sendWithRetry(_0x6d9b6,{'text':_0x41f6f3(0x2b9)+_0x41f6f3(0x2ea)+_0x41f6f3(0x28d)+_0x41f6f3(0x291)+_0x41f6f3(0x281)+(_0x41f6f3(0x246)+_0x41f6f3(0x2e0)+'>\x20send\x20rec'+_0x41f6f3(0x33e)+_0x41f6f3(0x1c6))+(_0x41f6f3(0x344)+_0x41f6f3(0x1fd)+_0x41f6f3(0x1e6)+_0x41f6f3(0x224)+'\x20a\x20group\x0a')+(_0x41f6f3(0x31a)+_0x41f6f3(0x22e)+_0x41f6f3(0x33d)+'get\x20group\x20'+_0x41f6f3(0x203))+('\x20delete\x20cl'+_0x41f6f3(0x212)+_0x41f6f3(0x2a1)+'arget\x20grou'+'p\x20JID\x0a\x0a')+(_0x41f6f3(0x185)+_0x41f6f3(0x280))+('\x20Send\x20Mode'+_0x41f6f3(0x340)+_0x3d3c73+'*\x0a')+(_0x41f6f3(0x304)+_0x41f6f3(0x202)+DEFAULT_SEND_DELETE+'*\x0a')+('\x20Cleanup\x20A'+_0x41f6f3(0x24f)+DELETE_CLEANUP_DAYS+_0x41f6f3(0x30d))});}catch(_0x77ef91){error(_0x77ef91,_0x41f6f3(0x25d)+_0x41f6f3(0x326)+'rror:\x20'+(_0x77ef91?.[_0x41f6f3(0x205)]||_0x77ef91));}}export async function initialize(_0x256fcd){const _0x5ceabe=_0x251909;if(!_0x256fcd)throw new Error('delete\x20mod'+_0x5ceabe(0x2b8)+_0x5ceabe(0x2cc));botRef=_0x256fcd,refreshConfig(),await ensureTable()[_0x5ceabe(0x363)](_0x1e33b1=>{const _0x2ade03=_0x5ceabe;error(_0x2ade03(0x352)+_0x2ade03(0x26a)+_0x2ade03(0x33a)+_0x2ade03(0x24c)+_0x2ade03(0x25f)+(_0x1e33b1?.[_0x2ade03(0x205)]||_0x1e33b1));throw _0x1e33b1;}),startManagedListener({'botRef':botRef,'eventName':_0x5ceabe(0x349)+_0x5ceabe(0x30b),'handler':rawMessagesUpsertHandler,'moduleName':name}),await autoCleanOldMessagesSafe()[_0x5ceabe(0x363)](_0x4e10d5=>warn(_0x5ceabe(0x262)+_0x5ceabe(0x2f0)+_0x5ceabe(0x1c9)+':\x20'+(_0x4e10d5?.[_0x5ceabe(0x205)]||_0x4e10d5)));if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(autoCleanOldMessagesSafe,CLEANUP_INTERVAL||FALLBACKS['CLEANUP_IN'+_0x5ceabe(0x351)]),info(_0x5ceabe(0x28c)+'nitialized'+_0x5ceabe(0x34e)+DELETE_MODE+(',\x20Cleanup\x20'+_0x5ceabe(0x2c6))+DELETE_CLEANUP_DAYS);}export async function cleanup(){const _0x370f37=_0x251909;try{stopManagedListener(name,_0x370f37(0x349)+_0x370f37(0x30b)),cleanupInterval&&(clearInterval(cleanupInterval),cleanupInterval=null),messageQueue[_0x370f37(0x268)]=0x19ad*-0x1+0xcba+0xcf3,deletionQueue[_0x370f37(0x268)]=0x56*0x5b+-0x3*-0x1b7+-0x29*0xdf,pendingRecovered['length']=-0x3*-0x4a+0x1*-0x929+0x84b;}catch(_0x290997){warn(_0x370f37(0x353)+_0x370f37(0x32a)+'or:\x20'+(_0x290997?.[_0x370f37(0x205)]||_0x290997));}finally{botRef=null;}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};