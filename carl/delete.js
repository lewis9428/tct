const _0x195b9c=_0x57d5;(function(_0x4b5a5f,_0x38565a){const _0x283971=_0x57d5,_0x14daa3=_0x4b5a5f();while(!![]){try{const _0x171255=parseInt(_0x283971(0x146))/(0x1cc1+-0x240*-0x9+0x8*-0x620)+-parseInt(_0x283971(0x29a))/(0x13d6+-0x256*0xd+0xa8a)*(parseInt(_0x283971(0x160))/(-0x2*0x2e7+0x10b9+-0xae8))+parseInt(_0x283971(0x276))/(-0x247a+-0x1422+0x38a0)+parseInt(_0x283971(0x174))/(-0x2190+-0x313*-0xb+-0x3c)+-parseInt(_0x283971(0x1ac))/(0x222f+-0xf3d+-0x12ec)+-parseInt(_0x283971(0x241))/(-0x5*0x488+-0x31*-0x12+0x1*0x133d)*(parseInt(_0x283971(0x284))/(0x1*-0xfb5+0x17d2+-0x815*0x1))+-parseInt(_0x283971(0xea))/(-0x2313+-0x4a6+0x27c2);if(_0x171255===_0x38565a)break;else _0x14daa3['push'](_0x14daa3['shift']());}catch(_0x1c49df){_0x14daa3['push'](_0x14daa3['shift']());}}}(_0x1c43,0x8d69*0x1c+0x16c58+-0x5637a));import _0x5cd66a from'path';import _0x17ff46 from'fs';import{mkdirSync}from'fs';import{rm as _0x16ae4f}from'fs/promises';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';function _0x57d5(_0x284124,_0x4c424d){const _0xea8e7f=_0x1c43();return _0x57d5=function(_0x29840e,_0x41f028){_0x29840e=_0x29840e-(-0x9ce+-0x1c30+0x26da);let _0x1a0898=_0xea8e7f[_0x29840e];return _0x1a0898;},_0x57d5(_0x284124,_0x4c424d);}import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import _0x5e99fe from'node-cache';import{isSudo}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x195b9c(0x103)+'overy';export const version=_0x195b9c(0x2b7);function _0x1c43(){const _0x497b1a=['ed:\x20','text','error:\x20','etry\x20inser','?,\x20?,\x20?,\x20?','ed_at=excl','send\x20faile','REPLACE\x20IN','TIAL_BACKO','poll','json,\x20time','leanup\x20aft','vered\x20send','CURRENCY_L','plete.','SELECT\x20msg','once','createRead','failed\x20for','join','error\x20for\x20','IA_DIR','ed_at\x20FROM','toLowerCas','rror:\x20','ANUP_INTER','er\x20send\x20fa','s\x20(msg_id,','[Delete]\x20D','VAL_MS','[delete]\x20T','length','EXISTS\x20mes','ata','jid','FROM\x20messa','M\x20messages','CLEANUP_IN','\x20—\x20ensurin','get\x20availa','_path,\x20sav','delete','s\x20WHERE\x20ms','\x20Send\x20Mode','rget\x20avail','ICT(key)\x20D','messages.','run','ESSAGES\x20RE','ummary\x20sen','wId','item\x20error','DELETE_MED','_id\x20IN\x20(','splice','lback)\x20fai','audio','image','\x20delete\x20p|','T\x20NULL\x20AND','riginal\x20fo','refs\x20WHERE','data','bType','video','dia\x20error:','or\x20for\x20','Message','geRow\x20erro','eliver\x20med','xcluded.va','includes','DELETE_CLE','set','essages\x27)','\x20is\x20empty','DELETE_INI','get','DEFAULT_SE','SELECT\x20val','\x20days*','edia\x20(stre','document','ard\x20error:','ANUP_DAYS','groupMetad','ed_at','[Delete]\x20C','documentMe','arget\x20JID\x20','*Delete\x20Re','Only)*\x0a\x0a','sages\x20row:','group\x20\x20\x20\x20\x20','cipant_alt','nMessage\x20e','stringify','DEBOUNCE_M','=\x27mode\x27','fileName','PROJECT_RO','onWhatsApp','JID\x20set;\x20w','ToFile\x20fai','mentions','ck\x20to\x20bot\x20','DEFAULT_CO','IMIT','buttonsRes','selectedBu','aveDeleteM','saved:\x20','ting\x20file\x20','umn','\x20WHERE\x20msg','[delete]\x20F','message_js','DATE\x20SET\x20v','psert','R\x20DEFAULT\x20','led\x20for\x20','ded.value,','leanup\x20err','remove','estamp','g\x20in\x20DB\x20fo','GROUP\x20(','ssing\x20key.','[Delete]\x20i','[Delete]\x20d','remoteJid','ue\x20FROM\x20de','led:\x20','_id,\x20messa','\x20messages\x20','finish','destroy','edia\x20sent\x20','[Delete]\x20f','ode\x20set\x20to','shift','\x20Recovery\x20','[Delete]\x20r','.\x20Mode:\x20','UpsertHand','floor','28189IBYuaZ','s\x20will\x20be\x20','🗑\x20*','CREATE\x20TAB','listRespon','failed:\x20','[Delete]\x20a','[Delete]\x20m','all','IA_SEND_DE','messages.u','name','\x20delete\x20<j','mediaPath','[Delete]\x20I','has','cleared.\x20W','caption','ill\x20send\x20t','LE\x20IF\x20NOT\x20','(no-id)','TEXT\x20PRIMA','isArray','lear\x20targe','MODULE_CON','FF_MS','[Delete]\x20l','LAY_MS','[Delete]\x20s',',\x20?,\x20?)\x20ON','edia_path,','egacy\x20forw','zation\x20fai','ed\x20error:\x20','_DELAY_MS','INTEGER','parse','catch','pop','fromMe','PM\x20when\x20in','subject','ble.','pm\x20\x20\x20\x20\x20\x20\x20-','not\x20set','msg_id','arget_jid\x27','string','alMessage\x20','singleSele','function','ed\x20media\x20f','DELETE\x20FRO','5504512QGnmnj','et_jid\x27','arget\x20grou','B\x20initiali','d).\x20Leavin','key','\x20->\x20','exec','ttonId','\x20than\x20','IA_DIRNAME','ges\x20(older','[Sticker]','\x20\x20\x20updated','1192qDbOho','dMessages\x20','end\x20attemp','CKOFF_MS','es\x20bot\x20arg','ile-send\x20(','able','saved_at','ed\x20due\x20mis','d:\x20','keys','t\x20JID.','ET\x20value=e','sendMessag','aybeSaveMe','er\x20item\x20er','\x20Cleanup\x20A','treamMedia','ia_path,\x20s','o\x20send\x20tar','\x20chat_jid,','d\x20unexpect','2892lXIngY','slice','[delete]\x20M','nWhatsApp\x20','->\x20set\x20tar','\x20to\x20','CLEANUP_DA','📝\x20Content:','ker\x20item\x20e','stickerMes','type','bParameter','e\x20TEXT\x20NOT','try/cleanu','=\x27target_j','has\x20no\x20col','efreshConf','mp4','JID\x0a','\x20(all\x20atte','dMessagesS','ecovered\x20o','p\x20JID\x0a\x0a','statSync','O\x20delete_p','filter','adcast','ponseMessa','ot-reloade','4.2.0','fter:\x20*','r\x20later\x20re','eletionWor','extendedTe','rocessMess','VALUES\x20(\x27m','ailed\x20to\x20r','ES\x20(?,\x20?,\x20','ssage','lushRecove','leanup\x20com','value','nsertMessa','otReloadCo','endsWith','d_at\x20IS\x20NO','ptvMessage','sing\x20colum','jid,\x20parti','or:\x20','eStream','\x20a\x20group\x0a','ailed\x20dele','drain','ges\x20WHERE\x20','13007466tskakC','aveDeleteT','[Delete]\x20o','aved_at,\x20r','or\x20','seMessage','group','ND_DELETE','messageStu','er\x20legacy-','map','ode\x20saved:','essageWork','size','_id=?',',\x20message_','annot\x20repl','🗨\x20Group:\x20','MEDIA_SEND','ogg','add','O\x20UPDATE\x20S','refs\x20(key,','awMessages','forwarded\x20','delete-rec','esent_at)\x0a','\x20WHERE\x20key','lush\x20loop\x20','load\x20faile','lback)\x20err','\x20delete\x20g|','number','find','media','D_DELETE\x20f','\x20days)','unset','y\x20TEXT\x20PRI','eleteMessa','[Delete]\x20p','ptv','ode\x20failed','bin','%\x22id\x22:\x22','ot\x20JID\x20is\x20','sticker','redBatch\x20e','EFAULT_SEN','uded.updat','imageMessa','originalMe','ler\x20error:','sage','lue,\x20updat','[no-id]','o\x20bot\x20PM\x20u','NCURRENCY','ode\x27,\x20?,\x20?','ETRIES','nsert\x20fail','tatus:*\x0a','OUNCE_MS','end','GROUP','\x20PM.\x20Recov','url\x20form)\x20','DELETE_CON','TERVAL_MS','INSERT\x20INT',',\x0a\x20\x20','rocessDele','ror:\x20','\x20key=\x27targ','anup\x20error','Usage:\x0a','Stream','\x20\x20\x20\x20\x20\x20valu','to\x20bot\x20PM.','lete_prefs','g\x20table\x20an','media_path','indexOf','clear','ALTER\x20TABL','forward\x20fa','existsSync','RY\x20KEY','nitialized','protocolMe','jpg','led\x20fatall','1146988IGxFog','->\x20send\x20re','ed\x20message','webp','utoCleanOl','pollCreati','trim','ed\x20target\x20','conversati','INITIAL_BA','t=excluded','[Voice\x20not','[Delete]\x20t','object','[Media]','ear\x20\x20\x20\x20\x20\x20\x20','MAX_SEND_R','no\x20send\x20ta','->\x20clear\x20t','[Delete]\x20c','\x20?)','ptt','videoMessa','\x20delete\x20cl','No\x20persist','EXISTS\x20del','234bUwVyG','sender','stream\x20fal','ble',',\x20?,\x20?,\x20?,','\x20ADD\x20COLUM','message','TEXT','stamp,\x20med','0\x0a\x20\x20\x20\x20);','le_info(\x27m','iled:\x20','basename',':\x20*','ge_json,\x20m','low','notify','\x20JID:\x20','\x20because\x20b','participan','2547995lGqsyM','mapping\x20fa','emove\x20file','gifPlaybac','[Delete]\x20P','dd\x20column\x20','content','\x20saved_at\x20','arget_jid\x20','resolve','[Delete]\x20u','split','\x20value,\x20up','messageTim','pping\x20reco','g_id=?','[Delete]\x20e','\x20NULL,\x0a\x20\x20\x20','tionItem\x20e','push','geToDB:\x20mi','👤\x20From:\x20@','\x20remote_al','audioMessa','remoteJidA','etchOrigin','id>\x20\x20\x20\x20\x20\x20\x20','arget\x20fail','sock','er\x20stream-','\x0a);','ave\x20target','COVERED*\x20🗑','dated_at)\x20',',\x20Cleanup\x20','ecovered\x20m','ailed\x20to\x20s','afe\x20error:','not\x20availa','rate','xtMessage','ode\x27,\x27p\x27,\x20','DELETE_MAX','Configured','ia\x20for\x20','e_info\x20fai','d\x20retry','boolean','DELETE_DEB','ageItem\x20er','tings\x20(PM-','selectedRo','for\x20','seconds','\x20GROUP.\x20','mimetype','725256LuvWny','IES','now'];_0x1c43=function(){return _0x497b1a;};return _0x1c43();}export const priority=0x6*-0x2f5+-0x20e2+0x32d2;export const commands=[_0x195b9c(0x1d8)];export const configKeys=[_0x195b9c(0x1e3)+'IA_DIRNAME',_0x195b9c(0x1a4)+_0x195b9c(0x128),'DELETE_CON'+'CURRENCY',_0x195b9c(0x1fd)+_0x195b9c(0xf1),_0x195b9c(0x1f7)+_0x195b9c(0x203),_0x195b9c(0x1f7)+'ANUP_INTER'+_0x195b9c(0x1cc)];const FALLBACKS={'DEBOUNCE_MS':0xbb8,'MEDIA_DIRNAME':_0x195b9c(0x10c),'DEFAULT_CONCURRENCY':0x3,'CLEANUP_INTERVAL_MS':(0x1058+0x1377+-0x23c9)*(0x9d*-0x17+-0x66*0x61+0x34fd*0x1)*(0x2376+-0x31*-0xbf+-0x47c9)*(0x1*0x15ed+0x25e+-0x11*0x133),'MEDIA_SEND_DELAY_MS':0x12c,'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4,'CLEANUP_DAYS':0x3};let botRef=null,cleanupInterval=null;const messageQueue=[],deletionQueue=[];let activeMessageTasks=-0x964+-0xe6f+0x17d3,activeDeletionTasks=0x545+-0x8ed+0x3a8,MEDIA_DIR=null,DEBOUNCE_DELAY_MS=FALLBACKS[_0x195b9c(0x210)+'S'],CONCURRENCY=FALLBACKS[_0x195b9c(0x219)+_0x195b9c(0x123)],MEDIA_SEND_DELAY_MS=FALLBACKS[_0x195b9c(0xfc)+_0x195b9c(0x263)],CLEANUP_INTERVAL=FALLBACKS['CLEANUP_IN'+_0x195b9c(0x12e)],MAX_SEND_RETRIES=FALLBACKS[_0x195b9c(0x156)+_0x195b9c(0x125)],INITIAL_BACKOFF=FALLBACKS['INITIAL_BA'+_0x195b9c(0x287)],DELETE_CLEANUP_DAYS=FALLBACKS[_0x195b9c(0x2a0)+'YS'],DEFAULT_SEND_DELETE=![],DELETE_MODE='p',TARGET_JID=null;const nameCache=new _0x5e99fe({'stdTTL':0xe10});let flushTimer=null;const pendingRecovered=[];function ensureDirSync(_0x33f46a){if(!_0x17ff46['existsSync'](_0x33f46a))mkdirSync(_0x33f46a,{'recursive':!![]});}function sleep(_0x42c102){return new Promise(_0x565a92=>setTimeout(_0x565a92,_0x42c102));}function normalizeToUserJid(_0x5b16b2){const _0x3b1f73=_0x195b9c;try{if(!_0x5b16b2||typeof _0x5b16b2!==_0x3b1f73(0x270))return _0x5b16b2;const _0x208d1e=_0x5b16b2[_0x3b1f73(0x13c)]('@');if(_0x208d1e===-(-0xa*-0xf8+0x8f2+-0x12a1))return _0x5b16b2;const _0x84907=_0x5b16b2[_0x3b1f73(0x29b)](0x2574+-0xb27+-0x1a4d*0x1,_0x208d1e),_0x2e21e9=_0x5b16b2['slice'](_0x208d1e),_0x4f8832=_0x84907[_0x3b1f73(0x13c)](':');if(_0x4f8832===-(-0xe2*-0xb+0x20d0+0x5*-0x881))return _0x5b16b2;return _0x84907[_0x3b1f73(0x29b)](-0x1*0xd8b+-0x634+0x13bf,_0x4f8832)+_0x2e21e9;}catch(_0x322579){return _0x5b16b2;}}function refreshConfig(){const _0x7ceb8b=_0x195b9c;try{const _0xe01d4d=getConfig()||{};DEFAULT_SEND_DELETE=typeof _0xe01d4d['DEFAULT_SE'+_0x7ceb8b(0xf1)]===_0x7ceb8b(0x1a3)?_0xe01d4d[_0x7ceb8b(0x1fd)+_0x7ceb8b(0xf1)]:DEFAULT_SEND_DELETE,DEBOUNCE_DELAY_MS=Number(_0xe01d4d['DELETE_DEB'+_0x7ceb8b(0x128)]??FALLBACKS[_0x7ceb8b(0x210)+'S']),CONCURRENCY=Number(_0xe01d4d[_0x7ceb8b(0x12d)+'CURRENCY']??_0xe01d4d[_0x7ceb8b(0x259)+_0x7ceb8b(0x1bc)+_0x7ceb8b(0x21a)]??FALLBACKS[_0x7ceb8b(0x219)+_0x7ceb8b(0x123)]),MEDIA_SEND_DELAY_MS=Number(_0xe01d4d['DELETE_MED'+_0x7ceb8b(0x24a)+_0x7ceb8b(0x25c)]??FALLBACKS[_0x7ceb8b(0xfc)+'_DELAY_MS']),CLEANUP_INTERVAL=Number(_0xe01d4d['DELETE_CLE'+_0x7ceb8b(0x1c8)+_0x7ceb8b(0x1cc)]??FALLBACKS[_0x7ceb8b(0x1d4)+_0x7ceb8b(0x12e)]),MAX_SEND_RETRIES=Number(_0xe01d4d[_0x7ceb8b(0x19e)+'_SEND_RETR'+_0x7ceb8b(0x1ad)]??FALLBACKS[_0x7ceb8b(0x156)+_0x7ceb8b(0x125)]),INITIAL_BACKOFF=Number(_0xe01d4d[_0x7ceb8b(0x1fb)+_0x7ceb8b(0x1b7)+_0x7ceb8b(0x25a)]??FALLBACKS['INITIAL_BA'+_0x7ceb8b(0x287)]),DELETE_CLEANUP_DAYS=Number(_0xe01d4d[_0x7ceb8b(0x1f7)+_0x7ceb8b(0x203)]??FALLBACKS[_0x7ceb8b(0x2a0)+'YS']);const _0x53f58c=_0xe01d4d[_0x7ceb8b(0x213)+'OT']&&typeof _0xe01d4d[_0x7ceb8b(0x213)+'OT']===_0x7ceb8b(0x270)?_0xe01d4d[_0x7ceb8b(0x213)+'OT']:process['cwd'](),_0x558c2f=_0x5cd66a[_0x7ceb8b(0x17d)](_0x53f58c,_0x7ceb8b(0x1ed),_0x7ceb8b(0x1d8));ensureDirSync(_0x558c2f),MEDIA_DIR=_0x5cd66a['join'](_0x558c2f,_0xe01d4d[_0x7ceb8b(0x1e3)+_0x7ceb8b(0x280)]??_0xe01d4d[_0x7ceb8b(0x1e3)+_0x7ceb8b(0x1c4)]??FALLBACKS['MEDIA_DIRN'+'AME']),ensureDirSync(MEDIA_DIR);}catch(_0xe6673f){warn(_0x7ceb8b(0x23d)+_0x7ceb8b(0x2aa)+'ig\x20error:\x20'+(_0xe6673f?.[_0x7ceb8b(0x166)]||_0xe6673f));}}try{hotReloadConfig&&hotReloadConfig(()=>{const _0x2264ca=_0x195b9c;refreshConfig(),info('[Delete]\x20H'+_0x2264ca(0x2b6)+'d\x20config.');});}catch(_0x2ebe4c){warn('[Delete]\x20h'+_0x195b9c(0xde)+'nfig\x20regis'+'tration\x20fa'+_0x195b9c(0x16b)+(_0x2ebe4c?.[_0x195b9c(0x166)]||_0x2ebe4c));}refreshConfig();const MESSAGES_COLUMNS={'msg_id':_0x195b9c(0x256)+_0x195b9c(0x141),'chat_jid':'TEXT','remote_alt':_0x195b9c(0x167),'sender_jid':_0x195b9c(0x167),'participant_alt':_0x195b9c(0x167),'message_json':_0x195b9c(0x167),'timestamp':_0x195b9c(0x264),'media_path':_0x195b9c(0x167),'saved_at':_0x195b9c(0x264),'resent_at':_0x195b9c(0x264)};async function ensureTable(){const _0x51de86=_0x195b9c;try{const _0x513a6f=Object['entries'](MESSAGES_COLUMNS)[_0x51de86(0xf4)](([_0x553981,_0x5d5d6f])=>_0x553981+'\x20'+_0x5d5d6f)[_0x51de86(0x1c2)](_0x51de86(0x130));await db[_0x51de86(0x27d)](_0x51de86(0x244)+_0x51de86(0x254)+_0x51de86(0x1cf)+'sages\x20(\x0a\x20\x20'+_0x513a6f+_0x51de86(0x192));let _0x203f48=[];try{const _0x292833=await db['all']('PRAGMA\x20tab'+_0x51de86(0x16a)+_0x51de86(0x1f9));_0x203f48=(_0x292833||[])[_0x51de86(0xf4)](_0x2737a2=>_0x2737a2[_0x51de86(0x24c)]);}catch(_0x114d2d){warn(_0x51de86(0x178)+'RAGMA\x20tabl'+_0x51de86(0x1a1)+_0x51de86(0x233)+(_0x114d2d?.[_0x51de86(0x166)]||_0x114d2d));}for(const _0x416447 of Object[_0x51de86(0x28e)](MESSAGES_COLUMNS)){if(!_0x203f48['includes'](_0x416447)){const _0x470c9c=MESSAGES_COLUMNS[_0x416447];try{await db['run'](_0x51de86(0x13e)+'E\x20messages'+_0x51de86(0x165)+'N\x20'+_0x416447+'\x20'+_0x470c9c),info(_0x51de86(0x247)+'dded\x20missi'+'ng\x20column\x20'+_0x51de86(0x1dd)+_0x416447);}catch(_0x4a1675){warn(_0x51de86(0x239)+'ailed\x20to\x20a'+_0x51de86(0x179)+_0x416447+':\x20'+(_0x4a1675?.[_0x51de86(0x166)]||_0x4a1675));}}}await db[_0x51de86(0x27d)](_0x51de86(0x244)+_0x51de86(0x254)+_0x51de86(0x15f)+'ete_prefs\x20'+'(\x0a\x20\x20\x20\x20\x20\x20ke'+_0x51de86(0x110)+'MARY\x20KEY,\x0a'+_0x51de86(0x137)+_0x51de86(0x2a6)+_0x51de86(0x185)+_0x51de86(0x283)+'_at\x20INTEGE'+_0x51de86(0x226)+_0x51de86(0x169));try{const _0x2a24b9=await db[_0x51de86(0x1fc)](_0x51de86(0x1fe)+'ue\x20FROM\x20de'+'lete_prefs'+'\x20WHERE\x20key'+_0x51de86(0x211));if(!_0x2a24b9){const _0x4f342b=Math[_0x51de86(0x240)](Date['now']()/(0x1e76+-0x722+0x9b6*-0x2));await db[_0x51de86(0x1de)]('INSERT\x20INT'+_0x51de86(0x2b2)+_0x51de86(0x100)+_0x51de86(0x180)+_0x51de86(0x195)+_0x51de86(0x2bd)+_0x51de86(0x19d)+'?)',[_0x4f342b]),DELETE_MODE='p';}else DELETE_MODE=_0x2a24b9['value']==='g'?'g':'p';}catch(_0x18cc40){warn(_0x51de86(0x112)+'refs\x20(mode'+')\x20load\x20fai'+'led:\x20'+(_0x18cc40?.[_0x51de86(0x166)]||_0x18cc40));}try{const _0x4add79=await db[_0x51de86(0x1fc)]('SELECT\x20val'+_0x51de86(0x232)+_0x51de86(0x139)+_0x51de86(0x105)+_0x51de86(0x2a8)+'id\x27');TARGET_JID=_0x4add79?.[_0x51de86(0xdc)]||null;}catch(_0x2b41c4){warn(_0x51de86(0x152)+_0x51de86(0x17c)+_0x51de86(0x107)+_0x51de86(0x28d)+(_0x2b41c4?.[_0x51de86(0x166)]||_0x2b41c4)),TARGET_JID=null;}}catch(_0x35e5de){warn(_0x51de86(0x184)+'nsureTable'+'\x20top\x20error'+':\x20'+(_0x35e5de?.['message']||_0x35e5de));throw _0x35e5de;}}async function streamMediaToFile(_0x14a1c4,_0x85c99c){const _0x517f2c=_0x195b9c;try{const _0x44b5d3=_0x14a1c4[_0x517f2c(0x166)][_0x85c99c+_0x517f2c(0x1f2)],_0x494a0d=await downloadContentFromMessage(_0x44b5d3,_0x85c99c);let _0x4a2992=_0x517f2c(0x115);if(_0x85c99c===_0x517f2c(0x1e8))_0x4a2992=_0x517f2c(0x144);else{if(_0x85c99c===_0x517f2c(0x1ef)||_0x85c99c===_0x517f2c(0x113))_0x4a2992=_0x517f2c(0x2ab);else{if(_0x85c99c===_0x517f2c(0x1e7))_0x4a2992=_0x517f2c(0xfd);else{if(_0x85c99c===_0x517f2c(0x201))_0x4a2992=_0x44b5d3?.[_0x517f2c(0x212)]?_0x44b5d3['fileName'][_0x517f2c(0x17f)]('.')[_0x517f2c(0x267)]():'pdf';else{if(_0x85c99c===_0x517f2c(0x118))_0x4a2992=_0x517f2c(0x149);}}}}const _0x5d1b00=_0x14a1c4['key']['id']+'.'+_0x4a2992,_0x20773d=_0x5cd66a['join'](MEDIA_DIR,_0x5d1b00);await new Promise((_0x35f929,_0x3d0bbd)=>{const _0x31cde5=_0x517f2c,_0x5796ed=_0x17ff46['createWrit'+_0x31cde5(0xe5)](_0x20773d);((async()=>{const _0x9da066=_0x31cde5;try{for await(const _0x3b7263 of _0x494a0d){if(!_0x5796ed['write'](_0x3b7263))await new Promise(_0x5138cd=>_0x5796ed[_0x9da066(0x1bf)](_0x9da066(0xe8),_0x5138cd));}_0x5796ed[_0x9da066(0x129)](),_0x5796ed[_0x9da066(0x1bf)](_0x9da066(0x236),()=>_0x35f929());}catch(_0x1e26eb){try{_0x5796ed[_0x9da066(0x237)]();}catch(_0x12c5a0){}_0x3d0bbd(_0x1e26eb);}})());});try{const _0x2e267b=_0x17ff46[_0x517f2c(0x2b1)](_0x20773d);if(_0x2e267b[_0x517f2c(0xf7)]===0x1c90+0x20d7+-0x3d67)return warn(_0x517f2c(0x25d)+'aved\x20file\x20'+_0x20773d+_0x517f2c(0x1fa)),null;}catch(_0x5d281a){}return _0x20773d;}catch(_0x55c444){return warn(_0x517f2c(0x25d)+_0x517f2c(0x295)+_0x517f2c(0x216)+'led\x20for\x20'+(_0x14a1c4[_0x517f2c(0x27b)]?.['id']||_0x517f2c(0x121))+':\x20'+(_0x55c444?.[_0x517f2c(0x166)]||_0x55c444)),null;}}async function maybeSaveMedia(_0x380bba){const _0xb33608=_0x195b9c;try{const _0x277274=['image',_0xb33608(0x1ef),'ptv',_0xb33608(0x1e7),_0xb33608(0x201),'sticker'];for(const _0x95a8b of _0x277274){if(_0x95a8b===_0xb33608(0x113)){if(_0x380bba[_0xb33608(0x166)]?.['ptvMessage'])return await streamMediaToFile(_0x380bba,'ptv');continue;}if(_0x380bba[_0xb33608(0x166)]?.[_0x95a8b+_0xb33608(0x1f2)])return await streamMediaToFile(_0x380bba,_0x95a8b);}return null;}catch(_0x36f7dd){return warn(_0xb33608(0x248)+_0xb33608(0x292)+_0xb33608(0x1f0)+'\x20'+(_0x36f7dd?.[_0xb33608(0x166)]||_0x36f7dd)),null;}}async function insertMessageToDB(_0x55174b,_0x4909c0){const _0x3b4c82=_0x195b9c;try{if(!_0x55174b||!_0x55174b[_0x3b4c82(0x27b)])return;const {id:_0x306042,remoteJid:_0x4b9b17,participant:_0x389bff}=_0x55174b[_0x3b4c82(0x27b)],_0x16b316=_0x389bff||_0x4b9b17,_0x535611=typeof _0x55174b[_0x3b4c82(0x181)+'estamp']===_0x3b4c82(0x10a)?_0x55174b[_0x3b4c82(0x181)+_0x3b4c82(0x22b)]:_0x55174b['messageTim'+'estamp']?.[_0x3b4c82(0x16f)]||Math[_0x3b4c82(0x240)](Date[_0x3b4c82(0x1ae)]()/(-0x3*-0xcf7+0x1759+-0x3a56)),_0x474858=_0x55174b[_0x3b4c82(0x27b)]?.[_0x3b4c82(0x18c)+'lt']||null,_0x129637=_0x55174b['key']?.[_0x3b4c82(0x173)+'tAlt']||null,_0x6967bd=Math[_0x3b4c82(0x240)](Date[_0x3b4c82(0x1ae)]()/(0x1841+-0x19ad+0x554));if(!_0x306042){warn(_0x3b4c82(0x22f)+_0x3b4c82(0xdd)+_0x3b4c82(0x188)+_0x3b4c82(0x22e)+'id');return;}const _0xd0a89c='INSERT\x20OR\x20'+_0x3b4c82(0x1b6)+'TO\x20message'+_0x3b4c82(0x1ca)+_0x3b4c82(0x298)+_0x3b4c82(0x18a)+'t,\x20sender_'+_0x3b4c82(0xe3)+_0x3b4c82(0x20d)+_0x3b4c82(0xf9)+_0x3b4c82(0x1b9)+_0x3b4c82(0x168)+_0x3b4c82(0x296)+_0x3b4c82(0xed)+_0x3b4c82(0x104)+'\x20\x20\x20\x20\x20\x20VALU'+_0x3b4c82(0x2bf)+_0x3b4c82(0x1b3)+_0x3b4c82(0x164)+_0x3b4c82(0x15a),_0x48c9ca=[_0x306042,_0x4b9b17||null,_0x474858,_0x16b316||null,_0x129637,JSON[_0x3b4c82(0x20f)](_0x55174b),_0x535611,_0x4909c0||null,_0x6967bd,null];try{await db[_0x3b4c82(0x1de)](_0xd0a89c,_0x48c9ca);}catch(_0xfbcf21){const _0x5e13b8=String(_0xfbcf21?.[_0x3b4c82(0x166)]||'');if(_0x5e13b8[_0x3b4c82(0x1f6)](_0x3b4c82(0x2a9)+_0x3b4c82(0x220))){warn(_0x3b4c82(0x22f)+_0x3b4c82(0x126)+_0x3b4c82(0x28c)+_0x3b4c82(0xe2)+'n:\x20'+_0x5e13b8+(_0x3b4c82(0x1d5)+_0x3b4c82(0x13a)+_0x3b4c82(0x1a2)));try{await ensureTable(),await db[_0x3b4c82(0x1de)](_0xd0a89c,_0x48c9ca);}catch(_0x3c2ba2){warn(_0x3b4c82(0x23d)+_0x3b4c82(0x1b2)+'t\x20failed:\x20'+(_0x3c2ba2?.[_0x3b4c82(0x166)]||_0x3c2ba2));}}else throw _0xfbcf21;}}catch(_0xc0fd1){warn(_0x3b4c82(0x22f)+'nsertMessa'+'geToDB\x20fai'+'led:\x20'+(_0xc0fd1?.[_0x3b4c82(0x166)]||_0xc0fd1));}}async function fetchOriginalMessage(_0x3698e9){const _0x4d0f2c=_0x195b9c;try{if(!_0x3698e9)return null;const _0xc6cc7e=await db[_0x4d0f2c(0x1fc)]('SELECT\x20msg'+'_id,\x20messa'+_0x4d0f2c(0x16e)+_0x4d0f2c(0x25f)+_0x4d0f2c(0x17b)+'FROM\x20messa'+'ges\x20WHERE\x20'+'msg_id=?',[_0x3698e9]);if(_0xc6cc7e)try{return{'msg_id':_0xc6cc7e[_0x4d0f2c(0x26e)],'message':JSON['parse'](_0xc6cc7e[_0x4d0f2c(0x223)+'on']),'media_path':_0xc6cc7e[_0x4d0f2c(0x13b)],'saved_at':_0xc6cc7e[_0x4d0f2c(0x28b)]};}catch(_0x180300){return{'msg_id':_0xc6cc7e[_0x4d0f2c(0x26e)],'message':null,'media_path':_0xc6cc7e['media_path'],'saved_at':_0xc6cc7e[_0x4d0f2c(0x28b)]};}const _0x15cadb=_0x4d0f2c(0x116)+_0x3698e9+'\x22%',_0x10c6d4=await db['all'](_0x4d0f2c(0x1be)+_0x4d0f2c(0x234)+_0x4d0f2c(0x16e)+_0x4d0f2c(0x25f)+_0x4d0f2c(0x17b)+_0x4d0f2c(0x1d2)+_0x4d0f2c(0xe9)+_0x4d0f2c(0x223)+'on\x20LIKE\x20?\x20'+'LIMIT\x201',[_0x15cadb]);if(_0x10c6d4&&_0x10c6d4['length'])try{return{'msg_id':_0x10c6d4[-0xc1+0x71b*-0x1+-0x4*-0x1f7][_0x4d0f2c(0x26e)],'message':JSON[_0x4d0f2c(0x265)](_0x10c6d4[-0x1*0x1ec2+-0x26e9*0x1+0x45ab]['message_js'+'on']),'media_path':_0x10c6d4[-0x341*0x4+-0x2411*-0x1+0x7*-0x34b][_0x4d0f2c(0x13b)],'saved_at':_0x10c6d4[-0x1d3+-0x1b9*0x15+0x2600][_0x4d0f2c(0x28b)]};}catch(_0xc51418){return{'msg_id':_0x10c6d4[0x19f*0x1+0x1f34+0x20d3*-0x1][_0x4d0f2c(0x26e)],'message':null,'media_path':_0x10c6d4[0xda8+-0x98f+-0x419][_0x4d0f2c(0x13b)],'saved_at':_0x10c6d4[-0x13cc+-0xa41+0x1*0x1e0d][_0x4d0f2c(0x28b)]};}return null;}catch(_0x590c5e){return warn('[Delete]\x20f'+_0x4d0f2c(0x18d)+_0x4d0f2c(0x271)+_0x4d0f2c(0x1b1)+(_0x590c5e?.[_0x4d0f2c(0x166)]||_0x590c5e)),null;}}async function deleteMessageRow(_0x123d9b){const _0xa2b65a=_0x195b9c;try{if(!_0x123d9b)return;const _0x5b6a48=await db[_0xa2b65a(0x1fc)]('SELECT\x20med'+'ia_path\x20FR'+'OM\x20message'+_0xa2b65a(0x1d9)+_0xa2b65a(0x183),[_0x123d9b]);if(_0x5b6a48?.['media_path'])try{await _0x16ae4f(_0x5b6a48[_0xa2b65a(0x13b)]),info('[Delete]\x20r'+'emoved\x20sav'+_0xa2b65a(0x274)+'ile');}catch(_0x3d2842){warn('[Delete]\x20f'+_0xa2b65a(0x2be)+_0xa2b65a(0x176)+'\x20'+_0x5b6a48[_0xa2b65a(0x13b)]+':\x20'+(_0x3d2842?.[_0xa2b65a(0x166)]||_0x3d2842));}await db[_0xa2b65a(0x1de)]('DELETE\x20FRO'+'M\x20messages'+'\x20WHERE\x20msg'+_0xa2b65a(0xf8),[_0x123d9b]),info(_0xa2b65a(0x230)+'eleted\x20mes'+_0xa2b65a(0x20b)+'\x20'+_0x123d9b);}catch(_0x3c255a){warn('[Delete]\x20d'+_0xa2b65a(0x111)+_0xa2b65a(0x1f3)+'r:\x20'+(_0x3c255a?.[_0xa2b65a(0x166)]||_0x3c255a));}}async function sendWithRetry(_0x499a13,_0x4cda5b,_0x5f431e=[]){const _0x99d3e1=_0x195b9c,_0x30ac83=Number(MAX_SEND_RETRIES||FALLBACKS[_0x99d3e1(0x156)+_0x99d3e1(0x125)]);let _0x3b8089=0xbb4*0x1+0x80d*-0x4+0x1480,_0x53e4bc=Number(INITIAL_BACKOFF||FALLBACKS[_0x99d3e1(0x14f)+'CKOFF_MS']);const _0x5dfc71=[_0x499a13,TARGET_JID,getBotJid()][_0x99d3e1(0x2b3)](Boolean)['map'](normalizeToUserJid),_0x381ceb=new Set(),_0x168f34=[];for(const _0xefef5b of _0x5dfc71){if(!_0xefef5b)continue;!_0x381ceb['has'](_0xefef5b)&&(_0x381ceb[_0x99d3e1(0xfe)](_0xefef5b),_0x168f34[_0x99d3e1(0x187)](_0xefef5b));}let _0x534818=_0x168f34[_0x99d3e1(0x1ce)]?_0x168f34[0xca6+0xe9e+0x2ba*-0xa]:null;if(_0x534818&&_0x534818[_0x99d3e1(0xdf)]('@lid')&&typeof botRef?.[_0x99d3e1(0x190)]?.[_0x99d3e1(0x214)]===_0x99d3e1(0x273))try{const _0x10ee93=await botRef[_0x99d3e1(0x190)][_0x99d3e1(0x214)](_0x534818);if(Array[_0x99d3e1(0x257)](_0x10ee93)&&_0x10ee93[0x54f+0xb12+-0x1061*0x1]&&_0x10ee93[-0x981+0x5c9+0x3b8][_0x99d3e1(0x1d1)])_0x534818=normalizeToUserJid(_0x10ee93[-0x1f*0x82+0x1*-0x11bd+-0xb29*-0x3][_0x99d3e1(0x1d1)]);}catch(_0xda6fd0){warn('[Delete]\x20o'+_0x99d3e1(0x29d)+_0x99d3e1(0x175)+_0x99d3e1(0x16b)+(_0xda6fd0?.[_0x99d3e1(0x166)]||_0xda6fd0));}while(_0x3b8089<_0x30ac83){try{if(!_0x534818)throw new Error(_0x99d3e1(0x157)+_0x99d3e1(0x1db)+_0x99d3e1(0x28a));if(Array['isArray'](_0x5f431e)&&_0x5f431e[_0x99d3e1(0x1ce)]&&typeof _0x4cda5b===_0x99d3e1(0x153)&&_0x4cda5b!==null)_0x4cda5b[_0x99d3e1(0x217)]=_0x5f431e;return await botRef[_0x99d3e1(0x291)+'e'](_0x534818,_0x4cda5b),!![];}catch(_0x1090d5){_0x3b8089++;const _0x528c50=String(_0x1090d5?.[_0x99d3e1(0x166)]||'')[_0x99d3e1(0x1c6)+'e']()['includes'](_0x99d3e1(0x19b))||_0x1090d5?.['status']===0x160f+0x23cc+-0x382e;warn(_0x99d3e1(0x25d)+_0x99d3e1(0x286)+'t\x20'+_0x3b8089+_0x99d3e1(0x29f)+_0x534818+'\x20failed:\x20'+(_0x1090d5?.[_0x99d3e1(0x166)]||_0x1090d5));if(_0x3b8089>=_0x30ac83||!_0x528c50)return![];await sleep(_0x53e4bc),_0x53e4bc*=0x17*-0x98+-0x2*0xac5+-0x2ef*-0xc;}}return![];}function extractContent(_0x26af2c){const _0x1a098d=_0x195b9c;if(!_0x26af2c)return'';if(_0x26af2c[_0x1a098d(0x14e)+'on'])return _0x26af2c['conversati'+'on'];if(_0x26af2c[_0x1a098d(0x2bb)+_0x1a098d(0x19c)])return _0x26af2c['extendedTe'+_0x1a098d(0x19c)]['text'];if(_0x26af2c[_0x1a098d(0x11c)+'ge'])return _0x26af2c['imageMessa'+'ge']['caption']||'';if(_0x26af2c[_0x1a098d(0x15c)+'ge'])return _0x26af2c[_0x1a098d(0x15c)+'ge'][_0x1a098d(0x252)]||'';if(_0x26af2c[_0x1a098d(0xe1)])return _0x26af2c[_0x1a098d(0xe1)][_0x1a098d(0x252)]||'';if(_0x26af2c[_0x1a098d(0x18b)+'ge'])return _0x26af2c['audioMessa'+'ge']?.['ptt']?_0x1a098d(0x151)+'e]':'[Audio]';if(_0x26af2c['documentMe'+'ssage'])return _0x26af2c[_0x1a098d(0x207)+_0x1a098d(0x2c0)][_0x1a098d(0x212)]||'';if(_0x26af2c['stickerMes'+_0x1a098d(0x11f)])return _0x1a098d(0x282);if(_0x26af2c[_0x1a098d(0x14b)+'onMessageV'+'3'])return'[Poll:\x20'+(_0x26af2c[_0x1a098d(0x14b)+'onMessageV'+'3'][_0x1a098d(0x24c)]||_0x1a098d(0x1b8))+']';return _0x1a098d(0x154);}function isMediaMessage(_0xe02c0b){const _0x5832e1=_0x195b9c;if(!_0xe02c0b)return![];if(_0xe02c0b[_0x5832e1(0x11c)+'ge'])return!![];if(_0xe02c0b['videoMessa'+'ge'])return!![];if(_0xe02c0b[_0x5832e1(0x18b)+'ge'])return!![];if(_0xe02c0b[_0x5832e1(0x207)+_0x5832e1(0x2c0)])return!![];if(_0xe02c0b[_0x5832e1(0x2a3)+_0x5832e1(0x11f)])return!![];if(_0xe02c0b[_0x5832e1(0xe1)])return!![];if(_0xe02c0b[_0x5832e1(0x15c)+'ge']&&_0xe02c0b[_0x5832e1(0x15c)+'ge'][_0x5832e1(0x177)+'k'])return!![];const _0x1ddcd7=Object[_0x5832e1(0x28e)](_0xe02c0b||{});for(const _0x2f4c38 of _0x1ddcd7){if(_0x2f4c38['endsWith'](_0x5832e1(0x1f2))&&[_0x5832e1(0x11c)+'ge','videoMessa'+'ge','audioMessa'+'ge',_0x5832e1(0x207)+_0x5832e1(0x2c0),_0x5832e1(0x2a3)+_0x5832e1(0x11f),_0x5832e1(0xe1)]['includes'](_0x2f4c38))return!![];}return![];}function buildPayloadForSavedFile(_0x519f6c,_0x4f7fcc){const _0x124337=_0x195b9c,_0x5abd46=_0x4f7fcc?.[_0x124337(0x166)]||{},_0x23818c=extractContent(_0x5abd46)||undefined;if(_0x5abd46[_0x124337(0x2a3)+_0x124337(0x11f)])return{'sticker':{'url':_0x519f6c}};if(_0x5abd46[_0x124337(0xe1)]){const _0x1a3c6f={'video':{'url':_0x519f6c},'ptv':!![]};if(_0x23818c)_0x1a3c6f[_0x124337(0x252)]=_0x23818c;if(_0x5abd46[_0x124337(0xe1)]?.[_0x124337(0x1ab)])_0x1a3c6f[_0x124337(0x1ab)]=_0x5abd46['ptvMessage'][_0x124337(0x1ab)];return _0x1a3c6f;}if(_0x5abd46['videoMessa'+'ge']){const _0x1c7fa9={'video':{'url':_0x519f6c}};if(_0x5abd46[_0x124337(0x15c)+'ge']?.[_0x124337(0x252)])_0x1c7fa9[_0x124337(0x252)]=_0x5abd46['videoMessa'+'ge'][_0x124337(0x252)];if(typeof _0x5abd46[_0x124337(0x15c)+'ge']?.['gifPlaybac'+'k']===_0x124337(0x1a3))_0x1c7fa9['gifPlaybac'+'k']=_0x5abd46[_0x124337(0x15c)+'ge'][_0x124337(0x177)+'k'];if(_0x5abd46['videoMessa'+'ge']?.[_0x124337(0x1ab)])_0x1c7fa9[_0x124337(0x1ab)]=_0x5abd46[_0x124337(0x15c)+'ge'][_0x124337(0x1ab)];return _0x1c7fa9;}if(_0x5abd46[_0x124337(0x11c)+'ge']){const _0x1cc172={'image':{'url':_0x519f6c}};if(_0x5abd46[_0x124337(0x11c)+'ge']?.['caption'])_0x1cc172[_0x124337(0x252)]=_0x5abd46['imageMessa'+'ge'][_0x124337(0x252)];return _0x1cc172;}if(_0x5abd46[_0x124337(0x18b)+'ge']){const _0x1e6baf={'audio':{'url':_0x519f6c}};if(typeof _0x5abd46[_0x124337(0x18b)+'ge']?.[_0x124337(0x15b)]===_0x124337(0x1a3))_0x1e6baf[_0x124337(0x15b)]=_0x5abd46[_0x124337(0x18b)+'ge'][_0x124337(0x15b)];if(_0x5abd46[_0x124337(0x18b)+'ge']?.[_0x124337(0x1ab)])_0x1e6baf[_0x124337(0x1ab)]=_0x5abd46[_0x124337(0x18b)+'ge']['mimetype'];if(typeof _0x5abd46[_0x124337(0x18b)+'ge']?.['seconds']===_0x124337(0x10a))_0x1e6baf[_0x124337(0x1a9)]=_0x5abd46['audioMessa'+'ge']['seconds'];return _0x1e6baf;}if(_0x5abd46[_0x124337(0x207)+_0x124337(0x2c0)]){const _0x249191=_0x5abd46[_0x124337(0x207)+_0x124337(0x2c0)]?.[_0x124337(0x212)]||_0x5cd66a['basename'](_0x519f6c),_0x2ce5ee={'document':{'url':_0x519f6c,'fileName':_0x249191}};if(_0x5abd46['documentMe'+'ssage']?.[_0x124337(0x1ab)])_0x2ce5ee['mimetype']=_0x5abd46[_0x124337(0x207)+_0x124337(0x2c0)]['mimetype'];if(_0x5abd46[_0x124337(0x207)+'ssage']?.['caption'])_0x2ce5ee[_0x124337(0x252)]=_0x5abd46[_0x124337(0x207)+_0x124337(0x2c0)]['caption'];if(_0x23818c&&!_0x2ce5ee[_0x124337(0x252)])_0x2ce5ee['caption']=_0x23818c;return _0x2ce5ee;}return{'document':{'url':_0x519f6c,'fileName':_0x5cd66a['basename'](_0x519f6c)},'caption':_0x23818c};}async function processDeletionItem(_0x382f2c){const _0x4e797b=_0x195b9c;try{const _0x2e5950=_0x382f2c[_0x4e797b(0x28e)]||[];if(!_0x2e5950[_0x4e797b(0x1ce)])return;for(const _0x11476c of _0x2e5950){const _0x1a28d3=await fetchOriginalMessage(_0x11476c['id']);if(!_0x1a28d3||!_0x1a28d3[_0x4e797b(0x166)])continue;const _0x28d388=_0x1a28d3[_0x4e797b(0x166)],_0x5c90da=getBotJidRaw(),_0x10f425=_0x28d388['key']?.[_0x4e797b(0x173)+'t']||_0x28d388[_0x4e797b(0x27b)]?.[_0x4e797b(0x231)];if(_0x28d388[_0x4e797b(0x27b)]?.[_0x4e797b(0x268)]||_0x10f425===_0x5c90da)continue;const _0x317950=_0x28d388[_0x4e797b(0x27b)][_0x4e797b(0x173)+'t']||_0x28d388[_0x4e797b(0x27b)][_0x4e797b(0x231)],_0x45ebf9=extractContent(_0x28d388['message']);let _0xc4857=nameCache[_0x4e797b(0x1fc)](_0x317950);if(!_0xc4857){try{const [_0x15373a]=await botRef[_0x4e797b(0x190)]['onWhatsApp'](_0x317950);_0xc4857=_0x15373a?.[_0x4e797b(0x170)]||'~'+_0x317950['split']('@')[0xc2*0x2f+-0x1aea+0x22d*-0x4];}catch{_0xc4857='~'+_0x317950[_0x4e797b(0x17f)]('@')[0x1689*0x1+0x2449*-0x1+0xdc0];}nameCache[_0x4e797b(0x1f8)](_0x317950,_0xc4857);}let _0x538056='';if(isJidGroup(_0x28d388[_0x4e797b(0x27b)][_0x4e797b(0x231)]))try{_0x538056=(await botRef[_0x4e797b(0x190)][_0x4e797b(0x204)+_0x4e797b(0x1d0)](_0x28d388[_0x4e797b(0x27b)][_0x4e797b(0x231)]))[_0x4e797b(0x26a)];}catch{_0x538056='[Unknown\x20G'+'roup]';}deletionPush({'msg_id':_0x1a28d3[_0x4e797b(0x26e)],'sender':_0x317950,'name':_0xc4857,'group':_0x538056,'content':_0x45ebf9,'mediaPath':_0x1a28d3[_0x4e797b(0x13b)]||null,'originalMessage':_0x28d388});}}catch(_0x1c9253){warn(_0x4e797b(0x112)+_0x4e797b(0x131)+_0x4e797b(0x186)+'rror:\x20'+(_0x1c9253?.['message']||_0x1c9253));}}async function deletionWorker(){const _0x53b672=_0x195b9c,_0x2ffdef=CONCURRENCY||FALLBACKS[_0x53b672(0x219)+'NCURRENCY'];while(deletionQueue[_0x53b672(0x1ce)]>0xe97*-0x1+0x22d3+-0x143c*0x1&&activeDeletionTasks<_0x2ffdef){const _0x3426df=deletionQueue[_0x53b672(0x23b)]();if(!_0x3426df)break;activeDeletionTasks++,((async()=>{const _0x4f1698=_0x53b672;try{await processDeletionItem(_0x3426df);}catch(_0x177dea){warn(_0x4f1698(0x230)+_0x4f1698(0x2ba)+_0x4f1698(0x2a2)+_0x4f1698(0x1c7)+(_0x177dea?.['message']||_0x177dea));}finally{activeDeletionTasks--,setImmediate(()=>{const _0x89b3d7=_0x4f1698;if(deletionQueue[_0x89b3d7(0x1ce)])deletionWorker()['catch'](()=>{});});}})());}}function deletionPush(_0x2cb88d){const _0x1e1960=_0x195b9c;pendingRecovered[_0x1e1960(0x187)](_0x2cb88d),clearTimeout(flushTimer),flushTimer=setTimeout(()=>{const _0x51ae84=_0x1e1960,_0x4bde8a=pendingRecovered[_0x51ae84(0x1e5)](-0x9b5+0x123b+-0x1*0x886,pendingRecovered[_0x51ae84(0x1ce)]);((async()=>{const _0x5d75dd=_0x51ae84;try{await flushRecoveredBatch(_0x4bde8a);}catch(_0x3cec8b){warn('[Delete]\x20f'+_0x5d75dd(0x2c1)+_0x5d75dd(0x119)+_0x5d75dd(0x1c7)+(_0x3cec8b?.[_0x5d75dd(0x166)]||_0x3cec8b));}})());},DEBOUNCE_DELAY_MS||FALLBACKS[_0x1e1960(0x210)+'S']);}function resolveDeleteTarget(_0x4b41e5){const _0x15698b=getBotJid();if(DELETE_MODE==='g'&&TARGET_JID){if(TARGET_JID===_0x4b41e5)return _0x15698b;return TARGET_JID;}return _0x15698b;}async function saveDeleteMode(_0x1fe8bf){const _0x52b8c9=_0x195b9c;try{const _0x498b90=_0x1fe8bf==='g'?'g':'p',_0x14f25b=Math[_0x52b8c9(0x240)](Date['now']()/(0xd*-0x50+0x215e+-0xcb3*0x2));return await db[_0x52b8c9(0x1de)](_0x52b8c9(0x12f)+_0x52b8c9(0x2b2)+_0x52b8c9(0x100)+_0x52b8c9(0x180)+_0x52b8c9(0x195)+_0x52b8c9(0x2bd)+_0x52b8c9(0x124)+')\x20ON\x20CONFL'+_0x52b8c9(0x1dc)+_0x52b8c9(0xff)+_0x52b8c9(0x290)+_0x52b8c9(0x1f5)+_0x52b8c9(0x120)+_0x52b8c9(0x1b4)+_0x52b8c9(0x11b)+_0x52b8c9(0x205),[_0x498b90,_0x14f25b]),DELETE_MODE=_0x498b90,info(_0x52b8c9(0x248)+_0x52b8c9(0xf5)+'\x20'+DELETE_MODE),!![];}catch(_0x53ae84){return warn('[Delete]\x20s'+_0x52b8c9(0x21d)+_0x52b8c9(0x114)+':\x20'+(_0x53ae84?.[_0x52b8c9(0x166)]||_0x53ae84)),![];}}async function saveDeleteTarget(_0xf1f0f4){const _0x40b63c=_0x195b9c;try{const _0x35dadd=Math[_0x40b63c(0x240)](Date[_0x40b63c(0x1ae)]()/(0x18*-0xdd+-0x124*-0x13+0x2f4));if(!_0xf1f0f4)return await db[_0x40b63c(0x1de)](_0x40b63c(0x275)+'M\x20delete_p'+_0x40b63c(0x1ec)+_0x40b63c(0x133)+_0x40b63c(0x277)),TARGET_JID=null,info(_0x40b63c(0x152)+_0x40b63c(0x17c)+'cleared'),!![];else{const _0x3a3021=normalizeToUserJid(_0xf1f0f4);return await db[_0x40b63c(0x1de)](_0x40b63c(0x12f)+_0x40b63c(0x2b2)+'refs\x20(key,'+_0x40b63c(0x180)+_0x40b63c(0x195)+'VALUES\x20(\x27t'+_0x40b63c(0x26f)+_0x40b63c(0x25e)+'\x20CONFLICT('+'key)\x20DO\x20UP'+_0x40b63c(0x224)+'alue=exclu'+_0x40b63c(0x228)+'\x20updated_a'+_0x40b63c(0x150)+'.updated_a'+'t',[_0x3a3021,_0x35dadd]),TARGET_JID=_0x3a3021,info(_0x40b63c(0x152)+'arget_jid\x20'+_0x40b63c(0x21e)+TARGET_JID),!![];}}catch(_0x521a90){return warn(_0x40b63c(0x25d)+_0x40b63c(0xeb)+_0x40b63c(0x18f)+_0x40b63c(0x1af)+(_0x521a90?.['message']||_0x521a90)),![];}}async function flushRecoveredBatch(_0x162211){const _0x39bb5a=_0x195b9c;if(!_0x162211||_0x162211[_0x39bb5a(0x1ce)]===0xf3+0xfdc+-0x10cf)return;if(!DEFAULT_SEND_DELETE){info('[Delete]\x20D'+_0x39bb5a(0x11a)+_0x39bb5a(0x10d)+'alse\x20—\x20ski'+_0x39bb5a(0x182)+_0x39bb5a(0x1bb)+'s.');return;}const _0x41517a=_0x162211[_0x39bb5a(0x10b)](_0x394e86=>_0x394e86[_0x39bb5a(0x11d)+_0x39bb5a(0x2c0)])?.['originalMe'+'ssage']?.['key']?.[_0x39bb5a(0x231)]||null,_0xf19ae4=resolveDeleteTarget(_0x41517a)||getBotJid();if(!_0xf19ae4){warn('[Delete]\x20n'+_0x39bb5a(0x297)+_0x39bb5a(0x1d6)+_0x39bb5a(0x163));return;}const _0x205fe9=[...new Set(_0x162211[_0x39bb5a(0xf4)](_0x2ad9f7=>_0x2ad9f7[_0x39bb5a(0x161)]))],_0x2ef67a=_0x162211[_0x39bb5a(0xf4)](_0xa307e5=>_0x39bb5a(0x189)+_0xa307e5[_0x39bb5a(0x161)][_0x39bb5a(0x17f)]('@')[-0x657+-0x1bc1+0x110c*0x2]+'\x20('+_0xa307e5['name']+')\x0a'+(_0xa307e5[_0x39bb5a(0xf0)]?_0x39bb5a(0xfb)+_0xa307e5[_0x39bb5a(0xf0)]+'\x0a':'')+(_0x39bb5a(0x2a1)+'\x20'+_0xa307e5[_0x39bb5a(0x17a)]+'\x0a')+'─'['repeat'](0xb0b*0x2+0x25ad+-0x3baa))[_0x39bb5a(0x1c2)]('\x0a'),_0x1edb29=_0x39bb5a(0x243)+_0x162211['length']+('\x20DELETED\x20M'+_0x39bb5a(0x1df)+_0x39bb5a(0x194)+'\x0a\x0a');try{const _0x2806d8=await sendWithRetry(_0xf19ae4,{'text':_0x1edb29+_0x2ef67a},_0x205fe9);if(!_0x2806d8)warn(_0x39bb5a(0x25d)+'ummary\x20sen'+'d\x20may\x20have'+'\x20failed');}catch(_0x2e29b8){warn(_0x39bb5a(0x25d)+_0x39bb5a(0x1e0)+_0x39bb5a(0x299)+_0x39bb5a(0x262)+(_0x2e29b8?.[_0x39bb5a(0x166)]||_0x2e29b8));}for(const _0x167f23 of _0x162211){try{const _0x2a63cb=_0x167f23[_0x39bb5a(0x24e)],_0x4a9c96=_0x167f23[_0x39bb5a(0x11d)+_0x39bb5a(0x2c0)],_0x1ac992=!!_0x2a63cb||isMediaMessage(_0x4a9c96?.[_0x39bb5a(0x166)]);if(!_0x1ac992){try{await deleteMessageRow(_0x167f23[_0x39bb5a(0x26e)]);}catch(_0x136a53){}continue;}const _0x5c4ffd=_0x4a9c96?.[_0x39bb5a(0x27b)]?.['id']||_0x39bb5a(0x255);let _0x2f060f=![];if(_0x2a63cb&&_0x17ff46[_0x39bb5a(0x140)](_0x2a63cb)){const _0x145792=buildPayloadForSavedFile(_0x2a63cb,_0x4a9c96);try{const _0x201b06=await sendWithRetry(_0xf19ae4,_0x145792);if(_0x201b06){info(_0x39bb5a(0x23d)+_0x39bb5a(0x197)+_0x39bb5a(0x238)+_0x39bb5a(0x1a8)+_0x5c4ffd+'\x20->\x20'+_0xf19ae4),_0x2f060f=!![];try{await deleteMessageRow(_0x167f23[_0x39bb5a(0x26e)]);}catch(_0x3072b4){warn(_0x39bb5a(0x159)+'leanup\x20aft'+_0x39bb5a(0x1c9)+_0x39bb5a(0x16b)+(_0x3072b4?.[_0x39bb5a(0x166)]||_0x3072b4));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS['MEDIA_SEND'+_0x39bb5a(0x263)]);continue;}else warn('[Delete]\x20f'+'ile-send\x20('+_0x39bb5a(0x12c)+_0x39bb5a(0x1c1)+'\x20'+_0x2a63cb);}catch(_0xbf328d){warn(_0x39bb5a(0x239)+_0x39bb5a(0x289)+'url\x20form)\x20'+_0x39bb5a(0x1c3)+_0x2a63cb+':\x20'+(_0xbf328d?.['message']||_0xbf328d));}}if(!_0x2f060f&&_0x2a63cb&&_0x17ff46[_0x39bb5a(0x140)](_0x2a63cb))try{const _0x157b1d=_0x4a9c96?.['message']||{};let _0x14c2e1;if(_0x157b1d['stickerMes'+'sage'])_0x14c2e1={'sticker':_0x17ff46[_0x39bb5a(0x1c0)+_0x39bb5a(0x136)](_0x2a63cb)};else{if(_0x157b1d[_0x39bb5a(0xe1)])_0x14c2e1={'video':_0x17ff46[_0x39bb5a(0x1c0)+'Stream'](_0x2a63cb),'ptv':!![]};else{if(_0x157b1d[_0x39bb5a(0x15c)+'ge'])_0x14c2e1={'video':_0x17ff46[_0x39bb5a(0x1c0)+'Stream'](_0x2a63cb),'caption':_0x157b1d[_0x39bb5a(0x15c)+'ge']?.[_0x39bb5a(0x252)]||undefined,'gifPlayback':!!_0x157b1d[_0x39bb5a(0x15c)+'ge']?.[_0x39bb5a(0x177)+'k']};else{if(_0x157b1d[_0x39bb5a(0x11c)+'ge'])_0x14c2e1={'image':_0x17ff46[_0x39bb5a(0x1c0)+_0x39bb5a(0x136)](_0x2a63cb),'caption':_0x157b1d['imageMessa'+'ge']?.['caption']||undefined};else{if(_0x157b1d[_0x39bb5a(0x18b)+'ge'])_0x14c2e1={'audio':_0x17ff46[_0x39bb5a(0x1c0)+'Stream'](_0x2a63cb),'ptt':!!_0x157b1d[_0x39bb5a(0x18b)+'ge']?.['ptt'],'mimetype':_0x157b1d[_0x39bb5a(0x18b)+'ge']?.['mimetype']};else _0x14c2e1={'document':_0x17ff46[_0x39bb5a(0x1c0)+_0x39bb5a(0x136)](_0x2a63cb),'fileName':_0x5cd66a[_0x39bb5a(0x16c)](_0x2a63cb),'caption':extractContent(_0x157b1d)};}}}}const _0x424ef5=await sendWithRetry(_0xf19ae4,_0x14c2e1);if(_0x424ef5){info(_0x39bb5a(0x23d)+_0x39bb5a(0x197)+_0x39bb5a(0x200)+'am)\x20sent\x20f'+_0x39bb5a(0xee)+_0x5c4ffd+_0x39bb5a(0x27c)+_0xf19ae4),_0x2f060f=!![];try{await deleteMessageRow(_0x167f23[_0x39bb5a(0x26e)]);}catch(_0x563d1c){warn(_0x39bb5a(0x159)+_0x39bb5a(0x1ba)+_0x39bb5a(0x191)+_0x39bb5a(0x1b5)+_0x39bb5a(0x28d)+(_0x563d1c?.['message']||_0x563d1c));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS['MEDIA_SEND'+_0x39bb5a(0x263)]);continue;}else warn(_0x39bb5a(0x239)+_0x39bb5a(0x289)+_0x39bb5a(0x162)+_0x39bb5a(0x1e6)+_0x39bb5a(0x227)+_0x2a63cb);}catch(_0xb6ddfb){warn(_0x39bb5a(0x239)+_0x39bb5a(0x289)+_0x39bb5a(0x162)+_0x39bb5a(0x108)+_0x39bb5a(0x1f1)+_0x2a63cb+':\x20'+(_0xb6ddfb?.[_0x39bb5a(0x166)]||_0xb6ddfb));}try{const _0x314def=await sendWithRetry(_0xf19ae4,{'forward':_0x4a9c96});if(_0x314def){info(_0x39bb5a(0x23d)+_0x39bb5a(0x2af)+_0x39bb5a(0x1eb)+'rwarded\x20fo'+'r\x20'+_0x5c4ffd+_0x39bb5a(0x27c)+_0xf19ae4);try{await deleteMessageRow(_0x167f23[_0x39bb5a(0x26e)]);}catch(_0x12d5db){warn(_0x39bb5a(0x159)+_0x39bb5a(0x1ba)+_0x39bb5a(0xf3)+_0x39bb5a(0x13f)+'iled:\x20'+(_0x12d5db?.[_0x39bb5a(0x166)]||_0x12d5db));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x39bb5a(0xfc)+_0x39bb5a(0x263)]);continue;}}catch(_0x19cf2f){warn(_0x39bb5a(0x25b)+_0x39bb5a(0x260)+_0x39bb5a(0x202)+'\x20'+(_0x19cf2f?.[_0x39bb5a(0x166)]||_0x19cf2f));}warn(_0x39bb5a(0x17e)+'nable\x20to\x20d'+_0x39bb5a(0x1f4)+_0x39bb5a(0x1a0)+_0x5c4ffd+(_0x39bb5a(0x2ad)+'mpts\x20faile'+_0x39bb5a(0x27a)+_0x39bb5a(0x22c)+_0x39bb5a(0x2b9)+_0x39bb5a(0x2a7)+'p.'));}catch(_0x5c8655){warn(_0x39bb5a(0x239)+_0x39bb5a(0x106)+_0x39bb5a(0x1e2)+':\x20'+(_0x5c8655?.['message']||_0x5c8655));}}}async function rawMessagesUpsertHandler({messages:_0x1bfe9e}){const _0x40a252=_0x195b9c;try{if(!_0x1bfe9e||!Array[_0x40a252(0x257)](_0x1bfe9e))return;for(const _0x2237fe of _0x1bfe9e){if(!_0x2237fe||!_0x2237fe['message']||_0x2237fe[_0x40a252(0x27b)]?.[_0x40a252(0x231)]==='status@bro'+_0x40a252(0x2b4))continue;if(_0x2237fe['key']?.['fromMe'])continue;messageQueue[_0x40a252(0x187)](_0x2237fe),setImmediate(()=>{const _0x13fe9d=_0x40a252;messageWorker()[_0x13fe9d(0x266)](()=>{});});const _0x335aea=_0x2237fe['message']?.[_0x40a252(0x143)+_0x40a252(0x2c0)];if(_0x335aea?.[_0x40a252(0x2a4)]===0x7*0x158+-0xf79*-0x1+-0x18e1&&_0x335aea?.['key'])deletionQueue[_0x40a252(0x187)]({'keys':[_0x335aea[_0x40a252(0x27b)]],'remoteJid':_0x2237fe[_0x40a252(0x27b)]['remoteJid']}),setImmediate(()=>{const _0x355d58=_0x40a252;deletionWorker()[_0x355d58(0x266)](()=>{});});else{if(_0x2237fe[_0x40a252(0xf2)+_0x40a252(0x1ee)]===0x5*-0x61d+0x3*0x7d3+0x71c&&Array[_0x40a252(0x257)](_0x2237fe[_0x40a252(0xf2)+'bParameter'+'s'])&&_0x2237fe[_0x40a252(0xf2)+_0x40a252(0x2a5)+'s'][-0x24f1+0x1*0xaab+0x1a46]==='REVOKE'){const _0xb2f1ae=[];for(let _0x25350e=0x4*-0x9b+-0x3*0xa57+0x2172;_0x25350e<_0x2237fe['messageStu'+_0x40a252(0x2a5)+'s'][_0x40a252(0x1ce)];_0x25350e++)_0xb2f1ae[_0x40a252(0x187)]({'id':_0x2237fe['messageStu'+_0x40a252(0x2a5)+'s'][_0x25350e],'remoteJid':_0x2237fe[_0x40a252(0x27b)][_0x40a252(0x231)]});_0xb2f1ae[_0x40a252(0x1ce)]&&(deletionQueue[_0x40a252(0x187)]({'keys':_0xb2f1ae,'remoteJid':_0x2237fe[_0x40a252(0x27b)]['remoteJid']}),setImmediate(()=>{const _0x446810=_0x40a252;deletionWorker()[_0x446810(0x266)](()=>{});}));}}}}catch(_0x348f10){warn('[Delete]\x20r'+_0x40a252(0x101)+_0x40a252(0x23f)+_0x40a252(0x11e)+'\x20'+(_0x348f10?.[_0x40a252(0x166)]||_0x348f10));}}async function processMessageItem(_0x1475c1){const _0xaaa8f3=_0x195b9c;try{if(!_0x1475c1||!_0x1475c1['message']||_0x1475c1['key']?.[_0xaaa8f3(0x268)])return;const _0x90a246=await maybeSaveMedia(_0x1475c1);await insertMessageToDB(_0x1475c1,_0x90a246);}catch(_0xe98d9){warn(_0xaaa8f3(0x112)+_0xaaa8f3(0x2bc)+_0xaaa8f3(0x1a5)+_0xaaa8f3(0x132)+(_0xe98d9?.['message']||_0xe98d9));}}async function messageWorker(){const _0x97248b=_0x195b9c,_0x3a06fa=CONCURRENCY||FALLBACKS[_0x97248b(0x219)+'NCURRENCY'];while(messageQueue[_0x97248b(0x1ce)]>-0x360*0x2+0xee5+0x1a1*-0x5&&activeMessageTasks<_0x3a06fa){const _0x430ab8=messageQueue[_0x97248b(0x23b)]();if(!_0x430ab8)break;activeMessageTasks++,((async()=>{const _0x2789bf=_0x97248b;try{await processMessageItem(_0x430ab8);}catch(_0x2c967f){warn(_0x2789bf(0x248)+_0x2789bf(0xf6)+_0x2789bf(0x293)+_0x2789bf(0x132)+(_0x2c967f?.[_0x2789bf(0x166)]||_0x2c967f));}finally{activeMessageTasks--,setImmediate(()=>{const _0x92fbdd=_0x2789bf;if(messageQueue['length'])messageWorker()[_0x92fbdd(0x266)](()=>{});});}})());}}async function autoCleanOldMessagesSafe(){const _0x4ccb71=_0x195b9c;try{await autoCleanOldMessages();}catch(_0x361321){warn(_0x4ccb71(0x247)+_0x4ccb71(0x14a)+_0x4ccb71(0x2ae)+_0x4ccb71(0x199)+'\x20'+(_0x361321?.['message']||_0x361321));}}async function autoCleanOldMessages(){const _0x129948=_0x195b9c;try{const _0x1537a4=Math[_0x129948(0x240)](Date[_0x129948(0x1ae)]()/(-0x1*0x263d+0x1*0x1bb6+-0x5*-0x2e3))-Number(DELETE_CLEANUP_DAYS||FALLBACKS[_0x129948(0x2a0)+'YS'])*(-0x1a5c+0x1204*0x1+0x24*0x3c)*(-0x1023+-0x1f43+0x6ce*0x7)*(0x39f+0x1*0xe37+-0x119a),_0x42d00e=await db[_0x129948(0x249)](_0x129948(0x1be)+'_id,\x20media'+_0x129948(0x1d7)+_0x129948(0x1c5)+_0x129948(0x235)+'WHERE\x20save'+_0x129948(0xe0)+_0x129948(0x1ea)+_0x129948(0x17b)+'<\x20?',[_0x1537a4]);if(!_0x42d00e||_0x42d00e[_0x129948(0x1ce)]===-0x12aa+-0x8c0+0x1b6a)return;info('[Delete]\x20c'+'leaning\x20'+_0x42d00e['length']+('\x20old\x20messa'+_0x129948(0x281)+_0x129948(0x27f))+DELETE_CLEANUP_DAYS+_0x129948(0x10e));for(const _0x39302f of _0x42d00e){if(_0x39302f['media_path'])try{await _0x16ae4f(_0x39302f[_0x129948(0x13b)]);}catch(_0x38c9ef){warn('[Delete]\x20f'+_0x129948(0xe7)+_0x129948(0x21f)+_0x39302f[_0x129948(0x13b)]+':\x20'+(_0x38c9ef?.[_0x129948(0x166)]||_0x38c9ef));}}const _0x5323c1=_0x42d00e[_0x129948(0xf4)](_0x5bdb7e=>_0x5bdb7e[_0x129948(0x26e)]),_0x5f0cfd=-0xd3+-0x1859+0x19f4;for(let _0x1c2027=-0x49d+-0x1*0x15cb+0x104*0x1a;_0x1c2027<_0x5323c1[_0x129948(0x1ce)];_0x1c2027+=_0x5f0cfd){const _0x42d974=_0x5323c1[_0x129948(0x29b)](_0x1c2027,_0x1c2027+_0x5f0cfd),_0x42541c=_0x42d974['map'](()=>'?')['join'](',');await db[_0x129948(0x1de)](_0x129948(0x275)+_0x129948(0x1d3)+_0x129948(0x221)+_0x129948(0x1e4)+_0x42541c+')',_0x42d974);}info(_0x129948(0x159)+_0x129948(0x2c2)+_0x129948(0x1bd));}catch(_0x357b65){warn('[Delete]\x20a'+_0x129948(0x14a)+_0x129948(0x285)+_0x129948(0x246)+(_0x357b65?.['message']||_0x357b65));}}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0xd85*-0x1+0x5*0xc1+-0x112c)*(-0xe3+-0x1db9+0x2284);function markCmdProcessed(_0x33a945){const _0x213e40=_0x195b9c;if(!_0x33a945)return;if(processedCmdKeys[_0x213e40(0x250)](_0x33a945))try{clearTimeout(processedCmdKeys[_0x213e40(0x1fc)](_0x33a945));}catch(_0x557060){};const _0xb8fa14=setTimeout(()=>processedCmdKeys[_0x213e40(0x1d8)](_0x33a945),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x213e40(0x1f8)](_0x33a945,_0xb8fa14);}function isCmdProcessed(_0x28e87b){const _0x3dc21b=_0x195b9c;return _0x28e87b&&processedCmdKeys[_0x3dc21b(0x250)](_0x28e87b);}export async function onMessage(_0x6d3e2){const _0x51d8f8=_0x195b9c;try{if(!_0x6d3e2||!_0x6d3e2['key']||!_0x6d3e2[_0x51d8f8(0x166)]||!_0x6d3e2['isCommand'])return;if(isJidGroup(_0x6d3e2[_0x51d8f8(0x27b)][_0x51d8f8(0x231)]))return;const _0x4d7e34=_0x6d3e2[_0x51d8f8(0x27b)][_0x51d8f8(0x268)],_0x1babf9=await isSudo(botRef,_0x6d3e2)[_0x51d8f8(0x266)](()=>![]);if(!_0x4d7e34&&!_0x1babf9)return;let _0x29b0ca;if(_0x4d7e34){_0x29b0ca=getBotJid();if(!_0x29b0ca){warn(_0x51d8f8(0x206)+_0x51d8f8(0xfa)+'y\x20to\x20owner'+_0x51d8f8(0x172)+_0x51d8f8(0x117)+_0x51d8f8(0x19a)+_0x51d8f8(0x26b));return;}}else _0x29b0ca=_0x6d3e2[_0x51d8f8(0x27b)][_0x51d8f8(0x231)];const _0x4b41bc=String(_0x6d3e2[_0x51d8f8(0x27b)][_0x51d8f8(0x231)]||'')+'::'+String(_0x6d3e2[_0x51d8f8(0x27b)]['id']||_0x6d3e2[_0x51d8f8(0x27b)][_0x51d8f8(0x173)+'t']||'');if(isCmdProcessed(_0x4b41bc))return;markCmdProcessed(_0x4b41bc);const _0x325adb=typeof _0x6d3e2[_0x51d8f8(0x1b0)]===_0x51d8f8(0x270)&&_0x6d3e2[_0x51d8f8(0x1b0)][_0x51d8f8(0x14c)]()[_0x51d8f8(0x1ce)]?_0x6d3e2['text'][_0x51d8f8(0x14c)]():function _0x54333b(_0x505b4d){const _0x46a9d1=_0x51d8f8;if(!_0x505b4d||!_0x505b4d[_0x46a9d1(0x166)])return'';const _0x2b75eb=_0x505b4d['message'];if(_0x2b75eb[_0x46a9d1(0x14e)+'on'])return _0x2b75eb[_0x46a9d1(0x14e)+'on'];if(_0x2b75eb[_0x46a9d1(0x2bb)+_0x46a9d1(0x19c)]?.[_0x46a9d1(0x1b0)])return _0x2b75eb[_0x46a9d1(0x2bb)+'xtMessage'][_0x46a9d1(0x1b0)];if(_0x2b75eb[_0x46a9d1(0x11c)+'ge']?.['caption'])return _0x2b75eb[_0x46a9d1(0x11c)+'ge'][_0x46a9d1(0x252)];if(_0x2b75eb[_0x46a9d1(0x15c)+'ge']?.['caption'])return _0x2b75eb[_0x46a9d1(0x15c)+'ge'][_0x46a9d1(0x252)];if(_0x2b75eb[_0x46a9d1(0x21b)+_0x46a9d1(0x2b5)+'ge']?.[_0x46a9d1(0x21c)+_0x46a9d1(0x27e)])return _0x2b75eb[_0x46a9d1(0x21b)+_0x46a9d1(0x2b5)+'ge'][_0x46a9d1(0x21c)+_0x46a9d1(0x27e)];if(_0x2b75eb[_0x46a9d1(0x245)+_0x46a9d1(0xef)]?.[_0x46a9d1(0x272)+'ctReply']?.['selectedRo'+_0x46a9d1(0x1e1)])return _0x2b75eb[_0x46a9d1(0x245)+_0x46a9d1(0xef)][_0x46a9d1(0x272)+'ctReply'][_0x46a9d1(0x1a7)+_0x46a9d1(0x1e1)];return'';}(_0x6d3e2)||'';if(!_0x325adb)return;const _0x5d9862=(_0x325adb[_0x51d8f8(0x17f)](/\r?\n/)[-0x1*0x121+0x6dd+-0x5bc]||'')['trim'](),_0x1a103d=_0x5d9862[_0x51d8f8(0x17f)](/\s+/),_0x271fba=(_0x1a103d[-0x28*0xc5+-0x1f15+0x149f*0x3]||'')[_0x51d8f8(0x1c6)+'e']();if(!commands[_0x51d8f8(0x1f6)](_0x271fba))return;const _0x14fd21=(_0x1a103d[0x33*0x33+-0x1af9+0x10d1]||'')[_0x51d8f8(0x1c6)+'e']();if(_0x14fd21&&_0x14fd21[_0x51d8f8(0x1f6)]('@')){const _0x2f2ad6=normalizeToUserJid(_0x14fd21),_0x24e48e=await saveDeleteTarget(_0x2f2ad6);if(_0x24e48e)await sendWithRetry(_0x29b0ca,{'text':_0x51d8f8(0x1cd)+_0x51d8f8(0x208)+_0x51d8f8(0x21e)+_0x2f2ad6+'.\x20Mode:\x20'+(DELETE_MODE==='g'?_0x51d8f8(0x12a):'PM')});else await sendWithRetry(_0x29b0ca,{'text':'[delete]\x20F'+_0x51d8f8(0x198)+_0x51d8f8(0x193)+_0x51d8f8(0x171)+_0x2f2ad6});return;}if(_0x14fd21===_0x51d8f8(0x13d)||_0x14fd21===_0x51d8f8(0x10f)||_0x14fd21===_0x51d8f8(0x22a)){const _0x26f036=await saveDeleteTarget(null);if(_0x26f036)await sendWithRetry(_0x29b0ca,{'text':_0x51d8f8(0x1cd)+_0x51d8f8(0x208)+_0x51d8f8(0x251)+'ill\x20fallba'+_0x51d8f8(0x218)+_0x51d8f8(0x269)+'\x20GROUP\x20mod'+'e.'});else await sendWithRetry(_0x29b0ca,{'text':_0x51d8f8(0x222)+'ailed\x20to\x20c'+_0x51d8f8(0x258)+_0x51d8f8(0x28f)});return;}if(_0x14fd21==='p'||_0x14fd21==='pm'){await saveDeleteMode('p'),await sendWithRetry(_0x29b0ca,{'text':_0x51d8f8(0x29c)+_0x51d8f8(0x23a)+_0x51d8f8(0x12b)+'ered\x20delet'+_0x51d8f8(0x148)+_0x51d8f8(0x242)+_0x51d8f8(0x102)+_0x51d8f8(0x138)});return;}if(_0x14fd21==='g'||_0x14fd21===_0x51d8f8(0xf0)||_0x14fd21==='gp'){await saveDeleteMode('g');const _0x11d086=TARGET_JID?_0x51d8f8(0x19f)+'\x20group:\x20'+TARGET_JID:_0x51d8f8(0x15e)+_0x51d8f8(0x14d)+_0x51d8f8(0x215)+_0x51d8f8(0x253)+_0x51d8f8(0x122)+'ntil\x20confi'+'gured.';await sendWithRetry(_0x29b0ca,{'text':_0x51d8f8(0x29c)+_0x51d8f8(0x23a)+_0x51d8f8(0x1aa)+_0x11d086});return;}const _0x353cf0=DELETE_MODE==='g'?_0x51d8f8(0x22d)+(TARGET_JID||_0x51d8f8(0x26d))+')':'PM';await sendWithRetry(_0x29b0ca,{'text':_0x51d8f8(0x209)+'covery\x20Set'+_0x51d8f8(0x1a6)+_0x51d8f8(0x20a)+_0x51d8f8(0x135)+(_0x51d8f8(0x1e9)+_0x51d8f8(0x26c)+'>\x20send\x20rec'+'overed\x20to\x20'+'bot\x20PM\x0a')+(_0x51d8f8(0x109)+_0x51d8f8(0x20c)+_0x51d8f8(0x147)+'covered\x20to'+_0x51d8f8(0xe6))+(_0x51d8f8(0x24d)+_0x51d8f8(0x18e)+_0x51d8f8(0x29e)+'get\x20group\x20'+_0x51d8f8(0x2ac))+(_0x51d8f8(0x15d)+_0x51d8f8(0x155)+_0x51d8f8(0x158)+_0x51d8f8(0x278)+_0x51d8f8(0x2b0))+('*Current\x20S'+_0x51d8f8(0x127))+(_0x51d8f8(0x1da)+_0x51d8f8(0x16d)+_0x353cf0+'*\x0a')+(_0x51d8f8(0x23c)+'Active:\x20*'+DEFAULT_SEND_DELETE+'*\x0a')+(_0x51d8f8(0x294)+_0x51d8f8(0x2b8)+DELETE_CLEANUP_DAYS+_0x51d8f8(0x1ff))});}catch(_0x162996){error(_0x162996,_0x51d8f8(0xec)+_0x51d8f8(0x20e)+'rror:\x20'+(_0x162996?.[_0x51d8f8(0x166)]||_0x162996));}}export async function initialize(_0x292bf3){const _0x17710b=_0x195b9c;if(!_0x292bf3)throw new Error('delete\x20mod'+'ule\x20requir'+_0x17710b(0x288));botRef=_0x292bf3,refreshConfig(),await ensureTable()['catch'](_0x2a3a85=>{const _0x1b248e=_0x17710b;error(_0x1b248e(0x1cb)+_0x1b248e(0x279)+_0x1b248e(0x261)+_0x1b248e(0x145)+'y:\x20'+(_0x2a3a85?.[_0x1b248e(0x166)]||_0x2a3a85));throw _0x2a3a85;}),startManagedListener({'botRef':botRef,'eventName':_0x17710b(0x24b)+_0x17710b(0x225),'handler':rawMessagesUpsertHandler,'moduleName':name}),await autoCleanOldMessagesSafe()[_0x17710b(0x266)](_0x5e91bd=>warn(_0x17710b(0x22f)+'nitial\x20cle'+_0x17710b(0x134)+':\x20'+(_0x5e91bd?.[_0x17710b(0x166)]||_0x5e91bd)));if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(autoCleanOldMessagesSafe,CLEANUP_INTERVAL||FALLBACKS['CLEANUP_IN'+_0x17710b(0x12e)]),info(_0x17710b(0x24f)+_0x17710b(0x142)+_0x17710b(0x23e)+DELETE_MODE+(_0x17710b(0x196)+'Days:\x20')+DELETE_CLEANUP_DAYS);}export async function cleanup(){const _0x479b27=_0x195b9c;try{stopManagedListener(name,'messages.u'+_0x479b27(0x225)),cleanupInterval&&(clearInterval(cleanupInterval),cleanupInterval=null),messageQueue[_0x479b27(0x1ce)]=0xb4f+0x670+0x4d*-0x3b,deletionQueue['length']=0xb26+0x8*-0xe2+-0x416,pendingRecovered['length']=-0x68a+-0xbff+-0x49*-0x41;}catch(_0x5a91d2){warn(_0x479b27(0x159)+_0x479b27(0x229)+_0x479b27(0xe4)+(_0x5a91d2?.[_0x479b27(0x166)]||_0x5a91d2));}finally{botRef=null;}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};