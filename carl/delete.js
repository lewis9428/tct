const _0x44635a=_0x1bd5;(function(_0x3ad0f0,_0x229355){const _0xee7727=_0x1bd5,_0x2e1d02=_0x3ad0f0();while(!![]){try{const _0x430d31=parseInt(_0xee7727(0x3c3))/(0x3ef+0x254a+0x8*-0x527)*(parseInt(_0xee7727(0x26f))/(-0x970+0x19be+-0x104c))+-parseInt(_0xee7727(0x2ee))/(0x1*0x7ff+0x7*-0x1f5+0x5b7)+-parseInt(_0xee7727(0x346))/(-0x1bb5*0x1+0x31*-0x95+0x17*0x272)+parseInt(_0xee7727(0x331))/(-0x1*-0x775+-0x16a7+0x30b*0x5)*(parseInt(_0xee7727(0x2d9))/(0x5d2+0x2295+-0x1*0x2861))+parseInt(_0xee7727(0x2af))/(0x8f5*0x4+0xeee+-0x14d*0x27)*(-parseInt(_0xee7727(0x1f6))/(-0x8e+-0x3*-0x645+-0x1239))+parseInt(_0xee7727(0x36d))/(-0x89f+-0x16*-0x137+-0x202*0x9)+-parseInt(_0xee7727(0x38d))/(0xe1d*0x1+0x26c3*-0x1+0x18b0);if(_0x430d31===_0x229355)break;else _0x2e1d02['push'](_0x2e1d02['shift']());}catch(_0x31eaaf){_0x2e1d02['push'](_0x2e1d02['shift']());}}}(_0xdf02,-0x1003*-0x19+0x2aab8+-0x2a710));import _0x23c40f from'path';import _0x4e9f85 from'fs';import{mkdirSync}from'fs';import{rm as _0x49e0f6}from'fs/promises';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import _0x1f21c0 from'node-cache';import{isSudo}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name='delete-rec'+_0x44635a(0x24c);export const version=_0x44635a(0x370);export const priority=-0x110b+-0x7d7+0x6*0x42e;export const commands=[_0x44635a(0x2e9)];export const configKeys=[_0x44635a(0x29f)+_0x44635a(0x2e8),'DELETE_DEB'+'OUNCE_MS',_0x44635a(0x2ae)+_0x44635a(0x27f),_0x44635a(0x2e3)+_0x44635a(0x350),_0x44635a(0x24b)+_0x44635a(0x20c),_0x44635a(0x24b)+_0x44635a(0x312)+_0x44635a(0x38f)];const FALLBACKS={'DEBOUNCE_MS':0xbb8,'MEDIA_DIRNAME':'media','DEFAULT_CONCURRENCY':0x3,'CLEANUP_INTERVAL_MS':(-0xff3+0x1*-0x543+0x6*0x38a)*(-0xb*-0x1e7+0x37*0x13+0x18c6*-0x1)*(0x18ef+-0x4a*-0x3+-0x1991)*(-0x23*0xdc+-0x697+0x2893),'MEDIA_SEND_DELAY_MS':0x12c,'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4,'CLEANUP_DAYS':0x3};let botRef=null,cleanupInterval=null;const messageQueue=[],deletionQueue=[];let activeMessageTasks=-0x1b6a+-0x43+0x1bad,activeDeletionTasks=-0x1*0xe3+0x8*-0x320+0x19e3,MEDIA_DIR=null,DEBOUNCE_DELAY_MS=FALLBACKS[_0x44635a(0x278)+'S'],CONCURRENCY=FALLBACKS['DEFAULT_CO'+_0x44635a(0x2d4)],MEDIA_SEND_DELAY_MS=FALLBACKS[_0x44635a(0x2fc)+_0x44635a(0x2fa)],CLEANUP_INTERVAL=FALLBACKS[_0x44635a(0x3ac)+_0x44635a(0x29b)],MAX_SEND_RETRIES=FALLBACKS[_0x44635a(0x2d5)+_0x44635a(0x286)],INITIAL_BACKOFF=FALLBACKS[_0x44635a(0x304)+_0x44635a(0x284)],DELETE_CLEANUP_DAYS=FALLBACKS[_0x44635a(0x308)+'YS'],DEFAULT_SEND_DELETE=![],DELETE_MODE='p',TARGET_JID=null;const nameCache=new _0x1f21c0({'stdTTL':0xe10});let flushTimer=null;const pendingRecovered=[];function ensureDirSync(_0x93cc74){const _0x2b4859=_0x44635a;if(!_0x4e9f85[_0x2b4859(0x1fd)](_0x93cc74))mkdirSync(_0x93cc74,{'recursive':!![]});}function sleep(_0x4627e1){return new Promise(_0x31e8df=>setTimeout(_0x31e8df,_0x4627e1));}function normalizeToUserJid(_0x2e39e4){const _0x81de35=_0x44635a;try{if(!_0x2e39e4||typeof _0x2e39e4!=='string')return _0x2e39e4;const _0x251f31=_0x2e39e4[_0x81de35(0x23e)]('@');if(_0x251f31===-(0x2f2*0x2+0x19ba+-0x1f9d))return _0x2e39e4;const _0x2e2a1c=_0x2e39e4[_0x81de35(0x200)](0x296+-0xa82+0x7ec,_0x251f31),_0x306d66=_0x2e39e4['slice'](_0x251f31),_0x14f2c3=_0x2e2a1c[_0x81de35(0x23e)](':');if(_0x14f2c3===-(-0x3de*0x1+-0x10c3+0x14a2))return _0x2e39e4;return _0x2e2a1c[_0x81de35(0x200)](-0x1ca5*0x1+-0x1403+0x30a8,_0x14f2c3)+_0x306d66;}catch(_0xd3ce1){return _0x2e39e4;}}function refreshConfig(){const _0xda2cc3=_0x44635a;try{const _0x4be078=getConfig()||{};DEFAULT_SEND_DELETE=typeof _0x4be078[_0xda2cc3(0x2e3)+_0xda2cc3(0x350)]===_0xda2cc3(0x293)?_0x4be078[_0xda2cc3(0x2e3)+_0xda2cc3(0x350)]:DEFAULT_SEND_DELETE,DEBOUNCE_DELAY_MS=Number(_0x4be078[_0xda2cc3(0x307)+_0xda2cc3(0x292)]??FALLBACKS[_0xda2cc3(0x278)+'S']),CONCURRENCY=Number(_0x4be078['DELETE_CON'+_0xda2cc3(0x27f)]??_0x4be078[_0xda2cc3(0x380)+_0xda2cc3(0x34e)+'IMIT']??FALLBACKS['DEFAULT_CO'+'NCURRENCY']),MEDIA_SEND_DELAY_MS=Number(_0x4be078['DELETE_MED'+_0xda2cc3(0x3b8)+'LAY_MS']??FALLBACKS[_0xda2cc3(0x2fc)+'_DELAY_MS']),CLEANUP_INTERVAL=Number(_0x4be078[_0xda2cc3(0x24b)+_0xda2cc3(0x312)+'VAL_MS']??FALLBACKS[_0xda2cc3(0x3ac)+_0xda2cc3(0x29b)]),MAX_SEND_RETRIES=Number(_0x4be078[_0xda2cc3(0x246)+_0xda2cc3(0x310)+_0xda2cc3(0x26b)]??FALLBACKS[_0xda2cc3(0x2d5)+'ETRIES']),INITIAL_BACKOFF=Number(_0x4be078[_0xda2cc3(0x3b6)+_0xda2cc3(0x237)+_0xda2cc3(0x1ff)]??FALLBACKS['INITIAL_BA'+_0xda2cc3(0x284)]),DELETE_CLEANUP_DAYS=Number(_0x4be078['DELETE_CLE'+_0xda2cc3(0x20c)]??FALLBACKS[_0xda2cc3(0x308)+'YS']);const _0x5e9caf=_0x4be078[_0xda2cc3(0x298)+'OT']&&typeof _0x4be078[_0xda2cc3(0x298)+'OT']==='string'?_0x4be078['PROJECT_RO'+'OT']:process[_0xda2cc3(0x1ed)](),_0x31a53a=_0x23c40f['resolve'](_0x5e9caf,_0xda2cc3(0x204),_0xda2cc3(0x2e9));ensureDirSync(_0x31a53a),MEDIA_DIR=_0x23c40f[_0xda2cc3(0x2c8)](_0x31a53a,_0x4be078[_0xda2cc3(0x29f)+'IA_DIRNAME']??_0x4be078[_0xda2cc3(0x29f)+_0xda2cc3(0x29e)]??FALLBACKS[_0xda2cc3(0x314)+_0xda2cc3(0x21e)]),ensureDirSync(MEDIA_DIR);}catch(_0x48cc9a){warn(_0xda2cc3(0x359)+_0xda2cc3(0x1f1)+'ig\x20error:\x20'+(_0x48cc9a?.[_0xda2cc3(0x388)]||_0x48cc9a));}}function _0x1bd5(_0x50a488,_0xe2dd5b){const _0x438562=_0xdf02();return _0x1bd5=function(_0x208f77,_0x1ae2fd){_0x208f77=_0x208f77-(0x161c+0x25eb+-0x1*0x3a22);let _0x261e35=_0x438562[_0x208f77];return _0x261e35;},_0x1bd5(_0x50a488,_0xe2dd5b);}try{hotReloadConfig&&hotReloadConfig(()=>{const _0x1a9ece=_0x44635a;refreshConfig(),info(_0x1a9ece(0x3c2)+_0x1a9ece(0x29a)+_0x1a9ece(0x2db));});}catch(_0x5af3b7){warn(_0x44635a(0x2da)+_0x44635a(0x220)+_0x44635a(0x1fc)+_0x44635a(0x23d)+_0x44635a(0x38e)+(_0x5af3b7?.[_0x44635a(0x388)]||_0x5af3b7));}refreshConfig();const MESSAGES_COLUMNS={'msg_id':_0x44635a(0x248)+_0x44635a(0x315),'chat_jid':'TEXT','remote_alt':_0x44635a(0x39d),'sender_jid':_0x44635a(0x39d),'participant_alt':_0x44635a(0x39d),'message_json':_0x44635a(0x39d),'timestamp':_0x44635a(0x3c5),'media_path':_0x44635a(0x39d),'saved_at':_0x44635a(0x3c5),'resent_at':'INTEGER'};async function ensureTable(){const _0x26eff5=_0x44635a;try{const _0x43386b=Object['entries'](MESSAGES_COLUMNS)[_0x26eff5(0x364)](([_0x39b5f8,_0x5b9652])=>_0x39b5f8+'\x20'+_0x5b9652)[_0x26eff5(0x2c8)](_0x26eff5(0x35c));await db[_0x26eff5(0x335)](_0x26eff5(0x28e)+_0x26eff5(0x32d)+_0x26eff5(0x2f1)+_0x26eff5(0x362)+_0x43386b+'\x0a);');let _0x330f7e=[];try{const _0x158e50=await db['all'](_0x26eff5(0x37e)+_0x26eff5(0x24d)+_0x26eff5(0x3c8));_0x330f7e=(_0x158e50||[])[_0x26eff5(0x364)](_0x493cb3=>_0x493cb3[_0x26eff5(0x302)]);}catch(_0x5d211d){warn(_0x26eff5(0x30b)+_0x26eff5(0x34a)+_0x26eff5(0x234)+_0x26eff5(0x294)+(_0x5d211d?.[_0x26eff5(0x388)]||_0x5d211d));}for(const _0x57a959 of Object[_0x26eff5(0x2ea)](MESSAGES_COLUMNS)){if(!_0x330f7e[_0x26eff5(0x2d0)](_0x57a959)){const _0x516da4=MESSAGES_COLUMNS[_0x57a959];try{await db[_0x26eff5(0x1f5)](_0x26eff5(0x3bb)+_0x26eff5(0x35d)+_0x26eff5(0x39c)+'N\x20'+_0x57a959+'\x20'+_0x516da4),info('[Delete]\x20a'+_0x26eff5(0x384)+_0x26eff5(0x2bd)+_0x26eff5(0x344)+_0x57a959);}catch(_0x4b50b9){warn(_0x26eff5(0x3b2)+_0x26eff5(0x394)+'dd\x20column\x20'+_0x57a959+':\x20'+(_0x4b50b9?.[_0x26eff5(0x388)]||_0x4b50b9));}}}await db['exec'](_0x26eff5(0x28e)+'LE\x20IF\x20NOT\x20'+_0x26eff5(0x38a)+'ete_prefs\x20'+'(\x0a\x20\x20\x20\x20\x20\x20ke'+_0x26eff5(0x2d3)+_0x26eff5(0x2aa)+'\x20\x20\x20\x20\x20\x20valu'+'e\x20TEXT\x20NOT'+_0x26eff5(0x339)+_0x26eff5(0x2e7)+_0x26eff5(0x3b5)+_0x26eff5(0x3d1)+_0x26eff5(0x313));try{const _0x1515d6=await db[_0x26eff5(0x226)]('SELECT\x20val'+_0x26eff5(0x216)+'lete_prefs'+_0x26eff5(0x3d8)+_0x26eff5(0x2c1));if(!_0x1515d6){const _0x409164=Math['floor'](Date[_0x26eff5(0x2d7)]()/(-0x1d36+-0x21ac+0x42ca));await db['run']('INSERT\x20INT'+_0x26eff5(0x358)+_0x26eff5(0x2a5)+_0x26eff5(0x2b6)+_0x26eff5(0x1f2)+'VALUES\x20(\x27m'+'ode\x27,\x27p\x27,\x20'+'?)',[_0x409164]),DELETE_MODE='p';}else DELETE_MODE=_0x1515d6[_0x26eff5(0x268)]==='g'?'g':'p';}catch(_0x19193b){warn('[Delete]\x20p'+_0x26eff5(0x244)+')\x20load\x20fai'+_0x26eff5(0x294)+(_0x19193b?.['message']||_0x19193b));}try{const _0x539832=await db[_0x26eff5(0x226)](_0x26eff5(0x351)+'ue\x20FROM\x20de'+_0x26eff5(0x3ba)+'\x20WHERE\x20key'+_0x26eff5(0x324)+'id\x27');TARGET_JID=_0x539832?.['value']||null;}catch(_0x542482){warn('[Delete]\x20t'+'arget_jid\x20'+'load\x20faile'+_0x26eff5(0x387)+(_0x542482?.['message']||_0x542482)),TARGET_JID=null;}}catch(_0x5f1063){warn(_0x26eff5(0x306)+'nsureTable'+_0x26eff5(0x336)+':\x20'+(_0x5f1063?.[_0x26eff5(0x388)]||_0x5f1063));throw _0x5f1063;}}async function streamMediaToFile(_0x280edf,_0x3029b8){const _0x5205f2=_0x44635a;try{const _0x51fcb3=_0x280edf[_0x5205f2(0x388)][_0x3029b8+_0x5205f2(0x36e)],_0x5618e5=await downloadContentFromMessage(_0x51fcb3,_0x3029b8);let _0x3007bd=_0x5205f2(0x316);if(_0x3029b8===_0x5205f2(0x33e))_0x3007bd='jpg';else{if(_0x3029b8===_0x5205f2(0x287)||_0x3029b8===_0x5205f2(0x203))_0x3007bd=_0x5205f2(0x2a8);else{if(_0x3029b8==='audio')_0x3007bd=_0x5205f2(0x25d);else{if(_0x3029b8===_0x5205f2(0x328))_0x3007bd=_0x51fcb3?.[_0x5205f2(0x303)]?_0x51fcb3[_0x5205f2(0x303)][_0x5205f2(0x3a5)]('.')[_0x5205f2(0x218)]():_0x5205f2(0x2cd);else{if(_0x3029b8==='sticker')_0x3007bd=_0x5205f2(0x22a);}}}}const _0x31aba7=_0x280edf['key']['id']+'.'+_0x3007bd,_0x342072=_0x23c40f[_0x5205f2(0x2c8)](MEDIA_DIR,_0x31aba7);await new Promise((_0x144c00,_0x3307f0)=>{const _0x2c71fd=_0x5205f2,_0x5a817f=_0x4e9f85['createWrit'+_0x2c71fd(0x31b)](_0x342072);((async()=>{const _0x2b08b9=_0x2c71fd;try{for await(const _0x482516 of _0x5618e5){if(!_0x5a817f[_0x2b08b9(0x259)](_0x482516))await new Promise(_0x143389=>_0x5a817f['once'](_0x2b08b9(0x30e),_0x143389));}_0x5a817f[_0x2b08b9(0x319)](),_0x5a817f['once'](_0x2b08b9(0x2a3),()=>_0x144c00());}catch(_0x4cfe7b){try{_0x5a817f[_0x2b08b9(0x3b1)]();}catch(_0x5dd48a){}_0x3307f0(_0x4cfe7b);}})());});try{const _0x31d828=_0x4e9f85['statSync'](_0x342072);if(_0x31d828[_0x5205f2(0x281)]===0x158a+-0x1091+-0x4f9)return warn(_0x5205f2(0x357)+_0x5205f2(0x2f3)+_0x342072+_0x5205f2(0x356)),null;}catch(_0xee18d2){}return _0x342072;}catch(_0x376318){return warn(_0x5205f2(0x357)+'treamMedia'+_0x5205f2(0x375)+_0x5205f2(0x345)+(_0x280edf[_0x5205f2(0x35b)]?.['id']||_0x5205f2(0x2dd))+':\x20'+(_0x376318?.[_0x5205f2(0x388)]||_0x376318)),null;}}async function maybeSaveMedia(_0x3b2b25){const _0x1fe05d=_0x44635a;try{const _0x4a223e=[_0x1fe05d(0x33e),_0x1fe05d(0x287),_0x1fe05d(0x203),_0x1fe05d(0x214),_0x1fe05d(0x328),_0x1fe05d(0x2e0)];for(const _0x1df9be of _0x4a223e){if(_0x1df9be===_0x1fe05d(0x203)){if(_0x3b2b25[_0x1fe05d(0x388)]?.['ptvMessage'])return await streamMediaToFile(_0x3b2b25,_0x1fe05d(0x203));continue;}if(_0x3b2b25[_0x1fe05d(0x388)]?.[_0x1df9be+_0x1fe05d(0x36e)])return await streamMediaToFile(_0x3b2b25,_0x1df9be);}return null;}catch(_0x50cff5){return warn('[Delete]\x20m'+'aybeSaveMe'+'dia\x20error:'+'\x20'+(_0x50cff5?.[_0x1fe05d(0x388)]||_0x50cff5)),null;}}async function insertMessageToDB(_0x1f0310,_0xac5b4){const _0x2d9b0b=_0x44635a;try{if(!_0x1f0310||!_0x1f0310['key'])return;const {id:_0x3893fc,remoteJid:_0x3b69c1,participant:_0x574b64}=_0x1f0310['key'],_0x4f9396=_0x574b64||_0x3b69c1,_0x47446f=typeof _0x1f0310[_0x2d9b0b(0x37c)+_0x2d9b0b(0x245)]===_0x2d9b0b(0x392)?_0x1f0310[_0x2d9b0b(0x37c)+'estamp']:_0x1f0310[_0x2d9b0b(0x37c)+_0x2d9b0b(0x245)]?.[_0x2d9b0b(0x254)]||Math[_0x2d9b0b(0x256)](Date[_0x2d9b0b(0x2d7)]()/(-0x26be+0x1e30+0xc76)),_0x1b35c8=_0x1f0310[_0x2d9b0b(0x35b)]?.[_0x2d9b0b(0x369)+'lt']||null,_0x39dbda=_0x1f0310[_0x2d9b0b(0x35b)]?.[_0x2d9b0b(0x3d4)+_0x2d9b0b(0x1f4)]||null,_0x5ddeba=Math[_0x2d9b0b(0x256)](Date[_0x2d9b0b(0x2d7)]()/(0xb39+0xaf8+-0x1249));if(!_0x3893fc){warn(_0x2d9b0b(0x34c)+_0x2d9b0b(0x2b5)+'geToDB:\x20mi'+_0x2d9b0b(0x3af)+'id');return;}const _0x311dc9='INSERT\x20OR\x20'+_0x2d9b0b(0x21b)+_0x2d9b0b(0x340)+_0x2d9b0b(0x266)+_0x2d9b0b(0x29c)+_0x2d9b0b(0x2bf)+_0x2d9b0b(0x2f6)+_0x2d9b0b(0x2cb)+_0x2d9b0b(0x289)+_0x2d9b0b(0x301)+_0x2d9b0b(0x2e2)+_0x2d9b0b(0x3be)+_0x2d9b0b(0x3a2)+_0x2d9b0b(0x250)+'esent_at)\x0a'+_0x2d9b0b(0x382)+_0x2d9b0b(0x21a)+_0x2d9b0b(0x3aa)+_0x2d9b0b(0x37a)+_0x2d9b0b(0x2b2),_0x15e8ff=[_0x3893fc,_0x3b69c1||null,_0x1b35c8,_0x4f9396||null,_0x39dbda,JSON[_0x2d9b0b(0x2a4)](_0x1f0310),_0x47446f,_0xac5b4||null,_0x5ddeba,null];try{await db[_0x2d9b0b(0x1f5)](_0x311dc9,_0x15e8ff);}catch(_0xbe3ce8){const _0x5ec4c9=String(_0xbe3ce8?.[_0x2d9b0b(0x388)]||'');if(_0x5ec4c9['includes'](_0x2d9b0b(0x264)+_0x2d9b0b(0x2d6))){warn(_0x2d9b0b(0x34c)+_0x2d9b0b(0x321)+_0x2d9b0b(0x3ab)+_0x2d9b0b(0x2ed)+_0x2d9b0b(0x395)+_0x5ec4c9+('\x20â€”\x20ensurin'+'g\x20table\x20an'+_0x2d9b0b(0x242)));try{await ensureTable(),await db[_0x2d9b0b(0x1f5)](_0x311dc9,_0x15e8ff);}catch(_0x3772db){warn(_0x2d9b0b(0x359)+_0x2d9b0b(0x2cf)+'t\x20failed:\x20'+(_0x3772db?.[_0x2d9b0b(0x388)]||_0x3772db));}}else throw _0xbe3ce8;}}catch(_0x37ade8){warn(_0x2d9b0b(0x34c)+'nsertMessa'+_0x2d9b0b(0x223)+_0x2d9b0b(0x294)+(_0x37ade8?.[_0x2d9b0b(0x388)]||_0x37ade8));}}async function fetchOriginalMessage(_0x46558c){const _0x36b051=_0x44635a;try{if(!_0x46558c)return null;const _0x56ec97=await db['get']('SELECT\x20msg'+_0x36b051(0x323)+_0x36b051(0x1ef)+_0x36b051(0x22e)+'\x20saved_at\x20'+_0x36b051(0x20d)+_0x36b051(0x20e)+'msg_id=?',[_0x46558c]);if(_0x56ec97)try{return{'msg_id':_0x56ec97[_0x36b051(0x354)],'message':JSON[_0x36b051(0x32b)](_0x56ec97[_0x36b051(0x2ab)+'on']),'media_path':_0x56ec97['media_path'],'saved_at':_0x56ec97[_0x36b051(0x25a)]};}catch(_0x44689f){return{'msg_id':_0x56ec97[_0x36b051(0x354)],'message':null,'media_path':_0x56ec97[_0x36b051(0x3a1)],'saved_at':_0x56ec97['saved_at']};}const _0x1c86f2=_0x36b051(0x2b9)+_0x46558c+'\x22%',_0x5e9e6c=await db[_0x36b051(0x348)](_0x36b051(0x236)+'_id,\x20messa'+'ge_json,\x20m'+'edia_path,'+'\x20saved_at\x20'+'FROM\x20messa'+_0x36b051(0x20e)+_0x36b051(0x2ab)+_0x36b051(0x1f9)+_0x36b051(0x23c),[_0x1c86f2]);if(_0x5e9e6c&&_0x5e9e6c[_0x36b051(0x3cf)])try{return{'msg_id':_0x5e9e6c[0x1*0x229f+-0x1*-0x4a2+-0x1*0x2741][_0x36b051(0x354)],'message':JSON['parse'](_0x5e9e6c[-0xcb9*0x2+0xf3f*-0x1+0x28b1]['message_js'+'on']),'media_path':_0x5e9e6c[0x4*0x293+-0x1417+0x17*0x6d][_0x36b051(0x3a1)],'saved_at':_0x5e9e6c[0x22ed*-0x1+0x1c3a+0x6b3][_0x36b051(0x25a)]};}catch(_0x240c07){return{'msg_id':_0x5e9e6c[0x1a27+0x3*-0x5cf+-0x8ba][_0x36b051(0x354)],'message':null,'media_path':_0x5e9e6c[0x79e+0x1175*0x2+-0x2a88]['media_path'],'saved_at':_0x5e9e6c[0x1079*-0x1+-0x167e*0x1+-0x19*-0x18f][_0x36b051(0x25a)]};}return null;}catch(_0x45964e){return warn(_0x36b051(0x3b2)+_0x36b051(0x3c9)+'alMessage\x20'+_0x36b051(0x263)+(_0x45964e?.[_0x36b051(0x388)]||_0x45964e)),null;}}async function deleteMessageRow(_0x286a91){const _0x172a1a=_0x44635a;try{if(!_0x286a91)return;const _0x110609=await db[_0x172a1a(0x226)](_0x172a1a(0x2f2)+_0x172a1a(0x22c)+_0x172a1a(0x343)+_0x172a1a(0x251)+_0x172a1a(0x1eb),[_0x286a91]);if(_0x110609?.['media_path'])try{await _0x49e0f6(_0x110609['media_path']),info(_0x172a1a(0x359)+'emoved\x20sav'+_0x172a1a(0x2fd)+_0x172a1a(0x3a9));}catch(_0x5a1447){warn('[Delete]\x20f'+'ailed\x20to\x20r'+_0x172a1a(0x2c0)+'\x20'+_0x110609[_0x172a1a(0x3a1)]+':\x20'+(_0x5a1447?.['message']||_0x5a1447));}await db[_0x172a1a(0x1f5)](_0x172a1a(0x269)+'M\x20messages'+_0x172a1a(0x39e)+_0x172a1a(0x39f),[_0x286a91]),info(_0x172a1a(0x34f)+_0x172a1a(0x231)+_0x172a1a(0x1ee)+'\x20'+_0x286a91);}catch(_0x2cf92f){warn('[Delete]\x20d'+'eleteMessa'+'geRow\x20erro'+_0x172a1a(0x373)+(_0x2cf92f?.[_0x172a1a(0x388)]||_0x2cf92f));}}async function sendWithRetry(_0x197aa8,_0x455d26,_0x138f9b=[]){const _0x3da602=_0x44635a,_0x171838=Number(MAX_SEND_RETRIES||FALLBACKS[_0x3da602(0x2d5)+_0x3da602(0x286)]);let _0x713d=0x880+0x5*-0x3af+0x9eb,_0x319b60=Number(INITIAL_BACKOFF||FALLBACKS[_0x3da602(0x304)+_0x3da602(0x284)]);const _0x53cab7=[_0x197aa8,TARGET_JID,getBotJid()][_0x3da602(0x261)](Boolean)[_0x3da602(0x364)](normalizeToUserJid),_0x297eb6=new Set(),_0x1ecfdc=[];for(const _0x35bbcb of _0x53cab7){if(!_0x35bbcb)continue;!_0x297eb6[_0x3da602(0x3d5)](_0x35bbcb)&&(_0x297eb6[_0x3da602(0x207)](_0x35bbcb),_0x1ecfdc[_0x3da602(0x3b3)](_0x35bbcb));}let _0x2d4ec7=_0x1ecfdc[_0x3da602(0x3cf)]?_0x1ecfdc[-0x391+-0x874+0xc05]:null;if(_0x2d4ec7&&_0x2d4ec7[_0x3da602(0x232)](_0x3da602(0x1ec))&&typeof botRef?.[_0x3da602(0x229)]?.[_0x3da602(0x3b4)]===_0x3da602(0x276))try{const _0x2e8dec=await botRef['sock']['onWhatsApp'](_0x2d4ec7);if(Array['isArray'](_0x2e8dec)&&_0x2e8dec[-0x4*-0x4b9+0x1e5*0x1+-0x14c9]&&_0x2e8dec[0x112e+-0x1e3b+0xd0d*0x1][_0x3da602(0x3bc)])_0x2d4ec7=normalizeToUserJid(_0x2e8dec[-0xfa4+0x3de+-0x112*-0xb][_0x3da602(0x3bc)]);}catch(_0x536b30){warn(_0x3da602(0x3a3)+'nWhatsApp\x20'+_0x3da602(0x2c2)+_0x3da602(0x38e)+(_0x536b30?.['message']||_0x536b30));}while(_0x713d<_0x171838){try{if(!_0x2d4ec7)throw new Error(_0x3da602(0x385)+_0x3da602(0x296)+_0x3da602(0x27a));if(Array[_0x3da602(0x25f)](_0x138f9b)&&_0x138f9b[_0x3da602(0x3cf)]&&typeof _0x455d26===_0x3da602(0x2ba)&&_0x455d26!==null)_0x455d26[_0x3da602(0x365)]=_0x138f9b;return await botRef['sendMessag'+'e'](_0x2d4ec7,_0x455d26),!![];}catch(_0x4d64ac){_0x713d++;const _0x17147d=String(_0x4d64ac?.[_0x3da602(0x388)]||'')[_0x3da602(0x381)+'e']()['includes'](_0x3da602(0x201))||_0x4d64ac?.[_0x3da602(0x36f)]===0x7*-0x13d+-0xf*0x1f+0x11b*0xb;warn(_0x3da602(0x357)+'end\x20attemp'+'t\x20'+_0x713d+_0x3da602(0x2ac)+_0x2d4ec7+'\x20failed:\x20'+(_0x4d64ac?.['message']||_0x4d64ac));if(_0x713d>=_0x171838||!_0x17147d)return![];await sleep(_0x319b60),_0x319b60*=0xf8f+0x21ca+-0x11*0x2e7;}}return![];}function extractContent(_0x170a58){const _0x19d02b=_0x44635a;if(!_0x170a58)return'';if(_0x170a58[_0x19d02b(0x349)+'on'])return _0x170a58[_0x19d02b(0x349)+'on'];if(_0x170a58[_0x19d02b(0x243)+_0x19d02b(0x26e)])return _0x170a58['extendedTe'+_0x19d02b(0x26e)][_0x19d02b(0x2b8)];if(_0x170a58[_0x19d02b(0x2ff)+'ge'])return _0x170a58['imageMessa'+'ge'][_0x19d02b(0x27b)]||'';if(_0x170a58[_0x19d02b(0x399)+'ge'])return _0x170a58[_0x19d02b(0x399)+'ge'][_0x19d02b(0x27b)]||'';if(_0x170a58[_0x19d02b(0x2a1)])return _0x170a58['ptvMessage'][_0x19d02b(0x27b)]||'';if(_0x170a58[_0x19d02b(0x30c)+'ge'])return _0x170a58[_0x19d02b(0x30c)+'ge']?.['ptt']?_0x19d02b(0x31c)+'e]':_0x19d02b(0x22d);if(_0x170a58[_0x19d02b(0x2f9)+_0x19d02b(0x3ce)])return _0x170a58[_0x19d02b(0x2f9)+_0x19d02b(0x3ce)]['fileName']||'';if(_0x170a58[_0x19d02b(0x325)+_0x19d02b(0x330)])return _0x19d02b(0x21c);if(_0x170a58['pollCreati'+_0x19d02b(0x2dc)+'3'])return _0x19d02b(0x30a)+(_0x170a58[_0x19d02b(0x2a2)+_0x19d02b(0x2dc)+'3'][_0x19d02b(0x302)]||_0x19d02b(0x213))+']';return _0x19d02b(0x277);}function isMediaMessage(_0x432ed0){const _0x46067a=_0x44635a;if(!_0x432ed0)return![];if(_0x432ed0[_0x46067a(0x2ff)+'ge'])return!![];if(_0x432ed0['videoMessa'+'ge'])return!![];if(_0x432ed0['audioMessa'+'ge'])return!![];if(_0x432ed0[_0x46067a(0x2f9)+_0x46067a(0x3ce)])return!![];if(_0x432ed0[_0x46067a(0x325)+_0x46067a(0x330)])return!![];if(_0x432ed0[_0x46067a(0x2a1)])return!![];if(_0x432ed0[_0x46067a(0x399)+'ge']&&_0x432ed0[_0x46067a(0x399)+'ge'][_0x46067a(0x227)+'k'])return!![];const _0x1b371d=Object[_0x46067a(0x2ea)](_0x432ed0||{});for(const _0x1a1de2 of _0x1b371d){if(_0x1a1de2[_0x46067a(0x232)]('Message')&&['imageMessa'+'ge',_0x46067a(0x399)+'ge',_0x46067a(0x30c)+'ge',_0x46067a(0x2f9)+_0x46067a(0x3ce),_0x46067a(0x325)+_0x46067a(0x330),_0x46067a(0x2a1)][_0x46067a(0x2d0)](_0x1a1de2))return!![];}return![];}function buildPayloadForSavedFile(_0x4f239d,_0x5a30d0){const _0x214e0e=_0x44635a,_0x5f6166=_0x5a30d0?.[_0x214e0e(0x388)]||{},_0xeb5aa=extractContent(_0x5f6166)||undefined;if(_0x5f6166[_0x214e0e(0x325)+'sage'])return{'sticker':{'url':_0x4f239d}};if(_0x5f6166[_0x214e0e(0x2a1)]){const _0x296404={'video':{'url':_0x4f239d},'ptv':!![]};if(_0xeb5aa)_0x296404[_0x214e0e(0x27b)]=_0xeb5aa;if(_0x5f6166['ptvMessage']?.[_0x214e0e(0x27c)])_0x296404[_0x214e0e(0x27c)]=_0x5f6166['ptvMessage'][_0x214e0e(0x27c)];return _0x296404;}if(_0x5f6166['videoMessa'+'ge']){const _0x32c01a={'video':{'url':_0x4f239d}};if(_0x5f6166['videoMessa'+'ge']?.[_0x214e0e(0x27b)])_0x32c01a['caption']=_0x5f6166[_0x214e0e(0x399)+'ge']['caption'];if(typeof _0x5f6166['videoMessa'+'ge']?.[_0x214e0e(0x227)+'k']===_0x214e0e(0x293))_0x32c01a[_0x214e0e(0x227)+'k']=_0x5f6166[_0x214e0e(0x399)+'ge'][_0x214e0e(0x227)+'k'];if(_0x5f6166[_0x214e0e(0x399)+'ge']?.[_0x214e0e(0x27c)])_0x32c01a[_0x214e0e(0x27c)]=_0x5f6166[_0x214e0e(0x399)+'ge']['mimetype'];return _0x32c01a;}if(_0x5f6166[_0x214e0e(0x2ff)+'ge']){const _0x3a4034={'image':{'url':_0x4f239d}};if(_0x5f6166['imageMessa'+'ge']?.[_0x214e0e(0x27b)])_0x3a4034[_0x214e0e(0x27b)]=_0x5f6166[_0x214e0e(0x2ff)+'ge'][_0x214e0e(0x27b)];return _0x3a4034;}if(_0x5f6166[_0x214e0e(0x30c)+'ge']){const _0x163d37={'audio':{'url':_0x4f239d}};if(typeof _0x5f6166[_0x214e0e(0x30c)+'ge']?.[_0x214e0e(0x391)]===_0x214e0e(0x293))_0x163d37[_0x214e0e(0x391)]=_0x5f6166[_0x214e0e(0x30c)+'ge'][_0x214e0e(0x391)];if(_0x5f6166[_0x214e0e(0x30c)+'ge']?.[_0x214e0e(0x27c)])_0x163d37[_0x214e0e(0x27c)]=_0x5f6166['audioMessa'+'ge'][_0x214e0e(0x27c)];if(typeof _0x5f6166['audioMessa'+'ge']?.['seconds']===_0x214e0e(0x392))_0x163d37[_0x214e0e(0x1fe)]=_0x5f6166['audioMessa'+'ge'][_0x214e0e(0x1fe)];return _0x163d37;}if(_0x5f6166[_0x214e0e(0x2f9)+_0x214e0e(0x3ce)]){const _0x1f88c5=_0x5f6166[_0x214e0e(0x2f9)+_0x214e0e(0x3ce)]?.['fileName']||_0x23c40f[_0x214e0e(0x322)](_0x4f239d),_0x46cbbc={'document':{'url':_0x4f239d,'fileName':_0x1f88c5}};if(_0x5f6166['documentMe'+_0x214e0e(0x3ce)]?.[_0x214e0e(0x27c)])_0x46cbbc['mimetype']=_0x5f6166[_0x214e0e(0x2f9)+_0x214e0e(0x3ce)][_0x214e0e(0x27c)];if(_0x5f6166[_0x214e0e(0x2f9)+_0x214e0e(0x3ce)]?.['caption'])_0x46cbbc[_0x214e0e(0x27b)]=_0x5f6166[_0x214e0e(0x2f9)+'ssage'][_0x214e0e(0x27b)];if(_0xeb5aa&&!_0x46cbbc[_0x214e0e(0x27b)])_0x46cbbc['caption']=_0xeb5aa;return _0x46cbbc;}return{'document':{'url':_0x4f239d,'fileName':_0x23c40f[_0x214e0e(0x322)](_0x4f239d)},'caption':_0xeb5aa};}async function processDeletionItem(_0x26f7a6){const _0x4591a6=_0x44635a;try{const _0x13fc49=_0x26f7a6['keys']||[];if(!_0x13fc49[_0x4591a6(0x3cf)])return;for(const _0x41e064 of _0x13fc49){const _0x1352c0=await fetchOriginalMessage(_0x41e064['id']);if(!_0x1352c0||!_0x1352c0[_0x4591a6(0x388)])continue;const _0x2acda3=_0x1352c0[_0x4591a6(0x388)],_0x259c60=getBotJidRaw(),_0x16cd01=_0x2acda3['key']?.[_0x4591a6(0x3d4)+'t']||_0x2acda3[_0x4591a6(0x35b)]?.[_0x4591a6(0x290)];if(_0x2acda3[_0x4591a6(0x35b)]?.[_0x4591a6(0x208)]||_0x16cd01===_0x259c60)continue;const _0x3c397d=_0x2acda3[_0x4591a6(0x35b)]['participan'+'t']||_0x2acda3['key'][_0x4591a6(0x290)],_0x559fc9=extractContent(_0x2acda3[_0x4591a6(0x388)]);let _0x3df5a4=nameCache[_0x4591a6(0x226)](_0x3c397d);if(!_0x3df5a4){try{const [_0x39522a]=await botRef[_0x4591a6(0x229)][_0x4591a6(0x3b4)](_0x3c397d);_0x3df5a4=_0x39522a?.[_0x4591a6(0x376)]||'~'+_0x3c397d[_0x4591a6(0x3a5)]('@')[-0x177*-0x9+0x1b56+0xfd*-0x29];}catch{_0x3df5a4='~'+_0x3c397d[_0x4591a6(0x3a5)]('@')[-0x1a8a+0x236b*0x1+-0x8e1*0x1];}nameCache[_0x4591a6(0x2c4)](_0x3c397d,_0x3df5a4);}let _0x22831e='';if(isJidGroup(_0x2acda3[_0x4591a6(0x35b)][_0x4591a6(0x290)]))try{_0x22831e=(await botRef['sock'][_0x4591a6(0x29d)+_0x4591a6(0x2a0)](_0x2acda3[_0x4591a6(0x35b)]['remoteJid']))[_0x4591a6(0x2e1)];}catch{_0x22831e=_0x4591a6(0x2f5)+_0x4591a6(0x3cd);}deletionPush({'msg_id':_0x1352c0['msg_id'],'sender':_0x3c397d,'name':_0x3df5a4,'group':_0x22831e,'content':_0x559fc9,'mediaPath':_0x1352c0['media_path']||null,'originalMessage':_0x2acda3});}}catch(_0x168e2d){warn(_0x4591a6(0x2bb)+_0x4591a6(0x317)+_0x4591a6(0x258)+'rror:\x20'+(_0x168e2d?.[_0x4591a6(0x388)]||_0x168e2d));}}async function deletionWorker(){const _0x409f96=_0x44635a,_0x5ad9bf=CONCURRENCY||FALLBACKS[_0x409f96(0x360)+'NCURRENCY'];while(deletionQueue[_0x409f96(0x3cf)]>-0xc17*-0x1+0x26cb+-0x1a*0x1f5&&activeDeletionTasks<_0x5ad9bf){const _0x35901f=deletionQueue[_0x409f96(0x2ec)]();if(!_0x35901f)break;activeDeletionTasks++,((async()=>{const _0x21877b=_0x409f96;try{await processDeletionItem(_0x35901f);}catch(_0x3601a){warn(_0x21877b(0x34f)+_0x21877b(0x209)+_0x21877b(0x30d)+_0x21877b(0x2b3)+(_0x3601a?.[_0x21877b(0x388)]||_0x3601a));}finally{activeDeletionTasks--,setImmediate(()=>{const _0x45e793=_0x21877b;if(deletionQueue[_0x45e793(0x3cf)])deletionWorker()[_0x45e793(0x36b)](()=>{});});}})());}}function deletionPush(_0x37b637){const _0x46c1ea=_0x44635a;pendingRecovered[_0x46c1ea(0x3b3)](_0x37b637),clearTimeout(flushTimer),flushTimer=setTimeout(()=>{const _0x16369d=_0x46c1ea,_0x569809=pendingRecovered[_0x16369d(0x28f)](0x1eca+0xc0*-0x13+-0x108a,pendingRecovered['length']);((async()=>{const _0x4de75f=_0x16369d;try{await flushRecoveredBatch(_0x569809);}catch(_0x2279c3){warn(_0x4de75f(0x3b2)+'lushRecove'+_0x4de75f(0x300)+_0x4de75f(0x2b3)+(_0x2279c3?.[_0x4de75f(0x388)]||_0x2279c3));}})());},DEBOUNCE_DELAY_MS||FALLBACKS[_0x46c1ea(0x278)+'S']);}function resolveDeleteTarget(_0xe608c0){const _0x5ea01e=getBotJid();if(DELETE_MODE==='g'&&TARGET_JID){if(TARGET_JID===_0xe608c0)return _0x5ea01e;return TARGET_JID;}return _0x5ea01e;}async function saveDeleteMode(_0x5792e5){const _0x4bd3ba=_0x44635a;try{const _0x36f8e1=_0x5792e5==='g'?'g':'p',_0x2ae827=Math[_0x4bd3ba(0x256)](Date[_0x4bd3ba(0x2d7)]()/(-0x2*0xa08+-0xd5e+0x2556));return await db[_0x4bd3ba(0x1f5)](_0x4bd3ba(0x241)+_0x4bd3ba(0x358)+_0x4bd3ba(0x2a5)+_0x4bd3ba(0x2b6)+_0x4bd3ba(0x1f2)+_0x4bd3ba(0x20b)+_0x4bd3ba(0x32a)+')\x20ON\x20CONFL'+_0x4bd3ba(0x1f7)+_0x4bd3ba(0x372)+'ET\x20value=e'+_0x4bd3ba(0x1f8)+_0x4bd3ba(0x271)+_0x4bd3ba(0x273)+'uded.updat'+_0x4bd3ba(0x23f),[_0x36f8e1,_0x2ae827]),DELETE_MODE=_0x36f8e1,info(_0x4bd3ba(0x2f8)+'ode\x20saved:'+'\x20'+DELETE_MODE),!![];}catch(_0x9d5862){return warn(_0x4bd3ba(0x357)+_0x4bd3ba(0x2eb)+_0x4bd3ba(0x30f)+':\x20'+(_0x9d5862?.['message']||_0x9d5862)),![];}}async function saveDeleteTarget(_0x6b0c9f){const _0x26bb53=_0x44635a;try{const _0x39696f=Math[_0x26bb53(0x256)](Date[_0x26bb53(0x2d7)]()/(0x92f*-0x4+0x12e*0x8+0x1*0x1f34));if(!_0x6b0c9f)return await db[_0x26bb53(0x1f5)]('DELETE\x20FRO'+'M\x20delete_p'+_0x26bb53(0x396)+'\x20key=\x27targ'+_0x26bb53(0x355)),TARGET_JID=null,info('[Delete]\x20t'+_0x26bb53(0x39a)+_0x26bb53(0x2be)),!![];else{const _0x4e43b8=normalizeToUserJid(_0x6b0c9f);return await db[_0x26bb53(0x1f5)](_0x26bb53(0x241)+_0x26bb53(0x358)+_0x26bb53(0x2a5)+_0x26bb53(0x2b6)+_0x26bb53(0x1f2)+_0x26bb53(0x31a)+_0x26bb53(0x31d)+_0x26bb53(0x3d7)+_0x26bb53(0x1e7)+'key)\x20DO\x20UP'+_0x26bb53(0x3c7)+_0x26bb53(0x285)+'ded.value,'+'\x20updated_a'+_0x26bb53(0x3ae)+_0x26bb53(0x37f)+'t',[_0x4e43b8,_0x39696f]),TARGET_JID=_0x4e43b8,info(_0x26bb53(0x225)+_0x26bb53(0x39a)+_0x26bb53(0x267)+TARGET_JID),!![];}}catch(_0x54af1f){return warn(_0x26bb53(0x357)+'aveDeleteT'+_0x26bb53(0x3b0)+'ed:\x20'+(_0x54af1f?.['message']||_0x54af1f)),![];}}async function flushRecoveredBatch(_0x2ce222){const _0x361ffc=_0x44635a;if(!_0x2ce222||_0x2ce222[_0x361ffc(0x3cf)]===0x688+0x22d7+-0x295f)return;if(!DEFAULT_SEND_DELETE){info(_0x361ffc(0x2bc)+_0x361ffc(0x37d)+_0x361ffc(0x3c6)+_0x361ffc(0x2f7)+_0x361ffc(0x205)+_0x361ffc(0x32f)+'s.');return;}const _0x5169d5=_0x2ce222['find'](_0x1e61e0=>_0x1e61e0[_0x361ffc(0x320)+'ssage'])?.[_0x361ffc(0x320)+'ssage']?.[_0x361ffc(0x35b)]?.['remoteJid']||null,_0x109828=resolveDeleteTarget(_0x5169d5)||getBotJid();if(!_0x109828){warn(_0x361ffc(0x253)+_0x361ffc(0x2c6)+_0x361ffc(0x318)+'ble');return;}const _0x3573f5=[...new Set(_0x2ce222[_0x361ffc(0x364)](_0x8c9c47=>_0x8c9c47[_0x361ffc(0x311)]))],_0x45c38e=_0x2ce222['map'](_0x5d6b92=>_0x361ffc(0x26c)+_0x5d6b92[_0x361ffc(0x311)][_0x361ffc(0x3a5)]('@')[-0xa6f*-0x3+-0x1a1d+-0x530]+'\x20('+_0x5d6b92[_0x361ffc(0x302)]+')\x0a'+(_0x5d6b92[_0x361ffc(0x334)]?_0x361ffc(0x262)+_0x5d6b92['group']+'\x0a':'')+(_0x361ffc(0x21f)+'\x20'+_0x5d6b92[_0x361ffc(0x3cb)]+'\x0a')+'â”€'[_0x361ffc(0x1e6)](-0x2f*0x27+-0x244+0x4c3*0x2))[_0x361ffc(0x2c8)]('\x0a'),_0x5e8535=_0x361ffc(0x393)+_0x2ce222['length']+(_0x361ffc(0x23a)+_0x361ffc(0x240)+_0x361ffc(0x2a6)+'\x0a\x0a');try{const _0x347e65=await sendWithRetry(_0x109828,{'text':_0x5e8535+_0x45c38e},_0x3573f5);if(!_0x347e65)warn('[Delete]\x20s'+_0x361ffc(0x27d)+_0x361ffc(0x279)+_0x361ffc(0x36a));}catch(_0xd33a8d){warn('[Delete]\x20s'+_0x361ffc(0x27d)+_0x361ffc(0x24a)+_0x361ffc(0x295)+(_0xd33a8d?.[_0x361ffc(0x388)]||_0xd33a8d));}for(const _0x773da9 of _0x2ce222){try{const _0x1fbcda=_0x773da9['mediaPath'],_0xd08aec=_0x773da9[_0x361ffc(0x320)+'ssage'],_0x4b5036=!!_0x1fbcda||isMediaMessage(_0xd08aec?.[_0x361ffc(0x388)]);if(!_0x4b5036){try{await deleteMessageRow(_0x773da9[_0x361ffc(0x354)]);}catch(_0x33a9d4){}continue;}const _0x56f968=_0xd08aec?.[_0x361ffc(0x35b)]?.['id']||'(no-id)';let _0x97438e=![];if(_0x1fbcda&&_0x4e9f85[_0x361ffc(0x1fd)](_0x1fbcda)){const _0x2e1744=buildPayloadForSavedFile(_0x1fbcda,_0xd08aec);try{const _0x47cad9=await sendWithRetry(_0x109828,_0x2e1744);if(_0x47cad9){info(_0x361ffc(0x359)+'ecovered\x20m'+_0x361ffc(0x2c9)+_0x361ffc(0x2de)+_0x56f968+_0x361ffc(0x22f)+_0x109828),_0x97438e=!![];try{await deleteMessageRow(_0x773da9['msg_id']);}catch(_0x54488c){warn('[Delete]\x20c'+_0x361ffc(0x1fb)+_0x361ffc(0x33c)+_0x361ffc(0x38e)+(_0x54488c?.[_0x361ffc(0x388)]||_0x54488c));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x361ffc(0x2fc)+_0x361ffc(0x2fa)]);continue;}else warn(_0x361ffc(0x3b2)+_0x361ffc(0x2c3)+_0x361ffc(0x2ad)+_0x361ffc(0x272)+'\x20'+_0x1fbcda);}catch(_0x4f929b){warn('[Delete]\x20f'+_0x361ffc(0x2c3)+_0x361ffc(0x2ad)+_0x361ffc(0x3c4)+_0x1fbcda+':\x20'+(_0x4f929b?.[_0x361ffc(0x388)]||_0x4f929b));}}if(!_0x97438e&&_0x1fbcda&&_0x4e9f85[_0x361ffc(0x1fd)](_0x1fbcda))try{const _0x10bf0c=_0xd08aec?.[_0x361ffc(0x388)]||{};let _0x4994da;if(_0x10bf0c[_0x361ffc(0x325)+_0x361ffc(0x330)])_0x4994da={'sticker':_0x4e9f85[_0x361ffc(0x3a0)+_0x361ffc(0x3a7)](_0x1fbcda)};else{if(_0x10bf0c['ptvMessage'])_0x4994da={'video':_0x4e9f85[_0x361ffc(0x3a0)+_0x361ffc(0x3a7)](_0x1fbcda),'ptv':!![]};else{if(_0x10bf0c[_0x361ffc(0x399)+'ge'])_0x4994da={'video':_0x4e9f85[_0x361ffc(0x3a0)+'Stream'](_0x1fbcda),'caption':_0x10bf0c[_0x361ffc(0x399)+'ge']?.[_0x361ffc(0x27b)]||undefined,'gifPlayback':!!_0x10bf0c[_0x361ffc(0x399)+'ge']?.[_0x361ffc(0x227)+'k']};else{if(_0x10bf0c[_0x361ffc(0x2ff)+'ge'])_0x4994da={'image':_0x4e9f85[_0x361ffc(0x3a0)+_0x361ffc(0x3a7)](_0x1fbcda),'caption':_0x10bf0c[_0x361ffc(0x2ff)+'ge']?.[_0x361ffc(0x27b)]||undefined};else{if(_0x10bf0c[_0x361ffc(0x30c)+'ge'])_0x4994da={'audio':_0x4e9f85[_0x361ffc(0x3a0)+_0x361ffc(0x3a7)](_0x1fbcda),'ptt':!!_0x10bf0c['audioMessa'+'ge']?.[_0x361ffc(0x391)],'mimetype':_0x10bf0c[_0x361ffc(0x30c)+'ge']?.[_0x361ffc(0x27c)]};else _0x4994da={'document':_0x4e9f85['createRead'+_0x361ffc(0x3a7)](_0x1fbcda),'fileName':_0x23c40f[_0x361ffc(0x322)](_0x1fbcda),'caption':extractContent(_0x10bf0c)};}}}}const _0xa83ed6=await sendWithRetry(_0x109828,_0x4994da);if(_0xa83ed6){info(_0x361ffc(0x359)+_0x361ffc(0x2e4)+_0x361ffc(0x2b4)+_0x361ffc(0x3a6)+_0x361ffc(0x224)+_0x56f968+_0x361ffc(0x22f)+_0x109828),_0x97438e=!![];try{await deleteMessageRow(_0x773da9[_0x361ffc(0x354)]);}catch(_0x56a8b0){warn(_0x361ffc(0x38b)+'leanup\x20aft'+_0x361ffc(0x2df)+_0x361ffc(0x1e9)+_0x361ffc(0x387)+(_0x56a8b0?.[_0x361ffc(0x388)]||_0x56a8b0));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x361ffc(0x2fc)+_0x361ffc(0x2fa)]);continue;}else warn(_0x361ffc(0x3b2)+'ile-send\x20('+_0x361ffc(0x26a)+_0x361ffc(0x1f0)+'led\x20for\x20'+_0x1fbcda);}catch(_0x46928d){warn(_0x361ffc(0x3b2)+_0x361ffc(0x2c3)+'stream\x20fal'+_0x361ffc(0x326)+_0x361ffc(0x221)+_0x1fbcda+':\x20'+(_0x46928d?.[_0x361ffc(0x388)]||_0x46928d));}try{const _0x326942=await sendWithRetry(_0x109828,{'forward':_0xd08aec});if(_0x326942){info(_0x361ffc(0x359)+_0x361ffc(0x3a8)+_0x361ffc(0x202)+_0x361ffc(0x297)+'r\x20'+_0x56f968+_0x361ffc(0x22f)+_0x109828);try{await deleteMessageRow(_0x773da9[_0x361ffc(0x354)]);}catch(_0x9f5e4c){warn('[Delete]\x20c'+_0x361ffc(0x1fb)+_0x361ffc(0x329)+_0x361ffc(0x2cc)+_0x361ffc(0x38e)+(_0x9f5e4c?.['message']||_0x9f5e4c));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS['MEDIA_SEND'+_0x361ffc(0x2fa)]);continue;}}catch(_0x5e342e){warn(_0x361ffc(0x20f)+'egacy\x20forw'+_0x361ffc(0x347)+'\x20'+(_0x5e342e?.[_0x361ffc(0x388)]||_0x5e342e));}warn('[Delete]\x20u'+'nable\x20to\x20d'+_0x361ffc(0x333)+_0x361ffc(0x2d1)+_0x56f968+('\x20(all\x20atte'+_0x361ffc(0x3bd)+_0x361ffc(0x260)+'g\x20in\x20DB\x20fo'+_0x361ffc(0x274)+_0x361ffc(0x1e8)+'p.'));}catch(_0xc7a0e8){warn('[Delete]\x20f'+'lush\x20loop\x20'+_0x361ffc(0x34b)+':\x20'+(_0xc7a0e8?.[_0x361ffc(0x388)]||_0xc7a0e8));}}}async function rawMessagesUpsertHandler({messages:_0x3d9ce8}){const _0x2afac0=_0x44635a;try{if(!_0x3d9ce8||!Array[_0x2afac0(0x25f)](_0x3d9ce8))return;for(const _0x108dbd of _0x3d9ce8){if(!_0x108dbd||!_0x108dbd[_0x2afac0(0x388)]||_0x108dbd[_0x2afac0(0x35b)]?.[_0x2afac0(0x290)]===_0x2afac0(0x361)+_0x2afac0(0x33d))continue;if(_0x108dbd['key']?.[_0x2afac0(0x208)])continue;messageQueue[_0x2afac0(0x3b3)](_0x108dbd),setImmediate(()=>{const _0x572fcc=_0x2afac0;messageWorker()[_0x572fcc(0x36b)](()=>{});});const _0x456832=_0x108dbd[_0x2afac0(0x388)]?.[_0x2afac0(0x20a)+_0x2afac0(0x3ce)];if(_0x456832?.[_0x2afac0(0x332)]===-0x99d+0x13ea+-0xa4d*0x1&&_0x456832?.[_0x2afac0(0x35b)])deletionQueue[_0x2afac0(0x3b3)]({'keys':[_0x456832[_0x2afac0(0x35b)]],'remoteJid':_0x108dbd[_0x2afac0(0x35b)]['remoteJid']}),setImmediate(()=>{const _0x204c4f=_0x2afac0;deletionWorker()[_0x204c4f(0x36b)](()=>{});});else{if(_0x108dbd[_0x2afac0(0x377)+'bType']===-0x874+-0x232c+-0x15*-0x214&&Array['isArray'](_0x108dbd[_0x2afac0(0x377)+_0x2afac0(0x206)+'s'])&&_0x108dbd[_0x2afac0(0x377)+_0x2afac0(0x206)+'s'][0x2693*0x1+0x25aa+-0x4c3d]===_0x2afac0(0x2b7)){const _0x561124=[];for(let _0x5c26ba=-0x1*0x17d7+0x1*0x185+-0x5*-0x477;_0x5c26ba<_0x108dbd[_0x2afac0(0x377)+_0x2afac0(0x206)+'s'][_0x2afac0(0x3cf)];_0x5c26ba++)_0x561124[_0x2afac0(0x3b3)]({'id':_0x108dbd[_0x2afac0(0x377)+_0x2afac0(0x206)+'s'][_0x5c26ba],'remoteJid':_0x108dbd['key'][_0x2afac0(0x290)]});_0x561124['length']&&(deletionQueue[_0x2afac0(0x3b3)]({'keys':_0x561124,'remoteJid':_0x108dbd[_0x2afac0(0x35b)][_0x2afac0(0x290)]}),setImmediate(()=>{const _0x24cc8d=_0x2afac0;deletionWorker()[_0x24cc8d(0x36b)](()=>{});}));}}}}catch(_0x3a2f6e){warn(_0x2afac0(0x359)+_0x2afac0(0x378)+_0x2afac0(0x235)+_0x2afac0(0x397)+'\x20'+(_0x3a2f6e?.['message']||_0x3a2f6e));}}async function processMessageItem(_0x5f56f1){const _0x22c392=_0x44635a;try{if(!_0x5f56f1||!_0x5f56f1[_0x22c392(0x388)]||_0x5f56f1[_0x22c392(0x35b)]?.[_0x22c392(0x208)])return;const _0x4f174d=await maybeSaveMedia(_0x5f56f1);await insertMessageToDB(_0x5f56f1,_0x4f174d);}catch(_0x396e53){warn(_0x22c392(0x2bb)+'rocessMess'+_0x22c392(0x2f0)+_0x22c392(0x371)+(_0x396e53?.[_0x22c392(0x388)]||_0x396e53));}}async function messageWorker(){const _0x44e2e9=_0x44635a,_0x58e8f7=CONCURRENCY||FALLBACKS[_0x44e2e9(0x360)+'NCURRENCY'];while(messageQueue[_0x44e2e9(0x3cf)]>0x8*0x6+0x1fac+-0x1fdc&&activeMessageTasks<_0x58e8f7){const _0x1f5b74=messageQueue['shift']();if(!_0x1f5b74)break;activeMessageTasks++,((async()=>{const _0x171fd0=_0x44e2e9;try{await processMessageItem(_0x1f5b74);}catch(_0x20f396){warn(_0x171fd0(0x2f8)+'essageWork'+'er\x20item\x20er'+'ror:\x20'+(_0x20f396?.[_0x171fd0(0x388)]||_0x20f396));}finally{activeMessageTasks--,setImmediate(()=>{const _0x28c368=_0x171fd0;if(messageQueue['length'])messageWorker()[_0x28c368(0x36b)](()=>{});});}})());}}async function autoCleanOldMessagesSafe(){const _0xed7d09=_0x44635a;try{await autoCleanOldMessages();}catch(_0x2e1c93){warn('[Delete]\x20a'+_0xed7d09(0x363)+_0xed7d09(0x2d2)+_0xed7d09(0x2ce)+'\x20'+(_0x2e1c93?.[_0xed7d09(0x388)]||_0x2e1c93));}}function _0xdf02(){const _0x9fc1e0=['\x20NULL,\x0a\x20\x20\x20','tings\x20(PM-','Days:\x20','er\x20send\x20fa','adcast','image','lear\x20targe','TO\x20message','Configured','led\x20fatall','OM\x20message','messages.','led\x20for\x20','249788ktUjGz','ard\x20error:','all','conversati','RAGMA\x20tabl','item\x20error','[Delete]\x20i','\x20a\x20group\x0a','CURRENCY_L','[Delete]\x20d','ND_DELETE','SELECT\x20val','s\x20will\x20be\x20','\x20saved_at\x20','msg_id','et_jid\x27','\x20is\x20empty','[Delete]\x20s','O\x20delete_p','[Delete]\x20r','zation\x20fai','key',',\x0a\x20\x20','E\x20messages','GROUP\x20(','\x20PM.\x20Recov','DEFAULT_CO','status@bro','sages\x20(\x0a\x20\x20','utoCleanOl','map','mentions','failed:\x20','M\x20messages','<\x20?','remoteJidA','\x20failed','catch','JID\x0a','1617201GesVeW','Message','status','4.2.0','ror:\x20','O\x20UPDATE\x20S','r:\x20','\x20GROUP\x20mod','ToFile\x20fai','notify','messageStu','awMessages','dMessages\x20',',\x20?,\x20?,\x20?,','\x20Cleanup\x20A','messageTim','EFAULT_SEN','PRAGMA\x20tab','.updated_a','MODULE_CON','toLowerCas','\x20\x20\x20\x20\x20\x20VALU','or:\x20','dded\x20missi','no\x20send\x20ta','Active:\x20*','d:\x20','message','group\x20\x20\x20\x20\x20','EXISTS\x20del','[Delete]\x20c','buttonsRes','2705070ASfmkL','iled:\x20','VAL_MS','ave\x20target','ptt','number','ðŸ—‘\x20*','ailed\x20to\x20a','n:\x20','refs\x20WHERE','ler\x20error:','p\x20JID\x0a\x0a','videoMessa','arget_jid\x20','ered\x20delet','\x20ADD\x20COLUM','TEXT','\x20WHERE\x20msg','_id=?','createRead','media_path','ia_path,\x20s','[Delete]\x20o','[Delete]\x20a','split','am)\x20sent\x20f','Stream','ecovered\x20o','ile','?,\x20?,\x20?,\x20?','ed\x20due\x20mis','CLEANUP_IN','remove','t=excluded','ssing\x20key.','arget\x20fail','destroy','[Delete]\x20f','push','onWhatsApp','_at\x20INTEGE','DELETE_INI','No\x20persist','IA_SEND_DE','covery\x20Set','lete_prefs','ALTER\x20TABL','jid','mpts\x20faile','stamp,\x20med','[delete]\x20M','trim','y\x20to\x20owner','[Delete]\x20H','2KVLwHH','error\x20for\x20','INTEGER','D_DELETE\x20f','DATE\x20SET\x20v','essages\x27)','etchOrigin','ed\x20target\x20','content','\x20Recovery\x20','roup]','ssage','length','\x20messages\x20','R\x20DEFAULT\x20','clear','gured.','participan','has','>\x20send\x20rec',',\x20?,\x20?)\x20ON','\x20WHERE\x20key','GROUP','repeat','\x20CONFLICT(','try/cleanu','send\x20faile','ntil\x20confi','g_id=?','@lid','cwd','sages\x20row:','ge_json,\x20m','lback)\x20fai','efreshConf','dated_at)\x20','plete.','tAlt','run','91992kROCxq','ICT(key)\x20D','xcluded.va','on\x20LIKE\x20?\x20','_id,\x20media','leanup\x20aft','nfig\x20regis','existsSync','seconds','FF_MS','slice','rate','riginal\x20fo','ptv','data','pping\x20reco','bParameter','add','fromMe','eletionWor','protocolMe','VALUES\x20(\x27m','ANUP_DAYS','FROM\x20messa','ges\x20WHERE\x20','[Delete]\x20l','arget\x20JID\x20','ill\x20send\x20t','ponseMessa','poll','audio','selectedRo','ue\x20FROM\x20de','\x20delete\x20p|','pop','forwarded\x20','ES\x20(?,\x20?,\x20','REPLACE\x20IN','[Sticker]','listRespon','AME','ðŸ“\x20Content:','otReloadCo','or\x20for\x20','ailed\x20to\x20s','geToDB\x20fai','or\x20','[Delete]\x20t','get','gifPlaybac','singleSele','sock','webp','[delete]\x20T','ia_path\x20FR','[Audio]','edia_path,','\x20->\x20','ailed\x20dele','eleted\x20mes','endsWith','ed_at\x20FROM','e_info\x20fai','UpsertHand','SELECT\x20msg','TIAL_BACKO','ting\x20file\x20','\x20delete\x20<j','\x20DELETED\x20M','ctReply','LIMIT\x201','tration\x20fa','indexOf','ed_at','ESSAGES\x20RE','INSERT\x20INT','d\x20retry','extendedTe','refs\x20(mode','estamp','DELETE_MAX','y:\x20','TEXT\x20PRIMA','\x20days*','d\x20unexpect','DELETE_CLE','overy','le_info(\x27m','\x20JID:\x20','\x20days)','aved_at,\x20r','s\x20WHERE\x20ms','tatus:*\x0a','[Delete]\x20n','low','ck\x20to\x20bot\x20','floor','wId','tionItem\x20e','write','saved_at','WHERE\x20save','overed\x20to\x20','ogg','nitial\x20cle','isArray','d).\x20Leavin','filter','ðŸ—¨\x20Group:\x20','error:\x20','has\x20no\x20col','delete\x20mod','s\x20(msg_id,','saved:\x20','value','DELETE\x20FRO','stream\x20fal','IES','ðŸ‘¤\x20From:\x20@','unset','xtMessage','181462TUYzwt','t\x20JID.','lue,\x20updat','failed\x20for','ed_at=excl','r\x20later\x20re','messages.u','function','[Media]','DEBOUNCE_M','d\x20may\x20have','able','caption','mimetype','ummary\x20sen','covered\x20to','CURRENCY','seMessage','size','ble.','psert','CKOFF_MS','alue=exclu','ETRIES','video','*Current\x20S','cipant_alt','->\x20send\x20re','\x20GROUP.\x20','cleared.\x20W','ed\x20message','CREATE\x20TAB','splice','remoteJid','selectedBu','OUNCE_MS','boolean','led:\x20','ed\x20error:\x20','rget\x20avail','rwarded\x20fo','PROJECT_RO','\x20group:\x20','ot-reloade','TERVAL_MS','\x20chat_jid,','groupMetad','IA_DIR','DELETE_MED','ata','ptvMessage','pollCreati','finish','stringify','refs\x20(key,','COVERED*\x20ðŸ—‘','\x20delete\x20g|','mp4','ear\x20\x20\x20\x20\x20\x20\x20','MARY\x20KEY,\x0a','message_js','\x20to\x20','url\x20form)\x20','DELETE_CON','21VszNzY','isCommand','B\x20initiali','\x20?)','rror:\x20','edia\x20(stre','nsertMessa','\x20value,\x20up','REVOKE','text','%\x22id\x22:\x22','object','[Delete]\x20p','[Delete]\x20D','ng\x20column\x20','cleared','\x20remote_al','emove\x20file','=\x27mode\x27','mapping\x20fa','ile-send\x20(','set','leanup\x20err','o\x20send\x20tar','.\x20Mode:\x20','join','edia\x20sent\x20','anup\x20error','jid,\x20parti','forward\x20fa','pdf','afe\x20error:','etry\x20inser','includes','ia\x20for\x20','dMessagesS','y\x20TEXT\x20PRI','NCURRENCY','MAX_SEND_R','umn','now','annot\x20repl','6IwrZqJ','[Delete]\x20h','d\x20config.','onMessageV','[no-id]','for\x20','er\x20stream-','sticker','subject','json,\x20time','DEFAULT_SE','ecovered\x20m','bot\x20PM\x0a','*Delete\x20Re','\x20\x20\x20updated','IA_DIRNAME','delete','keys','aveDeleteM','shift','sing\x20colum','57837cxJUat','o\x20bot\x20PM\x20u','ageItem\x20er','EXISTS\x20mes','SELECT\x20med','aved\x20file\x20','pm\x20\x20\x20\x20\x20\x20\x20-','[Unknown\x20G','t,\x20sender_','alse\x20â€”\x20ski','[Delete]\x20m','documentMe','_DELAY_MS','ule\x20requir','MEDIA_SEND','ed\x20media\x20f','\x20delete\x20cl','imageMessa','redBatch\x20e',',\x20message_','name','fileName','INITIAL_BA','ode\x20set\x20to','[Delete]\x20e','DELETE_DEB','CLEANUP_DA',',\x20Cleanup\x20','[Poll:\x20','[Delete]\x20P','audioMessa','ker\x20item\x20e','drain','ode\x20failed','_SEND_RETR','sender','ANUP_INTER','0\x0a\x20\x20\x20\x20);','MEDIA_DIRN','RY\x20KEY','bin','rocessDele','get\x20availa','end','VALUES\x20(\x27t','eStream','[Voice\x20not','arget_jid\x27','not\x20set','ttonId','originalMe','nsert\x20fail','basename','_id,\x20messa','=\x27target_j','stickerMes','lback)\x20err','ot\x20JID\x20is\x20','document','er\x20legacy-','ode\x27,\x20?,\x20?','parse','nMessage\x20e','LE\x20IF\x20NOT\x20','id>\x20\x20\x20\x20\x20\x20\x20','vered\x20send','sage','644950RLictf','type','eliver\x20med','group','exec','\x20top\x20error','\x20Send\x20Mode','[delete]\x20F'];_0xdf02=function(){return _0x9fc1e0;};return _0xdf02();}async function autoCleanOldMessages(){const _0x355f99=_0x44635a;try{const _0x241f3c=Math[_0x355f99(0x256)](Date[_0x355f99(0x2d7)]()/(-0x1*-0x3f5+0x1*-0x1945+0x21a*0xc))-Number(DELETE_CLEANUP_DAYS||FALLBACKS[_0x355f99(0x308)+'YS'])*(-0x926*-0x3+0x1*-0x23d5+0x87b)*(-0xd3c+-0x3ad*0x7+0xf*0x29d)*(0x1*-0x22c5+-0x1*0x1bae+0x14e5*0x3),_0x272c33=await db[_0x355f99(0x348)]('SELECT\x20msg'+_0x355f99(0x1fa)+'_path,\x20sav'+_0x355f99(0x233)+_0x355f99(0x3d0)+_0x355f99(0x25b)+'d_at\x20IS\x20NO'+'T\x20NULL\x20AND'+_0x355f99(0x353)+_0x355f99(0x368),[_0x241f3c]);if(!_0x272c33||_0x272c33[_0x355f99(0x3cf)]===-0x321*-0xb+0xdbe+-0x3029*0x1)return;info('[Delete]\x20c'+'leaning\x20'+_0x272c33[_0x355f99(0x3cf)]+('\x20old\x20messa'+'ges\x20(older'+'\x20than\x20')+DELETE_CLEANUP_DAYS+_0x355f99(0x24f));for(const _0x1b26d2 of _0x272c33){if(_0x1b26d2[_0x355f99(0x3a1)])try{await _0x49e0f6(_0x1b26d2[_0x355f99(0x3a1)]);}catch(_0x456e1e){warn(_0x355f99(0x3b2)+_0x355f99(0x230)+_0x355f99(0x238)+_0x1b26d2[_0x355f99(0x3a1)]+':\x20'+(_0x456e1e?.['message']||_0x456e1e));}}const _0x9d55f0=_0x272c33[_0x355f99(0x364)](_0x2ae3d8=>_0x2ae3d8[_0x355f99(0x354)]),_0x23efaa=-0x5ea+0x578+0x2*0x9d;for(let _0x103587=0x9d4+-0xb84+-0xd8*-0x2;_0x103587<_0x9d55f0[_0x355f99(0x3cf)];_0x103587+=_0x23efaa){const _0x59e31b=_0x9d55f0[_0x355f99(0x200)](_0x103587,_0x103587+_0x23efaa),_0x190c01=_0x59e31b[_0x355f99(0x364)](()=>'?')[_0x355f99(0x2c8)](',');await db['run'](_0x355f99(0x269)+_0x355f99(0x367)+_0x355f99(0x39e)+'_id\x20IN\x20('+_0x190c01+')',_0x59e31b);}info(_0x355f99(0x38b)+'leanup\x20com'+_0x355f99(0x1f3));}catch(_0x4dc87e){warn(_0x355f99(0x3a4)+_0x355f99(0x363)+_0x355f99(0x379)+_0x355f99(0x366)+(_0x4dc87e?.[_0x355f99(0x388)]||_0x4dc87e));}}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0x332*-0x5+-0x1*-0x2384+-0x3360)*(-0x2149+-0x172f+0x3c60);function markCmdProcessed(_0x33299f){const _0x2b0811=_0x44635a;if(!_0x33299f)return;if(processedCmdKeys[_0x2b0811(0x3d5)](_0x33299f))try{clearTimeout(processedCmdKeys[_0x2b0811(0x226)](_0x33299f));}catch(_0x465e83){};const _0x5e4d36=setTimeout(()=>processedCmdKeys[_0x2b0811(0x2e9)](_0x33299f),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x2b0811(0x2c4)](_0x33299f,_0x5e4d36);}function isCmdProcessed(_0x4481e9){const _0x5d766a=_0x44635a;return _0x4481e9&&processedCmdKeys[_0x5d766a(0x3d5)](_0x4481e9);}export async function onMessage(_0xd8ddb7){const _0x16aa64=_0x44635a;try{if(!_0xd8ddb7||!_0xd8ddb7[_0x16aa64(0x35b)]||!_0xd8ddb7[_0x16aa64(0x388)]||!_0xd8ddb7[_0x16aa64(0x2b0)])return;if(isJidGroup(_0xd8ddb7[_0x16aa64(0x35b)][_0x16aa64(0x290)]))return;const _0x4e4e95=_0xd8ddb7[_0x16aa64(0x35b)][_0x16aa64(0x208)],_0x1914a9=await isSudo(botRef,_0xd8ddb7)[_0x16aa64(0x36b)](()=>![]);if(!_0x4e4e95&&!_0x1914a9)return;let _0x3c48b4;if(_0x4e4e95){_0x3c48b4=getBotJid();if(!_0x3c48b4){warn('[Delete]\x20C'+_0x16aa64(0x2d8)+_0x16aa64(0x3c1)+'\x20because\x20b'+_0x16aa64(0x327)+'not\x20availa'+_0x16aa64(0x282));return;}}else _0x3c48b4=_0xd8ddb7[_0x16aa64(0x35b)][_0x16aa64(0x290)];const _0xe42c36=String(_0xd8ddb7[_0x16aa64(0x35b)]['remoteJid']||'')+'::'+String(_0xd8ddb7['key']['id']||_0xd8ddb7[_0x16aa64(0x35b)][_0x16aa64(0x3d4)+'t']||'');if(isCmdProcessed(_0xe42c36))return;markCmdProcessed(_0xe42c36);const _0xff0615=typeof _0xd8ddb7['text']==='string'&&_0xd8ddb7['text']['trim']()[_0x16aa64(0x3cf)]?_0xd8ddb7[_0x16aa64(0x2b8)]['trim']():function _0x4d988f(_0x404fb6){const _0x56fb45=_0x16aa64;if(!_0x404fb6||!_0x404fb6['message'])return'';const _0x50dcab=_0x404fb6['message'];if(_0x50dcab[_0x56fb45(0x349)+'on'])return _0x50dcab['conversati'+'on'];if(_0x50dcab[_0x56fb45(0x243)+'xtMessage']?.[_0x56fb45(0x2b8)])return _0x50dcab[_0x56fb45(0x243)+_0x56fb45(0x26e)][_0x56fb45(0x2b8)];if(_0x50dcab[_0x56fb45(0x2ff)+'ge']?.[_0x56fb45(0x27b)])return _0x50dcab[_0x56fb45(0x2ff)+'ge'][_0x56fb45(0x27b)];if(_0x50dcab[_0x56fb45(0x399)+'ge']?.[_0x56fb45(0x27b)])return _0x50dcab[_0x56fb45(0x399)+'ge']['caption'];if(_0x50dcab[_0x56fb45(0x38c)+_0x56fb45(0x212)+'ge']?.[_0x56fb45(0x291)+_0x56fb45(0x31f)])return _0x50dcab[_0x56fb45(0x38c)+_0x56fb45(0x212)+'ge'][_0x56fb45(0x291)+'ttonId'];if(_0x50dcab['listRespon'+_0x56fb45(0x280)]?.['singleSele'+'ctReply']?.[_0x56fb45(0x215)+_0x56fb45(0x257)])return _0x50dcab[_0x56fb45(0x21d)+_0x56fb45(0x280)][_0x56fb45(0x228)+_0x56fb45(0x23b)]['selectedRo'+_0x56fb45(0x257)];return'';}(_0xd8ddb7)||'';if(!_0xff0615)return;const _0xa23c10=(_0xff0615['split'](/\r?\n/)[0x18f3+0x3*0xb3f+-0x3ab0]||'')[_0x16aa64(0x3c0)](),_0x1c5694=_0xa23c10[_0x16aa64(0x3a5)](/\s+/),_0x4b2fef=(_0x1c5694[0x1*-0x1d87+-0x92d+-0x26b4*-0x1]||'')[_0x16aa64(0x381)+'e']();if(!commands[_0x16aa64(0x2d0)](_0x4b2fef))return;const _0x439e3a=(_0x1c5694[-0xf76*0x1+0x46c*-0x2+0x184f]||'')['toLowerCas'+'e']();if(_0x439e3a&&_0x439e3a[_0x16aa64(0x2d0)]('@')){const _0x340f88=normalizeToUserJid(_0x439e3a),_0x1199e7=await saveDeleteTarget(_0x340f88);if(_0x1199e7)await sendWithRetry(_0x3c48b4,{'text':_0x16aa64(0x22b)+_0x16aa64(0x210)+_0x16aa64(0x267)+_0x340f88+_0x16aa64(0x2c7)+(DELETE_MODE==='g'?_0x16aa64(0x1e5):'PM')});else await sendWithRetry(_0x3c48b4,{'text':_0x16aa64(0x338)+_0x16aa64(0x222)+_0x16aa64(0x390)+_0x16aa64(0x24e)+_0x340f88});return;}if(_0x439e3a===_0x16aa64(0x3d2)||_0x439e3a===_0x16aa64(0x26d)||_0x439e3a===_0x16aa64(0x3ad)){const _0x53aff6=await saveDeleteTarget(null);if(_0x53aff6)await sendWithRetry(_0x3c48b4,{'text':'[delete]\x20T'+_0x16aa64(0x210)+_0x16aa64(0x28c)+'ill\x20fallba'+_0x16aa64(0x255)+'PM\x20when\x20in'+_0x16aa64(0x374)+'e.'});else await sendWithRetry(_0x3c48b4,{'text':_0x16aa64(0x338)+'ailed\x20to\x20c'+_0x16aa64(0x33f)+_0x16aa64(0x270)});return;}if(_0x439e3a==='p'||_0x439e3a==='pm'){await saveDeleteMode('p'),await sendWithRetry(_0x3c48b4,{'text':_0x16aa64(0x3bf)+_0x16aa64(0x305)+_0x16aa64(0x35f)+_0x16aa64(0x39b)+_0x16aa64(0x28d)+_0x16aa64(0x352)+_0x16aa64(0x219)+'to\x20bot\x20PM.'});return;}if(_0x439e3a==='g'||_0x439e3a===_0x16aa64(0x334)||_0x439e3a==='gp'){await saveDeleteMode('g');const _0x323e8a=TARGET_JID?_0x16aa64(0x341)+_0x16aa64(0x299)+TARGET_JID:_0x16aa64(0x3b7)+_0x16aa64(0x3ca)+'JID\x20set;\x20w'+_0x16aa64(0x211)+_0x16aa64(0x2ef)+_0x16aa64(0x1ea)+_0x16aa64(0x3d3);await sendWithRetry(_0x3c48b4,{'text':_0x16aa64(0x3bf)+'ode\x20set\x20to'+_0x16aa64(0x28b)+_0x323e8a});return;}const _0x34a420=DELETE_MODE==='g'?_0x16aa64(0x35e)+(TARGET_JID||_0x16aa64(0x31e))+')':'PM';await sendWithRetry(_0x3c48b4,{'text':_0x16aa64(0x2e6)+_0x16aa64(0x3b9)+_0x16aa64(0x33a)+'Only)*\x0a\x0a'+'Usage:\x0a'+(_0x16aa64(0x217)+_0x16aa64(0x2f4)+_0x16aa64(0x3d6)+_0x16aa64(0x25c)+_0x16aa64(0x2e5))+(_0x16aa64(0x2a7)+_0x16aa64(0x389)+_0x16aa64(0x28a)+_0x16aa64(0x27e)+_0x16aa64(0x34d))+(_0x16aa64(0x239)+_0x16aa64(0x32e)+'->\x20set\x20tar'+'get\x20group\x20'+_0x16aa64(0x36c))+(_0x16aa64(0x2fe)+_0x16aa64(0x2a9)+'->\x20clear\x20t'+'arget\x20grou'+_0x16aa64(0x398))+(_0x16aa64(0x288)+_0x16aa64(0x252))+(_0x16aa64(0x337)+':\x20*'+_0x34a420+'*\x0a')+(_0x16aa64(0x3cc)+_0x16aa64(0x386)+DEFAULT_SEND_DELETE+'*\x0a')+(_0x16aa64(0x37b)+'fter:\x20*'+DELETE_CLEANUP_DAYS+_0x16aa64(0x249))});}catch(_0x124b27){error(_0x124b27,_0x16aa64(0x3a3)+_0x16aa64(0x32c)+_0x16aa64(0x2b3)+(_0x124b27?.[_0x16aa64(0x388)]||_0x124b27));}}export async function initialize(_0x418a22){const _0x36ae9f=_0x44635a;if(!_0x418a22)throw new Error(_0x36ae9f(0x265)+_0x36ae9f(0x2fb)+'es\x20bot\x20arg');botRef=_0x418a22,refreshConfig(),await ensureTable()[_0x36ae9f(0x36b)](_0x25f9b9=>{const _0x5b076c=_0x36ae9f;error('[Delete]\x20D'+_0x5b076c(0x2b1)+_0x5b076c(0x35a)+_0x5b076c(0x342)+_0x5b076c(0x247)+(_0x25f9b9?.[_0x5b076c(0x388)]||_0x25f9b9));throw _0x25f9b9;}),startManagedListener({'botRef':botRef,'eventName':'messages.u'+_0x36ae9f(0x283),'handler':rawMessagesUpsertHandler,'moduleName':name}),await autoCleanOldMessagesSafe()[_0x36ae9f(0x36b)](_0x898904=>warn(_0x36ae9f(0x34c)+_0x36ae9f(0x25e)+_0x36ae9f(0x2ca)+':\x20'+(_0x898904?.[_0x36ae9f(0x388)]||_0x898904)));if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(autoCleanOldMessagesSafe,CLEANUP_INTERVAL||FALLBACKS[_0x36ae9f(0x3ac)+_0x36ae9f(0x29b)]),info('[Delete]\x20I'+'nitialized'+_0x36ae9f(0x2c7)+DELETE_MODE+(_0x36ae9f(0x309)+_0x36ae9f(0x33b))+DELETE_CLEANUP_DAYS);}export async function cleanup(){const _0x3b8cc9=_0x44635a;try{stopManagedListener(name,_0x3b8cc9(0x275)+_0x3b8cc9(0x283)),cleanupInterval&&(clearInterval(cleanupInterval),cleanupInterval=null),messageQueue[_0x3b8cc9(0x3cf)]=0x1cfa+-0x4ff*0x2+0x3*-0x654,deletionQueue['length']=-0x1434+0x1709+-0x2d5,pendingRecovered['length']=0x1*-0xc41+-0x2*-0x1331+0x1*-0x1a21;}catch(_0x34ee62){warn('[Delete]\x20c'+_0x3b8cc9(0x2c5)+_0x3b8cc9(0x383)+(_0x34ee62?.[_0x3b8cc9(0x388)]||_0x34ee62));}finally{botRef=null;}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};