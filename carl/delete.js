const _0x3556f1=_0x4d61;(function(_0x4cda85,_0x5e2f4f){const _0x52716b=_0x4d61,_0x4300e7=_0x4cda85();while(!![]){try{const _0xf8beba=-parseInt(_0x52716b(0x1ce))/(0x992+0xdf7+-0xc*0x1f6)*(-parseInt(_0x52716b(0x278))/(-0x19fb+-0x261b*0x1+0x4018))+-parseInt(_0x52716b(0x2a8))/(0x11*-0xe5+0x3a9*-0x5+0x2185)*(-parseInt(_0x52716b(0x1d7))/(0x1*-0x1ae1+0x2f7+0x17ee*0x1))+parseInt(_0x52716b(0x180))/(-0xf3f+0x1*0x1fa5+0x1*-0x1061)*(parseInt(_0x52716b(0x197))/(0x1b*0x129+0xdd0+-0x2d1d))+-parseInt(_0x52716b(0x1a3))/(-0x2109+-0x12db*0x1+0x33eb)+-parseInt(_0x52716b(0xfb))/(-0x1006+-0x8ef*0x1+0x18fd*0x1)+parseInt(_0x52716b(0x1fd))/(0x10*0x18e+0x9*0x215+-0x2b94)*(-parseInt(_0x52716b(0x15e))/(-0x626*-0x1+0xca1+-0x12bd*0x1))+-parseInt(_0x52716b(0xed))/(-0x1f06+-0x249a+0x11*0x3fb)*(-parseInt(_0x52716b(0xf6))/(-0x2eb+-0x220f*-0x1+-0x1f18));if(_0xf8beba===_0x5e2f4f)break;else _0x4300e7['push'](_0x4300e7['shift']());}catch(_0x2c1742){_0x4300e7['push'](_0x4300e7['shift']());}}}(_0x1d1d,-0x92c84+0x2*0x7a86c+-0x7*-0x696f));import _0x2f0839 from'path';import _0x321c7c from'fs';import{mkdirSync}from'fs';import{rm as _0x4f9e47}from'fs/promises';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import _0x51aa7e from'node-cache';import{isSudo}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x3556f1(0x257)+_0x3556f1(0x249);export const version='4.2.0';export const priority=0x245f+0x8*-0x241+-0x3a1*0x5;export const commands=[_0x3556f1(0x29e)];export const configKeys=[_0x3556f1(0xe6)+_0x3556f1(0x27a),'DELETE_DEB'+_0x3556f1(0x1ff),_0x3556f1(0x264)+_0x3556f1(0x1f2),_0x3556f1(0x22b)+_0x3556f1(0x2a1),_0x3556f1(0x288)+'ANUP_DAYS',_0x3556f1(0x288)+_0x3556f1(0x230)+_0x3556f1(0x2a9)];const FALLBACKS={'DEBOUNCE_MS':0xbb8,'MEDIA_DIRNAME':_0x3556f1(0x196),'DEFAULT_CONCURRENCY':0x3,'CLEANUP_INTERVAL_MS':(0x422+-0x8b0+-0x4*-0x125)*(-0x339+0xc74+-0x8ff)*(-0xb30+-0x1d4*0x3+0x1*0x10e8)*(0x43f*0x1+0x1f6d+-0x1fc4),'MEDIA_SEND_DELAY_MS':0x12c,'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4,'CLEANUP_DAYS':0x3};let botRef=null,cleanupInterval=null;const messageQueue=[],deletionQueue=[];function _0x1d1d(){const _0x2debdb=['WHERE\x20save','d\x20unexpect','write','nsertMessa','[no-id]','E\x20messages','d).\x20Leavin','poll','LIMIT\x201','join','ptv','CREATE\x20TAB','run','->\x20send\x20re','protocolMe','r\x20later\x20re','\x20ADD\x20COLUM','AME','ailed\x20dele','d\x20retry','arget\x20fail','has\x20no\x20col','CURRENCY','text','ed\x20message','\x20days)','\x20\x20\x20\x20\x20\x20VALU','=\x27target_j','ANUP_DAYS','[Poll:\x20','ecovered\x20m','refs\x20(key,','DEFAULT_CO','63927LnBSTQ','ed:\x20','OUNCE_MS','R\x20DEFAULT\x20','isCommand','dMessages\x20','EFAULT_SEN','exec','M\x20messages','\x20(all\x20atte','riginal\x20fo','g\x20in\x20DB\x20fo','selectedRo','eStream','et_jid\x27','ete_prefs\x20','TO\x20message','function','Days:\x20','wId','B\x20initiali','cwd','document','alue=exclu','MEDIA_SEND','\x20\x20\x20updated','documentMe','status@bro',')\x20ON\x20CONFL','mediaPath','\x20Send\x20Mode','ded.value,','ue\x20FROM\x20de','[Sticker]','->\x20clear\x20t','remoteJidA','_id=?','eletionWor','id\x27','ogg','[Delete]\x20p','lush\x20loop\x20','tings\x20(PM-','nMessage\x20e','entries','ICT(key)\x20D','DEFAULT_SE','\x0a);','d\x20may\x20have','ata','rocessDele','ANUP_INTER','error\x20for\x20','d\x20config.','[Delete]\x20D','\x20Cleanup\x20A','annot\x20repl','message','videoMessa','add','\x20than\x20','set','push','video','treamMedia','MEDIA_DIRN','refs\x20WHERE','get','TEXT\x20PRIMA','\x20delete\x20p|','s\x20will\x20be\x20','\x20?)','emoved\x20sav','GROUP','TIAL_BACKO','CKOFF_MS','overy','\x20a\x20group\x0a','ode\x20failed','PROJECT_RO','CLEANUP_DA','uded.updat','t\x20JID.','aved_at,\x20r','ker\x20item\x20e','Configured','DELETE_DEB',':\x20*','led\x20for\x20','afe\x20error:','delete-rec','ror:\x20','[Delete]\x20a','has','DELETE\x20FRO','destroy','nfig\x20regis','ode\x20set\x20to','ailed\x20to\x20s','\x20delete\x20<j','led\x20fatall','edia\x20(stre','ear\x20\x20\x20\x20\x20\x20\x20','DELETE_CON','sticker','onMessageV','VALUES\x20(\x27t','messageTim','RY\x20KEY','parse','ttonId','group','e_info\x20fai','createRead','lback)\x20fai','messages.u','umn','notify',',\x20message_','o\x20bot\x20PM\x20u','Usage:\x0a','eleteMessa','esent_at)\x0a','2ZCVZAC','ALTER\x20TABL','IA_DIRNAME','ig\x20error:\x20','subject','ng\x20column\x20','g_id=?','ESSAGES\x20RE','repeat','es\x20bot\x20arg','alse\x20â€”\x20ski','\x20â€”\x20ensurin','seconds','ck\x20to\x20bot\x20','INITIAL_BA','get\x20availa','DELETE_CLE','SELECT\x20val','json,\x20time','UpsertHand','\x20key=\x27targ','ummary\x20sen','now','filter','toLowerCas','\x20old\x20messa','clear','TEXT','delete\x20mod','\x20Recovery\x20',',\x20?,\x20?)\x20ON','_id,\x20messa','[Delete]\x20t','*Delete\x20Re','fromMe','_DELAY_MS','ðŸ—‘\x20*','\x20JID:\x20','delete','y\x20to\x20owner','ile','ND_DELETE','ðŸ“\x20Content:','Active:\x20*','lue,\x20updat','remoteJid','ode\x27,\x27p\x27,\x20','length','135PBvaqz','VAL_MS','audioMessa','[Delete]\x20m','bot\x20PM\x0a','not\x20availa','ed_at\x20FROM','tration\x20fa','sage','ssage','ETRIES','nitial\x20cle','string','singleSele','ctReply','t\x20failed:\x20','geToDB\x20fai','ge_json,\x20m','extendedTe','sender','eliver\x20med','aveDeleteM','[Delete]\x20i','FROM\x20messa','ponseMessa','egacy\x20forw','etry\x20inser','ageItem\x20er','\x20->\x20','g\x20table\x20an','T\x20NULL\x20AND','(no-id)','[Unknown\x20G','ed\x20due\x20mis','audio','VALUES\x20(\x27m','O\x20delete_p','status','DELETE_MED','rwarded\x20fo','\x20remote_al','.updated_a','GROUP\x20(','O\x20UPDATE\x20S','RAGMA\x20tabl','7038581DBLDND','[delete]\x20T',',\x0a\x20\x20','message_js','ave\x20target','conversati','\x20because\x20b','[delete]\x20M','\x20value,\x20up','48uEwBxb','mimetype','ET\x20value=e','rror:\x20','key)\x20DO\x20UP','7994656vJqJrD','find','pping\x20reco','ode\x27,\x20?,\x20?','LAY_MS','SELECT\x20msg','media_path','arget_jid\x20','id>\x20\x20\x20\x20\x20\x20\x20','sendMessag','lete_prefs','includes','[Audio]','\x20days*','or:\x20','onWhatsApp','lushRecove','[Delete]\x20f','ailed\x20to\x20a','d_at\x20IS\x20NO','[Delete]\x20P','ill\x20fallba','stickerMes','all','[Delete]\x20c','pollCreati','ule\x20requir','ed\x20target\x20','leanup\x20aft','try/cleanu','jid','ble.','D_DELETE\x20f','xtMessage','leanup\x20com','awMessages','dMessagesS','mp4','Message','stream\x20fal','arget\x20grou','[Delete]\x20I','trim','failed:\x20','\x20WHERE\x20msg','cleared','content','ssing\x20key.','nsert\x20fail','error:\x20','rget\x20avail','\x20saved_at\x20','map','JID\x20set;\x20w','existsSync','split','ailed\x20to\x20r','ntil\x20confi','\x20PM.\x20Recov','_path,\x20sav','imageMessa','originalMe','CURRENCY_L','nitialized','forwarded\x20','isArray','ðŸ‘¤\x20From:\x20@','selectedBu','ecovered\x20o','d:\x20','_id\x20IN\x20(','Stream','\x20to\x20','ptt','DEBOUNCE_M','zation\x20fai','groupMetad','msg_id','arget\x20JID\x20','participan','gifPlaybac','refs\x20(mode','once','sages\x20(\x0a\x20\x20','efreshConf','key','\x20top\x20error','get\x20group\x20','geToDB:\x20mi','\x20DELETED\x20M','plete.','ges\x20(older','catch','_at\x20INTEGE','sing\x20colum','psert','\x20messages\x20','saved_at','OM\x20message','1550GrzoDh','slice','*Current\x20S','etchOrigin','data','number','DATE\x20SET\x20v','->\x20set\x20tar','send\x20faile','fileName','listRespon','url\x20form)\x20','[Delete]\x20r',',\x20Cleanup\x20','tAlt','bParameter','PM\x20when\x20in','finish','er\x20send\x20fa','FF_MS','indexOf','led:\x20','keys','CLEANUP_IN','ed\x20media\x20f','NCURRENCY','%\x22id\x22:\x22','ard\x20error:','webp','estamp','t,\x20sender_','?,\x20?,\x20?,\x20?','tatus:*\x0a',')\x20load\x20fai','35cDAbpq','ed_at=excl','>\x20send\x20rec','.\x20Mode:\x20','[delete]\x20F','[Delete]\x20o','roup]','saved:\x20','basename','\x20delete\x20g|','[Delete]\x20s','ed_at','rate','messageStu','<\x20?','iled:\x20','leanup\x20err','end','name','nsureTable','stringify','INSERT\x20INT','media','393066jWqSjS','IMIT','resolve','emove\x20file','ile-send\x20(','n:\x20','ered\x20delet','msg_id=?','sages\x20row:','p\x20JID\x0a\x0a','INTEGER','No\x20persist','7349048cncyDB','nWhatsApp\x20','sock','[Delete]\x20l','size','edia\x20sent\x20','seMessage','for\x20','\x20GROUP\x20mod','pdf','ges\x20WHERE\x20','\x20delete\x20cl','\x20NULL,\x0a\x20\x20\x20','overed\x20to\x20','cleared.\x20W','\x20failed:\x20','DELETE_INI','jid,\x20parti','messages.','ble','ed\x20error:\x20','aved\x20file\x20','value','essages\x27)','edia_path,','ia_path,\x20s','MAX_SEND_R','remove','covered\x20to','SELECT\x20med','fter:\x20*','utoCleanOl','item\x20error','createWrit','INSERT\x20OR\x20','\x20is\x20empty','\x20CONFLICT(','ptvMessage','ia\x20for\x20','or\x20for\x20','mpts\x20faile','PRAGMA\x20tab','shift','220588KNrZXE','mapping\x20fa','ode\x20saved:','ia_path\x20FR','caption','[Delete]\x20d','[Delete]\x20H','TERVAL_MS','ill\x20send\x20t','44708WbXoio','floor','image','dated_at)\x20','ot-reloade'];_0x1d1d=function(){return _0x2debdb;};return _0x1d1d();}let activeMessageTasks=-0x28e+-0x18cb+0x1b59,activeDeletionTasks=0x1d*0xd4+0x1f7*-0x9+-0x655,MEDIA_DIR=null,DEBOUNCE_DELAY_MS=FALLBACKS[_0x3556f1(0x145)+'S'],CONCURRENCY=FALLBACKS[_0x3556f1(0x1fc)+'NCURRENCY'],MEDIA_SEND_DELAY_MS=FALLBACKS[_0x3556f1(0x215)+_0x3556f1(0x29b)],CLEANUP_INTERVAL=FALLBACKS[_0x3556f1(0x175)+_0x3556f1(0x1d5)],MAX_SEND_RETRIES=FALLBACKS['MAX_SEND_R'+_0x3556f1(0x2b2)],INITIAL_BACKOFF=FALLBACKS['INITIAL_BA'+'CKOFF_MS'],DELETE_CLEANUP_DAYS=FALLBACKS[_0x3556f1(0x24d)+'YS'],DEFAULT_SEND_DELETE=![],DELETE_MODE='p',TARGET_JID=null;const nameCache=new _0x51aa7e({'stdTTL':0xe10});let flushTimer=null;const pendingRecovered=[];function ensureDirSync(_0x5cbd43){if(!_0x321c7c['existsSync'](_0x5cbd43))mkdirSync(_0x5cbd43,{'recursive':!![]});}function sleep(_0x48c884){return new Promise(_0x2c316e=>setTimeout(_0x2c316e,_0x48c884));}function normalizeToUserJid(_0x5513f7){const _0x394ac0=_0x3556f1;try{if(!_0x5513f7||typeof _0x5513f7!==_0x394ac0(0x2b4))return _0x5513f7;const _0x1bea75=_0x5513f7[_0x394ac0(0x172)]('@');if(_0x1bea75===-(0xcc7*-0x1+0xe06*0x2+-0xf44))return _0x5513f7;const _0x34376b=_0x5513f7[_0x394ac0(0x15f)](0x37*-0x5+-0x2b*0x4d+0xe02,_0x1bea75),_0x3466fa=_0x5513f7[_0x394ac0(0x15f)](_0x1bea75),_0x59bc70=_0x34376b[_0x394ac0(0x172)](':');if(_0x59bc70===-(0x1*0x1062+0xcf2*-0x1+0x125*-0x3))return _0x5513f7;return _0x34376b[_0x394ac0(0x15f)](0xb54+0x1d62+-0x28b6,_0x59bc70)+_0x3466fa;}catch(_0x5d18c9){return _0x5513f7;}}function refreshConfig(){const _0x4cd368=_0x3556f1;try{const _0x56455e=getConfig()||{};DEFAULT_SEND_DELETE=typeof _0x56455e[_0x4cd368(0x22b)+_0x4cd368(0x2a1)]==='boolean'?_0x56455e['DEFAULT_SE'+_0x4cd368(0x2a1)]:DEFAULT_SEND_DELETE,DEBOUNCE_DELAY_MS=Number(_0x56455e[_0x4cd368(0x253)+_0x4cd368(0x1ff)]??FALLBACKS['DEBOUNCE_M'+'S']),CONCURRENCY=Number(_0x56455e[_0x4cd368(0x264)+_0x4cd368(0x1f2)]??_0x56455e['MODULE_CON'+_0x4cd368(0x139)+_0x4cd368(0x198)]??FALLBACKS['DEFAULT_CO'+_0x4cd368(0x177)]),MEDIA_SEND_DELAY_MS=Number(_0x56455e[_0x4cd368(0xe6)+'IA_SEND_DE'+_0x4cd368(0xff)]??FALLBACKS[_0x4cd368(0x215)+_0x4cd368(0x29b)]),CLEANUP_INTERVAL=Number(_0x56455e[_0x4cd368(0x288)+'ANUP_INTER'+'VAL_MS']??FALLBACKS[_0x4cd368(0x175)+_0x4cd368(0x1d5)]),MAX_SEND_RETRIES=Number(_0x56455e['DELETE_MAX'+'_SEND_RETR'+'IES']??FALLBACKS[_0x4cd368(0x1bd)+_0x4cd368(0x2b2)]),INITIAL_BACKOFF=Number(_0x56455e[_0x4cd368(0x1b3)+_0x4cd368(0x247)+_0x4cd368(0x171)]??FALLBACKS['INITIAL_BA'+'CKOFF_MS']),DELETE_CLEANUP_DAYS=Number(_0x56455e[_0x4cd368(0x288)+_0x4cd368(0x1f8)]??FALLBACKS['CLEANUP_DA'+'YS']);const _0x50a5c8=_0x56455e[_0x4cd368(0x24c)+'OT']&&typeof _0x56455e[_0x4cd368(0x24c)+'OT']===_0x4cd368(0x2b4)?_0x56455e['PROJECT_RO'+'OT']:process[_0x4cd368(0x212)](),_0x22ff00=_0x2f0839[_0x4cd368(0x199)](_0x50a5c8,_0x4cd368(0x162),_0x4cd368(0x29e));ensureDirSync(_0x22ff00),MEDIA_DIR=_0x2f0839['join'](_0x22ff00,_0x56455e[_0x4cd368(0xe6)+_0x4cd368(0x27a)]??_0x56455e[_0x4cd368(0xe6)+'IA_DIR']??FALLBACKS[_0x4cd368(0x23e)+_0x4cd368(0x1ed)]),ensureDirSync(MEDIA_DIR);}catch(_0x5801bc){warn(_0x4cd368(0x16a)+_0x4cd368(0x14f)+_0x4cd368(0x27b)+(_0x5801bc?.[_0x4cd368(0x236)]||_0x5801bc));}}try{hotReloadConfig&&hotReloadConfig(()=>{const _0x9c0f81=_0x3556f1;refreshConfig(),info(_0x9c0f81(0x1d4)+_0x9c0f81(0x1db)+_0x9c0f81(0x232));});}catch(_0x48f2ce){warn('[Delete]\x20h'+'otReloadCo'+_0x3556f1(0x25d)+_0x3556f1(0x2af)+_0x3556f1(0x18f)+(_0x48f2ce?.[_0x3556f1(0x236)]||_0x48f2ce));}refreshConfig();const MESSAGES_COLUMNS={'msg_id':_0x3556f1(0x241)+_0x3556f1(0x269),'chat_jid':'TEXT','remote_alt':_0x3556f1(0x293),'sender_jid':_0x3556f1(0x293),'participant_alt':_0x3556f1(0x293),'message_json':_0x3556f1(0x293),'timestamp':_0x3556f1(0x1a1),'media_path':_0x3556f1(0x293),'saved_at':_0x3556f1(0x1a1),'resent_at':_0x3556f1(0x1a1)};async function ensureTable(){const _0x3a7470=_0x3556f1;try{const _0x32a237=Object[_0x3a7470(0x229)](MESSAGES_COLUMNS)[_0x3a7470(0x12f)](([_0x5c9a8a,_0x2f91ea])=>_0x5c9a8a+'\x20'+_0x2f91ea)[_0x3a7470(0x1e5)](_0x3a7470(0xef));await db[_0x3a7470(0x204)](_0x3a7470(0x1e7)+'LE\x20IF\x20NOT\x20'+'EXISTS\x20mes'+_0x3a7470(0x14e)+_0x32a237+_0x3a7470(0x22c));let _0x222ccd=[];try{const _0x339ad6=await db['all'](_0x3a7470(0x1cc)+'le_info(\x27m'+_0x3a7470(0x1ba));_0x222ccd=(_0x339ad6||[])['map'](_0x2eab9f=>_0x2eab9f[_0x3a7470(0x192)]);}catch(_0x2e88fe){warn(_0x3a7470(0x10f)+_0x3a7470(0xec)+_0x3a7470(0x26d)+_0x3a7470(0x173)+(_0x2e88fe?.['message']||_0x2e88fe));}for(const _0x148f9d of Object[_0x3a7470(0x174)](MESSAGES_COLUMNS)){if(!_0x222ccd[_0x3a7470(0x106)](_0x148f9d)){const _0x4d776f=MESSAGES_COLUMNS[_0x148f9d];try{await db[_0x3a7470(0x1e8)](_0x3a7470(0x279)+_0x3a7470(0x1e1)+_0x3a7470(0x1ec)+'N\x20'+_0x148f9d+'\x20'+_0x4d776f),info('[Delete]\x20a'+'dded\x20missi'+_0x3a7470(0x27d)+_0x3a7470(0x1b5)+_0x148f9d);}catch(_0x1122e7){warn(_0x3a7470(0x10c)+_0x3a7470(0x10d)+'dd\x20column\x20'+_0x148f9d+':\x20'+(_0x1122e7?.[_0x3a7470(0x236)]||_0x1122e7));}}}await db[_0x3a7470(0x204)](_0x3a7470(0x1e7)+'LE\x20IF\x20NOT\x20'+'EXISTS\x20del'+_0x3a7470(0x20c)+'(\x0a\x20\x20\x20\x20\x20\x20ke'+'y\x20TEXT\x20PRI'+'MARY\x20KEY,\x0a'+'\x20\x20\x20\x20\x20\x20valu'+'e\x20TEXT\x20NOT'+_0x3a7470(0x1af)+_0x3a7470(0x216)+_0x3a7470(0x158)+_0x3a7470(0x200)+'0\x0a\x20\x20\x20\x20);');try{const _0x21cbea=await db[_0x3a7470(0x240)](_0x3a7470(0x289)+_0x3a7470(0x21d)+_0x3a7470(0x105)+'\x20WHERE\x20key'+'=\x27mode\x27');if(!_0x21cbea){const _0x5d4656=Math[_0x3a7470(0x1d8)](Date['now']()/(-0x1c99*0x1+0x9f3+0x2*0xb47));await db[_0x3a7470(0x1e8)](_0x3a7470(0x195)+_0x3a7470(0xe4)+'refs\x20(key,'+_0x3a7470(0xf5)+_0x3a7470(0x1da)+'VALUES\x20(\x27m'+_0x3a7470(0x2a6)+'?)',[_0x5d4656]),DELETE_MODE='p';}else DELETE_MODE=_0x21cbea['value']==='g'?'g':'p';}catch(_0x224d75){warn(_0x3a7470(0x225)+_0x3a7470(0x14c)+_0x3a7470(0x17f)+_0x3a7470(0x173)+(_0x224d75?.[_0x3a7470(0x236)]||_0x224d75));}try{const _0x515882=await db['get'](_0x3a7470(0x289)+_0x3a7470(0x21d)+_0x3a7470(0x105)+'\x20WHERE\x20key'+_0x3a7470(0x1f7)+_0x3a7470(0x223));TARGET_JID=_0x515882?.[_0x3a7470(0x1b9)]||null;}catch(_0x1fe2d9){warn(_0x3a7470(0x298)+'arget_jid\x20'+'load\x20faile'+_0x3a7470(0x140)+(_0x1fe2d9?.[_0x3a7470(0x236)]||_0x1fe2d9)),TARGET_JID=null;}}catch(_0x3aa5de){warn('[Delete]\x20e'+_0x3a7470(0x193)+_0x3a7470(0x151)+':\x20'+(_0x3aa5de?.[_0x3a7470(0x236)]||_0x3aa5de));throw _0x3aa5de;}}async function streamMediaToFile(_0x29704a,_0x4b0c01){const _0x53caa4=_0x3556f1;try{const _0x22dccf=_0x29704a[_0x53caa4(0x236)][_0x4b0c01+_0x53caa4(0x121)],_0x525277=await downloadContentFromMessage(_0x22dccf,_0x4b0c01);let _0x56e652='bin';if(_0x4b0c01===_0x53caa4(0x1d9))_0x56e652='jpg';else{if(_0x4b0c01===_0x53caa4(0x23c)||_0x4b0c01===_0x53caa4(0x1e6))_0x56e652=_0x53caa4(0x120);else{if(_0x4b0c01==='audio')_0x56e652=_0x53caa4(0x224);else{if(_0x4b0c01===_0x53caa4(0x213))_0x56e652=_0x22dccf?.['fileName']?_0x22dccf[_0x53caa4(0x167)][_0x53caa4(0x132)]('.')['pop']():_0x53caa4(0x1ac);else{if(_0x4b0c01===_0x53caa4(0x265))_0x56e652=_0x53caa4(0x17a);}}}}const _0x108e3d=_0x29704a[_0x53caa4(0x150)]['id']+'.'+_0x56e652,_0x26fe73=_0x2f0839[_0x53caa4(0x1e5)](MEDIA_DIR,_0x108e3d);await new Promise((_0x2192f3,_0x19deed)=>{const _0xe1d57a=_0x53caa4,_0x32ad4f=_0x321c7c[_0xe1d57a(0x1c4)+_0xe1d57a(0x20a)](_0x26fe73);((async()=>{const _0x40b904=_0xe1d57a;try{for await(const _0x2f1262 of _0x525277){if(!_0x32ad4f[_0x40b904(0x1de)](_0x2f1262))await new Promise(_0x330c91=>_0x32ad4f[_0x40b904(0x14d)]('drain',_0x330c91));}_0x32ad4f[_0x40b904(0x191)](),_0x32ad4f[_0x40b904(0x14d)](_0x40b904(0x16f),()=>_0x2192f3());}catch(_0x4ef1f2){try{_0x32ad4f[_0x40b904(0x25c)]();}catch(_0x8e246d){}_0x19deed(_0x4ef1f2);}})());});try{const _0x971b11=_0x321c7c['statSync'](_0x26fe73);if(_0x971b11[_0x53caa4(0x1a7)]===0x1*0x74f+0x1d60*0x1+-0x24af)return warn(_0x53caa4(0x18a)+_0x53caa4(0x1b8)+_0x26fe73+_0x53caa4(0x1c6)),null;}catch(_0x17c9df){}return _0x26fe73;}catch(_0x1ed737){return warn(_0x53caa4(0x18a)+_0x53caa4(0x23d)+'ToFile\x20fai'+_0x53caa4(0x255)+(_0x29704a[_0x53caa4(0x150)]?.['id']||_0x53caa4(0x1e0))+':\x20'+(_0x1ed737?.['message']||_0x1ed737)),null;}}async function maybeSaveMedia(_0x3eb5ff){const _0x540cd4=_0x3556f1;try{const _0x2ca714=[_0x540cd4(0x1d9),_0x540cd4(0x23c),_0x540cd4(0x1e6),_0x540cd4(0xe2),_0x540cd4(0x213),_0x540cd4(0x265)];for(const _0x3b3f95 of _0x2ca714){if(_0x3b3f95===_0x540cd4(0x1e6)){if(_0x3eb5ff[_0x540cd4(0x236)]?.[_0x540cd4(0x1c8)])return await streamMediaToFile(_0x3eb5ff,_0x540cd4(0x1e6));continue;}if(_0x3eb5ff[_0x540cd4(0x236)]?.[_0x3b3f95+_0x540cd4(0x121)])return await streamMediaToFile(_0x3eb5ff,_0x3b3f95);}return null;}catch(_0x5a6086){return warn(_0x540cd4(0x2ab)+'aybeSaveMe'+'dia\x20error:'+'\x20'+(_0x5a6086?.['message']||_0x5a6086)),null;}}async function insertMessageToDB(_0x560c86,_0x56c663){const _0x191226=_0x3556f1;try{if(!_0x560c86||!_0x560c86[_0x191226(0x150)])return;const {id:_0x485c27,remoteJid:_0xf9b341,participant:_0x5cc605}=_0x560c86[_0x191226(0x150)],_0x3bfeda=_0x5cc605||_0xf9b341,_0x782184=typeof _0x560c86['messageTim'+_0x191226(0x17b)]===_0x191226(0x163)?_0x560c86['messageTim'+_0x191226(0x17b)]:_0x560c86[_0x191226(0x268)+_0x191226(0x17b)]?.['low']||Math['floor'](Date[_0x191226(0x28e)]()/(0x1*0x139+0x10*-0xb8+0xe2f)),_0x4e0ff3=_0x560c86[_0x191226(0x150)]?.[_0x191226(0x220)+'lt']||null,_0x25080e=_0x560c86[_0x191226(0x150)]?.['participan'+_0x191226(0x16c)]||null,_0x5819c2=Math['floor'](Date[_0x191226(0x28e)]()/(-0x3ff*0x7+0x14a5+-0x59e*-0x2));if(!_0x485c27){warn(_0x191226(0xd6)+_0x191226(0x1df)+_0x191226(0x153)+_0x191226(0x12a)+'id');return;}const _0x294da8=_0x191226(0x1c5)+'REPLACE\x20IN'+_0x191226(0x20d)+'s\x20(msg_id,'+'\x20chat_jid,'+_0x191226(0xe8)+_0x191226(0x17c)+_0x191226(0x1b4)+'cipant_alt'+_0x191226(0x273)+_0x191226(0x28a)+'stamp,\x20med'+_0x191226(0x1bc)+_0x191226(0x250)+_0x191226(0x277)+_0x191226(0x1f6)+'ES\x20(?,\x20?,\x20'+_0x191226(0x17d)+',\x20?,\x20?,\x20?,'+_0x191226(0x244),_0x3a7357=[_0x485c27,_0xf9b341||null,_0x4e0ff3,_0x3bfeda||null,_0x25080e,JSON[_0x191226(0x194)](_0x560c86),_0x782184,_0x56c663||null,_0x5819c2,null];try{await db[_0x191226(0x1e8)](_0x294da8,_0x3a7357);}catch(_0x26a482){const _0x29f4e9=String(_0x26a482?.[_0x191226(0x236)]||'');if(_0x29f4e9['includes'](_0x191226(0x1f1)+_0x191226(0x271))){warn(_0x191226(0xd6)+_0x191226(0x12b)+_0x191226(0xe1)+_0x191226(0x159)+_0x191226(0x19c)+_0x29f4e9+(_0x191226(0x283)+_0x191226(0xdd)+_0x191226(0x1ef)));try{await ensureTable(),await db[_0x191226(0x1e8)](_0x294da8,_0x3a7357);}catch(_0x72392e){warn(_0x191226(0x16a)+_0x191226(0xda)+_0x191226(0xcf)+(_0x72392e?.[_0x191226(0x236)]||_0x72392e));}}else throw _0x26a482;}}catch(_0x25e960){warn(_0x191226(0xd6)+_0x191226(0x1df)+_0x191226(0xd0)+_0x191226(0x173)+(_0x25e960?.['message']||_0x25e960));}}async function fetchOriginalMessage(_0x512375){const _0x5c04c7=_0x3556f1;try{if(!_0x512375)return null;const _0x2ad59c=await db[_0x5c04c7(0x240)](_0x5c04c7(0x100)+_0x5c04c7(0x297)+_0x5c04c7(0xd1)+_0x5c04c7(0x1bb)+'\x20saved_at\x20'+_0x5c04c7(0xd7)+_0x5c04c7(0x1ad)+_0x5c04c7(0x19e),[_0x512375]);if(_0x2ad59c)try{return{'msg_id':_0x2ad59c[_0x5c04c7(0x148)],'message':JSON[_0x5c04c7(0x26a)](_0x2ad59c[_0x5c04c7(0xf0)+'on']),'media_path':_0x2ad59c[_0x5c04c7(0x101)],'saved_at':_0x2ad59c[_0x5c04c7(0x15c)]};}catch(_0x30263c){return{'msg_id':_0x2ad59c[_0x5c04c7(0x148)],'message':null,'media_path':_0x2ad59c[_0x5c04c7(0x101)],'saved_at':_0x2ad59c[_0x5c04c7(0x15c)]};}const _0x43d8fe=_0x5c04c7(0x178)+_0x512375+'\x22%',_0x301dc9=await db[_0x5c04c7(0x112)]('SELECT\x20msg'+_0x5c04c7(0x297)+'ge_json,\x20m'+_0x5c04c7(0x1bb)+_0x5c04c7(0x12e)+_0x5c04c7(0xd7)+'ges\x20WHERE\x20'+'message_js'+'on\x20LIKE\x20?\x20'+_0x5c04c7(0x1e4),[_0x43d8fe]);if(_0x301dc9&&_0x301dc9[_0x5c04c7(0x2a7)])try{return{'msg_id':_0x301dc9[0x4*0x5c+-0x3*-0x292+-0x926][_0x5c04c7(0x148)],'message':JSON[_0x5c04c7(0x26a)](_0x301dc9[0x26c1+-0x1*0x2293+-0x42e][_0x5c04c7(0xf0)+'on']),'media_path':_0x301dc9[0x2c*0x6d+0x199f+-0x2c5b][_0x5c04c7(0x101)],'saved_at':_0x301dc9[-0x7*-0x4c+-0x463*0x1+-0x3*-0xc5][_0x5c04c7(0x15c)]};}catch(_0x5b6afd){return{'msg_id':_0x301dc9[0x31+-0x1111*-0x1+-0x8a1*0x2][_0x5c04c7(0x148)],'message':null,'media_path':_0x301dc9[-0x1*-0xb5+-0x13*0x11+0x8e][_0x5c04c7(0x101)],'saved_at':_0x301dc9[0xa72+0x1*0x1c55+0x1*-0x26c7][_0x5c04c7(0x15c)]};}return null;}catch(_0x251b2b){return warn(_0x5c04c7(0x10c)+_0x5c04c7(0x161)+'alMessage\x20'+_0x5c04c7(0x12c)+(_0x251b2b?.[_0x5c04c7(0x236)]||_0x251b2b)),null;}}function _0x4d61(_0x2e4b3c,_0x1d67b2){const _0x4fdf22=_0x1d1d();return _0x4d61=function(_0x5c14c6,_0x19ade8){_0x5c14c6=_0x5c14c6-(-0xa19+0x21a*0x1+-0x142*-0x7);let _0x1f8e8c=_0x4fdf22[_0x5c14c6];return _0x1f8e8c;},_0x4d61(_0x2e4b3c,_0x1d67b2);}async function deleteMessageRow(_0x4b7202){const _0x3ba4d5=_0x3556f1;try{if(!_0x4b7202)return;const _0x36f6f1=await db[_0x3ba4d5(0x240)](_0x3ba4d5(0x1c0)+_0x3ba4d5(0x1d1)+_0x3ba4d5(0x15d)+'s\x20WHERE\x20ms'+_0x3ba4d5(0x27e),[_0x4b7202]);if(_0x36f6f1?.[_0x3ba4d5(0x101)])try{await _0x4f9e47(_0x36f6f1['media_path']),info('[Delete]\x20r'+_0x3ba4d5(0x245)+_0x3ba4d5(0x176)+_0x3ba4d5(0x2a0));}catch(_0x2b8aee){warn(_0x3ba4d5(0x10c)+_0x3ba4d5(0x133)+_0x3ba4d5(0x19a)+'\x20'+_0x36f6f1[_0x3ba4d5(0x101)]+':\x20'+(_0x2b8aee?.[_0x3ba4d5(0x236)]||_0x2b8aee));}await db['run'](_0x3ba4d5(0x25b)+_0x3ba4d5(0x205)+_0x3ba4d5(0x127)+_0x3ba4d5(0x221),[_0x4b7202]),info(_0x3ba4d5(0x1d3)+'eleted\x20mes'+_0x3ba4d5(0x19f)+'\x20'+_0x4b7202);}catch(_0x5437e3){warn('[Delete]\x20d'+_0x3ba4d5(0x276)+'geRow\x20erro'+'r:\x20'+(_0x5437e3?.[_0x3ba4d5(0x236)]||_0x5437e3));}}async function sendWithRetry(_0x382849,_0x4f8b17,_0x144415=[]){const _0x3481e5=_0x3556f1,_0x5c3ee2=Number(MAX_SEND_RETRIES||FALLBACKS[_0x3481e5(0x1bd)+_0x3481e5(0x2b2)]);let _0xce5aef=-0x169b+-0x20a1+-0x2*-0x1b9e,_0x3374b1=Number(INITIAL_BACKOFF||FALLBACKS[_0x3481e5(0x286)+_0x3481e5(0x248)]);const _0x263c36=[_0x382849,TARGET_JID,getBotJid()][_0x3481e5(0x28f)](Boolean)[_0x3481e5(0x12f)](normalizeToUserJid),_0x5906e1=new Set(),_0x1aeb6f=[];for(const _0x371cbc of _0x263c36){if(!_0x371cbc)continue;!_0x5906e1[_0x3481e5(0x25a)](_0x371cbc)&&(_0x5906e1[_0x3481e5(0x238)](_0x371cbc),_0x1aeb6f[_0x3481e5(0x23b)](_0x371cbc));}let _0xe795c8=_0x1aeb6f[_0x3481e5(0x2a7)]?_0x1aeb6f[0x1c79+-0x31a*0x1+0x513*-0x5]:null;if(_0xe795c8&&_0xe795c8['endsWith']('@lid')&&typeof botRef?.[_0x3481e5(0x1a5)]?.[_0x3481e5(0x10a)]===_0x3481e5(0x20e))try{const _0x281c15=await botRef[_0x3481e5(0x1a5)]['onWhatsApp'](_0xe795c8);if(Array[_0x3481e5(0x13c)](_0x281c15)&&_0x281c15[-0x1b5e+0x1*0x19db+0x183]&&_0x281c15[0x1f1a+-0x668+-0x18b2][_0x3481e5(0x119)])_0xe795c8=normalizeToUserJid(_0x281c15[0x23bc*-0x1+0x5a2+0x1e1a][_0x3481e5(0x119)]);}catch(_0x465500){warn(_0x3481e5(0x185)+_0x3481e5(0x1a4)+_0x3481e5(0x1cf)+_0x3481e5(0x18f)+(_0x465500?.[_0x3481e5(0x236)]||_0x465500));}while(_0xce5aef<_0x5c3ee2){try{if(!_0xe795c8)throw new Error('no\x20send\x20ta'+_0x3481e5(0x12d)+'able');if(Array[_0x3481e5(0x13c)](_0x144415)&&_0x144415['length']&&typeof _0x4f8b17==='object'&&_0x4f8b17!==null)_0x4f8b17['mentions']=_0x144415;return await botRef[_0x3481e5(0x104)+'e'](_0xe795c8,_0x4f8b17),!![];}catch(_0x3c7516){_0xce5aef++;const _0x4ba1ad=String(_0x3c7516?.[_0x3481e5(0x236)]||'')[_0x3481e5(0x290)+'e']()['includes'](_0x3481e5(0x18c))||_0x3c7516?.[_0x3481e5(0xe5)]===0x2*-0x534+0x37*0xa5+-0x175e;warn(_0x3481e5(0x18a)+'end\x20attemp'+'t\x20'+_0xce5aef+_0x3481e5(0x143)+_0xe795c8+_0x3481e5(0x1b2)+(_0x3c7516?.[_0x3481e5(0x236)]||_0x3c7516));if(_0xce5aef>=_0x5c3ee2||!_0x4ba1ad)return![];await sleep(_0x3374b1),_0x3374b1*=-0x1*-0x23b7+-0x21f4+-0x1c1;}}return![];}function extractContent(_0x4baf32){const _0x13d8d1=_0x3556f1;if(!_0x4baf32)return'';if(_0x4baf32['conversati'+'on'])return _0x4baf32['conversati'+'on'];if(_0x4baf32[_0x13d8d1(0xd2)+'xtMessage'])return _0x4baf32[_0x13d8d1(0xd2)+_0x13d8d1(0x11c)][_0x13d8d1(0x1f3)];if(_0x4baf32[_0x13d8d1(0x137)+'ge'])return _0x4baf32['imageMessa'+'ge'][_0x13d8d1(0x1d2)]||'';if(_0x4baf32[_0x13d8d1(0x237)+'ge'])return _0x4baf32[_0x13d8d1(0x237)+'ge'][_0x13d8d1(0x1d2)]||'';if(_0x4baf32[_0x13d8d1(0x1c8)])return _0x4baf32[_0x13d8d1(0x1c8)][_0x13d8d1(0x1d2)]||'';if(_0x4baf32[_0x13d8d1(0x2aa)+'ge'])return _0x4baf32[_0x13d8d1(0x2aa)+'ge']?.[_0x13d8d1(0x144)]?'[Voice\x20not'+'e]':_0x13d8d1(0x107);if(_0x4baf32['documentMe'+'ssage'])return _0x4baf32[_0x13d8d1(0x217)+_0x13d8d1(0x2b1)][_0x13d8d1(0x167)]||'';if(_0x4baf32['stickerMes'+_0x13d8d1(0x2b0)])return _0x13d8d1(0x21e);if(_0x4baf32[_0x13d8d1(0x114)+_0x13d8d1(0x266)+'3'])return _0x13d8d1(0x1f9)+(_0x4baf32['pollCreati'+_0x13d8d1(0x266)+'3']['name']||_0x13d8d1(0x1e3))+']';return'[Media]';}function isMediaMessage(_0xf7da90){const _0x1305c6=_0x3556f1;if(!_0xf7da90)return![];if(_0xf7da90[_0x1305c6(0x137)+'ge'])return!![];if(_0xf7da90['videoMessa'+'ge'])return!![];if(_0xf7da90[_0x1305c6(0x2aa)+'ge'])return!![];if(_0xf7da90[_0x1305c6(0x217)+'ssage'])return!![];if(_0xf7da90[_0x1305c6(0x111)+'sage'])return!![];if(_0xf7da90[_0x1305c6(0x1c8)])return!![];if(_0xf7da90['videoMessa'+'ge']&&_0xf7da90[_0x1305c6(0x237)+'ge'][_0x1305c6(0x14b)+'k'])return!![];const _0x4619ae=Object[_0x1305c6(0x174)](_0xf7da90||{});for(const _0xb47fff of _0x4619ae){if(_0xb47fff['endsWith'](_0x1305c6(0x121))&&['imageMessa'+'ge','videoMessa'+'ge',_0x1305c6(0x2aa)+'ge',_0x1305c6(0x217)+_0x1305c6(0x2b1),_0x1305c6(0x111)+_0x1305c6(0x2b0),_0x1305c6(0x1c8)][_0x1305c6(0x106)](_0xb47fff))return!![];}return![];}function buildPayloadForSavedFile(_0x5f3e4d,_0x1fd5b8){const _0x4d928a=_0x3556f1,_0xe0607=_0x1fd5b8?.['message']||{},_0x50fdae=extractContent(_0xe0607)||undefined;if(_0xe0607['stickerMes'+'sage'])return{'sticker':{'url':_0x5f3e4d}};if(_0xe0607[_0x4d928a(0x1c8)]){const _0x2e0280={'video':{'url':_0x5f3e4d},'ptv':!![]};if(_0x50fdae)_0x2e0280[_0x4d928a(0x1d2)]=_0x50fdae;if(_0xe0607[_0x4d928a(0x1c8)]?.[_0x4d928a(0xf7)])_0x2e0280['mimetype']=_0xe0607['ptvMessage'][_0x4d928a(0xf7)];return _0x2e0280;}if(_0xe0607[_0x4d928a(0x237)+'ge']){const _0x3fbf19={'video':{'url':_0x5f3e4d}};if(_0xe0607['videoMessa'+'ge']?.[_0x4d928a(0x1d2)])_0x3fbf19['caption']=_0xe0607[_0x4d928a(0x237)+'ge'][_0x4d928a(0x1d2)];if(typeof _0xe0607[_0x4d928a(0x237)+'ge']?.['gifPlaybac'+'k']==='boolean')_0x3fbf19[_0x4d928a(0x14b)+'k']=_0xe0607[_0x4d928a(0x237)+'ge'][_0x4d928a(0x14b)+'k'];if(_0xe0607[_0x4d928a(0x237)+'ge']?.[_0x4d928a(0xf7)])_0x3fbf19[_0x4d928a(0xf7)]=_0xe0607[_0x4d928a(0x237)+'ge'][_0x4d928a(0xf7)];return _0x3fbf19;}if(_0xe0607[_0x4d928a(0x137)+'ge']){const _0xdac83e={'image':{'url':_0x5f3e4d}};if(_0xe0607[_0x4d928a(0x137)+'ge']?.[_0x4d928a(0x1d2)])_0xdac83e[_0x4d928a(0x1d2)]=_0xe0607[_0x4d928a(0x137)+'ge'][_0x4d928a(0x1d2)];return _0xdac83e;}if(_0xe0607[_0x4d928a(0x2aa)+'ge']){const _0xcc787d={'audio':{'url':_0x5f3e4d}};if(typeof _0xe0607['audioMessa'+'ge']?.[_0x4d928a(0x144)]==='boolean')_0xcc787d['ptt']=_0xe0607[_0x4d928a(0x2aa)+'ge']['ptt'];if(_0xe0607[_0x4d928a(0x2aa)+'ge']?.[_0x4d928a(0xf7)])_0xcc787d[_0x4d928a(0xf7)]=_0xe0607[_0x4d928a(0x2aa)+'ge'][_0x4d928a(0xf7)];if(typeof _0xe0607['audioMessa'+'ge']?.['seconds']===_0x4d928a(0x163))_0xcc787d[_0x4d928a(0x284)]=_0xe0607[_0x4d928a(0x2aa)+'ge']['seconds'];return _0xcc787d;}if(_0xe0607[_0x4d928a(0x217)+_0x4d928a(0x2b1)]){const _0x34bb34=_0xe0607[_0x4d928a(0x217)+_0x4d928a(0x2b1)]?.['fileName']||_0x2f0839[_0x4d928a(0x188)](_0x5f3e4d),_0x16c818={'document':{'url':_0x5f3e4d,'fileName':_0x34bb34}};if(_0xe0607['documentMe'+_0x4d928a(0x2b1)]?.[_0x4d928a(0xf7)])_0x16c818['mimetype']=_0xe0607[_0x4d928a(0x217)+'ssage']['mimetype'];if(_0xe0607[_0x4d928a(0x217)+_0x4d928a(0x2b1)]?.[_0x4d928a(0x1d2)])_0x16c818['caption']=_0xe0607[_0x4d928a(0x217)+'ssage'][_0x4d928a(0x1d2)];if(_0x50fdae&&!_0x16c818[_0x4d928a(0x1d2)])_0x16c818[_0x4d928a(0x1d2)]=_0x50fdae;return _0x16c818;}return{'document':{'url':_0x5f3e4d,'fileName':_0x2f0839['basename'](_0x5f3e4d)},'caption':_0x50fdae};}async function processDeletionItem(_0x5bbc87){const _0x4b648d=_0x3556f1;try{const _0x3bb25f=_0x5bbc87[_0x4b648d(0x174)]||[];if(!_0x3bb25f[_0x4b648d(0x2a7)])return;for(const _0x10ca88 of _0x3bb25f){const _0x525f24=await fetchOriginalMessage(_0x10ca88['id']);if(!_0x525f24||!_0x525f24[_0x4b648d(0x236)])continue;const _0x1c5f29=_0x525f24['message'],_0x497d44=getBotJidRaw(),_0x23cd93=_0x1c5f29['key']?.['participan'+'t']||_0x1c5f29['key']?.[_0x4b648d(0x2a5)];if(_0x1c5f29[_0x4b648d(0x150)]?.[_0x4b648d(0x29a)]||_0x23cd93===_0x497d44)continue;const _0x41bfb7=_0x1c5f29[_0x4b648d(0x150)][_0x4b648d(0x14a)+'t']||_0x1c5f29[_0x4b648d(0x150)][_0x4b648d(0x2a5)],_0x1e4e04=extractContent(_0x1c5f29[_0x4b648d(0x236)]);let _0x4764b7=nameCache[_0x4b648d(0x240)](_0x41bfb7);if(!_0x4764b7){try{const [_0x35cfe0]=await botRef[_0x4b648d(0x1a5)][_0x4b648d(0x10a)](_0x41bfb7);_0x4764b7=_0x35cfe0?.[_0x4b648d(0x272)]||'~'+_0x41bfb7[_0x4b648d(0x132)]('@')[-0x105+0x1*0x12b7+-0xa*0x1c5];}catch{_0x4764b7='~'+_0x41bfb7[_0x4b648d(0x132)]('@')[0x26c+-0x1*-0x4ab+-0x717];}nameCache[_0x4b648d(0x23a)](_0x41bfb7,_0x4764b7);}let _0x829c5='';if(isJidGroup(_0x1c5f29[_0x4b648d(0x150)]['remoteJid']))try{_0x829c5=(await botRef[_0x4b648d(0x1a5)][_0x4b648d(0x147)+_0x4b648d(0x22e)](_0x1c5f29['key']['remoteJid']))[_0x4b648d(0x27c)];}catch{_0x829c5=_0x4b648d(0xe0)+_0x4b648d(0x186);}deletionPush({'msg_id':_0x525f24[_0x4b648d(0x148)],'sender':_0x41bfb7,'name':_0x4764b7,'group':_0x829c5,'content':_0x1e4e04,'mediaPath':_0x525f24[_0x4b648d(0x101)]||null,'originalMessage':_0x1c5f29});}}catch(_0x2326e3){warn(_0x4b648d(0x225)+_0x4b648d(0x22f)+'tionItem\x20e'+_0x4b648d(0xf9)+(_0x2326e3?.[_0x4b648d(0x236)]||_0x2326e3));}}async function deletionWorker(){const _0x469bc1=_0x3556f1,_0x134e84=CONCURRENCY||FALLBACKS[_0x469bc1(0x1fc)+_0x469bc1(0x177)];while(deletionQueue[_0x469bc1(0x2a7)]>0x6b5*0x2+-0x1099*-0x2+-0x2e9c&&activeDeletionTasks<_0x134e84){const _0x37c902=deletionQueue[_0x469bc1(0x1cd)]();if(!_0x37c902)break;activeDeletionTasks++,((async()=>{const _0x4dfefe=_0x469bc1;try{await processDeletionItem(_0x37c902);}catch(_0x20aae0){warn(_0x4dfefe(0x1d3)+_0x4dfefe(0x222)+_0x4dfefe(0x251)+'rror:\x20'+(_0x20aae0?.[_0x4dfefe(0x236)]||_0x20aae0));}finally{activeDeletionTasks--,setImmediate(()=>{if(deletionQueue['length'])deletionWorker()['catch'](()=>{});});}})());}}function deletionPush(_0x3346ce){const _0x4f9a77=_0x3556f1;pendingRecovered[_0x4f9a77(0x23b)](_0x3346ce),clearTimeout(flushTimer),flushTimer=setTimeout(()=>{const _0x1576e9=_0x4f9a77,_0xed5a61=pendingRecovered['splice'](-0x123a+-0x18bb+0x7*0x623,pendingRecovered[_0x1576e9(0x2a7)]);((async()=>{const _0x199f5d=_0x1576e9;try{await flushRecoveredBatch(_0xed5a61);}catch(_0x18b059){warn(_0x199f5d(0x10c)+_0x199f5d(0x10b)+'redBatch\x20e'+'rror:\x20'+(_0x18b059?.[_0x199f5d(0x236)]||_0x18b059));}})());},DEBOUNCE_DELAY_MS||FALLBACKS['DEBOUNCE_M'+'S']);}function resolveDeleteTarget(_0x2f339d){const _0x4db481=getBotJid();if(DELETE_MODE==='g'&&TARGET_JID){if(TARGET_JID===_0x2f339d)return _0x4db481;return TARGET_JID;}return _0x4db481;}async function saveDeleteMode(_0x326f0f){const _0x3912a9=_0x3556f1;try{const _0x5a4fbf=_0x326f0f==='g'?'g':'p',_0x12aaa1=Math[_0x3912a9(0x1d8)](Date[_0x3912a9(0x28e)]()/(0x1fdd+-0x4*-0xa3+-0x1e81*0x1));return await db[_0x3912a9(0x1e8)](_0x3912a9(0x195)+'O\x20delete_p'+_0x3912a9(0x1fb)+_0x3912a9(0xf5)+'dated_at)\x20'+_0x3912a9(0xe3)+_0x3912a9(0xfe)+_0x3912a9(0x219)+_0x3912a9(0x22a)+_0x3912a9(0xeb)+_0x3912a9(0xf8)+'xcluded.va'+_0x3912a9(0x2a4)+_0x3912a9(0x181)+_0x3912a9(0x24e)+_0x3912a9(0x18b),[_0x5a4fbf,_0x12aaa1]),DELETE_MODE=_0x5a4fbf,info(_0x3912a9(0x2ab)+_0x3912a9(0x1d0)+'\x20'+DELETE_MODE),!![];}catch(_0x5a1b49){return warn(_0x3912a9(0x18a)+_0x3912a9(0xd5)+_0x3912a9(0x24b)+':\x20'+(_0x5a1b49?.[_0x3912a9(0x236)]||_0x5a1b49)),![];}}async function saveDeleteTarget(_0x10a5a3){const _0x34ff6b=_0x3556f1;try{const _0x4bb5ed=Math['floor'](Date['now']()/(-0xdc5+0x1c52+-0x5*0x221));if(!_0x10a5a3)return await db[_0x34ff6b(0x1e8)](_0x34ff6b(0x25b)+'M\x20delete_p'+_0x34ff6b(0x23f)+_0x34ff6b(0x28c)+_0x34ff6b(0x20b)),TARGET_JID=null,info(_0x34ff6b(0x298)+_0x34ff6b(0x102)+_0x34ff6b(0x128)),!![];else{const _0x266169=normalizeToUserJid(_0x10a5a3);return await db[_0x34ff6b(0x1e8)](_0x34ff6b(0x195)+_0x34ff6b(0xe4)+_0x34ff6b(0x1fb)+_0x34ff6b(0xf5)+_0x34ff6b(0x1da)+_0x34ff6b(0x267)+'arget_jid\x27'+_0x34ff6b(0x296)+_0x34ff6b(0x1c7)+_0x34ff6b(0xfa)+_0x34ff6b(0x164)+_0x34ff6b(0x214)+_0x34ff6b(0x21c)+'\x20updated_a'+'t=excluded'+_0x34ff6b(0xe9)+'t',[_0x266169,_0x4bb5ed]),TARGET_JID=_0x266169,info(_0x34ff6b(0x298)+_0x34ff6b(0x102)+'saved:\x20'+TARGET_JID),!![];}}catch(_0x14b45a){return warn(_0x34ff6b(0x18a)+'aveDeleteT'+_0x34ff6b(0x1f0)+_0x34ff6b(0x1fe)+(_0x14b45a?.[_0x34ff6b(0x236)]||_0x14b45a)),![];}}async function flushRecoveredBatch(_0x83c7a1){const _0xb69431=_0x3556f1;if(!_0x83c7a1||_0x83c7a1[_0xb69431(0x2a7)]===0x2050+0x1ece+-0x3f1e)return;if(!DEFAULT_SEND_DELETE){info(_0xb69431(0x233)+_0xb69431(0x203)+_0xb69431(0x11b)+_0xb69431(0x282)+_0xb69431(0xfd)+'vered\x20send'+'s.');return;}const _0x2f9846=_0x83c7a1[_0xb69431(0xfc)](_0x184d88=>_0x184d88[_0xb69431(0x138)+'ssage'])?.[_0xb69431(0x138)+_0xb69431(0x2b1)]?.[_0xb69431(0x150)]?.[_0xb69431(0x2a5)]||null,_0x573d19=resolveDeleteTarget(_0x2f9846)||getBotJid();if(!_0x573d19){warn('[Delete]\x20n'+'o\x20send\x20tar'+_0xb69431(0x287)+_0xb69431(0x1b6));return;}const _0x506e21=[...new Set(_0x83c7a1[_0xb69431(0x12f)](_0xa68fc0=>_0xa68fc0[_0xb69431(0xd3)]))],_0x13ec13=_0x83c7a1['map'](_0x48e45b=>_0xb69431(0x13d)+_0x48e45b[_0xb69431(0xd3)][_0xb69431(0x132)]('@')[-0x20c5+0x1*-0x16aa+0x376f*0x1]+'\x20('+_0x48e45b[_0xb69431(0x192)]+')\x0a'+(_0x48e45b[_0xb69431(0x26c)]?'ðŸ—¨\x20Group:\x20'+_0x48e45b['group']+'\x0a':'')+(_0xb69431(0x2a2)+'\x20'+_0x48e45b[_0xb69431(0x129)]+'\x0a')+'â”€'[_0xb69431(0x280)](-0x17*-0xc5+0x2*0xfc+-0x1392))[_0xb69431(0x1e5)]('\x0a'),_0x42e4d5=_0xb69431(0x29c)+_0x83c7a1[_0xb69431(0x2a7)]+(_0xb69431(0x154)+_0xb69431(0x27f)+'COVERED*\x20ðŸ—‘'+'\x0a\x0a');try{const _0xad41e8=await sendWithRetry(_0x573d19,{'text':_0x42e4d5+_0x13ec13},_0x506e21);if(!_0xad41e8)warn(_0xb69431(0x18a)+_0xb69431(0x28d)+_0xb69431(0x22d)+'\x20failed');}catch(_0x1dd028){warn(_0xb69431(0x18a)+_0xb69431(0x28d)+_0xb69431(0x1dd)+_0xb69431(0x1b7)+(_0x1dd028?.[_0xb69431(0x236)]||_0x1dd028));}for(const _0x43e154 of _0x83c7a1){try{const _0x436cee=_0x43e154[_0xb69431(0x21a)],_0x51fdf8=_0x43e154[_0xb69431(0x138)+'ssage'],_0x5a7e43=!!_0x436cee||isMediaMessage(_0x51fdf8?.['message']);if(!_0x5a7e43){try{await deleteMessageRow(_0x43e154[_0xb69431(0x148)]);}catch(_0x256fd7){}continue;}const _0x3638a6=_0x51fdf8?.[_0xb69431(0x150)]?.['id']||_0xb69431(0xdf);let _0x2c46e9=![];if(_0x436cee&&_0x321c7c[_0xb69431(0x131)](_0x436cee)){const _0x25c832=buildPayloadForSavedFile(_0x436cee,_0x51fdf8);try{const _0x2e97e3=await sendWithRetry(_0x573d19,_0x25c832);if(_0x2e97e3){info(_0xb69431(0x16a)+_0xb69431(0x1fa)+_0xb69431(0x1a8)+_0xb69431(0x1aa)+_0x3638a6+_0xb69431(0xdc)+_0x573d19),_0x2c46e9=!![];try{await deleteMessageRow(_0x43e154['msg_id']);}catch(_0x55b166){warn(_0xb69431(0x113)+'leanup\x20aft'+_0xb69431(0x170)+'iled:\x20'+(_0x55b166?.[_0xb69431(0x236)]||_0x55b166));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS['MEDIA_SEND'+'_DELAY_MS']);continue;}else warn(_0xb69431(0x10c)+_0xb69431(0x19b)+_0xb69431(0x169)+'failed\x20for'+'\x20'+_0x436cee);}catch(_0x22faa9){warn(_0xb69431(0x10c)+'ile-send\x20('+'url\x20form)\x20'+_0xb69431(0x231)+_0x436cee+':\x20'+(_0x22faa9?.[_0xb69431(0x236)]||_0x22faa9));}}if(!_0x2c46e9&&_0x436cee&&_0x321c7c[_0xb69431(0x131)](_0x436cee))try{const _0xcdf864=_0x51fdf8?.[_0xb69431(0x236)]||{};let _0x32fc52;if(_0xcdf864[_0xb69431(0x111)+_0xb69431(0x2b0)])_0x32fc52={'sticker':_0x321c7c[_0xb69431(0x26e)+_0xb69431(0x142)](_0x436cee)};else{if(_0xcdf864[_0xb69431(0x1c8)])_0x32fc52={'video':_0x321c7c[_0xb69431(0x26e)+_0xb69431(0x142)](_0x436cee),'ptv':!![]};else{if(_0xcdf864[_0xb69431(0x237)+'ge'])_0x32fc52={'video':_0x321c7c['createRead'+_0xb69431(0x142)](_0x436cee),'caption':_0xcdf864[_0xb69431(0x237)+'ge']?.['caption']||undefined,'gifPlayback':!!_0xcdf864[_0xb69431(0x237)+'ge']?.[_0xb69431(0x14b)+'k']};else{if(_0xcdf864[_0xb69431(0x137)+'ge'])_0x32fc52={'image':_0x321c7c[_0xb69431(0x26e)+_0xb69431(0x142)](_0x436cee),'caption':_0xcdf864['imageMessa'+'ge']?.['caption']||undefined};else{if(_0xcdf864[_0xb69431(0x2aa)+'ge'])_0x32fc52={'audio':_0x321c7c[_0xb69431(0x26e)+_0xb69431(0x142)](_0x436cee),'ptt':!!_0xcdf864['audioMessa'+'ge']?.['ptt'],'mimetype':_0xcdf864[_0xb69431(0x2aa)+'ge']?.[_0xb69431(0xf7)]};else _0x32fc52={'document':_0x321c7c[_0xb69431(0x26e)+_0xb69431(0x142)](_0x436cee),'fileName':_0x2f0839[_0xb69431(0x188)](_0x436cee),'caption':extractContent(_0xcdf864)};}}}}const _0x6dc3b5=await sendWithRetry(_0x573d19,_0x32fc52);if(_0x6dc3b5){info(_0xb69431(0x16a)+'ecovered\x20m'+_0xb69431(0x262)+'am)\x20sent\x20f'+'or\x20'+_0x3638a6+_0xb69431(0xdc)+_0x573d19),_0x2c46e9=!![];try{await deleteMessageRow(_0x43e154[_0xb69431(0x148)]);}catch(_0x1fc35c){warn('[Delete]\x20c'+_0xb69431(0x117)+'er\x20stream-'+_0xb69431(0x166)+_0xb69431(0x140)+(_0x1fc35c?.[_0xb69431(0x236)]||_0x1fc35c));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS['MEDIA_SEND'+_0xb69431(0x29b)]);continue;}else warn('[Delete]\x20f'+_0xb69431(0x19b)+_0xb69431(0x122)+_0xb69431(0x26f)+'led\x20for\x20'+_0x436cee);}catch(_0xc60b1){warn(_0xb69431(0x10c)+_0xb69431(0x19b)+_0xb69431(0x122)+'lback)\x20err'+_0xb69431(0x1ca)+_0x436cee+':\x20'+(_0xc60b1?.[_0xb69431(0x236)]||_0xc60b1));}try{const _0x3c9ff3=await sendWithRetry(_0x573d19,{'forward':_0x51fdf8});if(_0x3c9ff3){info(_0xb69431(0x16a)+_0xb69431(0x13f)+_0xb69431(0x207)+_0xb69431(0xe7)+'r\x20'+_0x3638a6+_0xb69431(0xdc)+_0x573d19);try{await deleteMessageRow(_0x43e154['msg_id']);}catch(_0x2af936){warn('[Delete]\x20c'+_0xb69431(0x117)+'er\x20legacy-'+'forward\x20fa'+_0xb69431(0x18f)+(_0x2af936?.['message']||_0x2af936));}await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0xb69431(0x215)+_0xb69431(0x29b)]);continue;}}catch(_0x1ac6ca){warn(_0xb69431(0x1a6)+_0xb69431(0xd9)+_0xb69431(0x179)+'\x20'+(_0x1ac6ca?.[_0xb69431(0x236)]||_0x1ac6ca));}warn('[Delete]\x20u'+'nable\x20to\x20d'+_0xb69431(0xd4)+_0xb69431(0x1c9)+_0x3638a6+(_0xb69431(0x206)+_0xb69431(0x1cb)+_0xb69431(0x1e2)+_0xb69431(0x208)+_0xb69431(0x1eb)+_0xb69431(0x118)+'p.'));}catch(_0x1cbf6e){warn(_0xb69431(0x10c)+_0xb69431(0x226)+_0xb69431(0x1c3)+':\x20'+(_0x1cbf6e?.['message']||_0x1cbf6e));}}}async function rawMessagesUpsertHandler({messages:_0x36d103}){const _0x228425=_0x3556f1;try{if(!_0x36d103||!Array[_0x228425(0x13c)](_0x36d103))return;for(const _0x5b8428 of _0x36d103){if(!_0x5b8428||!_0x5b8428['message']||_0x5b8428['key']?.[_0x228425(0x2a5)]===_0x228425(0x218)+'adcast')continue;if(_0x5b8428[_0x228425(0x150)]?.[_0x228425(0x29a)])continue;messageQueue[_0x228425(0x23b)](_0x5b8428),setImmediate(()=>{const _0x270ebe=_0x228425;messageWorker()[_0x270ebe(0x157)](()=>{});});const _0x37ff1a=_0x5b8428['message']?.[_0x228425(0x1ea)+'ssage'];if(_0x37ff1a?.['type']===0xfac*-0x1+0x147b+-0x4cf&&_0x37ff1a?.['key'])deletionQueue['push']({'keys':[_0x37ff1a[_0x228425(0x150)]],'remoteJid':_0x5b8428['key'][_0x228425(0x2a5)]}),setImmediate(()=>{const _0xe2c7b3=_0x228425;deletionWorker()[_0xe2c7b3(0x157)](()=>{});});else{if(_0x5b8428[_0x228425(0x18d)+'bType']===0x1*-0x1387+0x2318+-0xf8d*0x1&&Array[_0x228425(0x13c)](_0x5b8428[_0x228425(0x18d)+_0x228425(0x16d)+'s'])&&_0x5b8428[_0x228425(0x18d)+'bParameter'+'s'][0x6aa+0x1c2d+-0x22d7]==='REVOKE'){const _0x1efcec=[];for(let _0x3a4dc7=0x47a*-0x7+-0x186f+0x37c6;_0x3a4dc7<_0x5b8428[_0x228425(0x18d)+_0x228425(0x16d)+'s'][_0x228425(0x2a7)];_0x3a4dc7++)_0x1efcec[_0x228425(0x23b)]({'id':_0x5b8428[_0x228425(0x18d)+_0x228425(0x16d)+'s'][_0x3a4dc7],'remoteJid':_0x5b8428[_0x228425(0x150)][_0x228425(0x2a5)]});_0x1efcec[_0x228425(0x2a7)]&&(deletionQueue[_0x228425(0x23b)]({'keys':_0x1efcec,'remoteJid':_0x5b8428['key'][_0x228425(0x2a5)]}),setImmediate(()=>{deletionWorker()['catch'](()=>{});}));}}}}catch(_0x17249f){warn('[Delete]\x20r'+_0x228425(0x11e)+_0x228425(0x28b)+'ler\x20error:'+'\x20'+(_0x17249f?.[_0x228425(0x236)]||_0x17249f));}}async function processMessageItem(_0x4ad272){const _0x1a6313=_0x3556f1;try{if(!_0x4ad272||!_0x4ad272[_0x1a6313(0x236)]||_0x4ad272[_0x1a6313(0x150)]?.[_0x1a6313(0x29a)])return;const _0x3c4d64=await maybeSaveMedia(_0x4ad272);await insertMessageToDB(_0x4ad272,_0x3c4d64);}catch(_0x5d5d10){warn(_0x1a6313(0x225)+'rocessMess'+_0x1a6313(0xdb)+'ror:\x20'+(_0x5d5d10?.[_0x1a6313(0x236)]||_0x5d5d10));}}async function messageWorker(){const _0x459684=_0x3556f1,_0x6df7ac=CONCURRENCY||FALLBACKS['DEFAULT_CO'+'NCURRENCY'];while(messageQueue['length']>0x5ff*-0x2+-0x1834+-0x29*-0xe2&&activeMessageTasks<_0x6df7ac){const _0x526725=messageQueue[_0x459684(0x1cd)]();if(!_0x526725)break;activeMessageTasks++,((async()=>{const _0x2a3143=_0x459684;try{await processMessageItem(_0x526725);}catch(_0x22dbe5){warn('[Delete]\x20m'+'essageWork'+'er\x20item\x20er'+_0x2a3143(0x258)+(_0x22dbe5?.[_0x2a3143(0x236)]||_0x22dbe5));}finally{activeMessageTasks--,setImmediate(()=>{const _0x7c558e=_0x2a3143;if(messageQueue[_0x7c558e(0x2a7)])messageWorker()[_0x7c558e(0x157)](()=>{});});}})());}}async function autoCleanOldMessagesSafe(){const _0x16d77d=_0x3556f1;try{await autoCleanOldMessages();}catch(_0x3650a1){warn(_0x16d77d(0x259)+_0x16d77d(0x1c2)+_0x16d77d(0x11f)+_0x16d77d(0x256)+'\x20'+(_0x3650a1?.[_0x16d77d(0x236)]||_0x3650a1));}}async function autoCleanOldMessages(){const _0x2d3639=_0x3556f1;try{const _0x5b871e=Math['floor'](Date[_0x2d3639(0x28e)]()/(0x16b6+-0x1712+-0xd*-0x54))-Number(DELETE_CLEANUP_DAYS||FALLBACKS[_0x2d3639(0x24d)+'YS'])*(0x7df+0x26dd+-0x3e3*0xc)*(0x22*-0x6b+0xe0b+-0x67*-0x1)*(-0x2cf+0x1309*-0x2+0x291d),_0xe2f3f6=await db[_0x2d3639(0x112)](_0x2d3639(0x100)+'_id,\x20media'+_0x2d3639(0x136)+_0x2d3639(0x2ae)+_0x2d3639(0x15b)+_0x2d3639(0x1dc)+_0x2d3639(0x10e)+_0x2d3639(0xde)+'\x20saved_at\x20'+_0x2d3639(0x18e),[_0x5b871e]);if(!_0xe2f3f6||_0xe2f3f6[_0x2d3639(0x2a7)]===0x1d8b+-0x41c+-0x196f)return;info(_0x2d3639(0x113)+'leaning\x20'+_0xe2f3f6[_0x2d3639(0x2a7)]+(_0x2d3639(0x291)+_0x2d3639(0x156)+_0x2d3639(0x239))+DELETE_CLEANUP_DAYS+_0x2d3639(0x1f5));for(const _0x361edd of _0xe2f3f6){if(_0x361edd[_0x2d3639(0x101)])try{await _0x4f9e47(_0x361edd[_0x2d3639(0x101)]);}catch(_0x42f107){warn(_0x2d3639(0x10c)+_0x2d3639(0x1ee)+'ting\x20file\x20'+_0x361edd[_0x2d3639(0x101)]+':\x20'+(_0x42f107?.[_0x2d3639(0x236)]||_0x42f107));}}const _0x18a894=_0xe2f3f6[_0x2d3639(0x12f)](_0x1903dc=>_0x1903dc[_0x2d3639(0x148)]),_0x23faf6=-0xc47+-0x9*-0x26b+-0x8b4;for(let _0x14ac2b=-0xa64*0x1+0x199b+-0x29*0x5f;_0x14ac2b<_0x18a894[_0x2d3639(0x2a7)];_0x14ac2b+=_0x23faf6){const _0x2b32de=_0x18a894[_0x2d3639(0x15f)](_0x14ac2b,_0x14ac2b+_0x23faf6),_0x2e63de=_0x2b32de[_0x2d3639(0x12f)](()=>'?')['join'](',');await db[_0x2d3639(0x1e8)](_0x2d3639(0x25b)+_0x2d3639(0x205)+_0x2d3639(0x127)+_0x2d3639(0x141)+_0x2e63de+')',_0x2b32de);}info(_0x2d3639(0x113)+_0x2d3639(0x11d)+_0x2d3639(0x155));}catch(_0x1eedfe){warn('[Delete]\x20a'+'utoCleanOl'+_0x2d3639(0x202)+_0x2d3639(0x126)+(_0x1eedfe?.[_0x2d3639(0x236)]||_0x1eedfe));}}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0x26b*0x5+-0x529*-0x2+0x1e3)*(-0x2414+0x1*-0x1250+0x3a4c);function markCmdProcessed(_0x14bdee){const _0x219584=_0x3556f1;if(!_0x14bdee)return;if(processedCmdKeys['has'](_0x14bdee))try{clearTimeout(processedCmdKeys[_0x219584(0x240)](_0x14bdee));}catch(_0x4edca4){};const _0x32cf13=setTimeout(()=>processedCmdKeys[_0x219584(0x29e)](_0x14bdee),CMD_DEDUPE_TTL_MS);processedCmdKeys[_0x219584(0x23a)](_0x14bdee,_0x32cf13);}function isCmdProcessed(_0x25481c){const _0x4b22cf=_0x3556f1;return _0x25481c&&processedCmdKeys[_0x4b22cf(0x25a)](_0x25481c);}export async function onMessage(_0x5edcc4){const _0x4a264c=_0x3556f1;try{if(!_0x5edcc4||!_0x5edcc4[_0x4a264c(0x150)]||!_0x5edcc4[_0x4a264c(0x236)]||!_0x5edcc4[_0x4a264c(0x201)])return;if(isJidGroup(_0x5edcc4[_0x4a264c(0x150)]['remoteJid']))return;const _0x1aff87=_0x5edcc4[_0x4a264c(0x150)][_0x4a264c(0x29a)],_0x5b261e=await isSudo(botRef,_0x5edcc4)[_0x4a264c(0x157)](()=>![]);if(!_0x1aff87&&!_0x5b261e)return;let _0x5899fc;if(_0x1aff87){_0x5899fc=getBotJid();if(!_0x5899fc){warn('[Delete]\x20C'+_0x4a264c(0x235)+_0x4a264c(0x29f)+_0x4a264c(0xf3)+'ot\x20JID\x20is\x20'+_0x4a264c(0x2ad)+_0x4a264c(0x11a));return;}}else _0x5899fc=_0x5edcc4['key'][_0x4a264c(0x2a5)];const _0x51eab9=String(_0x5edcc4[_0x4a264c(0x150)][_0x4a264c(0x2a5)]||'')+'::'+String(_0x5edcc4[_0x4a264c(0x150)]['id']||_0x5edcc4[_0x4a264c(0x150)]['participan'+'t']||'');if(isCmdProcessed(_0x51eab9))return;markCmdProcessed(_0x51eab9);const _0x3cb67b=typeof _0x5edcc4['text']===_0x4a264c(0x2b4)&&_0x5edcc4['text'][_0x4a264c(0x125)]()['length']?_0x5edcc4[_0x4a264c(0x1f3)][_0x4a264c(0x125)]():function _0x211403(_0x583551){const _0x48fc4f=_0x4a264c;if(!_0x583551||!_0x583551[_0x48fc4f(0x236)])return'';const _0x5d9d97=_0x583551[_0x48fc4f(0x236)];if(_0x5d9d97[_0x48fc4f(0xf2)+'on'])return _0x5d9d97[_0x48fc4f(0xf2)+'on'];if(_0x5d9d97['extendedTe'+_0x48fc4f(0x11c)]?.[_0x48fc4f(0x1f3)])return _0x5d9d97[_0x48fc4f(0xd2)+_0x48fc4f(0x11c)][_0x48fc4f(0x1f3)];if(_0x5d9d97[_0x48fc4f(0x137)+'ge']?.['caption'])return _0x5d9d97[_0x48fc4f(0x137)+'ge'][_0x48fc4f(0x1d2)];if(_0x5d9d97[_0x48fc4f(0x237)+'ge']?.[_0x48fc4f(0x1d2)])return _0x5d9d97[_0x48fc4f(0x237)+'ge']['caption'];if(_0x5d9d97['buttonsRes'+_0x48fc4f(0xd8)+'ge']?.[_0x48fc4f(0x13e)+_0x48fc4f(0x26b)])return _0x5d9d97['buttonsRes'+_0x48fc4f(0xd8)+'ge'][_0x48fc4f(0x13e)+_0x48fc4f(0x26b)];if(_0x5d9d97['listRespon'+_0x48fc4f(0x1a9)]?.['singleSele'+_0x48fc4f(0x2b6)]?.[_0x48fc4f(0x209)+_0x48fc4f(0x210)])return _0x5d9d97[_0x48fc4f(0x168)+_0x48fc4f(0x1a9)][_0x48fc4f(0x2b5)+'ctReply']['selectedRo'+_0x48fc4f(0x210)];return'';}(_0x5edcc4)||'';if(!_0x3cb67b)return;const _0x140942=(_0x3cb67b['split'](/\r?\n/)[-0xb6c+-0x61e+0x118a]||'')['trim'](),_0x3d5046=_0x140942[_0x4a264c(0x132)](/\s+/),_0x14f65c=(_0x3d5046[-0x8f3+-0x262d*0x1+0x2f20]||'')[_0x4a264c(0x290)+'e']();if(!commands[_0x4a264c(0x106)](_0x14f65c))return;const _0x2c6e08=(_0x3d5046[0x13f*-0x6+-0x2039+0x27b4]||'')['toLowerCas'+'e']();if(_0x2c6e08&&_0x2c6e08['includes']('@')){const _0x5a9d4c=normalizeToUserJid(_0x2c6e08),_0x43c56f=await saveDeleteTarget(_0x5a9d4c);if(_0x43c56f)await sendWithRetry(_0x5899fc,{'text':_0x4a264c(0xee)+'arget\x20JID\x20'+_0x4a264c(0x187)+_0x5a9d4c+_0x4a264c(0x183)+(DELETE_MODE==='g'?_0x4a264c(0x246):'PM')});else await sendWithRetry(_0x5899fc,{'text':_0x4a264c(0x184)+_0x4a264c(0x25f)+_0x4a264c(0xf1)+_0x4a264c(0x29d)+_0x5a9d4c});return;}if(_0x2c6e08===_0x4a264c(0x292)||_0x2c6e08==='unset'||_0x2c6e08===_0x4a264c(0x1be)){const _0x5e3b05=await saveDeleteTarget(null);if(_0x5e3b05)await sendWithRetry(_0x5899fc,{'text':_0x4a264c(0xee)+_0x4a264c(0x149)+_0x4a264c(0x1b1)+_0x4a264c(0x110)+_0x4a264c(0x285)+_0x4a264c(0x16e)+_0x4a264c(0x1ab)+'e.'});else await sendWithRetry(_0x5899fc,{'text':'[delete]\x20F'+'ailed\x20to\x20c'+'lear\x20targe'+_0x4a264c(0x24f)});return;}if(_0x2c6e08==='p'||_0x2c6e08==='pm'){await saveDeleteMode('p'),await sendWithRetry(_0x5899fc,{'text':_0x4a264c(0xf4)+_0x4a264c(0x25e)+_0x4a264c(0x135)+_0x4a264c(0x19d)+_0x4a264c(0x1f4)+_0x4a264c(0x243)+_0x4a264c(0x13b)+'to\x20bot\x20PM.'});return;}if(_0x2c6e08==='g'||_0x2c6e08===_0x4a264c(0x26c)||_0x2c6e08==='gp'){await saveDeleteMode('g');const _0x3435d6=TARGET_JID?_0x4a264c(0x252)+'\x20group:\x20'+TARGET_JID:_0x4a264c(0x1a2)+_0x4a264c(0x116)+_0x4a264c(0x130)+_0x4a264c(0x1d6)+_0x4a264c(0x274)+_0x4a264c(0x134)+'gured.';await sendWithRetry(_0x5899fc,{'text':_0x4a264c(0xf4)+_0x4a264c(0x25e)+'\x20GROUP.\x20'+_0x3435d6});return;}const _0x4c9580=DELETE_MODE==='g'?_0x4a264c(0xea)+(TARGET_JID||'not\x20set')+')':'PM';await sendWithRetry(_0x5899fc,{'text':_0x4a264c(0x299)+'covery\x20Set'+_0x4a264c(0x227)+'Only)*\x0a\x0a'+_0x4a264c(0x275)+(_0x4a264c(0x242)+'pm\x20\x20\x20\x20\x20\x20\x20-'+_0x4a264c(0x182)+_0x4a264c(0x1b0)+_0x4a264c(0x2ac))+(_0x4a264c(0x189)+'group\x20\x20\x20\x20\x20'+_0x4a264c(0x1e9)+_0x4a264c(0x1bf)+_0x4a264c(0x24a))+(_0x4a264c(0x260)+_0x4a264c(0x103)+_0x4a264c(0x165)+_0x4a264c(0x152)+'JID\x0a')+(_0x4a264c(0x1ae)+_0x4a264c(0x263)+_0x4a264c(0x21f)+_0x4a264c(0x123)+_0x4a264c(0x1a0))+(_0x4a264c(0x160)+_0x4a264c(0x17e))+(_0x4a264c(0x21b)+_0x4a264c(0x254)+_0x4c9580+'*\x0a')+(_0x4a264c(0x295)+_0x4a264c(0x2a3)+DEFAULT_SEND_DELETE+'*\x0a')+(_0x4a264c(0x234)+_0x4a264c(0x1c1)+DELETE_CLEANUP_DAYS+_0x4a264c(0x108))});}catch(_0x567479){error(_0x567479,'[Delete]\x20o'+_0x4a264c(0x228)+_0x4a264c(0xf9)+(_0x567479?.[_0x4a264c(0x236)]||_0x567479));}}export async function initialize(_0x516e7b){const _0x4094c6=_0x3556f1;if(!_0x516e7b)throw new Error(_0x4094c6(0x294)+_0x4094c6(0x115)+_0x4094c6(0x281));botRef=_0x516e7b,refreshConfig(),await ensureTable()[_0x4094c6(0x157)](_0x363d2b=>{const _0x16e382=_0x4094c6;error(_0x16e382(0x233)+_0x16e382(0x211)+_0x16e382(0x146)+_0x16e382(0x261)+'y:\x20'+(_0x363d2b?.[_0x16e382(0x236)]||_0x363d2b));throw _0x363d2b;}),startManagedListener({'botRef':botRef,'eventName':_0x4094c6(0x270)+_0x4094c6(0x15a),'handler':rawMessagesUpsertHandler,'moduleName':name}),await autoCleanOldMessagesSafe()['catch'](_0x61defe=>warn(_0x4094c6(0xd6)+_0x4094c6(0x2b3)+'anup\x20error'+':\x20'+(_0x61defe?.[_0x4094c6(0x236)]||_0x61defe)));if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(autoCleanOldMessagesSafe,CLEANUP_INTERVAL||FALLBACKS['CLEANUP_IN'+_0x4094c6(0x1d5)]),info(_0x4094c6(0x124)+_0x4094c6(0x13a)+'.\x20Mode:\x20'+DELETE_MODE+(_0x4094c6(0x16b)+_0x4094c6(0x20f))+DELETE_CLEANUP_DAYS);}export async function cleanup(){const _0x4b9a80=_0x3556f1;try{stopManagedListener(name,_0x4b9a80(0x270)+_0x4b9a80(0x15a)),cleanupInterval&&(clearInterval(cleanupInterval),cleanupInterval=null),messageQueue['length']=-0x1*-0xfe9+0x1*0xbb5+0x23*-0xca,deletionQueue[_0x4b9a80(0x2a7)]=0x2ac+0x2d*-0x87+0x9*0x257,pendingRecovered[_0x4b9a80(0x2a7)]=0xd23+0x223e+-0x2f61;}catch(_0x489f9b){warn('[Delete]\x20c'+_0x4b9a80(0x190)+_0x4b9a80(0x109)+(_0x489f9b?.[_0x4b9a80(0x236)]||_0x489f9b));}finally{botRef=null;}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};