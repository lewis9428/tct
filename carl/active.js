const _0x41b2f6=_0x5137;(function(_0x1bfb9e,_0x52b0f4){const _0x4713e2=_0x5137,_0x5d0607=_0x1bfb9e();while(!![]){try{const _0x351388=parseInt(_0x4713e2(0x16e))/(0x8c*0x2+-0x1df6+-0x13*-0x185)*(parseInt(_0x4713e2(0x171))/(0xa24+0xa41+-0x133*0x11))+-parseInt(_0x4713e2(0xff))/(0x242f+-0xd3f+-0x1*0x16ed)*(-parseInt(_0x4713e2(0x164))/(-0x72d*-0x1+0x2fe*0x3+-0x1023))+parseInt(_0x4713e2(0x1a0))/(0x643+0x2519*-0x1+0x1edb)*(-parseInt(_0x4713e2(0x1a1))/(0x1e73*0x1+0x36e*0x3+-0x28b7))+parseInt(_0x4713e2(0x133))/(0xbb5+0x2*-0x1316+-0x2*-0xd3f)*(parseInt(_0x4713e2(0x13c))/(-0x1be3+-0xd69*0x1+0x422*0xa))+parseInt(_0x4713e2(0x1c1))/(0x4f*0x4d+-0x32+0x2f1*-0x8)*(parseInt(_0x4713e2(0x14a))/(-0x11dd+0x1*-0x16bd+0x28a4))+parseInt(_0x4713e2(0x1de))/(0x1190+0x24*-0x1d+0x1*-0xd71)*(parseInt(_0x4713e2(0xe3))/(-0x2ab*-0x4+0x65*-0x5b+-0x2cf*-0x9))+-parseInt(_0x4713e2(0x134))/(-0x47*0xa+0x1496*0x1+-0x11c3*0x1);if(_0x351388===_0x52b0f4)break;else _0x5d0607['push'](_0x5d0607['shift']());}catch(_0x3e0c24){_0x5d0607['push'](_0x5d0607['shift']());}}}(_0x2be2,-0x13cd6*0x15+-0x13ec7e+0x3b994d));import{DateTime}from'luxon';import{db}from'../utils/database.js';import{info,warn,error}from'../utils/logger.js';import{isadmin}from'../utils/isadmin.js';import{getConfig}from'../utils/config.js';import{getBotJid}from'../utils/bot-state.js';export const name='active';export const version='1.1.1';export const priority=-0x1655+0x2*-0x4ef+0xd*0x281;export const commands=[_0x41b2f6(0x200),'inactive'];let botRef=null,sendApi=null;function _0x2be2(){const _0x373450=['fromObject','1OuCYii','e_count\x20=\x20','-\x20\x27daily\x27|','2657594EmDZBs','?,\x20?,\x20?)','remoteJid','nitialize\x20','failed:\x20','rd_message','\x20);\x0a\x20\x20\x20\x20','nt,\x20displa','e\x20members\x20','\x20message_c','length','determine\x20','\x20\x20\x20\x20\x20\x20buck','weekYear','sendMessag','ay_name\x20FR','unt><d|w|m','\x27weekly\x27\x20A','\x20?,\x20last_u','unt\x20+\x20?,\x20d',',\x20user_jid','\x20no\x20messag','ATE\x20TABLE\x20','from','daily\x27\x20AND','e_stats\x20WH','|y>\x0aExampl','TO\x20active_','HERE\x20timef','||weekly||','\x20\x20\x20\x20\x20\x20\x20tim','bucket_key','FROM\x20activ','[active]\x20s','IF\x20NOT\x20EXI','\x20timeframe','sage_id\x20TE','f\x20ON\x20activ','rackMessag','key\x20=\x20?\x20LI','ucket_key\x20','?,\x20?,\x20\x27wee','<=\x20?','ast_update','chat_jid,\x20','ive_stats\x20','t><d|w|m|y','5EumLvO','7002078lqaBUk','unt,\x20displ','[active]\x20e','e_stats(ch','endsWith','t_key\x20<=\x20?','>\x20\x20OR\x20\x20ina','display_na','user_jid);','catch','unt','frame,\x20buc','MM,\x20yearly','Found\x20','ion\x20INTEGE','join','message_co','ve_stats\x0a\x20','\x20\x20\x20\x20\x20\x20\x20id\x20','members\x20fo','cnt,\x20MAX(l','sock','[active]\x20t','\x20\x20\x20\x20\x20\x20\x20mes','clear','O_WEEK_DAY','SELECT\x20use','cnt','No\x20active\x20','d)\x0a\x20\x20\x20\x20\x20\x20\x20','sage_count','count','424026gOBKZk','Y\x20user_jid','SELECT\x20id,','eframe\x20=\x20\x27','e\x20unexpect','ACTIVE','leaned\x20up','TIME_ZONE','timeframe','OM\x20active_','R\x20PRIMARY\x20','text','ge_count\x20I','st_updated','sourceIds','year','\x20\x20\x20\x20\x20\x20\x20SET','LT\x20(strfti','at_jid,\x20ti','a\x20failed','=\x20?\x20WHERE\x20','MIT\x201','EGER\x20DEFAU','||yearly||','\x0a\x20\x20\x20\x20\x20\x20\x20\x20U','\x20?\x20AND\x20tim','UPDATE\x20act','\x20\x20chat_jid','ted_at\x20INT','1560801NxOMeq','inactive','weekNumber','eframe,\x20bu','red','\x20chat_jid,','cket_key,\x20','D\x20user_jid','nthly\x27','monthly','fromSecond','values','found\x20in\x20t','LE\x20IF\x20NOT\x20','meframe\x20=\x20','\x20\x20\x20\x20\x20\x20disp','setZone','@g.us','INSERT\x20INT','fromMe','_leaderboa','_count,\x20di','slice','=\x20?\x20AND\x20ti','E\x20chat_jid','d)\x20AS\x20last','\x20bucket_ke','imeframe\x20=','\x20\x20\x20VALUES\x20','ata','uildLeader','\x20\x20\x20\x20WHERE\x20','?,\x20?,\x20\x27mon','get','active','end\x20usage\x20','id\x20=\x20?\x20AND','t_updated\x20','isplay_nam','ctive\x20<amo','object','O_MONTH_DA','\x20\x20\x20\x20','AUTOINCREM','ROLLOVER_T','\x20user_jid\x20','tats\x20(chat','ount\x20=\x20mes','run','ive_stats(',';\x0a\x20\x20\x20\x20','ser\x20ON\x20act','AND\x20bucket','\x27monthly\x27\x20','[active]\x20b','groupMetad','XT\x0a\x20\x20\x20\x20\x20\x20)','\x20\x20\x20\x20\x20UNIQU','?,\x20?,\x20\x27yea','CREATE\x20TAB',':\x0a\x0a','r_jid,\x20tim','ve_stats\x20W','yyyy-LL-dd','elete\x20old\x20','\x201d,\x20activ','\x20user_jid,','chema\x20ensu','isCommand',',\x20?,\x20?)','ARY\x20KEY,\x0a\x20','\x20id\x20IN\x20(','string','_jid,\x20user','M\x20active_s','last_ts','e\x20=\x20?,\x20las','eekly:\x20YYY','id\x20=\x20?','es\x0a\x0a','toLowerCas','rame\x20=\x20\x27mo','\x20\x20\x20chat_ji','\x27,\x27yearly\x27','es:\x20active','.ACTIVE:\x20','ailed:\x20','amount','nsureSchem','132vSDejb','\x27yearly\x27\x20A','all','toFormat','e,\x20bucket_','pushName','nMessage\x20f','delete','\x20FROM\x20acti','ive\x20<amoun','ERE\x20chat_j','\x20AND\x20bucke','\x20messages\x0a','set','y_name,\x20la','O\x20active_s','ats_chat_u','[active]\x20i','ðŸ‘¤\x20@',',\x20?,\x20?)\x0a\x20\x20','EX\x20IF\x20NOT\x20','\x20active\x20us','_active_st','UTC','CREATE\x20IND','\x0a\x20\x20\x20\x20\x20\x20SEL','exec','key','55785KvuyRb','ket_key,\x20m','y,\x20message','\x20TEXT\x20PRIM','[active]\x20g','\x27weekly\x27|\x27','failed\x20for','minus','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','padStart','toSeconds','IMIT\x201','\x27,\x27monthly','unit','HERE\x20chat_',')\x20VALUES\x20(','tats\x20WHERE','NTEGER\x20DEF','me(\x27%s\x27,\x27n','\x20\x27daily\x27\x20A','und\x20in\x20the','T\x20NOT\x20NULL','t_jid,\x20use','push','O_YEAR_DAY','ily\x27\x20AND\x20b','user_jid','meframe,\x20b','DELETE\x20FRO','e\x201w,\x20inac','e\x20DB\x20error','_MS','splay_name','he\x20last\x20','trim','split','et_key\x20TEX','key)\x0a\x20\x20\x20\x20\x20','ticipants\x20','\x0a\x20\x20\x20\x20\x20\x20CRE','\x20=\x20\x27daily\x27','has','\x20last\x20','y\x20>=\x20?\x0a\x20\x20\x20','jid\x20TEXT\x20N','\x20=\x20?\x20AND\x20t','STS\x20active','MAX_DAILY_','\x20failed:\x20','plete','\x20INSERT\x20IN','ND\x20bucket_','40152pkHCXw','32228378otmpha','group\x20part','EXISTS\x20act','jid\x20=\x20?\x20AN','message','lay_name\x20T','filter','members\x20in','200xOFpPj','daily:\x20YYY','DEDUPE_TTL','lay_name\x20=','ive_migrat','isArray','[active]\x20p','daily\x20rows','chat_jid\x20=','r:\x20','[active]\x20f','thly\x27,\x20?,\x20','SET\x20messag','EXT\x20DEFAUL','60tDRcsG','PDATE\x20acti','USERS_LIMI','match','_jid,\x20time','ead\x20config','floor','Y-MM-DD,\x20w','\x20\x20\x20\x20last_u','_ts\x0a\x20\x20\x20\x20\x20\x20','board\x20erro','chat_jid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20W','id,\x20displa','ups\x20failed','[active]\x20o',',\x20\x20\x20\x20\x20\x20--\x20','function','participan','\x20\x20\x20\x20\x20\x20','EXISTS\x20idx','key\x20=\x20?\x0a\x20\x20','essage_cou','ow\x27)),\x0a\x20\x20\x20','map','stats\x20WHER','264sxnDVH','[active]\x20c','ay_name,\x20l','\x20inactive\x20','icipants.','_stats\x20(\x0a\x20','pdated\x20INT','now','N\x20(\x27weekly'];_0x2be2=function(){return _0x373450;};return _0x2be2();}const DEFAULTS={'TIME_ZONE':_0x41b2f6(0xfa),'MAX_DAILY_KEEP_DAYS':0x5a,'ROLLOVER_TO_WEEK_DAYS':0x7,'ROLLOVER_TO_MONTH_DAYS':0x1e,'ROLLOVER_TO_YEAR_DAYS':0x16d,'USERS_LIMIT_RETURN':0xc8,'DEDUPE_TTL_MS':(0x2f*-0x9f+-0x16*-0x1c+0x1ae7)*(-0x1*-0x1591+-0x1a22+-0x2d3*-0x3)};let CONFIG={...DEFAULTS};function normalizeJid(_0x573c35){return _0x573c35?String(_0x573c35)['trim']():'';}function sleep(_0x3d1c10){return new Promise(_0x1a4744=>setTimeout(_0x1a4744,_0x3d1c10));}function toLowerRoman(_0x40d672){const _0x1db3fb=_0x41b2f6,_0x465f34=[[0x586+-0x5a8+0x40a,'M'],[0x1b7d*0x1+0x1*0x19b1+0x3d2*-0xd,'CM'],[-0xc1+-0x1ef5+0x21aa,'D'],[-0x1*-0x193+0x1*-0x1149+0x1146,'CD'],[-0xabd*0x2+0x1d92+-0x11*0x74,'C'],[0xfa4+0x2*0x38f+-0x1668,'XC'],[-0x1179+-0x2230+0x1*0x33db,'L'],[0x3fb*-0x3+0x469*0x1+0x7b0,'XL'],[0x125d+-0x2354+0x1101,'X'],[-0x2*-0x183+-0x6*-0x5b4+-0x2535,'IX'],[-0xe*-0xef+-0x21f5*0x1+-0x8*-0x29d,'V'],[0xc2b*0x2+0x767+-0x1*0x1fb9,'IV'],[0x1d93+-0xdf4+0x2*-0x7cf,'I']];let _0x4a5bdc=_0x40d672,_0x1b9b2c='';for(const [_0x5f3441,_0x5a94bd]of _0x465f34)while(_0x4a5bdc>=_0x5f3441){_0x1b9b2c+=_0x5a94bd,_0x4a5bdc-=_0x5f3441;}return _0x1b9b2c[_0x1db3fb(0xda)+'e']();}function romanParen(_0x52cf33){return'('+toLowerRoman(_0x52cf33)+')';}const processedMessageKeys=new Map();function makeDedupeKey(_0x3140d0){const _0x138826=_0x41b2f6,_0x397159=_0x3140d0?.[_0x138826(0xfe)];if(!_0x397159)return null;const _0x6704f7=_0x397159['id']||_0x397159[_0x138826(0x15c)+'t']||'',_0xb11c36=_0x397159[_0x138826(0x173)]||'';return _0xb11c36+'::'+_0x6704f7;}function isMsgProcessed(_0x1296e9){const _0x4c7920=_0x41b2f6;return _0x1296e9&&processedMessageKeys[_0x4c7920(0x128)](_0x1296e9);}function markMsgProcessed(_0x5bda2c){const _0x26de54=_0x41b2f6;if(!_0x5bda2c)return;if(processedMessageKeys['has'](_0x5bda2c))clearTimeout(processedMessageKeys[_0x26de54(0x1ff)](_0x5bda2c));const _0xa75917=setTimeout(()=>processedMessageKeys[_0x26de54(0xea)](_0x5bda2c),CONFIG[_0x26de54(0x13e)+_0x26de54(0x11e)]);processedMessageKeys[_0x26de54(0xf0)](_0x5bda2c,_0xa75917);}async function ensureSchema(){const _0x289d88=_0x41b2f6;try{await db['exec'](_0x289d88(0xc5)+_0x289d88(0x1eb)+_0x289d88(0x136)+_0x289d88(0x140)+'ions\x20(vers'+_0x289d88(0x1af)+_0x289d88(0x1cb)+'KEY,\x20migra'+_0x289d88(0x1dd)+_0x289d88(0x1d7)+_0x289d88(0x1d2)+_0x289d88(0x111)+'ow\x27)));'),await db['exec'](_0x289d88(0x126)+_0x289d88(0x187)+'IF\x20NOT\x20EXI'+_0x289d88(0x12d)+_0x289d88(0x169)+_0x289d88(0x1b3)+'INTEGER\x20PR'+'IMARY\x20KEY\x20'+_0x289d88(0x209)+'ENT,\x0a\x20\x20\x20\x20\x20'+_0x289d88(0xdc)+'d\x20TEXT\x20NOT'+'\x20NULL,\x0a\x20\x20\x20'+'\x20\x20\x20\x20\x20user_'+_0x289d88(0x12b)+'OT\x20NULL,\x0a\x20'+_0x289d88(0x18f)+'eframe\x20TEX'+'T\x20NOT\x20NULL'+',\x20\x20\x20\x20\x20\x20\x20\x20-'+_0x289d88(0x170)+_0x289d88(0x104)+'monthly\x27|\x27'+'yearly\x27\x0a\x20\x20'+_0x289d88(0x17d)+_0x289d88(0x123)+_0x289d88(0x114)+_0x289d88(0x15a)+_0x289d88(0x13d)+_0x289d88(0x151)+_0x289d88(0xd7)+'Y-WW,\x20mont'+'hly:\x20YYYY-'+_0x289d88(0x1ad)+':\x20YYYY\x0a\x20\x20\x20'+'\x20\x20\x20\x20\x20messa'+_0x289d88(0x1cd)+_0x289d88(0x110)+'AULT\x200,\x0a\x20\x20'+_0x289d88(0x1ed)+_0x289d88(0x139)+_0x289d88(0x149)+'T\x20\x27\x27,\x0a\x20\x20\x20\x20'+_0x289d88(0x152)+_0x289d88(0x16a)+_0x289d88(0x1d7)+_0x289d88(0x1d2)+_0x289d88(0x111)+_0x289d88(0x161)+_0x289d88(0xc3)+'E(chat_jid'+_0x289d88(0x185)+',\x20timefram'+_0x289d88(0xe7)+_0x289d88(0x124)+_0x289d88(0x177)),await db[_0x289d88(0xfd)](_0x289d88(0xfb)+'EX\x20IF\x20NOT\x20'+_0x289d88(0x15e)+_0x289d88(0xf9)+'ats_chat_t'+_0x289d88(0x196)+_0x289d88(0x1a4)+_0x289d88(0x1d3)+_0x289d88(0x11a)+'ucket_key)'+';'),await db[_0x289d88(0xfd)](_0x289d88(0xfb)+_0x289d88(0xf7)+_0x289d88(0x15e)+'_active_st'+_0x289d88(0xf3)+_0x289d88(0x211)+_0x289d88(0x20f)+_0x289d88(0x19d)+_0x289d88(0x1a9)),await db[_0x289d88(0xfd)]('\x0a\x20\x20\x20\x20\x20\x20CRE'+'ATE\x20TABLE\x20'+_0x289d88(0x193)+_0x289d88(0x12d)+_0x289d88(0x1f2)+_0x289d88(0x176)+'s\x20(\x0a\x20\x20\x20\x20\x20\x20'+_0x289d88(0x1dc)+_0x289d88(0x102)+_0x289d88(0xd0)+_0x289d88(0x1b8)+_0x289d88(0x195)+_0x289d88(0xc2)+_0x289d88(0x210)),info(_0x289d88(0x192)+_0x289d88(0xcd)+_0x289d88(0x1e2));}catch(_0x5d939b){error(_0x5d939b,_0x289d88(0x1a3)+_0x289d88(0xe2)+_0x289d88(0x1d4));throw _0x5d939b;}}export async function trackMessage(_0x2123bb){const _0x418e14=_0x41b2f6;try{if(!_0x2123bb||!_0x2123bb['key']||!_0x2123bb[_0x418e14(0x138)])return;const _0x45113c=makeDedupeKey(_0x2123bb);if(!_0x45113c)return;if(isMsgProcessed(_0x45113c))return;markMsgProcessed(_0x45113c);if(_0x2123bb['key'][_0x418e14(0x1f1)])return;const _0x477d0c=_0x2123bb[_0x418e14(0xfe)]['remoteJid'];if(!_0x477d0c||!_0x477d0c[_0x418e14(0x1a5)](_0x418e14(0x1ef)))return;const _0x59b9a0=_0x2123bb[_0x418e14(0xfe)][_0x418e14(0x15c)+'t']||_0x2123bb['key']['from']||'';if(!_0x59b9a0)return;const _0x50ffee=normalizeJid(_0x59b9a0),_0x1f8bf0=DateTime['now']()[_0x418e14(0x1ee)](CONFIG[_0x418e14(0x1c8)]),_0x791cd2=_0x1f8bf0[_0x418e14(0xe6)](_0x418e14(0xc9));try{const _0x47d75f=await db['run'](_0x418e14(0x1d9)+_0x418e14(0x14b)+_0x418e14(0x1b2)+_0x418e14(0x1d1)+_0x418e14(0x17a)+_0x418e14(0x20d)+_0x418e14(0x1bf)+'\x20+\x201,\x20disp'+_0x418e14(0x13f)+_0x418e14(0x183)+'pdated\x20=\x20?'+_0x418e14(0x156)+_0x418e14(0x10d)+_0x418e14(0x137)+_0x418e14(0x1e5)+_0x418e14(0x12c)+_0x418e14(0x1f9)+_0x418e14(0x112)+_0x418e14(0x132)+_0x418e14(0x15f)+_0x418e14(0x208),[_0x2123bb[_0x418e14(0xe8)]||_0x2123bb['senderName']||'',Math[_0x418e14(0x150)](_0x1f8bf0[_0x418e14(0x109)]()),_0x477d0c,_0x50ffee,_0x791cd2]);(!_0x47d75f||!_0x47d75f['changes'])&&await db[_0x418e14(0x20e)](_0x418e14(0x107)+_0x418e14(0x131)+_0x418e14(0x18c)+'stats\x20(cha'+_0x418e14(0x115)+_0x418e14(0xc7)+_0x418e14(0x1e1)+_0x418e14(0x1e4)+_0x418e14(0x1b1)+_0x418e14(0x1a2)+_0x418e14(0x166)+_0x418e14(0x19c)+_0x418e14(0x1be)+_0x418e14(0x1fa)+'(?,\x20?,\x20\x27da'+'ily\x27,\x20?,\x201'+_0x418e14(0xf6)+_0x418e14(0x15d),[_0x477d0c,_0x50ffee,_0x791cd2,_0x2123bb['pushName']||_0x2123bb['senderName']||'',Math[_0x418e14(0x150)](_0x1f8bf0['toSeconds']())]);}catch(_0x139b6d){warn(_0x418e14(0x1b7)+_0x418e14(0x197)+_0x418e14(0x11d)+':\x20'+(_0x139b6d?.[_0x418e14(0x138)]||_0x139b6d));}}catch(_0x50620b){warn(_0x418e14(0x1b7)+_0x418e14(0x197)+_0x418e14(0x1c5)+'ed:\x20'+(_0x50620b?.[_0x418e14(0x138)]||_0x50620b));}}async function performRollups(){const _0xedf249=_0x41b2f6;try{const _0x227f26=DateTime['now']()[_0xedf249(0x1ee)](CONFIG['TIME_ZONE']),_0x4a8a53=_0x227f26[_0xedf249(0x106)]({'days':CONFIG[_0xedf249(0x20a)+_0xedf249(0x1ba)+'S']})['startOf']('day'),_0x27e55d=_0x4a8a53[_0xedf249(0xe6)]('yyyy-LL-dd'),_0x11aa3c=await db[_0xedf249(0xe5)]('SELECT\x20id,'+'\x20chat_jid,'+_0xedf249(0xcc)+_0xedf249(0x1f8)+_0xedf249(0x101)+_0xedf249(0x1f3)+_0xedf249(0x11f)+_0xedf249(0xeb)+_0xedf249(0xc8)+_0xedf249(0x18d)+'rame\x20=\x20\x27da'+_0xedf249(0x118)+_0xedf249(0x199)+_0xedf249(0x19b),[_0x27e55d]);if(_0x11aa3c&&_0x11aa3c[_0xedf249(0x17b)]){const _0x1302e3=new Map();for(const _0x3c8a4f of _0x11aa3c){const _0x128167=DateTime['fromFormat'](_0x3c8a4f[_0xedf249(0x190)],_0xedf249(0xc9),{'zone':CONFIG['TIME_ZONE']}),_0x377c12=_0x128167[_0xedf249(0x17e)]+'-'+String(_0x128167[_0xedf249(0x1e0)])[_0xedf249(0x108)](0x1*-0x1387+-0x1*-0x159+0x2*0x918,'0'),_0x2485b1=_0x3c8a4f[_0xedf249(0x155)]+'||'+_0x3c8a4f['user_jid']+_0xedf249(0x18e)+_0x377c12;if(!_0x1302e3['has'](_0x2485b1))_0x1302e3['set'](_0x2485b1,{'chat_jid':_0x3c8a4f[_0xedf249(0x155)],'user_jid':_0x3c8a4f['user_jid'],'timeframe':'weekly','bucket_key':_0x377c12,'message_count':0x0,'display_name':_0x3c8a4f[_0xedf249(0x1a8)+'me']||''});const _0x268fc4=_0x1302e3['get'](_0x2485b1);_0x268fc4[_0xedf249(0x1b1)+_0xedf249(0x1ab)]+=Number(_0x3c8a4f[_0xedf249(0x1b1)+_0xedf249(0x1ab)]||0x2*0x31+-0x2d*-0x6f+-0x13e5);}for(const _0x20f96c of _0x1302e3[_0xedf249(0x1e9)]()){const _0x1e5fdb=await db['get']('SELECT\x20id\x20'+_0xedf249(0x191)+_0xedf249(0x18a)+_0xedf249(0xed)+_0xedf249(0x202)+_0xedf249(0x20b)+_0xedf249(0x1f5)+'meframe\x20=\x20'+_0xedf249(0x182)+'ND\x20bucket_'+_0xedf249(0x198)+_0xedf249(0x1d6),[_0x20f96c[_0xedf249(0x155)],_0x20f96c[_0xedf249(0x119)],_0x20f96c['bucket_key']]);!_0x1e5fdb?await db['run'](_0xedf249(0x1f0)+'O\x20active_s'+_0xedf249(0x20c)+_0xedf249(0xd3)+_0xedf249(0x14e)+_0xedf249(0x1ac)+_0xedf249(0x100)+_0xedf249(0x160)+_0xedf249(0x178)+_0xedf249(0xf1)+'st_updated'+')\x20VALUES\x20('+_0xedf249(0x19a)+'kly\x27,\x20?,\x20?'+_0xedf249(0xcf),[_0x20f96c[_0xedf249(0x155)],_0x20f96c[_0xedf249(0x119)],_0x20f96c[_0xedf249(0x190)],_0x20f96c[_0xedf249(0x1b1)+'unt'],_0x20f96c['display_na'+'me']||'',Math[_0xedf249(0x150)](_0x227f26[_0xedf249(0x109)]())]):await db[_0xedf249(0x20e)](_0xedf249(0x1db)+_0xedf249(0x19e)+_0xedf249(0x148)+_0xedf249(0x16f)+_0xedf249(0x1b1)+_0xedf249(0x184)+'isplay_nam'+_0xedf249(0xd6)+_0xedf249(0x203)+_0xedf249(0x1d5)+'id\x20=\x20?',[_0x20f96c['message_co'+'unt'],_0x20f96c[_0xedf249(0x1a8)+'me']||'',Math[_0xedf249(0x150)](_0x227f26[_0xedf249(0x109)]()),_0x1e5fdb['id']]);}try{const _0x4d6d16=_0x11aa3c[_0xedf249(0x162)](_0x3af3a9=>_0x3af3a9['id']);for(let _0x19d027=-0x1*-0x1cbd+-0xc7*0x31+0x95a;_0x19d027<_0x4d6d16[_0xedf249(0x17b)];_0x19d027+=-0x1faf+0x1109+0x109a){const _0x26525f=_0x4d6d16[_0xedf249(0x1f4)](_0x19d027,_0x19d027+(-0x1*-0x55b+-0x9c8+0x661)),_0x49f00d=_0xedf249(0x11b)+_0xedf249(0xd4)+_0xedf249(0x10f)+_0xedf249(0xd1)+_0x26525f[_0xedf249(0x162)](()=>'?')[_0xedf249(0x1b0)](',')+')';await db[_0xedf249(0x20e)](_0x49f00d,_0x26525f);}}catch(_0x2cf0ef){warn('[active]\x20d'+_0xedf249(0xca)+_0xedf249(0x143)+_0xedf249(0x12f)+(_0x2cf0ef?.[_0xedf249(0x138)]||_0x2cf0ef));}}const _0xa15289=_0x227f26[_0xedf249(0x106)]({'days':CONFIG[_0xedf249(0x20a)+_0xedf249(0x207)+'YS']})[_0xedf249(0x109)](),_0x3c3529=await db[_0xedf249(0xe5)](_0xedf249(0x1c3)+_0xedf249(0x1e3)+_0xedf249(0xcc)+_0xedf249(0x1f8)+_0xedf249(0x101)+_0xedf249(0x1f3)+'splay_name'+_0xedf249(0xeb)+_0xedf249(0xc8)+_0xedf249(0x18d)+'rame\x20=\x20\x27we'+'ekly\x27');if(_0x3c3529&&_0x3c3529[_0xedf249(0x17b)]){const _0x4017a5=new Map();for(const _0x404640 of _0x3c3529){const _0x5ccc44=String(_0x404640[_0xedf249(0x190)]||'')['split']('-'),_0x5cfa6d=Number(_0x5ccc44[-0x1*0x1b52+0x1*0x160f+0x1*0x543])||0x282+0x2284+-0x1d54,_0x562778=Number(_0x5ccc44[0x1b8*0xb+-0x210a+0x149*0xb])||-0x263*0xf+0x1*-0xbb4+0x2f82,_0xcede05=DateTime['fromObject']({'weekYear':_0x5cfa6d,'weekNumber':_0x562778,'weekday':0x1,'zone':CONFIG[_0xedf249(0x1c8)]});if(_0xcede05['toSeconds']()>_0xa15289)continue;const _0x4dc47f=_0xcede05[_0xedf249(0x1d0)]+'-'+String(_0xcede05['month'])[_0xedf249(0x108)](0x2012+0x20a7+-0x40b7*0x1,'0'),_0x20549c=_0x404640[_0xedf249(0x155)]+'||'+_0x404640[_0xedf249(0x119)]+('||monthly|'+'|')+_0x4dc47f;if(!_0x4017a5[_0xedf249(0x128)](_0x20549c))_0x4017a5[_0xedf249(0xf0)](_0x20549c,{'chat_jid':_0x404640['chat_jid'],'user_jid':_0x404640[_0xedf249(0x119)],'timeframe':_0xedf249(0x1e7),'bucket_key':_0x4dc47f,'message_count':0x0,'display_name':_0x404640[_0xedf249(0x1a8)+'me']||'','sourceIds':[]});const _0x5ef559=_0x4017a5[_0xedf249(0x1ff)](_0x20549c);_0x5ef559[_0xedf249(0x1b1)+_0xedf249(0x1ab)]+=Number(_0x404640['message_co'+'unt']||-0x1bd*0xc+-0x1*0x16+-0x17f*-0xe),_0x5ef559[_0xedf249(0x1cf)][_0xedf249(0x116)](_0x404640['id']);}for(const _0x4a457b of _0x4017a5[_0xedf249(0x1e9)]()){const _0x10f78d=await db['get']('SELECT\x20id\x20'+_0xedf249(0x191)+_0xedf249(0x18a)+_0xedf249(0xed)+_0xedf249(0x202)+_0xedf249(0x20b)+_0xedf249(0x1f5)+_0xedf249(0x1ec)+_0xedf249(0xbf)+_0xedf249(0xbe)+'_key\x20=\x20?\x20L'+_0xedf249(0x10a),[_0x4a457b[_0xedf249(0x155)],_0x4a457b[_0xedf249(0x119)],_0x4a457b[_0xedf249(0x190)]]);!_0x10f78d?await db[_0xedf249(0x20e)]('INSERT\x20INT'+_0xedf249(0xf2)+'tats\x20(chat'+_0xedf249(0xd3)+'_jid,\x20time'+_0xedf249(0x1ac)+'ket_key,\x20m'+_0xedf249(0x160)+_0xedf249(0x178)+'y_name,\x20la'+_0xedf249(0x1ce)+_0xedf249(0x10e)+_0xedf249(0x1fe)+_0xedf249(0x147)+_0xedf249(0x172),[_0x4a457b[_0xedf249(0x155)],_0x4a457b[_0xedf249(0x119)],_0x4a457b[_0xedf249(0x190)],_0x4a457b[_0xedf249(0x1b1)+'unt'],_0x4a457b[_0xedf249(0x1a8)+'me']||'',Math[_0xedf249(0x150)](_0x227f26[_0xedf249(0x109)]())]):await db[_0xedf249(0x20e)](_0xedf249(0x1db)+'ive_stats\x20'+_0xedf249(0x148)+_0xedf249(0x16f)+'message_co'+'unt\x20+\x20?,\x20d'+_0xedf249(0x204)+'e\x20=\x20?,\x20las'+'t_updated\x20'+_0xedf249(0x1d5)+_0xedf249(0xd8),[_0x4a457b['message_co'+'unt'],_0x4a457b[_0xedf249(0x1a8)+'me']||'',Math[_0xedf249(0x150)](_0x227f26[_0xedf249(0x109)]()),_0x10f78d['id']]);if(Array[_0xedf249(0x141)](_0x4a457b['sourceIds'])&&_0x4a457b[_0xedf249(0x1cf)][_0xedf249(0x17b)])for(let _0x590bd2=0x230a+-0x7ab+-0x7*0x3e9;_0x590bd2<_0x4a457b[_0xedf249(0x1cf)][_0xedf249(0x17b)];_0x590bd2+=-0xe6*-0x1e+-0x4fc*0x2+-0xf08){const _0x3f99da=_0x4a457b[_0xedf249(0x1cf)]['slice'](_0x590bd2,_0x590bd2+(-0x7*0x1e9+-0x346*-0x7+-0x43*0x1d)),_0x3df98f=_0xedf249(0x11b)+'M\x20active_s'+_0xedf249(0x10f)+_0xedf249(0xd1)+_0x3f99da[_0xedf249(0x162)](()=>'?')['join'](',')+')';await db[_0xedf249(0x20e)](_0x3df98f,_0x3f99da);}}}const _0x4ebe0d=_0x227f26[_0xedf249(0x106)]({'days':CONFIG[_0xedf249(0x20a)+_0xedf249(0x117)+'S']})['toSeconds'](),_0x5921bc=await db[_0xedf249(0xe5)]('SELECT\x20id,'+'\x20chat_jid,'+'\x20user_jid,'+_0xedf249(0x1f8)+'y,\x20message'+_0xedf249(0x1f3)+_0xedf249(0x11f)+'\x20FROM\x20acti'+'ve_stats\x20W'+_0xedf249(0x18d)+_0xedf249(0xdb)+_0xedf249(0x1e6));if(_0x5921bc&&_0x5921bc['length']){const _0x491f6a=new Map();for(const _0x553a11 of _0x5921bc){const _0x3ebd22=String(_0x553a11[_0xedf249(0x190)]||'')['split']('-'),_0x1fcb10=Number(_0x3ebd22[0x2d2+-0xf18+0x1*0xc46])||0x1753+0x6be*0x2+-0x1d1d,_0x3d4e95=DateTime[_0xedf249(0x16d)]({'year':_0x1fcb10,'month':0x1,'day':0x1,'zone':CONFIG[_0xedf249(0x1c8)]});if(_0x3d4e95[_0xedf249(0x109)]()>_0x4ebe0d)continue;const _0x73f5f3=''+_0x1fcb10,_0x56b143=_0x553a11[_0xedf249(0x155)]+'||'+_0x553a11[_0xedf249(0x119)]+_0xedf249(0x1d8)+_0x73f5f3;if(!_0x491f6a[_0xedf249(0x128)](_0x56b143))_0x491f6a['set'](_0x56b143,{'chat_jid':_0x553a11[_0xedf249(0x155)],'user_jid':_0x553a11[_0xedf249(0x119)],'timeframe':'yearly','bucket_key':_0x73f5f3,'message_count':0x0,'display_name':_0x553a11[_0xedf249(0x1a8)+'me']||'','sourceIds':[]});const _0x2298b5=_0x491f6a['get'](_0x56b143);_0x2298b5[_0xedf249(0x1b1)+_0xedf249(0x1ab)]+=Number(_0x553a11[_0xedf249(0x1b1)+_0xedf249(0x1ab)]||0x115d+-0x24fc+0x139f),_0x2298b5[_0xedf249(0x1cf)]['push'](_0x553a11['id']);}for(const _0x8c95e9 of _0x491f6a[_0xedf249(0x1e9)]()){const _0x3a509b=await db['get']('SELECT\x20id\x20'+_0xedf249(0x191)+_0xedf249(0x18a)+'ERE\x20chat_j'+_0xedf249(0x202)+_0xedf249(0x20b)+_0xedf249(0x1f5)+_0xedf249(0x1ec)+_0xedf249(0xe4)+'ND\x20bucket_'+'key\x20=\x20?\x20LI'+_0xedf249(0x1d6),[_0x8c95e9[_0xedf249(0x155)],_0x8c95e9[_0xedf249(0x119)],_0x8c95e9[_0xedf249(0x190)]]);!_0x3a509b?await db[_0xedf249(0x20e)](_0xedf249(0x1f0)+_0xedf249(0xf2)+_0xedf249(0x20c)+_0xedf249(0xd3)+'_jid,\x20time'+_0xedf249(0x1ac)+'ket_key,\x20m'+'essage_cou'+_0xedf249(0x178)+_0xedf249(0xf1)+_0xedf249(0x1ce)+_0xedf249(0x10e)+_0xedf249(0xc4)+'rly\x27,\x20?,\x20?'+_0xedf249(0xcf),[_0x8c95e9[_0xedf249(0x155)],_0x8c95e9[_0xedf249(0x119)],_0x8c95e9['bucket_key'],_0x8c95e9[_0xedf249(0x1b1)+'unt'],_0x8c95e9[_0xedf249(0x1a8)+'me']||'',Math['floor'](_0x227f26[_0xedf249(0x109)]())]):await db['run'](_0xedf249(0x1db)+_0xedf249(0x19e)+_0xedf249(0x148)+_0xedf249(0x16f)+_0xedf249(0x1b1)+_0xedf249(0x184)+_0xedf249(0x204)+_0xedf249(0xd6)+_0xedf249(0x203)+'=\x20?\x20WHERE\x20'+_0xedf249(0xd8),[_0x8c95e9['message_co'+_0xedf249(0x1ab)],_0x8c95e9['display_na'+'me']||'',Math['floor'](_0x227f26['toSeconds']()),_0x3a509b['id']]);if(Array['isArray'](_0x8c95e9['sourceIds'])&&_0x8c95e9['sourceIds'][_0xedf249(0x17b)])for(let _0x3133e9=0x1e51+0x12c1*0x1+0x3112*-0x1;_0x3133e9<_0x8c95e9['sourceIds'][_0xedf249(0x17b)];_0x3133e9+=-0x9a8+0x11f8+0x1*-0x65c){const _0x1f5c17=_0x8c95e9[_0xedf249(0x1cf)]['slice'](_0x3133e9,_0x3133e9+(0xc37+0x5ca+-0x100d)),_0x1ffb43=_0xedf249(0x11b)+_0xedf249(0xd4)+_0xedf249(0x10f)+_0xedf249(0xd1)+_0x1f5c17['map'](()=>'?')[_0xedf249(0x1b0)](',')+')';await db['run'](_0x1ffb43,_0x1f5c17);}}}try{const _0x5b23ec=DateTime[_0xedf249(0x16b)]()[_0xedf249(0x1ee)](CONFIG[_0xedf249(0x1c8)])['minus']({'days':CONFIG[_0xedf249(0x12e)+'KEEP_DAYS']})[_0xedf249(0xe6)](_0xedf249(0xc9));await db['run'](_0xedf249(0x11b)+_0xedf249(0xd4)+_0xedf249(0x10f)+_0xedf249(0x194)+_0xedf249(0x127)+_0xedf249(0xee)+_0xedf249(0x1a6),[_0x5b23ec]);}catch(_0x13fb47){warn(_0xedf249(0x142)+'rune\x20daily'+_0xedf249(0x12f)+(_0x13fb47?.[_0xedf249(0x138)]||_0x13fb47));}info('[active]\x20r'+'ollups\x20com'+_0xedf249(0x130));}catch(_0xc62383){error(_0xc62383,_0xedf249(0x142)+'erformRoll'+_0xedf249(0x158)+':\x20'+(_0xc62383?.[_0xedf249(0x138)]||_0xc62383));}}function parsePeriodArg(_0x4671bf){const _0x2ffabd=_0x41b2f6;if(!_0x4671bf)return null;const _0x573a08=String(_0x4671bf)[_0x2ffabd(0x121)]()[_0x2ffabd(0xda)+'e']()[_0x2ffabd(0x14d)](/^(\d+)\s*([dwmy])$/);if(!_0x573a08)return null;return{'amount':Number(_0x573a08[-0x294+0xd0a+0xa75*-0x1]),'unit':_0x573a08[-0x182e+-0x3*-0xb3f+-0x98d]};}function _0x5137(_0x34bc28,_0x54ecd7){const _0x2dcf89=_0x2be2();return _0x5137=function(_0x41eb59,_0x146eb3){_0x41eb59=_0x41eb59-(-0x350+0x3*-0x406+0x1020);let _0x23a547=_0x2dcf89[_0x41eb59];return _0x23a547;},_0x5137(_0x34bc28,_0x54ecd7);}function computeCutoffSeconds(_0x37485b,_0x33507b){const _0x44d8ba=_0x41b2f6,_0x15fc4a=DateTime[_0x44d8ba(0x16b)]()[_0x44d8ba(0x1ee)](CONFIG[_0x44d8ba(0x1c8)]);let _0x551a13;if(_0x33507b==='d')_0x551a13=_0x15fc4a[_0x44d8ba(0x106)]({'days':_0x37485b});else{if(_0x33507b==='w')_0x551a13=_0x15fc4a[_0x44d8ba(0x106)]({'weeks':_0x37485b});else{if(_0x33507b==='m')_0x551a13=_0x15fc4a['minus']({'months':_0x37485b});else{if(_0x33507b==='y')_0x551a13=_0x15fc4a[_0x44d8ba(0x106)]({'years':_0x37485b});else _0x551a13=_0x15fc4a['minus']({'days':_0x37485b});}}}return Math[_0x44d8ba(0x150)](_0x551a13['toSeconds']());}async function buildLeaderboardForChat(_0x2c88c4,_0x2e7865,_0x4c9e67=CONFIG[_0x41b2f6(0x14c)+'T_RETURN']){const _0x240130=_0x41b2f6;try{const _0x1eba4c=DateTime[_0x240130(0x1e8)+'s'](_0x2e7865)[_0x240130(0x1ee)](CONFIG[_0x240130(0x1c8)]),_0x4864ec=_0x1eba4c[_0x240130(0xe6)](_0x240130(0xc9)),_0x283830=await db['all'](_0x240130(0xfc)+'ECT\x20user_j'+_0x240130(0x157)+'y_name,\x20SU'+'M(message_'+'count)\x20AS\x20'+_0x240130(0x1b5)+_0x240130(0x19c)+_0x240130(0x1f7)+_0x240130(0x153)+_0x240130(0x191)+'e_stats\x0a\x20\x20'+_0x240130(0x1fd)+_0x240130(0x144)+_0x240130(0x1da)+_0x240130(0x1c4)+_0x240130(0x189)+_0x240130(0x1f8)+_0x240130(0x12a)+'\x20\x20\x20GROUP\x20B'+_0x240130(0x1c2)+'\x0a\x20\x20\x20\x20',[_0x2c88c4,_0x4864ec]),_0x546659=new Map();for(const _0x78f196 of _0x283830||[]){const _0x547beb=normalizeJid(_0x78f196[_0x240130(0x119)]);_0x546659[_0x240130(0xf0)](_0x547beb,{'user_jid':_0x547beb,'display_name':_0x78f196[_0x240130(0x1a8)+'me']||_0x547beb['split']('@')[-0x103*-0xf+-0x9a8+0x9*-0x9d],'count':Number(_0x78f196[_0x240130(0x1bc)]||-0x3b*0x95+0x1e57+-0x10*-0x40),'last_ts':Number(_0x78f196[_0x240130(0xd5)]||-0x278*-0x3+0x26aa+0x2*-0x1709)});}const _0x5d2d6a=await db['all'](_0x240130(0x1bb)+_0x240130(0xc7)+_0x240130(0x1e1)+_0x240130(0x1e4)+_0x240130(0x1b1)+_0x240130(0x1a2)+_0x240130(0x180)+_0x240130(0x1ca)+_0x240130(0x163)+_0x240130(0x1f6)+_0x240130(0x12c)+'imeframe\x20I'+_0x240130(0x16c)+_0x240130(0x10b)+_0x240130(0xdd)+')',[_0x2c88c4]);for(const _0x1c7939 of _0x5d2d6a||[]){let _0x42fe4d=![];try{if(_0x1c7939[_0x240130(0x1c9)]==='weekly'){const _0x2fa628=String(_0x1c7939[_0x240130(0x190)]||'')['split']('-'),_0x3ef22f=Number(_0x2fa628[0xf66+-0x2*0xe5d+0xd54])||-0x6e+0xb74+0xc*-0x47,_0x343007=Number(_0x2fa628[-0x19fc+-0x1*-0x1be+0x183f])||0x10e8+-0x2e4+-0xe03,_0x49d1a2=DateTime[_0x240130(0x16d)]({'weekYear':_0x3ef22f,'weekNumber':_0x343007,'weekday':0x1})[_0x240130(0x1ee)](CONFIG[_0x240130(0x1c8)]);if(_0x49d1a2['toSeconds']()>=_0x2e7865)_0x42fe4d=!![];}else{if(_0x1c7939['timeframe']===_0x240130(0x1e7)){const _0x738b16=String(_0x1c7939[_0x240130(0x190)]||'')[_0x240130(0x122)]('-'),_0x56fd3a=Number(_0x738b16[0x12d4+0x3a5*0x7+-0x2c57*0x1])||-0x1*0x1583+-0x266d+0x43a2,_0x3c8bad=Number(_0x738b16[-0xc3b*-0x1+-0x1fcb+0x1391])||0x61f+0x2267+0xb*-0x3af,_0x5cc773=DateTime[_0x240130(0x16d)]({'year':_0x56fd3a,'month':_0x3c8bad,'day':0x1})[_0x240130(0x1ee)](CONFIG[_0x240130(0x1c8)]);if(_0x5cc773[_0x240130(0x109)]()>=_0x2e7865)_0x42fe4d=!![];}else{if(_0x1c7939['timeframe']==='yearly'){const _0x159d4f=Number(String(_0x1c7939[_0x240130(0x190)]||'')[_0x240130(0x122)]('-')[-0x954+0x1a13+-0x10bf])||0x1af*0xa+-0x1258+0x934,_0x35c661=DateTime['fromObject']({'year':_0x159d4f,'month':0x1,'day':0x1})['setZone'](CONFIG['TIME_ZONE']);if(_0x35c661['toSeconds']()>=_0x2e7865)_0x42fe4d=!![];}else _0x42fe4d=!![];}}}catch(_0x444759){_0x42fe4d=!![];}if(!_0x42fe4d)continue;const _0x2588da=normalizeJid(_0x1c7939[_0x240130(0x119)]);if(!_0x546659[_0x240130(0x128)](_0x2588da))_0x546659[_0x240130(0xf0)](_0x2588da,{'user_jid':_0x2588da,'display_name':_0x1c7939['display_na'+'me']||_0x2588da[_0x240130(0x122)]('@')[0x951*0x1+0x1976+0x133*-0x1d],'count':0x0,'last_ts':0x0});_0x546659[_0x240130(0x1ff)](_0x2588da)['count']+=Number(_0x1c7939[_0x240130(0x1b1)+_0x240130(0x1ab)]||0x6e3+-0xb*0x95+-0x7c);}const _0x206be4=Array[_0x240130(0x188)](_0x546659[_0x240130(0x1e9)]())['sort']((_0x294a07,_0x5e24e5)=>_0x5e24e5[_0x240130(0x1c0)]-_0x294a07[_0x240130(0x1c0)]||_0x5e24e5[_0x240130(0xd5)]-_0x294a07['last_ts']);return _0x206be4[_0x240130(0x1f4)](-0x253b+-0xa16*0x1+0x2f51,_0x4c9e67);}catch(_0x41f8cd){return warn(_0x240130(0xc0)+_0x240130(0x1fc)+_0x240130(0x154)+_0x240130(0x145)+(_0x41f8cd?.[_0x240130(0x138)]||_0x41f8cd)),[];}}async function getGroupParticipants(_0x4668f9,_0x2007f3){const _0x3c914b=_0x41b2f6;try{if(!_0x4668f9||typeof _0x4668f9['groupMetad'+_0x3c914b(0x1fb)]!==_0x3c914b(0x15b))return[];const _0xfcbc47=await _0x4668f9[_0x3c914b(0xc1)+_0x3c914b(0x1fb)](_0x2007f3),_0x3e11dc=Array[_0x3c914b(0x141)](_0xfcbc47?.[_0x3c914b(0x15c)+'ts'])?_0xfcbc47[_0x3c914b(0x15c)+'ts']:Object[_0x3c914b(0x1e9)](_0xfcbc47?.[_0x3c914b(0x15c)+'ts']||{}),_0x1a795b=_0x3e11dc[_0x3c914b(0x162)](_0x4601a7=>_0x4601a7['id'])[_0x3c914b(0x13a)](Boolean)[_0x3c914b(0x162)](normalizeJid);return _0x1a795b;}catch(_0x322c9f){return warn(_0x3c914b(0x103)+'etGroupPar'+_0x3c914b(0x125)+_0x3c914b(0x105)+'\x20'+_0x2007f3+':\x20'+(_0x322c9f?.[_0x3c914b(0x138)]||_0x322c9f)),[];}}export async function initialize(_0x32d0f7){const _0x4f8404=_0x41b2f6;try{botRef=_0x32d0f7;if(botRef){if(typeof botRef[_0x4f8404(0x17f)+'e']===_0x4f8404(0x15b))sendApi=(_0x5ecbd6,_0x3f7416)=>botRef['sendMessag'+'e'](_0x5ecbd6,_0x3f7416);else{if(botRef[_0x4f8404(0x1b6)]&&typeof botRef[_0x4f8404(0x1b6)]['sendMessag'+'e']==='function')sendApi=(_0x53510d,_0x588968)=>botRef[_0x4f8404(0x1b6)]['sendMessag'+'e'](_0x53510d,_0x588968);else sendApi=null;}}try{const _0x19861c=getConfig()||{};if(_0x19861c[_0x4f8404(0x1c6)]&&typeof _0x19861c[_0x4f8404(0x1c6)]===_0x4f8404(0x206))CONFIG={...CONFIG,..._0x19861c[_0x4f8404(0x1c6)]};}catch(_0x59a27f){warn(_0x4f8404(0x146)+'ailed\x20to\x20r'+_0x4f8404(0x14f)+_0x4f8404(0xdf)+(_0x59a27f?.[_0x4f8404(0x138)]||_0x59a27f));}await ensureSchema(),await performRollups(),info('[active]\x20i'+'nitialized');}catch(_0x2757f7){error(_0x2757f7,_0x4f8404(0xf4)+_0x4f8404(0x174)+'failed:\x20'+(_0x2757f7?.[_0x4f8404(0x138)]||_0x2757f7));throw _0x2757f7;}}export async function onMessage(_0x40c820){const _0x431f76=_0x41b2f6;try{await trackMessage(_0x40c820);if(!_0x40c820?.[_0x431f76(0xce)])return;const _0x43f1ea=_0x40c820[_0x431f76(0xfe)]?.['remoteJid'];if(!_0x43f1ea||!_0x43f1ea[_0x431f76(0x1a5)]('@g.us'))return;const _0xd03ad4=await isadmin(botRef,_0x40c820)[_0x431f76(0x1aa)](()=>![]);if(!_0xd03ad4)return;const _0x38ee2d=typeof _0x40c820[_0x431f76(0x1cc)]===_0x431f76(0xd2)&&_0x40c820[_0x431f76(0x1cc)]['trim']()?_0x40c820[_0x431f76(0x1cc)][_0x431f76(0x121)]():'';if(!_0x38ee2d)return;const _0x3481f8=_0x38ee2d[_0x431f76(0x122)](/\s+/)[_0x431f76(0x13a)](Boolean),_0x22963e=_0x3481f8[-0x7ad+-0x6d*0x53+0x2b04][_0x431f76(0xda)+'e']();if(_0x22963e!==_0x431f76(0x200)&&_0x22963e!=='inactive')return;const _0x4f09ad=_0x3481f8[-0xd*0x232+-0x2a2+-0x1f2d*-0x1]||'1w';let _0xd738fe=parsePeriodArg(_0x4f09ad);if(!_0xd738fe){const _0x149197=parseInt(_0x4f09ad,-0x1*-0x100f+0x25f*-0x4+0x689*-0x1);if(!isNaN(_0x149197))_0xd738fe={'amount':_0x149197,'unit':'d'};else{const _0x280a25='Usage:\x20act'+_0x431f76(0xec)+_0x431f76(0x19f)+_0x431f76(0x1a7)+_0x431f76(0x205)+_0x431f76(0x181)+_0x431f76(0x18b)+_0x431f76(0xde)+_0x431f76(0xcb)+_0x431f76(0x11c)+'tive\x207d';try{await sendApi(_0x43f1ea,{'text':_0x280a25});}catch(_0x2078c4){warn(_0x431f76(0x192)+_0x431f76(0x201)+_0x431f76(0x175)+(_0x2078c4?.[_0x431f76(0x138)]||_0x2078c4));}return;}}try{await performRollups();}catch(_0x323c25){}const _0xaf6519=computeCutoffSeconds(_0xd738fe[_0x431f76(0xe1)],_0xd738fe[_0x431f76(0x10c)]);if(_0x22963e===_0x431f76(0x200)){const _0xbd6332=await buildLeaderboardForChat(_0x43f1ea,_0xaf6519,CONFIG[_0x431f76(0x14c)+'T_RETURN']);if(!_0xbd6332||_0xbd6332[_0x431f76(0x17b)]===0x83d+0x1a74+-0x22b1){await sendApi(_0x43f1ea,{'text':_0x431f76(0x1bd)+_0x431f76(0x1b4)+_0x431f76(0x113)+_0x431f76(0x129)+_0xd738fe[_0x431f76(0xe1)]+_0xd738fe[_0x431f76(0x10c)]+'.'});return;}let _0x4d7784=_0x431f76(0x1ae)+_0xbd6332['length']+(_0x431f76(0xf8)+'ers\x20in\x20the'+_0x431f76(0x129))+_0xd738fe[_0x431f76(0xe1)]+_0xd738fe[_0x431f76(0x10c)]+':\x0a\x0a';const _0x4337f3=[];let _0x126c24=0x1*0x797+0x6*-0x2a5+0xd*0xa3;for(const _0x3f7515 of _0xbd6332){_0x126c24++;const _0x1fcf97=_0x3f7515[_0x431f76(0x119)][_0x431f76(0x122)]('@')[-0x10a4+0x1cc5+-0xf*0xcf];_0x4d7784+=_0x431f76(0xf5)+_0x1fcf97+'\x20('+(_0x3f7515[_0x431f76(0x1a8)+'me']||_0x1fcf97)+')\x0a',_0x4d7784+=romanParen(_0x126c24)+'\x20'+_0x3f7515[_0x431f76(0x1c0)]+(_0x431f76(0xef)+'\x0a'),_0x4337f3['push'](_0x3f7515[_0x431f76(0x119)]);}const _0x56f600=-0x1940+-0xbf7+0xa7*0x51;if(_0x4d7784[_0x431f76(0x17b)]<=_0x56f600)await sendApi(_0x43f1ea,{'text':_0x4d7784,'mentions':_0x4337f3});else{const _0x16e5da=_0x4d7784['split']('\x0a\x0a');let _0x27c5b2='';for(const _0x400898 of _0x16e5da){if((_0x27c5b2+'\x0a\x0a'+_0x400898)['length']>_0x56f600)await sendApi(_0x43f1ea,{'text':_0x27c5b2,'mentions':_0x4337f3}),_0x27c5b2=_0x400898+'\x0a\x0a';else _0x27c5b2+=(_0x27c5b2?'\x0a\x0a':'')+_0x400898;}if(_0x27c5b2[_0x431f76(0x121)]())await sendApi(_0x43f1ea,{'text':_0x27c5b2,'mentions':_0x4337f3});}return;}if(_0x22963e===_0x431f76(0x1df)){const _0x1426aa=botRef?.['sock']||botRef,_0xa2c5d6=await getGroupParticipants(_0x1426aa,_0x43f1ea);if(!_0xa2c5d6||_0xa2c5d6[_0x431f76(0x17b)]===0x1*0x497+0x1f*0x7c+-0x139b){await sendApi(_0x43f1ea,{'text':'Could\x20not\x20'+_0x431f76(0x17c)+_0x431f76(0x135)+_0x431f76(0x168)});return;}const _0x4b197a=await buildLeaderboardForChat(_0x43f1ea,_0xaf6519,0x7*-0x31733+0x1053a*-0x17+-0x1*-0x3c5cdb),_0x4efd51=new Set((_0x4b197a||[])[_0x431f76(0x162)](_0x5a652b=>normalizeJid(_0x5a652b[_0x431f76(0x119)]))),_0x2c494e=_0xa2c5d6[_0x431f76(0x13a)](_0x41cdda=>!_0x4efd51['has'](normalizeJid(_0x41cdda)));if(!_0x2c494e[_0x431f76(0x17b)]){await sendApi(_0x43f1ea,{'text':'No\x20inactiv'+_0x431f76(0x179)+_0x431f76(0x1ea)+_0x431f76(0x120)+_0xd738fe[_0x431f76(0xe1)]+_0xd738fe[_0x431f76(0x10c)]+'.'});return;}let _0x15177c=_0x431f76(0x1ae)+_0x2c494e[_0x431f76(0x17b)]+(_0x431f76(0x167)+_0x431f76(0x13b)+'\x20the\x20last\x20')+_0xd738fe[_0x431f76(0xe1)]+_0xd738fe[_0x431f76(0x10c)]+_0x431f76(0xc6);const _0x36c7e8=[];let _0x2a1ca9=-0x3*0xafb+-0x51c+-0x1*-0x260d;for(const _0x5cbaa1 of _0x2c494e){_0x2a1ca9++;const _0x56cf3e=_0x5cbaa1[_0x431f76(0x122)]('@')[-0xd3b*0x1+-0xc60+0x199b];_0x15177c+=_0x431f76(0xf5)+_0x56cf3e+'\x20('+_0x56cf3e+')\x0a',_0x15177c+=romanParen(_0x2a1ca9)+(_0x431f76(0x186)+_0x431f76(0xd9)),_0x36c7e8[_0x431f76(0x116)](_0x5cbaa1);}await sendApi(_0x43f1ea,{'text':_0x15177c,'mentions':_0x36c7e8});return;}}catch(_0x46f6ba){error(_0x46f6ba,_0x431f76(0x159)+_0x431f76(0xe9)+_0x431f76(0xe0)+(_0x46f6ba?.[_0x431f76(0x138)]||_0x46f6ba));}}export async function cleanup(){const _0x58392e=_0x41b2f6;try{for(const _0x48d6d8 of processedMessageKeys[_0x58392e(0x1e9)]())try{clearTimeout(_0x48d6d8);}catch(_0x20c418){}processedMessageKeys[_0x58392e(0x1b9)]();}catch(_0x3e8549){}botRef=null,sendApi=null,info(_0x58392e(0x165)+_0x58392e(0x1c7));}export default{'name':name,'version':version,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};