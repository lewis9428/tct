const _0x3acca5=_0x22bb;(function(_0x22282e,_0x2a5c99){const _0x53721c=_0x22bb,_0x3dd928=_0x22282e();while(!![]){try{const _0x2e3ba0=parseInt(_0x53721c(0x149))/(-0x140*-0xe+0x833*-0x3+0x71a)*(-parseInt(_0x53721c(0x1ab))/(-0xf06+-0x6*0xa4+0x12e0))+-parseInt(_0x53721c(0x121))/(-0x1444+-0x391+0x17d8)+parseInt(_0x53721c(0x10a))/(0x20d5*0x1+-0x1bde+0x1*-0x4f3)*(parseInt(_0x53721c(0x171))/(-0x26ab+-0x24b*-0xd+0x8e1))+-parseInt(_0x53721c(0x152))/(0x118*0x4+-0x7ea*-0x1+0x274*-0x5)+parseInt(_0x53721c(0x14e))/(-0x1*-0x741+0xe*-0x23d+0x607*0x4)*(-parseInt(_0x53721c(0x20d))/(0x79a+0x191c+-0x1*0x20ae))+-parseInt(_0x53721c(0x10f))/(-0x18be+-0x232*0x11+0x3e19)*(-parseInt(_0x53721c(0x124))/(0x2005+-0xc9*0xc+-0x113*0x15))+-parseInt(_0x53721c(0x220))/(-0x6*-0x2ec+-0x259*-0x1+-0x13d6)*(-parseInt(_0x53721c(0xf3))/(-0x543*-0x6+-0x5*0x429+-0x225*0x5));if(_0x2e3ba0===_0x2a5c99)break;else _0x3dd928['push'](_0x3dd928['shift']());}catch(_0x442038){_0x3dd928['push'](_0x3dd928['shift']());}}}(_0x2179,-0x4fe31+-0x1*0x59221+0x4dfdd*0x3));function _0x2179(){const _0x26412a=['TO\x20active_','1047376ijHaAc','push','\x20\x20\x20\x20\x20UNIQU','\x20\x20\x20\x20','sock','\x27weekly\x27\x20A','E\x20chat_jid','EGER\x20DEFAU','\x27weekly\x27|\x27','OT\x20NULL,\x0a\x20','_jid,\x20time','ekly\x27','display_na','SELECT\x20use','AULT\x200,\x0a\x20\x20','icipants.','map','day','EXISTS\x20act','5192671QxWcPv','\x20chat_jid,','SELECT\x20id,','\x20+\x201,\x20disp','XT\x0a\x20\x20\x20\x20\x20\x20)',',\x20user_jid','all','chema\x20ensu','run','splay_name','f\x20ON\x20activ','ge_count\x20I','timeframe','participan','\x201d,\x20activ','No\x20active\x20','ACTIVE','y_name,\x20la','inactive','group\x20part','\x20messages\x0a','nthly\x27','padStart','imeframe\x20=','leaned\x20up','SELECT\x20id\x20','\x20id\x20IN\x20(','meframe\x20=\x20','ive_stats(','sage_id\x20TE','ERE\x20chat_j','set','daily\x20rows','[active]\x20e','CREATE\x20TAB','ENT,\x0a\x20\x20\x20\x20\x20','frame,\x20buc','erformRoll','AND\x20bucket','\x20FROM\x20acti','bucket_key','pdated\x20INT','\x20last\x20','split','t_key\x20<=\x20?','members\x20in','ow\x27)),\x0a\x20\x20\x20','24IsrEsf','floor','ive_migrat','\x20INSERT\x20IN','_count,\x20di','rune\x20daily','[active]\x20r','toLowerCas','unt','d)\x0a\x20\x20\x20\x20\x20\x20\x20','_stats\x20(\x0a\x20','\x20inactive\x20','nitialize\x20','t_updated\x20','function','essage_cou','determine\x20','N\x20(\x27weekly','ve_stats\x0a\x20','ailed:\x20','ser\x20ON\x20act','_MS','ive_stats\x20','137964LrLMYq','nMessage\x20f','\x20\x27daily\x27\x20A','AUTOINCREM','LT\x20(strfti','43002VggEfD','values','he\x20last\x20','\x20=\x20?\x20AND\x20t','eekly:\x20YYY','e\x20unexpect','unt><d|w|m','slice','\x20);\x0a\x20\x20\x20\x20','board\x20erro','key)\x0a\x20\x20\x20\x20\x20','weekly','OM\x20active_','clear','rame\x20=\x20\x27mo','_key\x20=\x20?\x20L','tats\x20WHERE','sort','351030IvgERQ','[active]\x20b','\x0a\x20\x20\x20\x20\x20\x20CRE','710LbdCuM','yyyy-LL-dd','tive\x207d','eframe\x20=\x20\x27','[active]\x20d','string','object','key','t><d|w|m|y','\x20failed:\x20','FROM\x20activ','IF\x20NOT\x20EXI','y,\x20message','unt\x20+\x20?,\x20d','\x20=\x20\x27daily\x27','e,\x20bucket_','\x20\x20chat_jid','nsureSchem','Found\x20','message','toFormat','ow\x27)));','rame\x20=\x20\x27da','\x27,\x27yearly\x27','at_jid,\x20ti','1.1.1','join','jid\x20TEXT\x20N','ups\x20failed','trim','daily:\x20YYY','count)\x20AS\x20','ve_stats\x20W','UTC','\x20no\x20messag',',\x20\x20\x20\x20\x20\x20\x20\x20-','ast_update','123EsjROi','setZone','\x20\x20\x20\x20\x20\x20disp','\x0a\x20\x20\x20\x20\x20\x20SEL','get','21mmPdsM','lay_name\x20=','failed:\x20','st_updated','2408706LcEWRp','_ts\x0a\x20\x20\x20\x20\x20\x20','[active]\x20p','ay_name\x20FR','?,\x20?,\x20?)','\x20active\x20us','\x20NULL,\x0a\x20\x20\x20','\x20bucket_ke','T\x20\x27\x27,\x0a\x20\x20\x20\x20','-\x20\x27daily\x27|','year','chat_jid\x20=','message_co','\x27monthly\x27\x20','MAX_DAILY_','ive\x20<amoun','[active]\x20s','sourceIds','count','rly\x27,\x20?,\x20?','amount','MIT\x201','ATE\x20TABLE\x20','fromObject','[active]\x20i','\x20\x20\x20GROUP\x20B','\x20\x20\x20\x20\x20\x20\x20mes','unt,\x20displ','r_jid,\x20tim',',\x20\x20\x20\x20\x20\x20--\x20','id\x20=\x20?\x20AND','55fbbyik','@g.us','O_WEEK_DAY','stats\x20WHER','IMIT\x201','[active]\x20o','DEDUPE_TTL','DELETE\x20FRO','ollups\x20com','ticipants\x20','\x20AND\x20bucke','s\x20(\x0a\x20\x20\x20\x20\x20\x20','\x20\x20\x20\x20\x20\x20','INTEGER\x20PR','cnt','catch','.ACTIVE:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20W','\x20\x20\x20\x20\x20\x20\x20id\x20','ctive\x20<amo','startOf','ucket_key)','ers\x20in\x20the','ðŸ‘¤\x20@','ND\x20bucket_','ed:\x20','_jid,\x20user','\x20\x20\x20\x20\x20\x20\x20tim','length','groupMetad','last_ts','weekNumber','now','et_key\x20TEX','Could\x20not\x20','EXISTS\x20idx','=\x20?\x20WHERE\x20','key\x20=\x20?\x0a\x20\x20','||yearly||','found\x20in\x20t','key\x20=\x20?\x20LI','eframe\x20TEX','sendMessag','e\x20=\x20?,\x20las','e_count\x20=\x20','has','T_RETURN','r:\x20','rame\x20=\x20\x27we','[active]\x20g','d\x20TEXT\x20NOT','e\x20DB\x20error','es:\x20active','Y-MM-DD,\x20w','INSERT\x20INT','Y-WW,\x20mont',',\x20?,\x20?)',',\x20timefram','7894Xmlbfe','tats\x20(chat','d)\x20AS\x20last','ROLLOVER_T','Y\x20user_jid','cnt,\x20MAX(l','||weekly||','ion\x20INTEGE','MM,\x20yearly','failed\x20for','cket_key,\x20','[active]\x20c','[active]\x20t',')\x20VALUES\x20(','active','from','daily\x27\x20AND',';\x0a\x20\x20\x20\x20','monthly','EX\x20IF\x20NOT\x20','kly\x27,\x20?,\x20?','TIME_ZONE','toSeconds','M\x20active_s','endsWith','meframe,\x20b','\x20timeframe','exec','STS\x20active','[active]\x20f','chat_jid','\x20user_jid\x20','red','O_MONTH_DA','t_jid,\x20use','\x20user_jid,','ata','UPDATE\x20act','M(message_','_active_st','monthly\x27|\x27','\x20message_c','pushName','\x20\x20\x20\x20last_u','IMARY\x20KEY\x20','pdated\x20=\x20?','a\x20failed','ted_at\x20INT','D\x20user_jid',':\x20YYYY\x0a\x20\x20\x20','id\x20=\x20?','eframe,\x20bu','CREATE\x20IND','es\x0a\x0a','etGroupPar','nt,\x20displa','\x20?\x20AND\x20tim','=\x20?\x20AND\x20ti','minus','ats_chat_u','changes','ily\x27\x20AND\x20b','senderName',':\x0a\x0a','isArray','elete\x20old\x20','||monthly|','isCommand','NTEGER\x20DEF','SET\x20messag','KEEP_DAYS','user_jid','text','plete','user_jid);','unit',',\x20?,\x20?)\x0a\x20\x20','rackMessag','e_stats\x20WH','uildLeader','\x20\x20\x20VALUES\x20','yearly','remoteJid','USERS_LIMI','chat_jid,\x20','ket_key,\x20m','\x20the\x20last\x20','me(\x27%s\x27,\x27n','HERE\x20timef','isplay_nam','y_name,\x20SU','month','filter','<=\x20?','e\x20members\x20','T\x20NOT\x20NULL','O\x20active_s'];_0x2179=function(){return _0x26412a;};return _0x2179();}import{DateTime}from'luxon';import{db}from'../utils/database.js';import{info,warn,error}from'../utils/logger.js';import{isadmin}from'../utils/isadmin.js';import{getConfig}from'../utils/config.js';import{getBotJid}from'../utils/bot-state.js';export const name=_0x3acca5(0x1b9);export const version=_0x3acca5(0x13d);export const priority=0x12f4*-0x2+0x1afb*-0x1+-0x3*-0x15bf;export const commands=[_0x3acca5(0x1b9),_0x3acca5(0xd6)];let botRef=null,sendApi=null;const DEFAULTS={'TIME_ZONE':_0x3acca5(0x145),'MAX_DAILY_KEEP_DAYS':0x5a,'ROLLOVER_TO_WEEK_DAYS':0x7,'ROLLOVER_TO_MONTH_DAYS':0x1e,'ROLLOVER_TO_YEAR_DAYS':0x16d,'USERS_LIMIT_RETURN':0xc8,'DEDUPE_TTL_MS':(0x1dd9*0x1+0x708+-0x24c3)*(0x19b0+-0x20*-0x79+0x8*-0x49d)};let CONFIG={...DEFAULTS};function normalizeJid(_0x589ee3){const _0x3a6046=_0x3acca5;return _0x589ee3?String(_0x589ee3)[_0x3a6046(0x141)]():'';}function sleep(_0x2dac90){return new Promise(_0x299aa6=>setTimeout(_0x299aa6,_0x2dac90));}function toLowerRoman(_0x256fbc){const _0xde4517=[[0xb0c+-0x21c1+-0x9*-0x2f5,'M'],[0x16a2+-0x1ad3+-0x7b5*-0x1,'CM'],[-0x2214+0x117a+0x128e,'D'],[-0x1432+-0x2136*-0x1+-0xb74*0x1,'CD'],[0x13e0+0x2b*0x98+-0x2d04,'C'],[-0x53*0xa+0x9f*0x4+0x11c,'XC'],[0x110*-0xa+0x6cd*0x5+0x5*-0x4a3,'L'],[-0xd67*-0x2+0x58f*-0x7+0xc43,'XL'],[-0xb*-0x179+0x23f1+0x8af*-0x6,'X'],[-0x31*0x71+0x52c*-0x1+0x1ad6,'IX'],[-0x157*-0x5+0x221*-0xf+0x5*0x50d,'V'],[-0x119c+0x1600+0x38*-0x14,'IV'],[0x23e3+-0x1db7+-0x1*0x62b,'I']];let _0xd89bff=_0x256fbc,_0xad4e='';for(const [_0x4c04bd,_0x2de51f]of _0xde4517)while(_0xd89bff>=_0x4c04bd){_0xad4e+=_0x2de51f,_0xd89bff-=_0x4c04bd;}return _0xad4e['toLowerCas'+'e']();}function romanParen(_0x49269c){return'('+toLowerRoman(_0x49269c)+')';}const processedMessageKeys=new Map();function makeDedupeKey(_0xc20d6b){const _0x3978bc=_0x3acca5,_0x314982=_0xc20d6b?.['key'];if(!_0x314982)return null;const _0x21ca57=_0x314982['id']||_0x314982[_0x3978bc(0x22d)+'t']||'',_0x217f50=_0x314982['remoteJid']||'';return _0x217f50+'::'+_0x21ca57;}function isMsgProcessed(_0x3940a0){const _0x5cedb5=_0x3acca5;return _0x3940a0&&processedMessageKeys[_0x5cedb5(0x19e)](_0x3940a0);}function markMsgProcessed(_0x249cb5){const _0x2fca69=_0x3acca5;if(!_0x249cb5)return;if(processedMessageKeys[_0x2fca69(0x19e)](_0x249cb5))clearTimeout(processedMessageKeys[_0x2fca69(0x14d)](_0x249cb5));const _0x3e10c1=setTimeout(()=>processedMessageKeys['delete'](_0x249cb5),CONFIG[_0x2fca69(0x177)+_0x2fca69(0x108)]);processedMessageKeys[_0x2fca69(0xe3)](_0x249cb5,_0x3e10c1);}async function ensureSchema(){const _0x7a1dd6=_0x3acca5;try{await db[_0x7a1dd6(0x1c6)](_0x7a1dd6(0xe6)+'LE\x20IF\x20NOT\x20'+_0x7a1dd6(0x21f)+_0x7a1dd6(0xf5)+'ions\x20(vers'+_0x7a1dd6(0x1b2)+'R\x20PRIMARY\x20'+'KEY,\x20migra'+_0x7a1dd6(0x1da)+_0x7a1dd6(0x214)+_0x7a1dd6(0x10e)+'me(\x27%s\x27,\x27n'+_0x7a1dd6(0x139)),await db[_0x7a1dd6(0x1c6)](_0x7a1dd6(0x123)+_0x7a1dd6(0x168)+_0x7a1dd6(0x12f)+_0x7a1dd6(0x1c7)+_0x7a1dd6(0xfd)+_0x7a1dd6(0x183)+_0x7a1dd6(0x17e)+_0x7a1dd6(0x1d7)+_0x7a1dd6(0x10d)+_0x7a1dd6(0xe7)+'\x20\x20\x20chat_ji'+_0x7a1dd6(0x1a3)+_0x7a1dd6(0x158)+'\x20\x20\x20\x20\x20user_'+_0x7a1dd6(0x13f)+_0x7a1dd6(0x216)+_0x7a1dd6(0x18c)+_0x7a1dd6(0x19a)+_0x7a1dd6(0x20a)+_0x7a1dd6(0x147)+_0x7a1dd6(0x15b)+_0x7a1dd6(0x215)+_0x7a1dd6(0x1d3)+'yearly\x27\x0a\x20\x20'+'\x20\x20\x20\x20\x20\x20buck'+_0x7a1dd6(0x192)+_0x7a1dd6(0x20a)+_0x7a1dd6(0x16f)+_0x7a1dd6(0x142)+_0x7a1dd6(0x1a6)+_0x7a1dd6(0x113)+_0x7a1dd6(0x1a8)+'hly:\x20YYYY-'+_0x7a1dd6(0x1b3)+_0x7a1dd6(0x1dc)+'\x20\x20\x20\x20\x20messa'+_0x7a1dd6(0x22b)+_0x7a1dd6(0x1ef)+_0x7a1dd6(0x21b)+_0x7a1dd6(0x14b)+'lay_name\x20T'+'EXT\x20DEFAUL'+_0x7a1dd6(0x15a)+_0x7a1dd6(0x1d6)+_0x7a1dd6(0xed)+'EGER\x20DEFAU'+_0x7a1dd6(0x10e)+_0x7a1dd6(0x202)+_0x7a1dd6(0xf2)+_0x7a1dd6(0x20f)+'E(chat_jid'+_0x7a1dd6(0x225)+_0x7a1dd6(0x1aa)+_0x7a1dd6(0x133)+_0x7a1dd6(0x119)+_0x7a1dd6(0x117)),await db[_0x7a1dd6(0x1c6)]('CREATE\x20IND'+_0x7a1dd6(0x1be)+_0x7a1dd6(0x194)+_0x7a1dd6(0x1d2)+'ats_chat_t'+_0x7a1dd6(0x22a)+'e_stats(ch'+_0x7a1dd6(0x13c)+_0x7a1dd6(0x1c4)+_0x7a1dd6(0x186)+';'),await db[_0x7a1dd6(0x1c6)](_0x7a1dd6(0x1df)+_0x7a1dd6(0x1be)+_0x7a1dd6(0x194)+_0x7a1dd6(0x1d2)+_0x7a1dd6(0x1e6)+_0x7a1dd6(0x107)+_0x7a1dd6(0xe0)+_0x7a1dd6(0x1ff)+_0x7a1dd6(0x1f5)),await db[_0x7a1dd6(0x1c6)](_0x7a1dd6(0x123)+'ATE\x20TABLE\x20'+_0x7a1dd6(0x12f)+_0x7a1dd6(0x1c7)+'_leaderboa'+'rd_message'+_0x7a1dd6(0x17c)+_0x7a1dd6(0x134)+'\x20TEXT\x20PRIM'+'ARY\x20KEY,\x0a\x20'+_0x7a1dd6(0x16c)+_0x7a1dd6(0xe1)+_0x7a1dd6(0x224)+_0x7a1dd6(0x1bc)),info('[active]\x20s'+_0x7a1dd6(0x227)+_0x7a1dd6(0x1cb));}catch(_0x269665){error(_0x269665,_0x7a1dd6(0xe5)+_0x7a1dd6(0x135)+_0x7a1dd6(0x1d9));throw _0x269665;}}export async function trackMessage(_0x362e6d){const _0x483e14=_0x3acca5;try{if(!_0x362e6d||!_0x362e6d[_0x483e14(0x12b)]||!_0x362e6d['message'])return;const _0x350f1e=makeDedupeKey(_0x362e6d);if(!_0x350f1e)return;if(isMsgProcessed(_0x350f1e))return;markMsgProcessed(_0x350f1e);if(_0x362e6d[_0x483e14(0x12b)]['fromMe'])return;const _0x826141=_0x362e6d[_0x483e14(0x12b)]['remoteJid'];if(!_0x826141||!_0x826141[_0x483e14(0x1c3)](_0x483e14(0x172)))return;const _0x1ebe27=_0x362e6d['key'][_0x483e14(0x22d)+'t']||_0x362e6d[_0x483e14(0x12b)][_0x483e14(0x1ba)]||'';if(!_0x1ebe27)return;const _0x25f69a=normalizeJid(_0x1ebe27),_0x4d5948=DateTime[_0x483e14(0x191)]()[_0x483e14(0x14a)](CONFIG[_0x483e14(0x1c0)]),_0x45d8a5=_0x4d5948['toFormat'](_0x483e14(0x125));try{const _0x59176f=await db[_0x483e14(0x228)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20U'+'PDATE\x20acti'+_0x483e14(0x105)+'\x20\x20\x20\x20\x20\x20\x20SET'+_0x483e14(0x1d4)+'ount\x20=\x20mes'+'sage_count'+_0x483e14(0x223)+_0x483e14(0x14f)+'\x20?,\x20last_u'+_0x483e14(0x1d8)+_0x483e14(0x182)+'HERE\x20chat_'+'jid\x20=\x20?\x20AN'+_0x483e14(0x1db)+_0x483e14(0x112)+_0x483e14(0xdb)+_0x483e14(0x10c)+_0x483e14(0x189)+_0x483e14(0x196)+_0x483e14(0x210),[_0x362e6d[_0x483e14(0x1d5)]||_0x362e6d['senderName']||'',Math[_0x483e14(0xf4)](_0x4d5948[_0x483e14(0x1c1)]()),_0x826141,_0x25f69a,_0x45d8a5]);(!_0x59176f||!_0x59176f[_0x483e14(0x1e7)])&&await db[_0x483e14(0x228)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x483e14(0xf6)+_0x483e14(0x20c)+'stats\x20(cha'+_0x483e14(0x1cd)+_0x483e14(0x16e)+_0x483e14(0x1de)+_0x483e14(0x1b5)+'message_co'+_0x483e14(0x16d)+'ay_name,\x20l'+'ast_update'+_0x483e14(0xfc)+_0x483e14(0x1fb)+'(?,\x20?,\x20\x27da'+'ily\x27,\x20?,\x201'+_0x483e14(0x1f7)+_0x483e14(0x17d),[_0x826141,_0x25f69a,_0x45d8a5,_0x362e6d[_0x483e14(0x1d5)]||_0x362e6d[_0x483e14(0x1e9)]||'',Math[_0x483e14(0xf4)](_0x4d5948['toSeconds']())]);}catch(_0x431646){warn(_0x483e14(0x1b7)+_0x483e14(0x1f8)+_0x483e14(0x1a4)+':\x20'+(_0x431646?.[_0x483e14(0x137)]||_0x431646));}}catch(_0x406f4a){warn('[active]\x20t'+'rackMessag'+_0x483e14(0x114)+_0x483e14(0x18a)+(_0x406f4a?.[_0x483e14(0x137)]||_0x406f4a));}}function _0x22bb(_0x34c4cd,_0x919be7){const _0x4b1de3=_0x2179();return _0x22bb=function(_0x3b190b,_0x16bf97){_0x3b190b=_0x3b190b-(0x223+-0x14+-0x1*0x139);let _0xec1c45=_0x4b1de3[_0x3b190b];return _0xec1c45;},_0x22bb(_0x34c4cd,_0x919be7);}async function performRollups(){const _0x2d341a=_0x3acca5;try{const _0x25518e=DateTime[_0x2d341a(0x191)]()[_0x2d341a(0x14a)](CONFIG[_0x2d341a(0x1c0)]),_0x1ad9a9=_0x25518e['minus']({'days':CONFIG[_0x2d341a(0x1ae)+_0x2d341a(0x173)+'S']})[_0x2d341a(0x185)](_0x2d341a(0x21e)),_0x70ada3=_0x1ad9a9[_0x2d341a(0x138)](_0x2d341a(0x125)),_0x4e77f3=await db[_0x2d341a(0x226)](_0x2d341a(0x222)+_0x2d341a(0x221)+'\x20user_jid,'+_0x2d341a(0x159)+_0x2d341a(0x130)+_0x2d341a(0xf7)+_0x2d341a(0x229)+'\x20FROM\x20acti'+'ve_stats\x20W'+'HERE\x20timef'+_0x2d341a(0x13a)+_0x2d341a(0x1e8)+'ucket_key\x20'+_0x2d341a(0x208),[_0x70ada3]);if(_0x4e77f3&&_0x4e77f3['length']){const _0x5404b2=new Map();for(const _0x26af90 of _0x4e77f3){const _0x4a2220=DateTime['fromFormat'](_0x26af90['bucket_key'],_0x2d341a(0x125),{'zone':CONFIG['TIME_ZONE']}),_0x70cfa3=_0x4a2220['weekYear']+'-'+String(_0x4a2220[_0x2d341a(0x190)])[_0x2d341a(0xda)](-0x2*-0x1b1+-0x178+-0x1e8,'0'),_0x353d45=_0x26af90[_0x2d341a(0x1c9)]+'||'+_0x26af90[_0x2d341a(0x1f2)]+_0x2d341a(0x1b1)+_0x70cfa3;if(!_0x5404b2['has'](_0x353d45))_0x5404b2['set'](_0x353d45,{'chat_jid':_0x26af90[_0x2d341a(0x1c9)],'user_jid':_0x26af90[_0x2d341a(0x1f2)],'timeframe':_0x2d341a(0x11a),'bucket_key':_0x70cfa3,'message_count':0x0,'display_name':_0x26af90[_0x2d341a(0x219)+'me']||''});const _0x435b03=_0x5404b2[_0x2d341a(0x14d)](_0x353d45);_0x435b03['message_co'+'unt']+=Number(_0x26af90['message_co'+'unt']||0x201a+-0x1bbd*-0x1+0x3bd7*-0x1);}for(const _0x5d1af0 of _0x5404b2[_0x2d341a(0x110)]()){const _0x2224a6=await db[_0x2d341a(0x14d)](_0x2d341a(0xdd)+_0x2d341a(0x12e)+_0x2d341a(0x1f9)+_0x2d341a(0xe2)+'id\x20=\x20?\x20AND'+'\x20user_jid\x20'+_0x2d341a(0x1e4)+_0x2d341a(0xdf)+_0x2d341a(0x212)+_0x2d341a(0x189)+_0x2d341a(0x199)+'MIT\x201',[_0x5d1af0[_0x2d341a(0x1c9)],_0x5d1af0[_0x2d341a(0x1f2)],_0x5d1af0[_0x2d341a(0xec)]]);!_0x2224a6?await db['run'](_0x2d341a(0x1a7)+_0x2d341a(0x20b)+'tats\x20(chat'+_0x2d341a(0x18b)+_0x2d341a(0x217)+_0x2d341a(0xe8)+_0x2d341a(0x200)+_0x2d341a(0x102)+_0x2d341a(0x1e2)+_0x2d341a(0x231)+_0x2d341a(0x151)+_0x2d341a(0x1b8)+'?,\x20?,\x20\x27wee'+_0x2d341a(0x1bf)+_0x2d341a(0x1a9),[_0x5d1af0['chat_jid'],_0x5d1af0[_0x2d341a(0x1f2)],_0x5d1af0[_0x2d341a(0xec)],_0x5d1af0[_0x2d341a(0x15e)+_0x2d341a(0xfb)],_0x5d1af0[_0x2d341a(0x219)+'me']||'',Math['floor'](_0x25518e['toSeconds']())]):await db[_0x2d341a(0x228)](_0x2d341a(0x1d0)+'ive_stats\x20'+_0x2d341a(0x1f0)+_0x2d341a(0x19d)+'message_co'+_0x2d341a(0x131)+'isplay_nam'+'e\x20=\x20?,\x20las'+_0x2d341a(0x100)+_0x2d341a(0x195)+_0x2d341a(0x1dd),[_0x5d1af0[_0x2d341a(0x15e)+_0x2d341a(0xfb)],_0x5d1af0[_0x2d341a(0x219)+'me']||'',Math[_0x2d341a(0xf4)](_0x25518e[_0x2d341a(0x1c1)]()),_0x2224a6['id']]);}try{const _0x51896c=_0x4e77f3[_0x2d341a(0x21d)](_0x49cb7a=>_0x49cb7a['id']);for(let _0x102063=0x6*0x60a+-0x1def+-0x64d;_0x102063<_0x51896c[_0x2d341a(0x18d)];_0x102063+=0xc61+0x623*0x2+-0x27*0x95){const _0x1ef01e=_0x51896c[_0x2d341a(0x116)](_0x102063,_0x102063+(-0x1*0x234+0x99+0x38f)),_0x4872a3=_0x2d341a(0x178)+_0x2d341a(0x1c2)+_0x2d341a(0x11f)+_0x2d341a(0xde)+_0x1ef01e[_0x2d341a(0x21d)](()=>'?')[_0x2d341a(0x13e)](',')+')';await db[_0x2d341a(0x228)](_0x4872a3,_0x1ef01e);}}catch(_0x1051fd){warn(_0x2d341a(0x128)+_0x2d341a(0x1ec)+_0x2d341a(0xe4)+_0x2d341a(0x12d)+(_0x1051fd?.[_0x2d341a(0x137)]||_0x1051fd));}}const _0x39b0ba=_0x25518e[_0x2d341a(0x1e5)]({'days':CONFIG[_0x2d341a(0x1ae)+_0x2d341a(0x1cc)+'YS']})[_0x2d341a(0x1c1)](),_0x29c628=await db[_0x2d341a(0x226)](_0x2d341a(0x222)+_0x2d341a(0x221)+_0x2d341a(0x1ce)+'\x20bucket_ke'+_0x2d341a(0x130)+'_count,\x20di'+_0x2d341a(0x229)+_0x2d341a(0xeb)+_0x2d341a(0x144)+'HERE\x20timef'+_0x2d341a(0x1a1)+_0x2d341a(0x218));if(_0x29c628&&_0x29c628[_0x2d341a(0x18d)]){const _0xe8bf7b=new Map();for(const _0x42c9d3 of _0x29c628){const _0x52d790=String(_0x42c9d3[_0x2d341a(0xec)]||'')['split']('-'),_0xab9927=Number(_0x52d790[0x17a6+-0x25f9+-0xe53*-0x1])||0x1f*0xe2+-0x10c*-0x8+-0x1c0c,_0x4e0d09=Number(_0x52d790[-0x13c4+0x5ff+-0x1*-0xdc6])||0x2*0xfd6+-0x1317+-0xe6*0xe,_0x380f5a=DateTime[_0x2d341a(0x169)]({'weekYear':_0xab9927,'weekNumber':_0x4e0d09,'weekday':0x1,'zone':CONFIG[_0x2d341a(0x1c0)]});if(_0x380f5a[_0x2d341a(0x1c1)]()>_0x39b0ba)continue;const _0x4d7b41=_0x380f5a[_0x2d341a(0x15c)]+'-'+String(_0x380f5a[_0x2d341a(0x206)])[_0x2d341a(0xda)](-0x137b+0x35b+0x1022,'0'),_0x19e982=_0x42c9d3[_0x2d341a(0x1c9)]+'||'+_0x42c9d3['user_jid']+(_0x2d341a(0x1ed)+'|')+_0x4d7b41;if(!_0xe8bf7b[_0x2d341a(0x19e)](_0x19e982))_0xe8bf7b['set'](_0x19e982,{'chat_jid':_0x42c9d3['chat_jid'],'user_jid':_0x42c9d3['user_jid'],'timeframe':_0x2d341a(0x1bd),'bucket_key':_0x4d7b41,'message_count':0x0,'display_name':_0x42c9d3[_0x2d341a(0x219)+'me']||'','sourceIds':[]});const _0x2f502c=_0xe8bf7b[_0x2d341a(0x14d)](_0x19e982);_0x2f502c[_0x2d341a(0x15e)+_0x2d341a(0xfb)]+=Number(_0x42c9d3[_0x2d341a(0x15e)+'unt']||-0xb*-0x35b+0xb*-0x351+0xa*-0xb),_0x2f502c[_0x2d341a(0x163)][_0x2d341a(0x20e)](_0x42c9d3['id']);}for(const _0xf8d94d of _0xe8bf7b['values']()){const _0x3d4039=await db[_0x2d341a(0x14d)](_0x2d341a(0xdd)+_0x2d341a(0x12e)+_0x2d341a(0x1f9)+'ERE\x20chat_j'+_0x2d341a(0x170)+_0x2d341a(0x1ca)+'=\x20?\x20AND\x20ti'+_0x2d341a(0xdf)+_0x2d341a(0x15f)+_0x2d341a(0xea)+_0x2d341a(0x11e)+_0x2d341a(0x175),[_0xf8d94d['chat_jid'],_0xf8d94d['user_jid'],_0xf8d94d['bucket_key']]);!_0x3d4039?await db[_0x2d341a(0x228)](_0x2d341a(0x1a7)+'O\x20active_s'+_0x2d341a(0x1ac)+_0x2d341a(0x18b)+'_jid,\x20time'+'frame,\x20buc'+_0x2d341a(0x200)+_0x2d341a(0x102)+_0x2d341a(0x1e2)+_0x2d341a(0x231)+'st_updated'+_0x2d341a(0x1b8)+'?,\x20?,\x20\x27mon'+'thly\x27,\x20?,\x20'+_0x2d341a(0x156),[_0xf8d94d[_0x2d341a(0x1c9)],_0xf8d94d['user_jid'],_0xf8d94d[_0x2d341a(0xec)],_0xf8d94d[_0x2d341a(0x15e)+'unt'],_0xf8d94d['display_na'+'me']||'',Math[_0x2d341a(0xf4)](_0x25518e[_0x2d341a(0x1c1)]())]):await db[_0x2d341a(0x228)](_0x2d341a(0x1d0)+_0x2d341a(0x109)+_0x2d341a(0x1f0)+_0x2d341a(0x19d)+_0x2d341a(0x15e)+'unt\x20+\x20?,\x20d'+_0x2d341a(0x204)+_0x2d341a(0x19c)+_0x2d341a(0x100)+_0x2d341a(0x195)+_0x2d341a(0x1dd),[_0xf8d94d[_0x2d341a(0x15e)+_0x2d341a(0xfb)],_0xf8d94d[_0x2d341a(0x219)+'me']||'',Math[_0x2d341a(0xf4)](_0x25518e[_0x2d341a(0x1c1)]()),_0x3d4039['id']]);if(Array['isArray'](_0xf8d94d['sourceIds'])&&_0xf8d94d['sourceIds'][_0x2d341a(0x18d)])for(let _0x186289=-0x12d1*-0x2+-0x8*0x26+-0x2472;_0x186289<_0xf8d94d[_0x2d341a(0x163)][_0x2d341a(0x18d)];_0x186289+=-0x181e+0x9e4+-0x6d*-0x26){const _0x212591=_0xf8d94d[_0x2d341a(0x163)][_0x2d341a(0x116)](_0x186289,_0x186289+(-0x21da+-0x1dc7+0x4195)),_0x5cf04e=_0x2d341a(0x178)+_0x2d341a(0x1c2)+'tats\x20WHERE'+_0x2d341a(0xde)+_0x212591['map'](()=>'?')[_0x2d341a(0x13e)](',')+')';await db[_0x2d341a(0x228)](_0x5cf04e,_0x212591);}}}const _0x330219=_0x25518e[_0x2d341a(0x1e5)]({'days':CONFIG['ROLLOVER_T'+'O_YEAR_DAY'+'S']})[_0x2d341a(0x1c1)](),_0x5bed60=await db[_0x2d341a(0x226)](_0x2d341a(0x222)+_0x2d341a(0x221)+_0x2d341a(0x1ce)+_0x2d341a(0x159)+'y,\x20message'+_0x2d341a(0xf7)+_0x2d341a(0x229)+_0x2d341a(0xeb)+_0x2d341a(0x144)+_0x2d341a(0x203)+_0x2d341a(0x11d)+_0x2d341a(0xd9));if(_0x5bed60&&_0x5bed60[_0x2d341a(0x18d)]){const _0x3aca63=new Map();for(const _0x4c65b5 of _0x5bed60){const _0x372c37=String(_0x4c65b5[_0x2d341a(0xec)]||'')[_0x2d341a(0xef)]('-'),_0x632672=Number(_0x372c37[0xb74+0x2bb*0x3+0x2f*-0x6b])||-0xda+-0xee1+0x176d,_0x202c90=DateTime[_0x2d341a(0x169)]({'year':_0x632672,'month':0x1,'day':0x1,'zone':CONFIG[_0x2d341a(0x1c0)]});if(_0x202c90[_0x2d341a(0x1c1)]()>_0x330219)continue;const _0x53dc73=''+_0x632672,_0x2f6b11=_0x4c65b5['chat_jid']+'||'+_0x4c65b5[_0x2d341a(0x1f2)]+_0x2d341a(0x197)+_0x53dc73;if(!_0x3aca63['has'](_0x2f6b11))_0x3aca63[_0x2d341a(0xe3)](_0x2f6b11,{'chat_jid':_0x4c65b5[_0x2d341a(0x1c9)],'user_jid':_0x4c65b5['user_jid'],'timeframe':_0x2d341a(0x1fc),'bucket_key':_0x53dc73,'message_count':0x0,'display_name':_0x4c65b5['display_na'+'me']||'','sourceIds':[]});const _0x5a68d0=_0x3aca63[_0x2d341a(0x14d)](_0x2f6b11);_0x5a68d0[_0x2d341a(0x15e)+_0x2d341a(0xfb)]+=Number(_0x4c65b5[_0x2d341a(0x15e)+_0x2d341a(0xfb)]||0x1f07*0x1+0x1*0x153d+0x8b6*-0x6),_0x5a68d0[_0x2d341a(0x163)]['push'](_0x4c65b5['id']);}for(const _0xd7a426 of _0x3aca63[_0x2d341a(0x110)]()){const _0x50c8e4=await db[_0x2d341a(0x14d)](_0x2d341a(0xdd)+_0x2d341a(0x12e)+'e_stats\x20WH'+'ERE\x20chat_j'+_0x2d341a(0x170)+'\x20user_jid\x20'+_0x2d341a(0x1e4)+_0x2d341a(0xdf)+'\x27yearly\x27\x20A'+_0x2d341a(0x189)+_0x2d341a(0x199)+_0x2d341a(0x167),[_0xd7a426[_0x2d341a(0x1c9)],_0xd7a426[_0x2d341a(0x1f2)],_0xd7a426['bucket_key']]);!_0x50c8e4?await db['run']('INSERT\x20INT'+_0x2d341a(0x20b)+_0x2d341a(0x1ac)+_0x2d341a(0x18b)+'_jid,\x20time'+'frame,\x20buc'+'ket_key,\x20m'+_0x2d341a(0x102)+_0x2d341a(0x1e2)+_0x2d341a(0x231)+_0x2d341a(0x151)+_0x2d341a(0x1b8)+'?,\x20?,\x20\x27yea'+_0x2d341a(0x165)+',\x20?,\x20?)',[_0xd7a426[_0x2d341a(0x1c9)],_0xd7a426['user_jid'],_0xd7a426[_0x2d341a(0xec)],_0xd7a426['message_co'+_0x2d341a(0xfb)],_0xd7a426['display_na'+'me']||'',Math[_0x2d341a(0xf4)](_0x25518e['toSeconds']())]):await db[_0x2d341a(0x228)]('UPDATE\x20act'+_0x2d341a(0x109)+'SET\x20messag'+_0x2d341a(0x19d)+_0x2d341a(0x15e)+'unt\x20+\x20?,\x20d'+_0x2d341a(0x204)+'e\x20=\x20?,\x20las'+_0x2d341a(0x100)+'=\x20?\x20WHERE\x20'+_0x2d341a(0x1dd),[_0xd7a426[_0x2d341a(0x15e)+_0x2d341a(0xfb)],_0xd7a426['display_na'+'me']||'',Math['floor'](_0x25518e[_0x2d341a(0x1c1)]()),_0x50c8e4['id']]);if(Array[_0x2d341a(0x1eb)](_0xd7a426['sourceIds'])&&_0xd7a426[_0x2d341a(0x163)][_0x2d341a(0x18d)])for(let _0x53cde2=-0x1f*0x126+0xacb+0x18cf;_0x53cde2<_0xd7a426[_0x2d341a(0x163)]['length'];_0x53cde2+=0x25af+-0x4*-0x527+-0x3857){const _0x15b341=_0xd7a426[_0x2d341a(0x163)]['slice'](_0x53cde2,_0x53cde2+(-0x5ed*-0x1+-0x1*0x748+0xb*0x4d)),_0x5f2a02='DELETE\x20FRO'+_0x2d341a(0x1c2)+_0x2d341a(0x11f)+_0x2d341a(0xde)+_0x15b341[_0x2d341a(0x21d)](()=>'?')['join'](',')+')';await db[_0x2d341a(0x228)](_0x5f2a02,_0x15b341);}}}try{const _0x413173=DateTime[_0x2d341a(0x191)]()[_0x2d341a(0x14a)](CONFIG[_0x2d341a(0x1c0)])[_0x2d341a(0x1e5)]({'days':CONFIG[_0x2d341a(0x160)+_0x2d341a(0x1f1)]})['toFormat'](_0x2d341a(0x125));await db['run'](_0x2d341a(0x178)+'M\x20active_s'+'tats\x20WHERE'+_0x2d341a(0x1c5)+_0x2d341a(0x132)+_0x2d341a(0x17b)+_0x2d341a(0xf0),[_0x413173]);}catch(_0xd561fe){warn(_0x2d341a(0x154)+_0x2d341a(0xf8)+_0x2d341a(0x12d)+(_0xd561fe?.['message']||_0xd561fe));}info(_0x2d341a(0xf9)+_0x2d341a(0x179)+_0x2d341a(0x1f4));}catch(_0x4dc560){error(_0x4dc560,_0x2d341a(0x154)+_0x2d341a(0xe9)+_0x2d341a(0x140)+':\x20'+(_0x4dc560?.[_0x2d341a(0x137)]||_0x4dc560));}}function parsePeriodArg(_0x19e257){const _0x401f0a=_0x3acca5;if(!_0x19e257)return null;const _0x117c4a=String(_0x19e257)[_0x401f0a(0x141)]()[_0x401f0a(0xfa)+'e']()['match'](/^(\d+)\s*([dwmy])$/);if(!_0x117c4a)return null;return{'amount':Number(_0x117c4a[0x1193+0x17f6+-0x2988]),'unit':_0x117c4a[0x2aa*-0x5+-0x25e*0x2+0x1210]};}function computeCutoffSeconds(_0x4a3944,_0x394673){const _0x2302bc=_0x3acca5,_0x117010=DateTime['now']()[_0x2302bc(0x14a)](CONFIG[_0x2302bc(0x1c0)]);let _0x24ac26;if(_0x394673==='d')_0x24ac26=_0x117010['minus']({'days':_0x4a3944});else{if(_0x394673==='w')_0x24ac26=_0x117010[_0x2302bc(0x1e5)]({'weeks':_0x4a3944});else{if(_0x394673==='m')_0x24ac26=_0x117010['minus']({'months':_0x4a3944});else{if(_0x394673==='y')_0x24ac26=_0x117010['minus']({'years':_0x4a3944});else _0x24ac26=_0x117010['minus']({'days':_0x4a3944});}}}return Math[_0x2302bc(0xf4)](_0x24ac26['toSeconds']());}async function buildLeaderboardForChat(_0x15b362,_0x2e20b8,_0x19e04e=CONFIG[_0x3acca5(0x1fe)+_0x3acca5(0x19f)]){const _0x2d36c8=_0x3acca5;try{const _0xfc05=DateTime['fromSecond'+'s'](_0x2e20b8)[_0x2d36c8(0x14a)](CONFIG[_0x2d36c8(0x1c0)]),_0x120559=_0xfc05[_0x2d36c8(0x138)]('yyyy-LL-dd'),_0x5b8e6f=await db[_0x2d36c8(0x226)](_0x2d36c8(0x14c)+'ECT\x20user_j'+'id,\x20displa'+_0x2d36c8(0x205)+_0x2d36c8(0x1d1)+_0x2d36c8(0x143)+_0x2d36c8(0x1b0)+_0x2d36c8(0x148)+_0x2d36c8(0x1ad)+_0x2d36c8(0x153)+_0x2d36c8(0x12e)+'e_stats\x0a\x20\x20'+'\x20\x20\x20\x20WHERE\x20'+_0x2d36c8(0x15d)+_0x2d36c8(0x1e3)+_0x2d36c8(0x127)+_0x2d36c8(0x1bb)+_0x2d36c8(0x159)+'y\x20>=\x20?\x0a\x20\x20\x20'+_0x2d36c8(0x16b)+_0x2d36c8(0x1af)+'\x0a\x20\x20\x20\x20',[_0x15b362,_0x120559]),_0x42536f=new Map();for(const _0x3ac3bb of _0x5b8e6f||[]){const _0x337dad=normalizeJid(_0x3ac3bb[_0x2d36c8(0x1f2)]);_0x42536f[_0x2d36c8(0xe3)](_0x337dad,{'user_jid':_0x337dad,'display_name':_0x3ac3bb['display_na'+'me']||_0x337dad['split']('@')[0x224b+-0x1*0x2597+0x34c],'count':Number(_0x3ac3bb[_0x2d36c8(0x17f)]||-0x36*-0x19+0xdbb+0x2b7*-0x7),'last_ts':Number(_0x3ac3bb['last_ts']||-0x3*0x65b+-0xe4+0x3*0x6a7)});}const _0x525183=await db['all'](_0x2d36c8(0x21a)+_0x2d36c8(0x16e)+_0x2d36c8(0x1de)+_0x2d36c8(0x1b5)+_0x2d36c8(0x15e)+_0x2d36c8(0x16d)+_0x2d36c8(0x155)+_0x2d36c8(0x11b)+_0x2d36c8(0x174)+_0x2d36c8(0x213)+_0x2d36c8(0x112)+'imeframe\x20I'+_0x2d36c8(0x104)+'\x27,\x27monthly'+_0x2d36c8(0x13b)+')',[_0x15b362]);for(const _0x429895 of _0x525183||[]){let _0x4f64b8=![];try{if(_0x429895[_0x2d36c8(0x22c)]===_0x2d36c8(0x11a)){const _0x3beb27=String(_0x429895[_0x2d36c8(0xec)]||'')[_0x2d36c8(0xef)]('-'),_0x2f6861=Number(_0x3beb27[-0xc8f+-0x6df+0x136e])||-0x115a+-0x243d*0x1+0x3d49,_0x2888e1=Number(_0x3beb27[0x1*0x132e+0x1*-0xd81+0x4*-0x16b])||0x1a7*0x5+-0x24f5*-0x1+0x90b*-0x5,_0x1f3ae0=DateTime[_0x2d36c8(0x169)]({'weekYear':_0x2f6861,'weekNumber':_0x2888e1,'weekday':0x1})[_0x2d36c8(0x14a)](CONFIG[_0x2d36c8(0x1c0)]);if(_0x1f3ae0[_0x2d36c8(0x1c1)]()>=_0x2e20b8)_0x4f64b8=!![];}else{if(_0x429895['timeframe']===_0x2d36c8(0x1bd)){const _0x5234f4=String(_0x429895[_0x2d36c8(0xec)]||'')[_0x2d36c8(0xef)]('-'),_0x31cc42=Number(_0x5234f4[-0x23e3+-0x1448+0x3*0x12b9])||-0x775+0x1040+-0x119*0x1,_0x5618e9=Number(_0x5234f4[0x2*-0x439+0xa44+-0x1*0x1d1])||0x1270+-0x377*-0xb+-0x814*0x7,_0x470328=DateTime[_0x2d36c8(0x169)]({'year':_0x31cc42,'month':_0x5618e9,'day':0x1})[_0x2d36c8(0x14a)](CONFIG[_0x2d36c8(0x1c0)]);if(_0x470328['toSeconds']()>=_0x2e20b8)_0x4f64b8=!![];}else{if(_0x429895[_0x2d36c8(0x22c)]===_0x2d36c8(0x1fc)){const _0x445828=Number(String(_0x429895['bucket_key']||'')[_0x2d36c8(0xef)]('-')[0xc5e+0xb*-0x114+-0x82])||-0x3b8*-0x3+0xe*-0x105+0xad0,_0x2308b6=DateTime['fromObject']({'year':_0x445828,'month':0x1,'day':0x1})[_0x2d36c8(0x14a)](CONFIG[_0x2d36c8(0x1c0)]);if(_0x2308b6[_0x2d36c8(0x1c1)]()>=_0x2e20b8)_0x4f64b8=!![];}else _0x4f64b8=!![];}}}catch(_0x1b8da4){_0x4f64b8=!![];}if(!_0x4f64b8)continue;const _0x4c1532=normalizeJid(_0x429895[_0x2d36c8(0x1f2)]);if(!_0x42536f['has'](_0x4c1532))_0x42536f[_0x2d36c8(0xe3)](_0x4c1532,{'user_jid':_0x4c1532,'display_name':_0x429895[_0x2d36c8(0x219)+'me']||_0x4c1532['split']('@')[-0x409*-0x3+0x13e5+-0x2000],'count':0x0,'last_ts':0x0});_0x42536f['get'](_0x4c1532)['count']+=Number(_0x429895['message_co'+_0x2d36c8(0xfb)]||0x7*-0x2a8+0x25*0xca+0x54d*-0x2);}const _0x299798=Array['from'](_0x42536f[_0x2d36c8(0x110)]())[_0x2d36c8(0x120)]((_0x566faf,_0x56d29f)=>_0x56d29f[_0x2d36c8(0x164)]-_0x566faf[_0x2d36c8(0x164)]||_0x56d29f['last_ts']-_0x566faf[_0x2d36c8(0x18f)]);return _0x299798[_0x2d36c8(0x116)](0x2d*0x5e+0x1d8b+-0x2e11,_0x19e04e);}catch(_0x397c36){return warn(_0x2d36c8(0x122)+_0x2d36c8(0x1fa)+_0x2d36c8(0x118)+_0x2d36c8(0x1a0)+(_0x397c36?.[_0x2d36c8(0x137)]||_0x397c36)),[];}}async function getGroupParticipants(_0x3e6872,_0x55a389){const _0x33de44=_0x3acca5;try{if(!_0x3e6872||typeof _0x3e6872[_0x33de44(0x18e)+_0x33de44(0x1cf)]!==_0x33de44(0x101))return[];const _0x4a6bd4=await _0x3e6872[_0x33de44(0x18e)+_0x33de44(0x1cf)](_0x55a389),_0x1a779e=Array[_0x33de44(0x1eb)](_0x4a6bd4?.[_0x33de44(0x22d)+'ts'])?_0x4a6bd4['participan'+'ts']:Object[_0x33de44(0x110)](_0x4a6bd4?.[_0x33de44(0x22d)+'ts']||{}),_0x29dd26=_0x1a779e[_0x33de44(0x21d)](_0x4b3c94=>_0x4b3c94['id'])[_0x33de44(0x207)](Boolean)[_0x33de44(0x21d)](normalizeJid);return _0x29dd26;}catch(_0x4c6adf){return warn(_0x33de44(0x1a2)+_0x33de44(0x1e1)+_0x33de44(0x17a)+_0x33de44(0x1b4)+'\x20'+_0x55a389+':\x20'+(_0x4c6adf?.[_0x33de44(0x137)]||_0x4c6adf)),[];}}export async function initialize(_0x570167){const _0x4a2594=_0x3acca5;try{botRef=_0x570167;if(botRef){if(typeof botRef[_0x4a2594(0x19b)+'e']==='function')sendApi=(_0x55ca5b,_0x509be6)=>botRef[_0x4a2594(0x19b)+'e'](_0x55ca5b,_0x509be6);else{if(botRef[_0x4a2594(0x211)]&&typeof botRef[_0x4a2594(0x211)][_0x4a2594(0x19b)+'e']===_0x4a2594(0x101))sendApi=(_0x1964f9,_0x3909f6)=>botRef['sock']['sendMessag'+'e'](_0x1964f9,_0x3909f6);else sendApi=null;}}try{const _0x19965b=getConfig()||{};if(_0x19965b[_0x4a2594(0x230)]&&typeof _0x19965b[_0x4a2594(0x230)]===_0x4a2594(0x12a))CONFIG={...CONFIG,..._0x19965b[_0x4a2594(0x230)]};}catch(_0x3e767a){warn(_0x4a2594(0x1c8)+'ailed\x20to\x20r'+'ead\x20config'+_0x4a2594(0x181)+(_0x3e767a?.[_0x4a2594(0x137)]||_0x3e767a));}await ensureSchema(),await performRollups(),info(_0x4a2594(0x16a)+'nitialized');}catch(_0xb15479){error(_0xb15479,'[active]\x20i'+_0x4a2594(0xff)+'failed:\x20'+(_0xb15479?.[_0x4a2594(0x137)]||_0xb15479));throw _0xb15479;}}export async function onMessage(_0x287bd2){const _0x3eb803=_0x3acca5;try{await trackMessage(_0x287bd2);if(!_0x287bd2?.[_0x3eb803(0x1ee)])return;const _0x51de19=_0x287bd2[_0x3eb803(0x12b)]?.[_0x3eb803(0x1fd)];if(!_0x51de19||!_0x51de19['endsWith'](_0x3eb803(0x172)))return;const _0x3a7f28=await isadmin(botRef,_0x287bd2)[_0x3eb803(0x180)](()=>![]);if(!_0x3a7f28)return;const _0x374fe3=typeof _0x287bd2[_0x3eb803(0x1f3)]===_0x3eb803(0x129)&&_0x287bd2[_0x3eb803(0x1f3)][_0x3eb803(0x141)]()?_0x287bd2[_0x3eb803(0x1f3)]['trim']():'';if(!_0x374fe3)return;const _0x55febb=_0x374fe3[_0x3eb803(0xef)](/\s+/)['filter'](Boolean),_0x20f471=_0x55febb[0x1734+-0x21*0x60+-0x16*0x7e][_0x3eb803(0xfa)+'e']();if(_0x20f471!==_0x3eb803(0x1b9)&&_0x20f471!==_0x3eb803(0xd6))return;const _0x825145=_0x55febb[-0x21*-0x5b+-0x258f+0x19d5]||'1w';let _0x1a5269=parsePeriodArg(_0x825145);if(!_0x1a5269){const _0x4c7d02=parseInt(_0x825145,0xae8+-0x1454+0x976);if(!isNaN(_0x4c7d02))_0x1a5269={'amount':_0x4c7d02,'unit':'d'};else{const _0x5dbd12='Usage:\x20act'+_0x3eb803(0x161)+_0x3eb803(0x12c)+'>\x20\x20OR\x20\x20ina'+_0x3eb803(0x184)+_0x3eb803(0x115)+'|y>\x0aExampl'+_0x3eb803(0x1a5)+_0x3eb803(0x22e)+'e\x201w,\x20inac'+_0x3eb803(0x126);try{await sendApi(_0x51de19,{'text':_0x5dbd12});}catch(_0x4a6861){warn(_0x3eb803(0x162)+'end\x20usage\x20'+_0x3eb803(0x150)+(_0x4a6861?.[_0x3eb803(0x137)]||_0x4a6861));}return;}}try{await performRollups();}catch(_0x526fa4){}const _0x5f1769=computeCutoffSeconds(_0x1a5269[_0x3eb803(0x166)],_0x1a5269[_0x3eb803(0x1f6)]);if(_0x20f471===_0x3eb803(0x1b9)){const _0x3ab0fd=await buildLeaderboardForChat(_0x51de19,_0x5f1769,CONFIG[_0x3eb803(0x1fe)+_0x3eb803(0x19f)]);if(!_0x3ab0fd||_0x3ab0fd[_0x3eb803(0x18d)]===0x1*0x6f7+0x55*0x5c+-0x2583){await sendApi(_0x51de19,{'text':_0x3eb803(0x22f)+'members\x20fo'+'und\x20in\x20the'+_0x3eb803(0xee)+_0x1a5269[_0x3eb803(0x166)]+_0x1a5269[_0x3eb803(0x1f6)]+'.'});return;}let _0x302f47=_0x3eb803(0x136)+_0x3ab0fd[_0x3eb803(0x18d)]+(_0x3eb803(0x157)+_0x3eb803(0x187)+_0x3eb803(0xee))+_0x1a5269[_0x3eb803(0x166)]+_0x1a5269[_0x3eb803(0x1f6)]+_0x3eb803(0x1ea);const _0x291648=[];let _0x38905f=-0x5*-0x518+-0x22f*-0xe+-0x380a;for(const _0x3206b8 of _0x3ab0fd){_0x38905f++;const _0x3f6ad1=_0x3206b8[_0x3eb803(0x1f2)][_0x3eb803(0xef)]('@')[0x3f1*0x8+-0xb2d+-0x145b*0x1];_0x302f47+=_0x3eb803(0x188)+_0x3f6ad1+'\x20('+(_0x3206b8[_0x3eb803(0x219)+'me']||_0x3f6ad1)+')\x0a',_0x302f47+=romanParen(_0x38905f)+'\x20'+_0x3206b8[_0x3eb803(0x164)]+(_0x3eb803(0xd8)+'\x0a'),_0x291648[_0x3eb803(0x20e)](_0x3206b8[_0x3eb803(0x1f2)]);}const _0x4f016f=0x5*-0x5bf+0xcf4+0x1f67*0x1;if(_0x302f47[_0x3eb803(0x18d)]<=_0x4f016f)await sendApi(_0x51de19,{'text':_0x302f47,'mentions':_0x291648});else{const _0xf0d9cf=_0x302f47[_0x3eb803(0xef)]('\x0a\x0a');let _0x4929d8='';for(const _0x121545 of _0xf0d9cf){if((_0x4929d8+'\x0a\x0a'+_0x121545)[_0x3eb803(0x18d)]>_0x4f016f)await sendApi(_0x51de19,{'text':_0x4929d8,'mentions':_0x291648}),_0x4929d8=_0x121545+'\x0a\x0a';else _0x4929d8+=(_0x4929d8?'\x0a\x0a':'')+_0x121545;}if(_0x4929d8['trim']())await sendApi(_0x51de19,{'text':_0x4929d8,'mentions':_0x291648});}return;}if(_0x20f471===_0x3eb803(0xd6)){const _0xa73bc3=botRef?.[_0x3eb803(0x211)]||botRef,_0x31b4cd=await getGroupParticipants(_0xa73bc3,_0x51de19);if(!_0x31b4cd||_0x31b4cd[_0x3eb803(0x18d)]===0x10a5+0x1791+-0x2836){await sendApi(_0x51de19,{'text':_0x3eb803(0x193)+_0x3eb803(0x103)+_0x3eb803(0xd7)+_0x3eb803(0x21c)});return;}const _0x366cbe=await buildLeaderboardForChat(_0x51de19,_0x5f1769,-0x4*-0x58983+0x4ba42+0x27*-0x4c42),_0x4b7bd7=new Set((_0x366cbe||[])['map'](_0x2a57c7=>normalizeJid(_0x2a57c7[_0x3eb803(0x1f2)]))),_0x339d4d=_0x31b4cd[_0x3eb803(0x207)](_0x4f0157=>!_0x4b7bd7[_0x3eb803(0x19e)](normalizeJid(_0x4f0157)));if(!_0x339d4d['length']){await sendApi(_0x51de19,{'text':'No\x20inactiv'+_0x3eb803(0x209)+_0x3eb803(0x198)+_0x3eb803(0x111)+_0x1a5269[_0x3eb803(0x166)]+_0x1a5269[_0x3eb803(0x1f6)]+'.'});return;}let _0x24e62f='Found\x20'+_0x339d4d[_0x3eb803(0x18d)]+(_0x3eb803(0xfe)+_0x3eb803(0xf1)+_0x3eb803(0x201))+_0x1a5269[_0x3eb803(0x166)]+_0x1a5269[_0x3eb803(0x1f6)]+':\x0a\x0a';const _0x2c34ba=[];let _0x4cf427=-0x2076+-0x323*-0x1+0x1d53;for(const _0x28bf2e of _0x339d4d){_0x4cf427++;const _0x5211a7=_0x28bf2e['split']('@')[0x377+-0x1747+0x13d0];_0x24e62f+=_0x3eb803(0x188)+_0x5211a7+'\x20('+_0x5211a7+')\x0a',_0x24e62f+=romanParen(_0x4cf427)+(_0x3eb803(0x146)+_0x3eb803(0x1e0)),_0x2c34ba[_0x3eb803(0x20e)](_0x28bf2e);}await sendApi(_0x51de19,{'text':_0x24e62f,'mentions':_0x2c34ba});return;}}catch(_0x4a4be6){error(_0x4a4be6,_0x3eb803(0x176)+_0x3eb803(0x10b)+_0x3eb803(0x106)+(_0x4a4be6?.[_0x3eb803(0x137)]||_0x4a4be6));}}export async function cleanup(){const _0x1f2867=_0x3acca5;try{for(const _0x41cff2 of processedMessageKeys['values']())try{clearTimeout(_0x41cff2);}catch(_0x262370){}processedMessageKeys[_0x1f2867(0x11c)]();}catch(_0x3cad17){}botRef=null,sendApi=null,info(_0x1f2867(0x1b6)+_0x1f2867(0xdc));}export default{'name':name,'version':version,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};